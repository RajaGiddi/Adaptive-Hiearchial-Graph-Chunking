{"method": "ahgc", "num_chunks": 58, "avg_chunk_len": 1154.9655172413793, "std_chunk_len": 315.1473637521102, "max_chunk_len": 1616, "min_chunk_len": 178, "total_chars": 66988, "compression_ratio": 0.8797097987699289, "chunks": ["PREPRINT VERSION 2025 1 NeuFMT: Optical-Property-Adaptive Fluorescence Molecular Tomography via Implicit Neural Representation arXiv:2511.04510v1 [eess.IV] 6 Nov 2025 Shihan Zhao, Jianru Zhang, Yanan Wu, Linlin Li, Siyuan Shen, Xingjun Zhu, Guoyan Zheng, Member IEEE, Jiahua Jiang, and Wuwei Ren Abstract Fluorescence Molecular Tomography (FMT) is a promising technique for non-invasive 3D visualization of fluorescent probes, but its reconstruction remains challenging due to the inherent ill-posedness and reliance on inaccurate or oftenunknown tissue optical properties. While deep learning methods have shown promise, their supervised nature limits generalization beyond training data. To address these problems, we propose NeuFMT, a self-supervised FMT reconstruction framework that integrates implicit neural-based scene representation with explicit physical modeling of photon propagation. Its key innovation lies in jointly optimize both the fluorescence distribution and the optical properties ( ) during reconstruction, eliminating the need for precise prior knowledge of tissue optics or pre-conditioned training data. We demonstrate that NeuFMT robustly recovers accurate fluorophore distributions and optical coefficients even with severely erroneous initial values (0.5 to 2 of ground truth). Extensive numerical, phantom, and in vivo validations show that NeuFMT outperforms conventional and supervised deep learning approaches across diverse heterogeneous scenarios. Our work establishes a new paradigm for robust", "truth). Extensive numerical, phantom, and in vivo validations show that NeuFMT outperforms conventional and supervised deep learning approaches across diverse heterogeneous scenarios. Our work establishes a new paradigm for robust and accurate FMT reconstruction, paving the way for more reliable molecular imaging in complex clinically related scenarios, such as fluorescence guided surgery. Index Terms fluorescence molecular tomography, image reconstruction, optical properties, implicit neural representation, fluorescence guided surgery The work was supported by Science and Technology Commission of Shanghai Municipality under Grant 25JS2830300 (Wuwei Ren), National Natural Science Foundation of China under Grants 62105205 (Wuwei Ren), and Shanghai Clinical Research and Trial Center (Wuwei Ren). (Corresponding author: Wuwei Ren.) Shihan Zhao and Jianru Zhang contributed equally to this work. Shihan Zhao, Yanan Wu, Linlin Li and Siyuan Shen are with the School of Information Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail: zhaoshh, wuyn1, lill, shensy2023@shanghaitech.edu.cn). Jianru Zhang and Jiahua Jiang are with the School of Mathematics, University of Birmingham, Edgbaston, B15 2QN, United Kingdom (e-mail: jxz389@student.bham.ac.uk; j.jiang.3@bham.ac.uk). Xingjun Zhu is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail: zhuxj1@shanghaitech.edu.cn). Guoyan Zheng is with the Institute of Medical Robotics, School of Biomedical Engineering, Shanghai", "is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail: zhuxj1@shanghaitech.edu.cn). Guoyan Zheng is with the Institute of Medical Robotics, School of Biomedical Engineering, Shanghai Jiao Tong University, Shanghai 200240, China (e-mail: guoyan.zheng@sjtu.edu.cn) Wuwei Ren is with the School of Information Science and Technology, ShanghaiTech University, Shanghai 201210, China, and also with State Key Laboratory of Advanced Medical Materials and Devices, ShanghaiTech University, Shanghai 201210, China (e-mail: renww@shanghaitech.edu.cn).", "I. INTRODUCTION Fluorescence Molecular Tomography (FMT) has emerged as a promising molecular imaging modality, enabling noninvasive 3D visualization of fluorescent probe distribution in highly turbid media [1]. Owning to its high sensitivity, cost-effectiveness, and non-ionizing radiation, FMT has found broad applications in preclinical research and clinical practice, e.g., brain imaging [2], in vitro cell culture monitoring [3] and tumor detection [4]. FMT reconstructs the internal fluorescence distribution by measuring the photon distribution on the object surface and minimizing the discrepancy between real measurements and the simulated results. A canonic framework of FMT reconstruction employs an iterative optimization strategy with a forward model typically based on the Radiation Transfer Equation (RTE) or the diffusion equation (DE) and an inverse model that refines fluorescence distribution prediction until convergence [5], [6]. However, FMT reconstruction is inherently ill-posed due to insufficient surface measurements and strong photon scattering effect within tissues. Development of high-precision FMT reconstruction algorithms is highly attractive for further improvement of the spatial resolution and detection depth of this technology, which ultimately broaden the biological applications in drug discovery [7] and clinical use such as fluorescence guided surgery [8], [9]. To address the ill-posed nature of FMT reconstruction, regularization techniques that incorporate", "broaden the biological applications in drug discovery [7] and clinical use such as fluorescence guided surgery [8], [9]. To address the ill-posed nature of FMT reconstruction, regularization techniques that incorporate prior knowledge are applied. Conventional approaches include Tikhonov (L2 norm) regularization for smoothing the results [10], [11], and sparsepromoting regularization (L1 , Lp norm) or total variation (TV) regularization for enhancing the spatial resolution [12], [13]. Recent advancements in regularization techniques, such as the solution-decomposition algorithm, utilize an advanced stochastic prior model that improves the differentiation of fluorescence targets from background interference, thereby enhancing reconstruction quality [14]. While these methods stabilize solutions, their reliance on time-consuming iterative optimization and idealized assumptions about optical parameters often results in slow convergence and limited accuracy in heterogeneous tissues. Deep learning (DL) methods, particularly en-decoder-based neural networks [15] [21] and graphbased networks [22] [24], have recently been used in FMT reconstruction by learning direct mappings from boundary measurements to fluorescence distributions. These approaches 2 encode physical priors within network parameters, enabling overwhelmingly rapid inference. However, their dependence on supervised training with large, scenario-specific datasets restricts generalizability across variable experimental conditions (e.g., tissue object geometry and optical properties), leading to significant accuracy degradation when the", "However, their dependence on supervised training with large, scenario-specific datasets restricts generalizability across variable experimental conditions (e.g., tissue object geometry and optical properties), leading to significant accuracy degradation when the object properties deviate from training assumptions. Recently, implicit neural representation (INR) models have emerged as a powerful alternative for medical image reconstruction. By mapping arbitrary spatial coordinates to certain unknown physical quantities via a coordinate-based multilayer perceptron network (MLP), INRs achieve continuous 3D representations, self-supervised training, and memory efficiency. Originally popularized in computer vision and medical imaging, INRs have demonstrated remarkable success in modalities such as computed tomography (CT), magnetic resonance imaging (MRI) [25] [29], and notably in diffuse optical tomography (DOT), where INR has been proven to be able to capture a high-resolution, continuous optical absorption map that account for light scattering in complex tissues [30]. INR captures continuous spatial information and integrates physical priors makes it particularly suited for various imaging problems. In the context of FMT, preliminary work has explored position encoding strategies to enhance spatial resolution and improve the quality of FMT reconstructions [31]. Nevertheless, systematic studies integrating optical diffusion physics within an INR framework remain scarce. This gap presents an opportunity to harness the strengths", "and improve the quality of FMT reconstructions [31]. Nevertheless, systematic studies integrating optical diffusion physics within an INR framework remain scarce. This gap presents an opportunity to harness the strengths of implicit modeling for robust and data-efficient FMT reconstruction. To bridge this gap, we propose neural-field-based FMT, or NeuFMT, a physics-driven reconstruction framework unifying INR with explicit physical models. Unlike conventional DLbased FMT reconstruction algorithms that couple explicit fluorescence predictions to implicit physical model, NeuFMT integrates the DE-based forward model in the network loss, enabling self-supervised training without paired data. The differentiability of the forward model is achieved via finite element method (FEM). This inversion-free approach ensures rapid, continuous reconstruction across diverse geometries while inherently addressing scattering effects. Another critical limitation of both traditional and DL methods lies in the presumed optical properties of the object during reconstruction, which largely aggravate the ill-posedness of the inverse problem given the optical parameters were initially biased. To overcome this, we further introduce optical-property-adaptive NeuFMT, or NeuFMT, an adaptive extension of NeuFMT that dynamically optimizes scattering / absorption coefficients and fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations, NeuFMT achieves robust accuracy even when provided with", "dynamically optimizes scattering / absorption coefficients and fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations, NeuFMT achieves robust accuracy even when provided with erroneous initial guess of the optical coefficient values, addressing the problem of unrealistic assumption prior to FMT reconstruction. Both proposed INR-based FMT reconstruction algorithms were thoroughly compared and validated by simulations and phantom experiments along with other methods. Furthermore, in vivo lymph node imaging in mice was performed, further demonstrating the advantages of the proposed methods.", "PREPRINT VERSION 2025 II. M ETHODS A. Forward Modeling of FMT Model-based FMT reconstruction comprises two fundamental steps: forward modeling and inversion. The former predicts surface photon density measurements based on an assumed fluorescence distribution. At the macroscopic scale, we employ the first-order approximation of the radiative transport equation (RTE), known as the diffusion equation (DE) [32]. The excitation and fluorescence emission processes in continuouswave (CW) mode form a coupled pair of DEs expressed as [33], [34]: κ ϕx (r) + a ϕx (r) = qx (r), r , (1) κ ϕm (r) + a ϕm (r) = η C(r) ϕx (r), r , (2) where ϕx and ϕm denote the excitation and emission photon density, qx is the excitation source, C(r) is the fluorophore concentration to be reconstructed in the inversion, and η collects quantum-yield factors in the CW source term. κ represents the diffusion coefficient, calculated by [33] 1 , (3) κ= 3 ( a + s ) with the absorption coefficient a and the reduced scattering coefficient s . In a non-contact setting of FMT, to calculate the value of ϕ (r) on the object surface as the measurement, a Robin-type boundary condition is added alongside the", "s . In a non-contact setting of FMT, to calculate the value of ϕ (r) on the object surface as the measurement, a Robin-type boundary condition is added alongside the equation pair (1 2): ϕ (r) = 0, {x, m}, r , (4) ν where ζ(c) is the refractive index mismatch parameter that accounts for the light reflection on the boundary surface, with c representing the light speed inside the medium. ν denotes the outward normal on the boundary. Notably, to simplified the problem setting, we only consider a homogeneous medium case and the difference of a , s values under different wavelengths are neglected. ϕ (r) + 2 ζ(c) κ B. Finite Element Discretization and System Matrix Construction We apply the finite element method (FEM) [35] to the diffusion model (1) - (4). Discretizing with a tetrahedral N mesh of N i }i=1 , we approximate P nodes and nodal basis {ψP ϕ (r) i Φ ,i ψi (r) and qx (r) i (Qx )i ψi (r), which transforms the continuous-form equations into a linear system for excitation and emission photon propagation: S Φx = Qx (5) S Φm = Qm (6) where S RN N is the system", "the continuous-form equations into a linear system for excitation and emission photon propagation: S Φx = Qx (5) S Φm = Qm (6) where S RN N is the system matrix and Φ , Q RN are discretized form (coefficient vectors) for ϕ and q , respectively. In particular, the excitation field ϕx interacts with fluorophores C RN to produce the emission source term Qm = C Φx (7) with denoting element-wise multiplication. The equation (7) physically describes how fluorophores absorb excitation ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION explicitly reveals the functional dependence of S on the optical parameters a and s , which forms the mathematical foundation for our adaptive optimization approach introduced in Subsection II-C.", "(b) (a) 3 Camera Filter Wheel Real Measurement Sample C. INR-based FMT reconstruction: NeuFMT / NeuFMT Scanners Laser Predicted Measurement Focal Lens OD Filter (c) (d) Adaption Module Forward Model Based on DE Absorption Term High Absorption Low Absorption inv Di usion Term High Scattering Sti ness Matrix Low Scattering Boundary Term (e) Forward Data Backward Gradient Fluorescence Distribution Encoded with INR Node Coordinate 3D Mesh with Nodes sine cosine Positional Encoding MLP Fig. 1. Conceptual illustration of NeuFMT. (a) The FMT setup: a scanned laser illuminates the sample while a CMOS camera with filter wheel on the opposite side records boundary images. The raster scanning method yields the raw 2D image stack M real , serving as the input to the subsequent FMT reconstruction. (b) The difference between M real and the simulated meac( a , , Cθ ) is iteratively minimized until an optimized value surement M s of unknown fluorescence distribution C is found. R(C) is a regularization term and { a , s } is the intrinsic optical properties consisting of absorption coefficient a and scattering coefficient s . (c) A -adaption module is integrated into the FMT reconstruction. The stiffness matrix S is determined by", "intrinsic optical properties consisting of absorption coefficient a and scattering coefficient s . (c) A -adaption module is integrated into the FMT reconstruction. The stiffness matrix S is determined by both a and s . (d) The FEM-based simulator predicts virtual c( a , , Cθ ) based on the operator S 1 ( ) and predicted measurement M s fluorescence distribution C. (e) Fluorescence distribution encoded in an INR. 3D node coordinate serves as input, while a continuous C map is generated through positional encoding and an MLP network. Unlike traditional voxel-based or mesh-dependent representations, INR provides a continuous, memory-efficient framework for modeling complex physical fields. The basic variant, NeuFMT, learns only the fluorophore Cθ with fixed optical properties; the proposed adaptive NeuFMT jointly optimizes the optical coefficients ( a , s ) with Cθ for enhancing the reconstruction accuracy and robustness. In this section, we describe the NeuFMT representation, formulate the learning objective, introduce optical-property adaptation, and summarize the network architecture and implementation. 1) INR representation of the unknown fluorescence: Our NeuFMT model the 3D fluorescence field as an INR, i.e., a coordinate-conditioned MLP: Cθ (r) = fθ Γ (r) , (10) where r = (x, y, z)", "unknown fluorescence: Our NeuFMT model the 3D fluorescence field as an INR, i.e., a coordinate-conditioned MLP: Cθ (r) = fθ Γ (r) , (10) where r = (x, y, z) R3 , Γ : Rd is a highdimensional positional encoding of spatial coordinates, and fθ : Rd R is an MLP with parameters θ. This INR formulation (10) enables resolution-independent reconstruction and naturally accommodates arbitrary spatial queries without being constrained by the conventional discrete grid structure. To enhance the network s ability to represent high-frequency details, which is crucial for resolving complex in vivo fluorescence patterns, we apply a sinusoidal positional encoding to each coordinate component. Let γ : R R2L be γ(p) = sin(20 πp), cos(20 πp), , L 1 sin(2 πp), cos(2 L 1 (11) πp) , p {x, y, z}, photons and re-emit light at longer wavelengths. The emission source Qm then propagates through the same medium to produce the emission photon density Φm , which is finally detected at the boundary, which is computed as where L is the number of frequency bands. The 3D position is then encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that d = 6L. Feeding Γ (r)", "L is the number of frequency bands. The 3D position is then encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that d = 6L. Feeding Γ (r) into fθ enables compact representation of both low- and high-frequency variations in Cθ . 2) Learning objective: We estimate the fluorescence field Cθ and, in NeuFMT, the optical properties { a , s } by minimizing a data-fidelity term plus regularization: M = P Φm c( a , , Cθ ) M real 2 + λ R(Cθ ), (12) L( a , s , θ) = M s 2 (8) where P represents the transfer function, which maps the boundary photon density Φm the measurement data M acquired by the camera. The above linearized forward model provides the physical foundation for the inversion procedure. Crucially, the SPD FEM stiffness matrix S( a , s ) N N R in (5) (6) encode the optical properties and boundary geometry, generating from a linear combination of matrices corresponding to distinct physical components [33], [36] 1 Sd + Sb . (9) S( a , s ) = c a Sa + 3( a + s ) with Sa , Sd , and Sb", "[33], [36] 1 Sd + Sb . (9) S( a , s ) = c a Sa + 3( a + s ) with Sa , Sd , and Sb the assembled absorption, diffusion, and Robin-boundary matrices, respectively. This decomposition c denotes the boundary measurements, and R(Cθ ) is where M a regularization term applied to the fluorescence distribution. The hyperparameter λ controls the regularization strength, balancing data fidelity with sparsity constraints. The training of NeuFMT / NeuFMT follows a fully self-supervised paradigm that explicitly integrates the DE-based physical model into the optimization loop. Note that NeuFMT uses fixed optical parameters ( a , s ), whereas NeuFMT updates jointly. 3) Alternating optical-property adaptation: A fundamental innovation of NeuFMT lies in formulating the entire photon propagation process from excitation to emission as an end-to-end differentiable map. The forward model follows a", "4 PREPRINT VERSION 2025 precise physical sequence from excitation source to surface measurements, as described in Subsection II-B: c( a , s , Cθ ) = P S( a , s ) 1 Cθ S( a , s ) 1 Qx , M (13) We optimize the introduced objective L( a , s , θ) in (12), jointly updating network parameters θ and optical coefficients ( a , s ). The chain in (13) contains only differentiable operations, including linear solves, elementwise products, and linear c is differentiable w.r.t. both Cθ (hence θ) projections. Thus M and ( a , s ), enabling standard gradient-based training. For completeness, we state the chain-rule decomposition of the loss gradient with respect to ( a , s ). Based on (13), the gradient splits into an emission term and an excitation term: c S L M L S 1 = Φm + c Φm {z } | M Emission pathway c Φm Qm L M S Φx S 1 c Φm Qm Φx | M {z } (14) Excitation pathway { a , s }. The only model-specific ingredient of a and s is the Jacobian of S( a , s ). According", "| M {z } (14) Excitation pathway { a , s }. The only model-specific ingredient of a and s is the Jacobian of S( a , s ). According to (9), the partial derivatives are S 1 = c Sa Sd , a 3( a + s )2 S 1 =c Sd . (15) s 3( a + s )2 This allows a and s to be optimized directly using gradient descent, and then be updated together with θ, bridging the learning process with the underlying physical model. To mitigate potential coupling effects between a and s during optimization, we propose an alternating update strategy, which periodically updates one optical parameter with the other fixed. The alternating framework largely promotes training stability to avoid oscillations with sufficient computational efficiency. The complete NeuFMT algorithm is described in Algorithm 1. Overall, the alternating -adaption module ensures that each optical parameter receives dedicated optimization attention while maintaining the physical consistency of the forward model, yielding more accurate FMT reconstruction results even in the presence of mismatch between the initial guess and ground truth of the optical properties. 4) Network architecture and implementation: We adopt MLP for the NeuFMT / NeuFMT, comprising 8", "the presence of mismatch between the initial guess and ground truth of the optical properties. 4) Network architecture and implementation: We adopt MLP for the NeuFMT / NeuFMT, comprising 8 fullyconnected layers with 512 hidden units each, followed by a final layer with 128 units. ReLU activation functions are employed throughout the network. A critical skip connection bridges the input Γ (r) to the 4th hidden layer, facilitating gradient flow and enhancing the ability to learn fine-grained details. This architectural choice is particularly suited for FMT applications where accurately reconstructing high-contrast targets against complex backgrounds is essential. We implement the NeuFMT / NeuFMT framework with PyTorch, leveraging its automatic differentiation capability to compute the gradient through both MLP and the physical model. Adam optimizer is used with the initial learning rates of 10 4 for θ update, 10 3 for scattering coefficient and 10 5 for absorption coefficient. To improve the computational efficiency, a learning rate decay is applied for MLP update. These rates are determined empirically to ensure stable convergence. The L1 regularization parameter λ is set to 10 6 based on cross validation. The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality, with the entire process", "convergence. The L1 regularization parameter λ is set to 10 6 based on cross validation. The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality, with the entire process completing within 3 30 minutes on a single NVIDIA RTX 3090 GPU for problems of varying scales. The FEM discretization is built on TOAST++ toolkit [37], and the FMT simulation is based on a modular software platform STIFT [38] in MATLAB (R2024b, MathWorks, MA, US) using a desktop computer (Intel Core i5-12600 CPU @ 3.30 GHz, 128 GB RAM). Algorithm 1 NeuFMT Require: Real measurements M real , light speed c, stepsizes αθ , αa , αs , alternation period T , total iterations K 1: Initialize θ, a , s ; 2: Precompute Sa , Sd , Sb , Qx , P 3: Compute S via (9); 4: for i = 1 to K do 5: C = fθ Γ (r) 6: Solve Φx RN satisfying S Φx = Qx 7: Qm = C Φx 8: Solve Φm RN satisfying S Φm = Qm c = P Φm 9: Compute predicted measurements: M real 2 c 10: Compute loss: L = M M 2 + R(C) 11: Update MLP", "satisfying S Φm = Qm c = P Φm 9: Compute predicted measurements: M real 2 c 10: Compute loss: L = M M 2 + R(C) 11: Update MLP parameters: θ = θ αθ L θ 12: if i mod T = 0 then 13: if i/T is even then L 14: Update absorption: a = a αa a 15: else L 16: Update diffusion: s = s αs s 17: end if 1 18: Update S = c a Sa + S + S d b ; 3( a + s ) 19: end if 20: end for 21: Output: fluorescence C, optical parameters a , s D. FMT System Setup We devised a continuous-wave (CW) FMT system (SHMOT) [39], [40] as depicted in Fig. 1 (a), which incorporates a 16-bit CMOS camera (Edge 4.2, PCO, Germany) with 2048 2048 pixel resolution and a filter wheel (FW102C, Thorlabs, NJ, US) for selective wavelength detection. A tunable laser source (SuperK EXTREME, NKT, Denmark), spanning 400-890 nm, provides fluorescence excitation with a power density of approximately 2 mW/mm2 at the sample plane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube,", "with a power density of approximately 2 mW/mm2 at the sample plane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube, Germany) mounted aside steers the laser beam to raster-scan either the top or bottom object ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION surface, enabling switchable reflection-/transmission-mode detection. During experiments, the camera exposure time was fixed at 500 ms, with pixel binning applied to improve the signal-to-noise ratio. The acquired raw 2D image data serve as supervision target for NeuFMT / NeuFMT reconstruction (Fig. 1 (b)). It worth mentioning that our FMT system also integrates a programmable line-scanning illumination, which enables high-precision extraction of the surface geometry with approximated maximum error of 0.1 mm. The extracted surface information is then leveraged as prior knowledge for FEM meshing and improving reconstruction accuracy. E. Phantom preparation and optical calibration In our validation, the slab phantomswere cast from silicone (SYLGARDTM 184; DOW, CA, USA) to emulate softtissue matrix. Optical properties were tuned by dispersing titanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon black powder (Colins, Shanghai, China) as scattering and absorbing additives, respectively. In all phantoms, TiO2 and", "properties were tuned by dispersing titanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon black powder (Colins, Shanghai, China) as scattering and absorbing additives, respectively. In all phantoms, TiO2 and carbon black were uniformly distributed. All the designs shown in Fig. 4 (a) used the same TiO2 /carbon-black mixing ratio, yielding isotropic media with identical absorption and scattering parameters. F. In Vivo Lymph Node FMT Imaging Following numerical simulations and phantom experiments, we evaluated the proposed method in vivo in a murine lymph node imaging task. In cancer diagnostics, lymph node metastasis is a key prognostic indicator of tumor progression. Fluorescence imaging enables rapid screening of sentinel lymph nodes [41]. In our experiment, all animal procedures were approved by the Institutional Animal Care and Use Committee of ShanghaiTech University (Approval No. 20211115001). 5 female BALB/c mice (8 weeks old) were obtained from Shanghai Jihui Laboratory Animal Breeding Co. Ltd. and housed under a circadian rhythm of 12 hours of day and night alternation. Before taking imaging experiments, fur was removed over the whole body. For FMT reconstruction, we assumed an optically homogeneous medium with properties calibrated during the excitation step with ( a = 0.0055 mm 1 , s =", "over the whole body. For FMT reconstruction, we assumed an optically homogeneous medium with properties calibrated during the excitation step with ( a = 0.0055 mm 1 , s = 1.1 mm 1 ). We followed a three-stage protocol fluorescent-dye injection, imaging, and ex vivo validation. Prior to FMT imaging, Cy5-saline solution (1.2146 mol mL 1 , 40 L) was injected subcutaneously into the left forepaw to drive lymphatic drainage toward the sentinel lymph nodes and create a highintensity target. Next, follow-up FMT measurements were acquired using the system setup in Subsection II-D. Finally, after data collection, ex vivo verification was performed using a fluorescent stereoscopic microscope (MVX10, Olympus, Japan; 6.3 objective). Illumination was provided by a heightadjustable 630 nm LED at 20 mW cm 2 . White-light and Cy5-channel fluorescence images were recorded using filters matched to the Cy5 spectrum, and the lymph nodes were identified, excised, and imaged to validate the in vivo findings.", "5 III. R ESULTS A. Convergence Verification of Optical Property Adaptive Optimization To validate our proposed optical property adaptation mechanism, we conducted a series of numerical experiments on a digital phantom. The primary objective was to demonstrate that the -adaption module can robustly recover absorption a and s coefficients from severely erroneous initial estimates, thereby enabling high-fidelity fluorescence reconstruction. We constructed a homogeneous digital slab phantom of size 55 55 15 mm3 featuring an S -shaped fluorescent target at its geometric center. The ground-truth optical properties were 1 set to true and s true = 1.0 mm 1 . To rigorously a = 0.1 mm test the correction capability, we initialized the reconstruction with significantly mismatched scattering coefficients ( s init = 0.5, 1.5, 2.0 mm 1 ) while keeping the absorption coefficient fixed at its true value for this specific test. As summarized in Fig. 2 (a), without the -adaption module, the reconstructed fluorescence distributions suffered from substantial errors in both depth localization and morphological accuracy. The mismatched s value led to an incorrect model of photon propagation, which directly translated to distorted reconstructions. In contrast, when the -adaption module was enabled, the proposed NeuFMT successfully recovered fluorescence distributions", "value led to an incorrect model of photon propagation, which directly translated to distorted reconstructions. In contrast, when the -adaption module was enabled, the proposed NeuFMT successfully recovered fluorescence distributions that closely matched the ground truth obtained with the correct optical properties. Crucially, the evolution of the scattering coefficient during optimization, plotted in Fig. 2 (b), demonstrates the module s robust convergence. Regardless of the initial value whether halved or doubled the estimated s reliably converged to the neighborhood of the true value (1.0 mm 1 ). A similar convergence behavior was observed for the absorption coefficient a . When initialized with biased values 1 ( init ) against a fixed true s , the a = 0.05, 0.15, 0.2 mm adaption module corrected a with an average error of only 1.5% (Fig. 2 (d)), and its convergence curves are shown in Fig. 2 (e). This convergence robustness was maintained across a range of true a and s values, confirming the general efficacy of our alternating optimization strategy in mitigating parameter coupling (Fig. 2 (c), (f)). We further extended the validation to the most challenging scenario, where both optical parameters were simultaneously initialized with substantial errors. In this experiment, the", "parameter coupling (Fig. 2 (c), (f)). We further extended the validation to the most challenging scenario, where both optical parameters were simultaneously initialized with substantial errors. In this experiment, the initial values for both a and s were set to 50% higher than their GT values. Remarkably, even under these highly adverse conditions, the -adaption module successfully drove both parameters towards their true values. The convergence trajectories remained stable and ultimately reached a neighborhood of the true parameter pair. These results collectively verify that the integrated -adaption module empowers NeuFMT to jointly recover accurate optical properties and fluorescence distributions even from profoundly inaccurate initial guesses, effectively addressing a critical source of ill-posedness in practical FMT scenarios. 6 PREPRINT VERSION 2025 0.995 1.0 0.996 1.5 1.007 2.0 1.006 GT y x DICE = 0.0257 0.7337 0.4660 Norm.int (a.u.) = 1.0 = 0.1 Non-Adaptive 1 0.3967 (b) 1.2 1.0 (c) 1.6 Adaptive y 0.7198 0.7230 0.6964 Norm.int (a.u.) z 0.7796 0.9 0.8 0.5 Asym. Line 0.8 0.4 2 4 6 8 10 12 14 0.12 0.11 1.4 Predicted z=8 2.0 1.5 1.2 1.1 1.6 0 1 2.0 Predicted 0.5 (a) 0.10 0.09 1.2 0.08 1.0 0 Asym. Line 1 2 4 8", "12 14 0.12 0.11 1.4 Predicted z=8 2.0 1.5 1.2 1.1 1.6 0 1 2.0 Predicted 0.5 (a) 0.10 0.09 1.2 0.08 1.0 0 Asym. Line 1 2 4 8 16 32 64 iterations 0.10 0.100 0.15 0.101 0.20 0.102 y x 0.0281 0.7337 0.7390 Norm.int (a.u.) GT 0.5991 z=8 z Adaptive y 0.6718 0.7642 0.8740 0.8708 (e) 0.2 = 1.0 = 0.1 GT 0.11 0.09 0.12 0.1 0.08 0 0.04 1 (f) 0.16 0.14 2 4 6 8 10 12 0.08 0.05 Asym. Line 14 1.2 1.1 1.0 0.9 0.12 0.8 0.1 0 (g) 0.20 0.15 0.12 0.16 Norm.int (a.u.) = 1.0 = 0.1 Non-Adaptive 1 Predicted (d) 0.097 Predicted 0.05 Asym. Line 1 2 4 8 16 32 64 iterations 2000 iters 5000 iters 10000 iters 20000 iters 1 y (h) 1.6 0.16 1.4 0.14 1.2 0.12 1.0 0.1 0.8125 0.8651 0.8691 z y = 1.5 = 0.15 1.333 0.1332 1.177 0.1156 1.050 0.1045 1.001 0.0995 0 0.8 2 5 8 11 14 17 Predicted 0.6481 Norm.int (a.u.) z=8 Predicted x 0.08 20 iterations Fig. 2. Ablation test for the optical-property-adaption ( -adaption) module in NeuFMT. (a-c) Effective test for the correction of s . (a) For a", "z=8 Predicted x 0.08 20 iterations Fig. 2. Ablation test for the optical-property-adaption ( -adaption) module in NeuFMT. (a-c) Effective test for the correction of s . (a) For a homogeneous phantom simulation with a S -shaped fluorescence inclusion, the ground truth (GT) of a and s values are 0.1 mm-1 and 1.0 mm-1 respectively. A mismatched initial guess of s was assumed for FMT reconstruction. The -adaption module successfully corrects s with an average error of 0.55%, leading to significantly improved FMT reconstruction results compared to non-adaptive NeuFMT. (b) Convergence curve of s given more initial s values ranging from 0.5 to 2 GT value under the same setting of (a). (c) Convergence curve of s value across all cases with different a values, given initial s = 1.5 mm-1 . (d-f) Effective test for the correction of the absorption coefficient ( a ). (d) For the same phantom in (a), a (mismatched) a initial value is assumed for FMT reconstruction. The -adaption module successfully corrects a with an average error of 1.5%, leading to significantly improved FMT reconstruction results. (e) Convergence curve of a given more initial a values ranging from 0.5 to 2 GT value under the", "average error of 1.5%, leading to significantly improved FMT reconstruction results. (e) Convergence curve of a given more initial a values ranging from 0.5 to 2 GT value under the same setting of (d). (f) Convergence curve of a value across all cases with different s values, given initial a = 0.15 mm-1 . (g-h) Effective test for the correction of both absorption and diffusion coefficients. (g) For the same phantom in (a), given mismatched initial a = 1.5 and s = 0.15, both of which are 50% higher than GT, the -adaption module successfully corrects both a and s at the same time. (h) Convergence curve given the iteration process in (g) for both optical coefficients. B. Numerical Simulations To comprehensively evaluate the performance of the proposed NeuFMT under controlled conditions, we designed four distinct numerical phantoms (Fig. 3 (a) (d) respectively) to systematically increase the reconstruction challenge: Case 1 - single small target: a 3 mm-diameter spherical fluorescence target embedded in a homogeneous cuboid phantom (55 55 15 mm3 ), serving as a baseline for evaluating localization and quantitative accuracy of a simple, isolated inclusion. Case 2 - complex surface geometry: a 2 mm-diameter spherical target inside a", "mm3 ), serving as a baseline for evaluating localization and quantitative accuracy of a simple, isolated inclusion. Case 2 - complex surface geometry: a 2 mm-diameter spherical target inside a phantom with a curved surface geometry, featuring a spherical cap top (base: 50 50 4 mm, cap height = 5 mm, total height = 9 mm). This case tests the method s robustness to non-planar surface topography. Case 3 - complex target shape: a large peanut-shaped fluorescence region with uniform concentration embedded in a standard cuboid phantom same as Case 1. This scenario assesses the capability to recover intricate morphological details beyond simple spheres. Case 4 - multi-target with background: the same peanutshaped region as in Case 3, but with the addition of a small, high-concentration spherical target inside. This represents a highly realistic and challenging condition, testing the ability to resolve targets of different concentrations and shapes against a noisy background. The ground-truth optical properties for all simulated measurements in this test were set to a = 0.1 mm 1 and s = 1.0 mm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against four established methods:", "1 and s = 1.0 mm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against four established methods: conventional Tikhonov-regularized", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION GT L2-CG L1-FISTA U-Net NeuFMT μNeuFMT 1 y x y z DICE = 0.6581 z=8 0.4956 0.6446 Norm.int (a.u.) Case 1 (a) 0.8800 0.5128 0 z y x y x y z 0.6286 z=2 0.7500 0.0000 Norm.int (a.u.) Case 2 (b) 1 0.7586 0.2041 0 z y x x y z z=8 0.6938 0.0828 0.6153 Norm.int (a.u.) Case 3 (c) 1 y 0.9751 0.4766 0 z y x y x y z 0.5435 z=8 0.5908 0.2637 Norm.int (a.u.) Case 4 (d) 1 0.8983 0.7645 0 z y x Norm.int (a.u.) (e) Case 1 Case 2 Case 3 Case 4 1 1 1 1 0.8 0.8 0.8 0.8 0.6 0.6 0.6 0.6 0.4 0.4 0.4 0.4 0.2 0.2 0.2 0 15 20 25 30 35 40 0 15 0 20 25 30 mm GT L2-CG 35 0.2 0 10 mm L1-FISTA 20 30 40 50 0 15 20 25 30 35 mm U-Net NeuFMT 40 mm μNeuFMT Fig. 3. Results of numerical phantom simulations. (a) (d) Ground truth (GT) and FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases.", "Results of numerical phantom simulations. (a) (d) Ground truth (GT) and FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each method, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and the Dice coefficient are displayed. (e) Intensity profiles along the dashed lines in the XY slices are compared for the four cases. conjugate gradients (L2 -CG) [42] and L1 -regularized nonnegative least squares (L1 -FISTA) [43], a pretrained supervised U-Net, and our baseline method NeuFMT without adaption. The U-Net was trained on a large, synthetically generated dataset of 5,488 samples. For each sample, the input was a boundary measurement simulated using the DEbased forward model under the ground-truth properties in a cuboid phantom (55 55 15 mm3 ), and the label was the corresponding 3D fluorescence map of 1 2 ellipsoids with random sizes and spatial positions. To clearly demonstrate the effect of the -adaption module, we focused on adapting s while fixing a at its true value during reconstruction. For all methods, the initial s was set to an erroneous value of 1.2 mm 1 , which is 20% higher than the ground truth. The results", "value during reconstruction. For all methods, the initial s was set to an erroneous value of 1.2 mm 1 , which is 20% higher than the ground truth. The results presented in Fig. 3 (a) (d) demonstrate the consistent superiority of NeuFMT across all four numerical cases. We observe that the conventional methods were adversely affected by the optical property mismatch: L2 -CG reconstructions were characteristically blurred and exhibited significant depth errors, such as full-depth penetration in Cases 3 and 4 and depth-wise expansion in Case 1. L1 -FISTA frequently introduced non-physical, fragmented artifacts, such as staircase patterns in Case 1 and hollow structures in Case 3, while it also suffered from severe depth inaccuracy. The supervised U-Net, though performed well in Case 1, showed limited generalization beyond its training data, as seen in its localization failure in the complex surface geometry of Case 2", "7 and noticeable shape distortion in the unseen peanut-shaped target of Case 3 and 4. The direct NeuFMT provided better depth prediction than the traditional methods but remained sensitive to the erroneous s , resulting in substantial shape expansion in the x-y plane (Cases 1, 2) and axial splitting (Case 3). In contrast, NeuFMT successfully rectified the optical properties and overcame these limitations. It achieved the most accurate spatial localization and shape fidelity, as evidenced by its 3D isosurfaces tightly conforming to the ground truth in both simple and complex targets, and it clearly resolved both the small target and the complex background in Case 4. Quantitatively, NeuFMT consistently achieved the highest Dice coefficients, and its intensity profiles (Fig. 3 (e)) most closely matched the ground truth in terms of peak location, width, and background suppression. C. Phantom Experiments We further evaluated the performance of all methods using physical phantom experiments to assess their practicality under real-world conditions, including measurement noise. The phantoms were fabricated from silicone, with their optical properties calibrated to be approximately a = 0.0055 mm 1 and s = 1.1 mm 1 at 680 nm. Fluorescent targets were embedded within the phantoms to create the four", "properties calibrated to be approximately a = 0.0055 mm 1 and s = 1.1 mm 1 at 680 nm. Fluorescent targets were embedded within the phantoms to create the four cases previously defined in the simulations. The initial value of s was set identically for all reconstruction methods as the calibrated value, and also the U-Net was retrained accordingly. Consistent with the simulation study, we focused on the adaptive recovery of the reduced scattering coefficient s . The reconstruction results are summarized in Fig. 4. Under these challenging real-world conditions, the limitations of the baseline methods became evident: conventional approaches (L2 -CG, L1 -FISTA) produced blurry or fragmented reconstructions with significant depth errors, while the supervised U-Net, susceptible to domain shift and noise, failed to generalize, resulting in complete localization failures (Case 1) or severely distorted shapes (Cases 3 and 4). In contrast, the INR-based frameworks, NeuFMT and NeuFMT, demonstrated markedly superior robustness, consistently yielding physically plausible and continuous reconstructions where other methods failed. A detailed comparison between the two reveals that NeuFMT provided critical refinements toward enhanced physical consistency. In Cases 1 and 3, NeuFMT achieved better depth sensitivity and more uniform fluorophore distribution, more faithfully representing the homogeneous", "reveals that NeuFMT provided critical refinements toward enhanced physical consistency. In Cases 1 and 3, NeuFMT achieved better depth sensitivity and more uniform fluorophore distribution, more faithfully representing the homogeneous nature of the true targets. In the complex geometry of Case 2, it uniquely achieved accurate localization, whereas direct NeuFMT produced a solution with an aberrant depth shift. For the multi-target scenario in Case 4, NeuFMT reconstructed the background region with improved morphological accuracy. Although the performance gap in quantitative metrics such as the Dice coefficient was occasionally narrow, which reflects the inherent robustness of the shared INR architecture, NeuFMT provided consistent, subtle refinements, particularly in depth accuracy. The phantom experiments confirm that the adaptive physical correction mechanism in NeuFMT can enhance reconstruction fidelity under practical conditions where the exact coefficient in most real experiments is uncertain. 8 PREPRINT VERSION 2025 (a) Silicone Phantoms GT L2-CG L1-FISTA U-Net NeuFMT μNeuFMT 1 y x y z DICE = 0.5895 z=8 0.6154 0.0762 Norm.int (a.u.) Case 1 (b) Fluorescence Inclusions 0.7023 0.6615 0 z (Fig. 5 (c)). The reconstructed target lengths from NeuFMT showed the closest agreement with the physical measurements taken from the ex vivo lymph nodes, as visualized by the", "0 z (Fig. 5 (c)). The reconstructed target lengths from NeuFMT showed the closest agreement with the physical measurements taken from the ex vivo lymph nodes, as visualized by the intensity profiles in Fig. 5 (c). These results demonstrate that NeuFMT provides a definitive advantage in practical in vivo scenarios, enabling robust and accurate target segmentation and localization under complex clinically related scenarios, such as fluorescence guided surgery. y x y x y z 0.3371 z=2 0.3810 0.4000 0.5200 0.2586 White Light Image (a) vein LN-2 0 z y x y z z=8 0.5413 0.3358 0.7011 0.8230 0.8050 0 z y x y x y z 0.5193 z=8 0.4319 0.6601 0.2849 Norm.int (a.u.) 0.6240 NeuFMT μNeuFMT z x vein LN-3 LN-2 LN-1 Case 3 Case 4 1 1 0.8 0.8 0.6 0.6 0.6 0.6 0.4 0.4 0.4 0.4 0.2 0.2 20 25 30 35 40 0 15 0.2 20 25 30 mm GT L2-CG 35 0.2 0 0 0 10 mm L1-FISTA 20 30 40 50 15 20 25 30 35 mm U-Net NeuFMT 40 mm NeuFMT-Ada Fig. 4. Results of real phantom experiments. (a) Photograph of the real silicone phantoms and fluorescence inclusions. (b) (e) Ground truth (GT) and", "35 mm U-Net NeuFMT 40 mm NeuFMT-Ada Fig. 4. Results of real phantom experiments. (a) Photograph of the real silicone phantoms and fluorescence inclusions. (b) (e) Ground truth (GT) and FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each method, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and the Dice coefficient are displayed. (f) Intensity profiles along the dashed lines in the XY slices are compared for the four cases.", "10 mm (c) We performed an in vivo imaging experiment on mice. Following the protocol described in Subsection II-F, Cy5 fluorescent dye accumulated primarily at the sentinel lymph nodes (LN), with some residual signal at the vein (Fig. 5 (a)). Our task was to reconstruct the spatial location and shape of the sentinel lymph nodes. The 3D FMT reconstruction results from all methods are presented in Fig. 5 (b). The conventional L2 -CG method produced a reconstruction where the volume of LN-3 was overestimated, and the signals from LN-1, LN-2, and the vein merged into a single, indistinguishable cluster. The L1 -FISTA reconstruction was highly fragmented, making it impossible to discern the shape or count of the lymph nodes accurately. Also, the baseline NeuFMT failed to produce a physiologically plausible reconstruction. In contrast, NeuFMT was the only method that successfully and distinctly resolved all three lymph nodes (LN-1, LN-2, LN-3) and the vein, clearly identifying each as separate, localized regions of fluorescence. For quantitative validation, the mouse was sacrificed, and the lymph nodes were excised to be imaged by ex vivo FRI LN-1 x y LN-3 LN-2 10 mm 0 1 1 1 0.8 0.8 0.8 0.6 LN-1 0.4 0.6", "the lymph nodes were excised to be imaged by ex vivo FRI LN-1 x y LN-3 LN-2 10 mm 0 1 1 1 0.8 0.8 0.8 0.6 LN-1 0.4 0.6 LN-2 0.4 0.2 0.6 0.2 0 2 4 6 L2-CG 8 10 12 mm LN-3 0.4 0.2 0 0 D. In Vivo Lymph Node FMT Imaging Experiments Concentration of Cy5 (a.u.) Case 2 1 0.8 Slice z = 8 mm Case 1 1 0.8 x y Slice z = 11 mm (f) Norm.int (a.u.) L1-FISTA R 1 Profiles y x 15 L2-CG LN-3 L 0 z 0 R y Concentration of Cy5 (a.u.) Case 4 (e) 1 (b) LN-1 L 3D Segmentation x Norm.int (a.u.) Case 3 (d) 1 y In vivo FRI Norm.int (a.u.) Case 2 (c) 1 0 0 2 L1-FISTA 4 6 8 10 12 mm 0 2 NeuFMT 4 6 8 10 12 mm μNeuFMT Fig. 5. In vivo lymph node FMT imaging and reconstruction results. (a) The white-light image and preview via 2D fluorescence reflectance imaging (FRI) overlaid on the white-light image with the red aera indicating the concentrated distribution of Cy5 probe on the cites of three lymph nodes (LN-1, LN-2, LN3) and the", "imaging (FRI) overlaid on the white-light image with the red aera indicating the concentrated distribution of Cy5 probe on the cites of three lymph nodes (LN-1, LN-2, LN3) and the vein. (b) Comparison of FMT reconstruction results from different methods. The 3D segmentation, along with two slices at z = 8 and 11 mm, are displayed. (c) Intensity profiles along the dashed lines in b. are compared for each ex vivo images of lymph nodes after sacrificing the animal. The gray zone represents the estimated size of LN, based on the ex vivo fluorescence images.", "IV. D ISCUSSION AND C ONCLUSION In this study, we introduced NeuFMT, an optical-propertyadaptive FMT reconstruction framework that integrates INR with an explicitly differentiable FEM-based light propagation model. By unifying a continuous fluorescence field parameterized by an INR and a physics-based forward model amenable to end-to-end optimization, NeuFMT addresses two fundamental limitations of existing FMT reconstruction techniques: their inability to efficiently adapt to complex and heterogeneous fluorescence distribution, and their reliance on ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION fixed, often inaccurate, optical properties, which significantly exacerbates the inherent ill-posedness of the inverse problem. Unlike supervised deep learning approaches which are constrained by the diversity and scale of training datasets and often fail under domain shift, NeuFMT operates in a selfsupervised, physics-informed regime. It does not require paired training data; instead, it directly minimizes the discrepancy between measured and simulated boundary fluxes. This not only eliminates the need for extensive experimental datasets but also ensures generalizability across different imaging geometries and target configurations. The continuous, coordinate-based representation provided by the INR further ensures that our reconstructions are free from discretization artifacts and inherently resolution-agnostic. A central contribution of our work is the introduction of an", "coordinate-based representation provided by the INR further ensures that our reconstructions are free from discretization artifacts and inherently resolution-agnostic. A central contribution of our work is the introduction of an optical property adaptation mechanism, which enables the dynamic optimization of absorption and scattering coefficients ( a , s ) concurrently with the fluorescence distribution. Our framework demonstrates that the integration of a differentiable physics-based forward model is the key to enabling this self-supervised adaptation. The FEM-based light propagation model is not merely a component of the loss function, but an active and adaptive part of the inverse solver. This stands in contrast to both traditional iterative methods, which hold optical properties static and thus aggravate the problem s illposedness, and conventional end-to-end deep learning approaches, which struggle to generalize beyond their training data. The adaptivity of our model is thus its core strength, providing a principled way to refine the physical model itself based on the measured data, which is crucial for practical applications where precise prior knowledge of tissue optics is unavailable. Our results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate that NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1", "optics is unavailable. Our results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate that NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1 ) and deep learningbased (U-Net) benchmarks. In particular, the method consistently localized fluorescent targets with higher spatial accuracy, improved contrast, and more realistic morphological features especially under challenging conditions involving background fluorescence and complex geometry. Despite these promising results, several aspects of NeuFMT merit further investigation. First, the current implementation assumes a homogeneous optical background a common simplification in FMT studies. Extending the model to incorporate spatially varying optical properties represents a logical next step, potentially by representing a (r) and s (r) with additional INRs, though this would significantly increase the complexity of the inverse problem. Nevertheless, the proposed NeuFMT can be validated or even combined with time-domain near-infrared spectroscopy (fNIRS) [44], [45] or diffuse optical tomography (DOT) [46] techniques, where the complex optical properties related with absorption and scattering can disentangled and calibrated. More importantly, the integration of NeuFMT with emerging imaging technologies holds particular promise. The inherent adaptivity of our framework is well-suited to the distinct scattering and absorption landscapes of NIR-II fluorescence tomography 9 [47], [48],", "NeuFMT with emerging imaging technologies holds particular promise. The inherent adaptivity of our framework is well-suited to the distinct scattering and absorption landscapes of NIR-II fluorescence tomography 9 [47], [48], where our optical property optimization could be crucial for accurately modeling the increased photon penetration and achieving higher-resolution reconstruction at depth. Furthermore, the framework can be naturally extended to hyperspectral FMT, using a single INR to output both fluorophore concentration and spectral signature, thereby disentangling multiple probes or accounting for wavelength-dependent optical properties. Finally, translating NeuFMT into clinical settings, such as intraoperative fluorescence-guided surgery [8], [9], represents an exciting frontier where its adaptability could overcome patient-specific variations in tissue optics. In conclusion, by harmonizing a differentiable physics model with a continuous INR, NeuFMT provides a robust, self-supervised, and adaptive framework for FMT reconstruction. It effectively mitigates the ill-posedness inherent to inverse problems with uncertain parameters, setting a new paradigm for practical, high-resolution fluorescence molecular imaging. We believe this physics-in-the-loop INR approach offers a generalizable template for tackling a wide range of tomographic and inverse problems in biomedical imaging. R EFERENCES [1] F. Song, P. Zhang, H. Wu, C. Ma, Z. Liu, R. Cai, Y. Feng, Y. He, X. Dong, Y.", "of tomographic and inverse problems in biomedical imaging. R EFERENCES [1] F. Song, P. Zhang, H. Wu, C. Ma, Z. Liu, R. Cai, Y. Feng, Y. He, X. Dong, Y. Tian, and G. Zhang, Advances of fluorescence molecular imaging: NIR-II window, probes, and tomography, Laser & Photonics Reviews, vol. 19, no. 10, p. 2400275, 2025. [2] B. Zhu, J. Hendricks, J. E. Morton, J. C. Rasmussen, C. Janssen, M. N. Shah, and E. M. Sevick-Muraca, Near-infrared fluorescence tomography and imaging of ventricular cerebrospinal fluid flow and extracranial outflow in non-human primates, IEEE Transactions on Medical Imaging, vol. 42, no. 12, pp. 3555 3565, 2023. [3] M. S. Ozturk and et al., High-resolution tomographic analysis of in vitro 3D glioblastoma tumor model under long-term drug treatment, Science Advances, vol. 6, no. 10, p. eaay7513, 2020. [4] M. Cai, Z. Zhang, X. Shi, Z. Hu, and J. Tian, NIR-II/NIR-I fluorescence molecular tomography of heterogeneous mice based on gaussian weighted neighborhood fused lasso method, IEEE Transactions on Medical Imaging, vol. 39, no. 6, pp. 2213 2222, 2020. [5] S. R. Arridge and J. C. Schotland, Optical tomography: forward and inverse problems, Inverse problems, vol. 25, no. 12, p. 123010, 2009. [6] L. V.", "pp. 2213 2222, 2020. [5] S. R. Arridge and J. C. Schotland, Optical tomography: forward and inverse problems, Inverse problems, vol. 25, no. 12, p. 123010, 2009. [6] L. V. Wang and H.-i. Wu, Biomedical optics: principles and imaging. John Wiley & Sons, 2007. [7] F. Stuker, J. Ripoll, and M. Rudin, Fluorescence molecular tomography: principles and potential for pharmaceutical research, Pharmaceutics, vol. 3, no. 2, pp. 229 274, 2011. [8] J. S. D. Mieog, F. B. Achterberg, A. Zlitni, M. Hutteman, J. Burggraaf, R.-J. Swijnenburg, S. Gioux, and A. L. Vahrmeijer, Fundamentals and developments in fluorescence-guided cancer surgery, Nature Reviews Clinical Oncology, vol. 19, no. 1, pp. 9 22, 2022. [9] K. Wang, Y. Du, Z. Zhang, K. He, Z. Cheng, L. Yin, D. Dong, C. Li, W. Li, Z. Hu et al., Fluorescence image-guided tumour surgery, Nature Reviews Bioengineering, vol. 1, no. 3, pp. 161 179, 2023. [10] D. Zhu et al., Comparison of regularization methods in fluorescence molecular tomography, Photonics, vol. 1, no. 2, pp. 95 109, 2014. [11] H. Yi et al., Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography: a comparative study, Journal of Biomedical Optics, vol. 18,", "2014. [11] H. Yi et al., Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography: a comparative study, Journal of Biomedical Optics, vol. 18, no. 5, p. 56013, 2013. [12] J. Shi, B. Zhang, F. Liu, J. Luo, and J. Bai, Efficient L1 regularizationbased reconstruction for fluorescent molecular tomography using restarted nonlinear conjugate gradient, Optics letters, vol. 38, no. 18, pp. 3696 3699, 2013. [13] D. Zhu and C. Li, Nonconvex regularizations in fluorescence molecular tomography for sparsity enhancement, Physics in Medicine & Biology, vol. 59, no. 12, p. 2901, 2014. [14] J. Zhang, L. Li, Q. Hu, J. Zhang, Y. Wu, L. Gu, J. Li, F. Li, X. Zhu, J. Jiang et al., High-fidelity solution decomposition fluorescence tomography in the presence of background interference, Laser & Photonics Reviews, p. e01013, 2025.", "10 [15] C. Huang, H. Meng, Y. Gao, S. Jiang, K. Wang, and J. Tian, Fast and robust reconstruction method for fluorescence molecular tomography based on deep neural network, in Imaging, Manipulation, and Analysis of Biomolecules, Cells, and Tissues XVII, vol. 10881. SPIE, 2019, pp. 257 262. [16] L. Guo, F. Liu, C. Cai, J. Liu, and G. Zhang, 3D deep encoder decoder network for fluorescence molecular tomography, Optics letters, vol. 44, no. 8, pp. 1892 1895, 2019. [17] P. Zhang, G. Fan, T. Xing, F. Song, and G. Zhang, UHR-DeepFMT: ultra-high spatial resolution reconstruction of fluorescence molecular tomography based on 3-d fusion dual-sampling deep neural network, IEEE Transactions on Medical Imaging, vol. 40, no. 11, pp. 3217 3228, 2021. [18] J. Cheng, P. Zhang, F. Liu, J. Liu, H. Hui, J. Tian, and J. Luo, Encoderdecoder deep learning network for simultaneous reconstruction of fluorescence yield and lifetime distributions, Biomedical Optics Express, vol. 13, no. 9, pp. 4693 4705, 2022. [19] P. Zhang, C. Ma, F. Song, Z. Liu, Y. Feng, Y. Sun, Y. He, F. Liu, D. Wang, and G. Zhang, Multi-branch attention prior based parameterized generative adversarial network for fast and accurate limited-projection reconstruction in fluorescence molecular tomography,", "Feng, Y. Sun, Y. He, F. Liu, D. Wang, and G. Zhang, Multi-branch attention prior based parameterized generative adversarial network for fast and accurate limited-projection reconstruction in fluorescence molecular tomography, Biomedical Optics Express, vol. 13, no. 10, pp. 5327 5343, 2022. [20] P. Zhang, F. Song, C. Ma, Z. Liu, H. Wu, Y. Sun, Y. Feng, Y. He, and G. Zhang, Robust reconstruction of fluorescence molecular tomography based on adaptive adversarial learning strategy, Physics in Medicine & Biology, vol. 68, no. 4, p. 04LT01, 2023. [21] P. Zhang, X. Liu, Q. Xue, Y. Shang, C. Liu, R. Chen, H. Gao, J. Liang, W. Wang, and G. Zhang, PAH2T-Former: Paired-attention hybrid hierarchical transformer for synergistically enhanced fmt reconstruction quality and efficiency, IEEE Transactions on Computational Imaging, 2025. [22] H. Meng, Y. Gao, X. Yang, K. Wang, and J. Tian, K-nearest neighbor based locally connected network for fast morphological reconstruction in fluorescence molecular tomography, IEEE transactions on medical imaging, vol. 39, no. 10, pp. 3019 3028, 2020. [23] D. Li, C. Chen, J. Li, and Q. Yan, Reconstruction of fluorescence molecular tomography based on graph convolution networks, Journal of Optics, vol. 22, no. 4, p. 045602, 2020. [24] Y. Wang, C. Bian,", "J. Li, and Q. Yan, Reconstruction of fluorescence molecular tomography based on graph convolution networks, Journal of Optics, vol. 22, no. 4, p. 045602, 2020. [24] Y. Wang, C. Bian, Y. An, H. Wang, Q. Liang, Y. Du, and J. Tian, Graph convolution based residual connected network for morphological reconstruction in fluorescence molecular tomography, in Medical Imaging 2022: Biomedical Applications in Molecular, Structural, and Functional Imaging, vol. 12036. SPIE, 2022, pp. 527 533. [25] Y. Sun, J. Liu, M. Xie, B. Wohlberg, and U. S. Kamilov, Coil: Coordinate-based internal learning for tomographic imaging, IEEE Transactions on Computational Imaging, vol. 7, pp. 1400 1412, 2021. [26] L. Lozenski, M. A. Anastasio, and U. Villa, A memory-efficient selfsupervised dynamic image reconstruction method using neural fields, IEEE Transactions on Computational Imaging, vol. 8, pp. 879 892, 2022. [27] A. W. Reed, H. Kim, R. Anirudh, K. A. Mohan, K. Champley, J. Kang, and S. Jayasuriya, Dynamic CT reconstruction from limited views with implicit neural representations and parametric motion fields, in Proceedings of the IEEE/CVF International Conference on Computer Vision, 2021, pp. 2258 2268. [28] L. Shen, J. Pauly, and L. Xing, NeRP: implicit neural representation learning with prior embedding for sparsely sampled image", "IEEE/CVF International Conference on Computer Vision, 2021, pp. 2258 2268. [28] L. Shen, J. Pauly, and L. Xing, NeRP: implicit neural representation learning with prior embedding for sparsely sampled image reconstruction, IEEE Transactions on Neural Networks and Learning Systems, vol. 35, no. 1, pp. 770 782, 2022. [29] R. Liu, Y. Sun, J. Zhu, L. Tian, and U. S. Kamilov, Recovery of continuous 3D refractive index maps from discrete intensity-only measurements using neural fields, Nature Machine Intelligence, vol. 4, no. 9, pp. 781 791, 2022. [30] S. Shen, L. Li, S. Gao, Y. Wang, L. Gu, S. Li, X. Zhu, J. Jiang, J. Yu, and W. Ren, High resolution diffuse optical tomography via neural fields, IEEE Transactions on Computational Imaging, 2024. [31] K. Han, C. Li, A. Xiao, Y. Tian, J. Tian, and Z. Hu, TSPE: Reconstruction of multi-morphological tumors of NIR-II fluorescence molecular tomography based on positional encoding, Computer Methods and Programs in Biomedicine, vol. 261, p. 108554, 2025. [32] S. R. Arridge, Optical tomography in medical imaging, Inverse problems, vol. 15, no. 2, p. R41, 1999. [33] , Photon-measurement density functions. part I: Analytical forms, Applied Optics, vol. 34, no. 31, pp. 7395 7409, 1995. [34] S. R.", "problems, vol. 15, no. 2, p. R41, 1999. [33] , Photon-measurement density functions. part I: Analytical forms, Applied Optics, vol. 34, no. 31, pp. 7395 7409, 1995. [34] S. R. Arridge and M. Schweiger, Photon-measurement density functions. part 2: Finite-element-method calculations, Applied Optics, vol. 34, no. 34, pp. 8026 8037, 1995. PREPRINT VERSION 2025 [35] O. C. Zienkiewicz, R. L. Taylor, P. Nithiarasu, and J. Zhu, The finite element method. Elsevier, 1977, vol. 3. [36] V. Ntziachristos, C. Bremer, and R. Weissleder, Fluorescence molecular tomography resolves protease activity in vivo, Nature Medicine, vol. 8, no. 7, pp. 757 760, 2002. [37] M. Schweiger and S. Arridge, The Toast++ software suite for forward and inverse modeling in optical tomography, Journal of biomedical optics, vol. 19, no. 4, pp. 040 801 040 801, 2014. [38] W. Ren, H. Isler, M. Wolf, J. Ripoll, and M. Rudin, Smart toolkit for fluorescence tomography: simulation, reconstruction, and validation, IEEE Transactions on Biomedical Engineering, vol. 67, no. 1, pp. 16 26, 2019. [39] S. Gao, J. Zhang, Y. Hu, Y. Wu, L. Li, Q. Hu, X. Lou, X. Zhu, J. Jiang, and W. Ren, Multifunctional optical tomography system with highfidelity surface extraction based on a single", "Zhang, Y. Hu, Y. Wu, L. Li, Q. Hu, X. Lou, X. Zhu, J. Jiang, and W. Ren, Multifunctional optical tomography system with highfidelity surface extraction based on a single programmable scanner and unified pinhole modeling, IEEE Transactions on Biomedical Engineering, 2023. [40] Y. Hu, Y. Wu, L. Li, L. Gu, X. Zhu, J. Jiang, and W. Ren, Simultaneous reconstruction of 3D fluorescence distribution and object surface using structured light illumination and dual-camera detection, Optics Express, vol. 32, no. 9, pp. 15 760 15 773, 2024. [41] C. Ji, M. Zhao, C. Wang, R. Liu, S. Zhu, X. Dong, C. Su, and Z. Gu, Biocompatible tantalum nanoparticles as radiosensitizers for enhancing therapy efficacy in primary tumor and metastatic sentinel lymph nodes, ACS nano, vol. 16, no. 6, pp. 9428 9441, 2022. [42] S. Kawata and O. Nalcioglu, Constrained iterative reconstruction by the conjugate gradient method, IEEE Transactions on Medical Imaging, vol. 4, no. 2, pp. 65 71, 1985. [43] A. Beck and M. Teboulle, A fast iterative shrinkage-thresholding algorithm for linear inverse problems, SIAM Journal on Imaging Sciences, vol. 2, no. 1, pp. 183 202, 2009. [44] Y. Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared spectroscopy and imaging: a", "linear inverse problems, SIAM Journal on Imaging Sciences, vol. 2, no. 1, pp. 183 202, 2009. [44] Y. Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared spectroscopy and imaging: a review, Applied Sciences, vol. 9, no. 6, p. 1127, 2019. [45] H. Y. Ban, G. M. Barrett, A. Borisevich, A. Chaturvedi, J. L. Dahle, H. Dehghani, J. Dubois, R. M. Field, V. Gopalakrishnan, A. Gundran et al., Kernel flow: a high channel count scalable time-domain functional near-infrared spectroscopy system, Journal of biomedical optics, vol. 27, no. 7, p. 074710, 2022. [46] A. Pifferi, D. Contini, A. D. Mora, A. Farina, L. Spinelli, and A. Torricelli, New frontiers in time-domain diffuse optics, a review, Journal of Biomedical Optics, vol. 21, no. 9, pp. 091 310 091 310, 2016. [47] F. Wang, Y. Zhong, O. Bruns, Y. Liang, and H. Dai, In vivo NIRII fluorescence imaging for biology and medicine, Nature Photonics, vol. 18, no. 6, pp. 535 547, 2024. [48] Z. Zhang, Y. Du, X. Shi, K. Wang, Q. Qu, Q. Liang, X. Ma, K. He, C. Chi, J. Tang et al., NIR-II light in clinical oncology: opportunities and challenges, Nature Reviews Clinical Oncology, vol. 21, no. 6, pp. 449 467,", "Liang, X. Ma, K. He, C. Chi, J. Tang et al., NIR-II light in clinical oncology: opportunities and challenges, Nature Reviews Clinical Oncology, vol. 21, no. 6, pp. 449 467, 2024."], "num_sections": 11, "num_graph_nodes": 70, "num_graph_edges": 116}
{"method": "fixed", "num_chunks": 74, "avg_chunk_len": 796.0405405405405, "std_chunk_len": 31.259350682847227, "max_chunk_len": 800, "min_chunk_len": 529, "total_chars": 58907, "compression_ratio": 1.0003904459571868, "chunks": ["PREPRINT VERSION 2025\n\n1\n\n NeuFMT: Optical-Property-Adaptive Fluorescence\nMolecular Tomography via Implicit\nNeural Representation\n\narXiv:2511.04510v1 [eess.IV] 6 Nov 2025\n\nShihan Zhao, Jianru Zhang, Yanan Wu, Linlin Li, Siyuan Shen, Xingjun Zhu, Guoyan Zheng, Member IEEE,\nJiahua Jiang, and Wuwei Ren\n\nAbstract Fluorescence Molecular Tomography (FMT) is a\npromising technique for non-invasive 3D visualization of fluorescent probes, but its reconstruction remains challenging due to\nthe inherent ill-posedness and reliance on inaccurate or oftenunknown tissue optical properties. While deep learning methods\nhave shown promise, their supervised nature limits generalization\nbeyond training data. To address these problems, we propose\n NeuFMT, a self-supervised FMT reconstruction framework that\ninteg", "rates implicit neural-based scene representation with explicit\nphysical modeling of photon propagation. Its key innovation lies\nin jointly optimize both the fluorescence distribution and the\noptical properties ( ) during reconstruction, eliminating the need\nfor precise prior knowledge of tissue optics or pre-conditioned\ntraining data. We demonstrate that NeuFMT robustly recovers\naccurate fluorophore distributions and optical coefficients even\nwith severely erroneous initial values (0.5 to 2 of ground\ntruth). Extensive numerical, phantom, and in vivo validations\nshow that NeuFMT outperforms conventional and supervised\ndeep learning approaches across diverse heterogeneous scenarios.\nOur work establishes a new paradigm for robust and accurate\nFMT reconstruction, paving the way for more reliab", "le molecular\nimaging in complex clinically related scenarios, such as fluorescence guided surgery.\nIndex Terms fluorescence molecular tomography, image reconstruction, optical properties, implicit neural representation,\nfluorescence guided surgery\n\nThe work was supported by Science and Technology Commission of Shanghai Municipality under Grant 25JS2830300 (Wuwei Ren), National Natural\nScience Foundation of China under Grants 62105205 (Wuwei Ren), and\nShanghai Clinical Research and Trial Center (Wuwei Ren). (Corresponding\nauthor: Wuwei Ren.)\nShihan Zhao and Jianru Zhang contributed equally to this work.\nShihan Zhao, Yanan Wu, Linlin Li and Siyuan Shen are with\nthe School of Information Science and Technology, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: zhaoshh, wuyn1, lill,\nshe", "nsy2023@shanghaitech.edu.cn).\nJianru Zhang and Jiahua Jiang are with the School of Mathematics,\nUniversity of Birmingham, Edgbaston, B15 2QN, United Kingdom (e-mail:\njxz389@student.bham.ac.uk; j.jiang.3@bham.ac.uk).\nXingjun Zhu is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail:\nzhuxj1@shanghaitech.edu.cn).\nGuoyan Zheng is with the Institute of Medical Robotics, School of\nBiomedical Engineering, Shanghai Jiao Tong University, Shanghai 200240,\nChina (e-mail: guoyan.zheng@sjtu.edu.cn)\nWuwei Ren is with the School of Information Science and Technology,\nShanghaiTech University, Shanghai 201210, China, and also with State\nKey Laboratory of Advanced Medical Materials and Devices, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail:", "renww@shanghaitech.edu.cn).\n\nI. INTRODUCTION\nFluorescence Molecular Tomography (FMT) has emerged\nas a promising molecular imaging modality, enabling noninvasive 3D visualization of fluorescent probe distribution\nin highly turbid media [1]. Owning to its high sensitivity,\ncost-effectiveness, and non-ionizing radiation, FMT has found\nbroad applications in preclinical research and clinical practice, e.g., brain imaging [2], in vitro cell culture monitoring\n[3] and tumor detection [4]. FMT reconstructs the internal\nfluorescence distribution by measuring the photon distribution\non the object surface and minimizing the discrepancy between\nreal measurements and the simulated results. A canonic framework of FMT reconstruction employs an iterative optimization\nstrategy with a forward model typicall", "y based on the\nRadiation Transfer Equation (RTE) or the diffusion equation\n(DE) and an inverse model that refines fluorescence distribution prediction until convergence [5], [6]. However, FMT\nreconstruction is inherently ill-posed due to insufficient surface measurements and strong photon scattering effect within\ntissues. Development of high-precision FMT reconstruction\nalgorithms is highly attractive for further improvement of\nthe spatial resolution and detection depth of this technology,\nwhich ultimately broaden the biological applications in drug\ndiscovery [7] and clinical use such as fluorescence guided\nsurgery [8], [9].\nTo address the ill-posed nature of FMT reconstruction,\nregularization techniques that incorporate prior knowledge are\napplied. Conventional approaches include Tikhonov", "(L2 norm)\nregularization for smoothing the results [10], [11], and sparsepromoting regularization (L1 , Lp norm) or total variation (TV)\nregularization for enhancing the spatial resolution [12], [13].\nRecent advancements in regularization techniques, such as\nthe solution-decomposition algorithm, utilize an advanced\nstochastic prior model that improves the differentiation of\nfluorescence targets from background interference, thereby\nenhancing reconstruction quality [14]. While these methods\nstabilize solutions, their reliance on time-consuming iterative\noptimization and idealized assumptions about optical parameters often results in slow convergence and limited accuracy in\nheterogeneous tissues. Deep learning (DL) methods, particularly en-decoder-based neural networks [15] [21] and graphba", "sed networks [22] [24], have recently been used in FMT\nreconstruction by learning direct mappings from boundary\nmeasurements to fluorescence distributions. These approaches\n\n2\n\nencode physical priors within network parameters, enabling\noverwhelmingly rapid inference. However, their dependence\non supervised training with large, scenario-specific datasets restricts generalizability across variable experimental conditions\n(e.g., tissue object geometry and optical properties), leading\nto significant accuracy degradation when the object properties\ndeviate from training assumptions.\nRecently, implicit neural representation (INR) models have\nemerged as a powerful alternative for medical image reconstruction. By mapping arbitrary spatial coordinates to certain\nunknown physical quantities via a coo", "rdinate-based multilayer perceptron network (MLP), INRs achieve continuous\n3D representations, self-supervised training, and memory efficiency. Originally popularized in computer vision and medical imaging, INRs have demonstrated remarkable success\nin modalities such as computed tomography (CT), magnetic\nresonance imaging (MRI) [25] [29], and notably in diffuse\noptical tomography (DOT), where INR has been proven to be\nable to capture a high-resolution, continuous optical absorption\nmap that account for light scattering in complex tissues [30].\nINR captures continuous spatial information and integrates\nphysical priors makes it particularly suited for various imaging problems. In the context of FMT, preliminary work has\nexplored position encoding strategies to enhance spatial resolution and", "improve the quality of FMT reconstructions [31].\nNevertheless, systematic studies integrating optical diffusion\nphysics within an INR framework remain scarce. This gap\npresents an opportunity to harness the strengths of implicit\nmodeling for robust and data-efficient FMT reconstruction.\nTo bridge this gap, we propose neural-field-based FMT, or\nNeuFMT, a physics-driven reconstruction framework unifying\nINR with explicit physical models. Unlike conventional DLbased FMT reconstruction algorithms that couple explicit\nfluorescence predictions to implicit physical model, NeuFMT\nintegrates the DE-based forward model in the network loss,\nenabling self-supervised training without paired data. The\ndifferentiability of the forward model is achieved via finite\nelement method (FEM). This inversion-free", "approach ensures\nrapid, continuous reconstruction across diverse geometries\nwhile inherently addressing scattering effects. Another critical\nlimitation of both traditional and DL methods lies in the\npresumed optical properties of the object during reconstruction, which largely aggravate the ill-posedness of the inverse\nproblem given the optical parameters were initially biased. To\novercome this, we further introduce optical-property-adaptive\nNeuFMT, or NeuFMT, an adaptive extension of NeuFMT\nthat dynamically optimizes scattering / absorption coefficients\nand fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations, NeuFMT achieves robust accuracy even when provided\nwith erroneous initial guess of the optical coefficient valu", "es,\naddressing the problem of unrealistic assumption prior to\nFMT reconstruction. Both proposed INR-based FMT reconstruction algorithms were thoroughly compared and validated\nby simulations and phantom experiments along with other\nmethods. Furthermore, in vivo lymph node imaging in mice\nwas performed, further demonstrating the advantages of the\nproposed methods.\n\nPREPRINT VERSION 2025\n\nII. M ETHODS\nA. Forward Modeling of FMT\nModel-based FMT reconstruction comprises two fundamental steps: forward modeling and inversion. The former predicts\nsurface photon density measurements based on an assumed\nfluorescence distribution. At the macroscopic scale, we employ\nthe first-order approximation of the radiative transport equation (RTE), known as the diffusion equation (DE) [32]. The\nexcitation and f", "luorescence emission processes in continuouswave (CW) mode form a coupled pair of DEs expressed as\n[33], [34]:\n κ ϕx (r) + a ϕx (r) = qx (r),\n\nr , (1)\n\n κ ϕm (r) + a ϕm (r) = η C(r) ϕx (r),\n\nr , (2)\n\nwhere ϕx and ϕm denote the excitation and emission photon\ndensity, qx is the excitation source, C(r) is the fluorophore\nconcentration to be reconstructed in the inversion, and η\ncollects quantum-yield factors in the CW source term. κ\nrepresents the diffusion coefficient, calculated by [33]\n1\n,\n(3)\nκ=\n3 ( a + s )\nwith the absorption coefficient a and the reduced scattering\ncoefficient s . In a non-contact setting of FMT, to calculate\nthe value of ϕ (r) on the object surface as the measurement, a Robin-type boundary condition is added alongside the\nequation pair (1 2):\n ϕ (r)\n= 0, {x, m}, r , (4", ")\n ν\nwhere ζ(c) is the refractive index mismatch parameter that\naccounts for the light reflection on the boundary surface, with\nc representing the light speed inside the medium. ν denotes\nthe outward normal on the boundary. Notably, to simplified the\nproblem setting, we only consider a homogeneous medium\ncase and the difference of a , s values under different\nwavelengths are neglected.\nϕ (r) + 2 ζ(c) κ\n\nB. Finite Element Discretization and System Matrix Construction\nWe apply the finite element method (FEM) [35] to the\ndiffusion model (1) - (4). Discretizing with a tetrahedral\nN\nmesh of N\ni }i=1 , we approximate\nP nodes and nodal basis {ψP\nϕ (r) i Φ ,i ψi (r) and qx (r) i (Qx )i ψi (r), which\ntransforms the continuous-form equations into a linear system\nfor excitation and emission photon pr", "opagation:\nS Φx = Qx\n\n(5)\n\nS Φm = Qm\n\n(6)\n\nwhere S RN N is the system matrix and Φ , Q RN\nare discretized form (coefficient vectors) for ϕ and q , respectively. In particular, the excitation field ϕx interacts with\nfluorophores C RN to produce the emission source term\nQm = C Φx\n\n(7)\n\nwith denoting element-wise multiplication. The equation\n(7) physically describes how fluorophores absorb excitation\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nexplicitly reveals the functional dependence of S on the\noptical parameters a and s , which forms the mathematical\nfoundation for our adaptive optimization approach introduced\nin Subsection II-C.\n\n(b)\n\n(a)\n\n3\n\nCamera\nFilter Wheel\nReal Measurement\nSample\n\nC. INR-based FMT reconstru", "ction: NeuFMT / NeuFMT\nScanners\n\nLaser\nPredicted\nMeasurement\n\nFocal Lens OD Filter\n(c)\n\n(d)\n\nAdaption Module\n\nForward Model\nBased on DE\n\nAbsorption Term\nHigh Absorption\n\nLow Absorption\n\ninv\nDi usion Term\n\nHigh Scattering\n\nSti ness Matrix\n\nLow Scattering\nBoundary Term\n\n(e)\n\nForward Data\nBackward Gradient\n\nFluorescence Distribution Encoded with INR\nNode Coordinate\n\n3D Mesh with\n\nNodes\n\nsine\n\ncosine\n\nPositional\nEncoding\n\nMLP\n\nFig. 1. Conceptual illustration of NeuFMT. (a) The FMT setup: a scanned\nlaser illuminates the sample while a CMOS camera with filter wheel on the\nopposite side records boundary images. The raster scanning method yields\nthe raw 2D image stack M real , serving as the input to the subsequent FMT\nreconstruction. (b) The difference between M real and the simulated meac( a , ,", "Cθ ) is iteratively minimized until an optimized value\nsurement M\ns\nof unknown fluorescence distribution C is found. R(C) is a regularization\nterm and { a , s } is the intrinsic optical properties consisting of\nabsorption coefficient a and scattering coefficient s . (c) A -adaption\nmodule is integrated into the FMT reconstruction. The stiffness matrix S is\ndetermined by both a and s . (d) The FEM-based simulator predicts virtual\nc( a , , Cθ ) based on the operator S 1 ( ) and predicted\nmeasurement M\ns\nfluorescence distribution C. (e) Fluorescence distribution encoded in an INR.\n3D node coordinate serves as input, while a continuous C map is generated\nthrough positional encoding and an MLP network.\n\nUnlike traditional voxel-based or mesh-dependent representations, INR provides a continuous", ", memory-efficient framework for modeling complex physical fields. The basic variant,\nNeuFMT, learns only the fluorophore Cθ with fixed optical\nproperties; the proposed adaptive NeuFMT jointly optimizes\nthe optical coefficients ( a , s ) with Cθ for enhancing the\nreconstruction accuracy and robustness. In this section, we\ndescribe the NeuFMT representation, formulate the learning\nobjective, introduce optical-property adaptation, and summarize the network architecture and implementation.\n1) INR representation of the unknown fluorescence: Our\n NeuFMT model the 3D fluorescence field as an INR, i.e., a\ncoordinate-conditioned MLP:\n\nCθ (r) = fθ Γ (r) ,\n(10)\nwhere r = (x, y, z) R3 , Γ : Rd is a highdimensional positional encoding of spatial coordinates, and\nfθ : Rd R is an MLP with parameters θ.", "This INR formulation (10) enables resolution-independent reconstruction and\nnaturally accommodates arbitrary spatial queries without being\nconstrained by the conventional discrete grid structure.\nTo enhance the network s ability to represent high-frequency\ndetails, which is crucial for resolving complex in vivo fluorescence patterns, we apply a sinusoidal positional encoding to\neach coordinate component. Let γ : R R2L be\nγ(p) = sin(20 πp), cos(20 πp), ,\nL 1\n\nsin(2\n\nπp), cos(2\n\nL 1\n\n(11)\n\nπp) ,\n\np {x, y, z},\n\nphotons and re-emit light at longer wavelengths. The emission\nsource Qm then propagates through the same medium to\nproduce the emission photon density Φm , which is finally\ndetected at the boundary, which is computed as\n\nwhere L is the number of frequency bands. The\n 3D position\nis the", "n encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that\nd = 6L. Feeding Γ (r) into fθ enables compact representation\nof both low- and high-frequency variations in Cθ .\n2) Learning objective: We estimate the fluorescence field\nCθ and, in NeuFMT, the optical properties { a , s } by\nminimizing a data-fidelity term plus regularization:\n\nM = P Φm\n\nc( a , , Cθ ) M real 2 + λ R(Cθ ), (12)\nL( a , s , θ) = M\ns\n2\n\n(8)\n\nwhere P represents the transfer function, which maps the\nboundary photon density Φm the measurement data M acquired by the camera. The above linearized forward model\nprovides the physical foundation for the inversion procedure.\nCrucially, the SPD FEM stiffness matrix S( a , s ) \nN N\nR\nin (5) (6) encode the optical properties and boundary\ngeometry, generating from a linear combination of m", "atrices\ncorresponding to distinct physical components [33], [36]\n\n1\n\n Sd + Sb . (9)\nS( a , s ) = c a Sa +\n3( a + s )\nwith Sa , Sd , and Sb the assembled absorption, diffusion, and\nRobin-boundary matrices, respectively. This decomposition\n\nc denotes the boundary measurements, and R(Cθ ) is\nwhere M\na regularization term applied to the fluorescence distribution.\nThe hyperparameter λ controls the regularization strength,\nbalancing data fidelity with sparsity constraints. The training of\n NeuFMT / NeuFMT follows a fully self-supervised paradigm\nthat explicitly integrates the DE-based physical model into\nthe optimization loop. Note that NeuFMT uses fixed optical\nparameters ( a , s ), whereas NeuFMT updates jointly.\n3) Alternating optical-property adaptation: A fundamental\ninnovation of NeuFMT li", "es in formulating the entire photon propagation process from excitation to emission as an\nend-to-end differentiable map. The forward model follows a\n\n4\n\nPREPRINT VERSION 2025\n\nprecise physical sequence from excitation source to surface\nmeasurements, as described in Subsection II-B:\n\nc( a , s , Cθ ) = P S( a , s ) 1 Cθ S( a , s ) 1 Qx ,\nM\n(13)\nWe optimize the introduced objective L( a , s , θ) in (12),\njointly updating network parameters θ and optical coefficients\n( a , s ). The chain in (13) contains only differentiable operations, including linear solves, elementwise products, and linear\nc is differentiable w.r.t. both Cθ (hence θ)\nprojections. Thus M\n\nand ( a , s ), enabling standard gradient-based training. For\ncompleteness, we state the chain-rule decomposition of the\nloss gradient wit", "h respect to ( a , s ). Based on (13), the\ngradient splits into an emission term and an excitation term:\n\nc \n S\n L M\n L\n S 1\n=\nΦm +\nc Φm\n\n{z\n}\n| M\nEmission pathway\n\nc Φm Qm \n L M\n S\nΦx\n S 1\nc Φm Qm Φx\n\n| M\n{z\n}\n\n(14)\n\nExcitation pathway\n\n { a , s }.\nThe only model-specific ingredient of a and s is the\nJacobian of S( a , s ). According to (9), the partial derivatives\nare\n\n S\n1\n= c Sa \nSd ,\n a\n3( a + s )2\n\n S\n1\n=c \nSd .\n(15)\n s\n3( a + s )2\nThis allows a and s to be optimized directly using gradient\ndescent, and then be updated together with θ, bridging the\nlearning process with the underlying physical model.\nTo mitigate potential coupling effects between a and s\nduring optimization, we propose an alternating update strategy,\nwhich periodically updates one optical parameter with the\nother fix", "ed. The alternating framework largely promotes training stability to avoid oscillations with sufficient computational\nefficiency. The complete NeuFMT algorithm is described in\nAlgorithm 1. Overall, the alternating -adaption module ensures that each optical parameter receives dedicated optimization attention while maintaining the physical consistency of\nthe forward model, yielding more accurate FMT reconstruction\nresults even in the presence of mismatch between the initial\nguess and ground truth of the optical properties.\n4) Network architecture and implementation: We adopt\nMLP for the NeuFMT / NeuFMT, comprising 8 fullyconnected layers with 512 hidden units each, followed by\na final layer with 128 units. ReLU activation functions are\nemployed throughout the network. A critical skip connect", "ion\nbridges the input Γ (r) to the 4th hidden layer, facilitating\ngradient flow and enhancing the ability to learn fine-grained\ndetails. This architectural choice is particularly suited for FMT\napplications where accurately reconstructing high-contrast targets against complex backgrounds is essential.\nWe implement the NeuFMT / NeuFMT framework with\nPyTorch, leveraging its automatic differentiation capability to\n\ncompute the gradient through both MLP and the physical\nmodel. Adam optimizer is used with the initial learning rates\nof 10 4 for θ update, 10 3 for scattering coefficient and\n10 5 for absorption coefficient. To improve the computational\nefficiency, a learning rate decay is applied for MLP update.\nThese rates are determined empirically to ensure stable convergence. The L1 regulariza", "tion parameter λ is set to 10 6\nbased on cross validation. The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality,\nwith the entire process completing within 3 30 minutes on\na single NVIDIA RTX 3090 GPU for problems of varying\nscales. The FEM discretization is built on TOAST++ toolkit\n[37], and the FMT simulation is based on a modular software\nplatform STIFT [38] in MATLAB (R2024b, MathWorks, MA,\nUS) using a desktop computer (Intel Core i5-12600 CPU @\n3.30 GHz, 128 GB RAM).\nAlgorithm 1 NeuFMT\nRequire: Real measurements M real , light speed c, stepsizes\nαθ , αa , αs , alternation period T , total iterations K\n1: Initialize θ, a , s ;\n2: Precompute Sa , Sd , Sb , Qx , P\n3: Compute S via (9);\n4: for i = 1 to K do \n5:\nC = fθ Γ (r)\n6:\nSolve Φx RN sati", "sfying S Φx = Qx\n7:\nQm = C Φx\n8:\nSolve Φm RN satisfying S Φm = Qm\nc = P Φm\n9:\nCompute predicted measurements: M\nreal 2\nc\n10:\nCompute loss: L = M M 2 + R(C)\n11:\nUpdate MLP parameters: θ = θ αθ L\n θ\n12:\nif i mod\n T = 0 then\n13:\nif i/T is even then\n L\n14:\nUpdate absorption: a = a αa \na\n15:\nelse\n L\n16:\nUpdate diffusion: s = s αs \n\ns\n17:\nend if\n\n1\n18:\nUpdate S = c a Sa +\nS\n+\nS\nd\nb ;\n3( a + s )\n19:\nend if\n20: end for\n21: Output: fluorescence C, optical parameters a , s\n\nD. FMT System Setup\nWe devised a continuous-wave (CW) FMT system\n(SHMOT) [39], [40] as depicted in Fig. 1 (a), which incorporates a 16-bit CMOS camera (Edge 4.2, PCO, Germany) with\n2048 2048 pixel resolution and a filter wheel (FW102C,\nThorlabs, NJ, US) for selective wavelength detection. A\ntunable laser source (SuperK EXTREME, N", "KT, Denmark),\nspanning 400-890 nm, provides fluorescence excitation with a\npower density of approximately 2 mW/mm2 at the sample\nplane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube, Germany) mounted aside steers\nthe laser beam to raster-scan either the top or bottom object\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nsurface, enabling switchable reflection-/transmission-mode detection. During experiments, the camera exposure time was\nfixed at 500 ms, with pixel binning applied to improve the\nsignal-to-noise ratio. The acquired raw 2D image data serve\nas supervision target for NeuFMT / NeuFMT reconstruction\n(Fig. 1 (b)). It worth m", "entioning that our FMT system also\nintegrates a programmable line-scanning illumination, which\nenables high-precision extraction of the surface geometry\nwith approximated maximum error of 0.1 mm. The extracted\nsurface information is then leveraged as prior knowledge for\nFEM meshing and improving reconstruction accuracy.\n\nE. Phantom preparation and optical calibration\nIn our validation, the slab phantomswere cast from silicone (SYLGARDTM 184; DOW, CA, USA) to emulate softtissue matrix. Optical properties were tuned by dispersing\ntitanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon\nblack powder (Colins, Shanghai, China) as scattering and\nabsorbing additives, respectively. In all phantoms, TiO2 and\ncarbon black were uniformly distributed. All the designs\nshown in Fig. 4 (a) used the s", "ame TiO2 /carbon-black mixing\nratio, yielding isotropic media with identical absorption and\nscattering parameters.\n\nF. In Vivo Lymph Node FMT Imaging\nFollowing numerical simulations and phantom experiments,\nwe evaluated the proposed method in vivo in a murine lymph\nnode imaging task. In cancer diagnostics, lymph node metastasis is a key prognostic indicator of tumor progression. Fluorescence imaging enables rapid screening of sentinel lymph\nnodes [41].\nIn our experiment, all animal procedures were approved by\nthe Institutional Animal Care and Use Committee of ShanghaiTech University (Approval No. 20211115001). 5 female\nBALB/c mice (8 weeks old) were obtained from Shanghai\nJihui Laboratory Animal Breeding Co. Ltd. and housed under\na circadian rhythm of 12 hours of day and night alternation.", "Before taking imaging experiments, fur was removed over the\nwhole body. For FMT reconstruction, we assumed an optically\nhomogeneous medium with properties calibrated during the\nexcitation step with ( a = 0.0055 mm 1 , s = 1.1 mm 1 ).\nWe followed a three-stage protocol fluorescent-dye injection, imaging, and ex vivo validation. Prior to FMT imaging, Cy5-saline solution (1.2146 mol mL 1 , 40 L) was injected subcutaneously into the left forepaw to drive lymphatic\ndrainage toward the sentinel lymph nodes and create a highintensity target. Next, follow-up FMT measurements were\nacquired using the system setup in Subsection II-D. Finally,\nafter data collection, ex vivo verification was performed using\na fluorescent stereoscopic microscope (MVX10, Olympus,\nJapan; 6.3 objective). Illumination was", "provided by a heightadjustable 630 nm LED at 20 mW cm 2 . White-light and\nCy5-channel fluorescence images were recorded using filters\nmatched to the Cy5 spectrum, and the lymph nodes were\nidentified, excised, and imaged to validate the in vivo findings.\n\n5\n\nIII. R ESULTS\nA. Convergence Verification of Optical Property Adaptive\nOptimization\nTo validate our proposed optical property adaptation mechanism, we conducted a series of numerical experiments on\na digital phantom. The primary objective was to demonstrate\nthat the -adaption module can robustly recover absorption a\nand s coefficients from severely erroneous initial estimates,\nthereby enabling high-fidelity fluorescence reconstruction.\nWe constructed a homogeneous digital slab phantom of size\n55 55 15 mm3 featuring an S -shaped fluoresc", "ent target at\nits geometric center. The ground-truth optical properties were\n 1\nset to true\nand s true = 1.0 mm 1 . To rigorously\na = 0.1 mm\ntest the correction capability, we initialized the reconstruction\nwith significantly mismatched scattering coefficients ( s init =\n0.5, 1.5, 2.0 mm 1 ) while keeping the absorption coefficient\nfixed at its true value for this specific test.\nAs summarized in Fig. 2 (a), without the -adaption module, the reconstructed fluorescence distributions suffered from\nsubstantial errors in both depth localization and morphological accuracy. The mismatched s value led to an incorrect\nmodel of photon propagation, which directly translated to\ndistorted reconstructions. In contrast, when the -adaption\nmodule was enabled, the proposed NeuFMT successfully\nrecovered flu", "orescence distributions that closely matched the\nground truth obtained with the correct optical properties.\nCrucially, the evolution of the scattering coefficient during\noptimization, plotted in Fig. 2 (b), demonstrates the module s\nrobust convergence. Regardless of the initial value whether\nhalved or doubled the estimated s reliably converged to the\nneighborhood of the true value (1.0 mm 1 ).\nA similar convergence behavior was observed for the absorption coefficient a . When initialized with biased values\n 1\n( init\n) against a fixed true s , the a = 0.05, 0.15, 0.2 mm\nadaption module corrected a with an average error of only\n1.5% (Fig. 2 (d)), and its convergence curves are shown in\nFig. 2 (e). This convergence robustness was maintained across\na range of true a and s values, confirming th", "e general\nefficacy of our alternating optimization strategy in mitigating\nparameter coupling (Fig. 2 (c), (f)).\nWe further extended the validation to the most challenging\nscenario, where both optical parameters were simultaneously\ninitialized with substantial errors. In this experiment, the initial\nvalues for both a and s were set to 50% higher than\ntheir GT values. Remarkably, even under these highly adverse\nconditions, the -adaption module successfully drove both\nparameters towards their true values. The convergence trajectories remained stable and ultimately reached a neighborhood\nof the true parameter pair. These results collectively verify\nthat the integrated -adaption module empowers NeuFMT\nto jointly recover accurate optical properties and fluorescence\ndistributions even from profou", "ndly inaccurate initial guesses,\neffectively addressing a critical source of ill-posedness in\npractical FMT scenarios.\n\n6\n\nPREPRINT VERSION 2025\n\n0.995\n\n1.0\n\n0.996\n\n1.5\n\n1.007\n\n2.0\n\n1.006\n\nGT\ny\nx\n\nDICE =\n0.0257\n\n0.7337\n\n0.4660\n\nNorm.int (a.u.)\n\n= 1.0\n= 0.1\n\nNon-Adaptive\n\n1\n\n0.3967\n\n(b)\n\n1.2\n1.0\n\n(c)\n\n1.6\n\nAdaptive\n\ny\n\n0.7198\n\n0.7230\n\n0.6964\n\nNorm.int (a.u.)\n\nz\n\n0.7796\n\n 0.9\n 0.8\n 0.5\nAsym.\nLine\n\n0.8\n0.4\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n14\n\n 0.12\n 0.11\n\n1.4\n\nPredicted\n\nz=8\n\n 2.0\n 1.5\n 1.2\n 1.1\n\n1.6\n\n0\n1\n\n2.0\n\nPredicted\n\n0.5\n\n(a)\n\n 0.10\n 0.09\n\n1.2\n\n 0.08\n1.0\n\n0\n\nAsym.\nLine\n1\n\n2\n\n4\n\n8\n\n16\n\n32\n\n64\n\niterations\n0.10\n\n0.100\n\n0.15\n\n0.101\n\n0.20\n\n0.102\n\ny\nx\n\n0.0281\n\n0.7337\n\n0.7390\n\nNorm.int (a.u.)\n\nGT\n\n0.5991\n\nz=8\nz\n\nAdaptive\n\ny\n\n0.6718\n\n0.7642\n\n0.8740\n\n0.8708\n\n(e)\n\n0.2\n\n= 1.0\n= 0.1\n\nGT\n\n 0.11\n 0.09\n\n0.12\n0.1\n0", ".08\n\n0\n\n0.04\n\n1\n\n(f) 0.16\n0.14\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n 0.08\n 0.05\nAsym.\nLine\n\n14\n\n 1.2\n 1.1\n 1.0\n 0.9\n\n0.12\n\n 0.8\n0.1\n\n0\n\n(g)\n\n 0.20\n 0.15\n 0.12\n\n0.16\n\nNorm.int (a.u.)\n\n= 1.0\n= 0.1\n\nNon-Adaptive\n\n1\n\nPredicted\n\n(d)\n\n0.097\n\nPredicted\n\n0.05\n\nAsym.\nLine\n1\n\n2\n\n4\n\n8\n\n16\n\n32\n\n64\n\niterations\n2000 iters\n\n5000 iters\n\n10000 iters\n\n20000 iters\n1\n\ny\n\n(h)\n\n1.6\n\n0.16\n\n1.4\n\n0.14\n\n1.2\n\n0.12\n\n1.0\n\n0.1\n\n0.8125\n\n0.8651\n\n0.8691\n\nz\ny\n\n= 1.5\n= 0.15\n\n1.333\n0.1332\n\n1.177\n0.1156\n\n1.050\n0.1045\n\n1.001\n0.0995\n\n0\n\n0.8\n\n2\n\n5\n\n8\n\n11\n\n14\n\n17\n\nPredicted\n\n0.6481\n\nNorm.int (a.u.)\n\nz=8\n\nPredicted\n\nx\n\n0.08\n20\n\niterations\n\nFig. 2. Ablation test for the optical-property-adaption ( -adaption) module in NeuFMT. (a-c) Effective test for the correction of s . (a) For a homogeneous\nphantom simulation with a S -shaped fluorescence inclu", "sion, the ground truth (GT) of a and s values are 0.1 mm-1 and 1.0 mm-1 respectively. A\nmismatched initial guess of s was assumed for FMT reconstruction. The -adaption module successfully corrects s with an average error of 0.55%,\nleading to significantly improved FMT reconstruction results compared to non-adaptive NeuFMT. (b) Convergence curve of s given more initial s values\nranging from 0.5 to 2 GT value under the same setting of (a). (c) Convergence curve of s value across all cases with different a values, given\ninitial s = 1.5 mm-1 . (d-f) Effective test for the correction of the absorption coefficient ( a ). (d) For the same phantom in (a), a (mismatched) a initial\nvalue is assumed for FMT reconstruction. The -adaption module successfully corrects a with an average error of 1.5%, le", "ading to significantly improved\nFMT reconstruction results. (e) Convergence curve of a given more initial a values ranging from 0.5 to 2 GT value under the same setting of (d).\n(f) Convergence curve of a value across all cases with different s values, given initial a = 0.15 mm-1 . (g-h) Effective test for the correction of both\nabsorption and diffusion coefficients. (g) For the same phantom in (a), given mismatched initial a = 1.5 and s = 0.15, both of which are 50% higher than\nGT, the -adaption module successfully corrects both a and s at the same time. (h) Convergence curve given the iteration process in (g) for both optical\ncoefficients.\n\nB. Numerical Simulations\nTo comprehensively evaluate the performance of the proposed NeuFMT under controlled conditions, we designed\nfour distinct num", "erical phantoms (Fig. 3 (a) (d) respectively)\nto systematically increase the reconstruction challenge:\n Case 1 - single small target: a 3 mm-diameter spherical\nfluorescence target embedded in a homogeneous cuboid\nphantom (55 55 15 mm3 ), serving as a baseline\nfor evaluating localization and quantitative accuracy of\na simple, isolated inclusion.\n Case 2 - complex surface geometry: a 2 mm-diameter\nspherical target inside a phantom with a curved surface\ngeometry, featuring a spherical cap top (base: 50 50 4\nmm, cap height = 5 mm, total height = 9 mm). This\ncase tests the method s robustness to non-planar surface\ntopography.\n\nCase 3 - complex target shape: a large peanut-shaped fluorescence region with uniform concentration embedded in\na standard cuboid phantom same as Case 1. This scenario\nas", "sesses the capability to recover intricate morphological\ndetails beyond simple spheres.\n Case 4 - multi-target with background: the same peanutshaped region as in Case 3, but with the addition of\na small, high-concentration spherical target inside. This\nrepresents a highly realistic and challenging condition,\ntesting the ability to resolve targets of different concentrations and shapes against a noisy background.\n\nThe ground-truth optical properties for all simulated measurements in this test were set to a = 0.1 mm 1 and s = 1.0\nmm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against\nfour established methods: conventional Tikhonov-regularized\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IM", "PLICIT NEURAL REPRESENTATION\n\nGT\n\nL2-CG\n\nL1-FISTA\n\nU-Net\n\nNeuFMT\n\nμNeuFMT\n1\n\ny\nx\n\ny\n\nz\n\nDICE =\n0.6581\n\nz=8\n\n0.4956\n\n0.6446\n\nNorm.int (a.u.)\n\nCase 1\n\n(a)\n\n0.8800\n\n0.5128\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.6286\n\nz=2\n\n0.7500\n\n0.0000\n\nNorm.int (a.u.)\n\nCase 2\n\n(b)\n\n1\n\n0.7586\n\n0.2041\n\n0\nz\n\ny\nx\n\nx\n\ny\n\nz\n\nz=8\n\n0.6938\n\n0.0828\n\n0.6153\n\nNorm.int (a.u.)\n\nCase 3\n\n(c)\n\n1\n\ny\n\n0.9751\n\n0.4766\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.5435\n\nz=8\n\n0.5908\n\n0.2637\n\nNorm.int (a.u.)\n\nCase 4\n\n(d)\n\n1\n\n0.8983\n\n0.7645\n\n0\nz\n\ny\nx\n\nNorm.int (a.u.)\n\n(e)\n\nCase 1\n\nCase 2\n\nCase 3\n\nCase 4\n\n1\n\n1\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.8\n\n0.8\n\n0.6\n\n0.6\n\n0.6\n\n0.6\n\n0.4\n\n0.4\n\n0.4\n\n0.4\n\n0.2\n\n0.2\n\n0.2\n\n0\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n0\n15\n\n0\n20\n\n25\n\n30\n\nmm\n\nGT\n\nL2-CG\n\n35\n\n0.2\n0\n\n10\n\nmm\n\nL1-FISTA\n\n20\n\n30\n\n40\n\n50\n\n0\n\n15\n\n20\n\n25\n\n30\n\n35\n\nmm\n\nU-Net\n\nNeuFMT\n\n40\n\nmm\n\nμNeuFMT\n\nFig. 3. Results", "of numerical phantom simulations. (a) (d) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (e) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.\n\nconjugate gradients (L2 -CG) [42] and L1 -regularized nonnegative least squares (L1 -FISTA) [43], a pretrained supervised U-Net, and our baseline method NeuFMT without adaption. The U-Net was trained on a large, synthetically\ngenerated dataset of 5,488 samples. For each sample, the\ninput was a boundary measurement simulated using the DEbased forward model under the ground-truth properties", "in a\ncuboid phantom (55 55 15 mm3 ), and the label was the\ncorresponding 3D fluorescence map of 1 2 ellipsoids with\nrandom sizes and spatial positions. To clearly demonstrate the\neffect of the -adaption module, we focused on adapting s\nwhile fixing a at its true value during reconstruction. For all\nmethods, the initial s was set to an erroneous value of 1.2\nmm 1 , which is 20% higher than the ground truth.\nThe results presented in Fig. 3 (a) (d) demonstrate the\nconsistent superiority of NeuFMT across all four numerical cases. We observe that the conventional methods were\nadversely affected by the optical property mismatch: L2 -CG\nreconstructions were characteristically blurred and exhibited\nsignificant depth errors, such as full-depth penetration in\nCases 3 and 4 and depth-wise expansion", "in Case 1. L1 -FISTA\nfrequently introduced non-physical, fragmented artifacts, such\nas staircase patterns in Case 1 and hollow structures in Case 3,\nwhile it also suffered from severe depth inaccuracy. The\nsupervised U-Net, though performed well in Case 1, showed\nlimited generalization beyond its training data, as seen in its\nlocalization failure in the complex surface geometry of Case 2\n\n7\n\nand noticeable shape distortion in the unseen peanut-shaped\ntarget of Case 3 and 4. The direct NeuFMT provided better\ndepth prediction than the traditional methods but remained\nsensitive to the erroneous s , resulting in substantial shape\nexpansion in the x-y plane (Cases 1, 2) and axial splitting\n(Case 3). In contrast, NeuFMT successfully rectified the\noptical properties and overcame these limitations", ". It achieved\nthe most accurate spatial localization and shape fidelity, as\nevidenced by its 3D isosurfaces tightly conforming to the\nground truth in both simple and complex targets, and it clearly\nresolved both the small target and the complex background in\nCase 4. Quantitatively, NeuFMT consistently achieved the\nhighest Dice coefficients, and its intensity profiles (Fig. 3 (e))\nmost closely matched the ground truth in terms of peak\nlocation, width, and background suppression.\nC. Phantom Experiments\nWe further evaluated the performance of all methods using\nphysical phantom experiments to assess their practicality under real-world conditions, including measurement noise. The\nphantoms were fabricated from silicone, with their optical\nproperties calibrated to be approximately a = 0.0055 mm 1", "and s = 1.1 mm 1 at 680 nm. Fluorescent targets were embedded within the phantoms to create the four cases previously\ndefined in the simulations. The initial value of s was set identically for all reconstruction methods as the calibrated value,\nand also the U-Net was retrained accordingly. Consistent with\nthe simulation study, we focused on the adaptive recovery of\nthe reduced scattering coefficient s .\nThe reconstruction results are summarized in Fig. 4. Under\nthese challenging real-world conditions, the limitations of the\nbaseline methods became evident: conventional approaches\n(L2 -CG, L1 -FISTA) produced blurry or fragmented reconstructions with significant depth errors, while the supervised\nU-Net, susceptible to domain shift and noise, failed to generalize, resulting in complete loca", "lization failures (Case 1)\nor severely distorted shapes (Cases 3 and 4). In contrast,\nthe INR-based frameworks, NeuFMT and NeuFMT, demonstrated markedly superior robustness, consistently yielding\nphysically plausible and continuous reconstructions where\nother methods failed. A detailed comparison between the two\nreveals that NeuFMT provided critical refinements toward\nenhanced physical consistency. In Cases 1 and 3, NeuFMT\nachieved better depth sensitivity and more uniform fluorophore\ndistribution, more faithfully representing the homogeneous\nnature of the true targets. In the complex geometry of Case 2,\nit uniquely achieved accurate localization, whereas direct\nNeuFMT produced a solution with an aberrant depth shift. For\nthe multi-target scenario in Case 4, NeuFMT reconstructed\nthe backgr", "ound region with improved morphological accuracy.\nAlthough the performance gap in quantitative metrics such\nas the Dice coefficient was occasionally narrow, which reflects the inherent robustness of the shared INR architecture,\n NeuFMT provided consistent, subtle refinements, particularly\nin depth accuracy. The phantom experiments confirm that the\nadaptive physical correction mechanism in NeuFMT can enhance reconstruction fidelity under practical conditions where\nthe exact coefficient in most real experiments is uncertain.\n\n8\n\nPREPRINT VERSION 2025\n\n(a)\n\nSilicone Phantoms\nGT\n\nL2-CG\n\nL1-FISTA\n\nU-Net\n\nNeuFMT\n\nμNeuFMT\n1\n\ny\nx\n\ny\n\nz\n\nDICE =\n0.5895\n\nz=8\n\n0.6154\n\n0.0762\n\nNorm.int (a.u.)\n\nCase 1\n\n(b)\n\nFluorescence Inclusions\n\n0.7023\n\n0.6615\n\n0\nz\n\n(Fig. 5 (c)). The reconstructed target lengths from", "NeuFMT\nshowed the closest agreement with the physical measurements\ntaken from the ex vivo lymph nodes, as visualized by the\nintensity profiles in Fig. 5 (c). These results demonstrate that\n NeuFMT provides a definitive advantage in practical in vivo\nscenarios, enabling robust and accurate target segmentation\nand localization under complex clinically related scenarios,\nsuch as fluorescence guided surgery.\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.3371\n\nz=2\n\n0.3810\n\n0.4000\n\n0.5200\n\n0.2586\n\nWhite Light Image\n\n(a)\n\nvein\n\nLN-2\n\n0\nz\n\ny\nx\n\ny\n\nz\n\nz=8\n\n0.5413\n\n0.3358\n\n0.7011\n\n0.8230\n\n0.8050\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.5193\n\nz=8\n\n0.4319\n\n0.6601\n\n0.2849\n\nNorm.int (a.u.)\n\n0.6240\n\nNeuFMT\n\nμNeuFMT\nz\nx\n\nvein\n\nLN-3\nLN-2\nLN-1\n\nCase 3\n\nCase 4\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.6\n\n0.6\n\n0.6\n\n0.6\n\n0.4\n\n0.4\n\n0.4\n\n0.4\n\n0.2\n\n0.2\n20\n\n25\n\n30\n\n35\n\n40\n\n0\n15", "0.2\n20\n\n25\n\n30\n\nmm\n\nGT\n\nL2-CG\n\n35\n\n0.2\n\n0\n\n0\n0\n\n10\n\nmm\n\nL1-FISTA\n\n20\n\n30\n\n40\n\n50\n\n15\n\n20\n\n25\n\n30\n\n35\n\nmm\n\nU-Net\n\nNeuFMT\n\n40\n\nmm\n\nNeuFMT-Ada\n\nFig. 4. Results of real phantom experiments. (a) Photograph of the real\nsilicone phantoms and fluorescence inclusions. (b) (e) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (f) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.\n\n10 mm\n\n(c)\n\nWe performed an in vivo imaging experiment on mice.\nFollowing the protocol described in Subsection II-F, Cy5\nfluorescent dye accumulated primarily at the", "sentinel lymph\nnodes (LN), with some residual signal at the vein (Fig. 5 (a)).\nOur task was to reconstruct the spatial location and shape of\nthe sentinel lymph nodes.\nThe 3D FMT reconstruction results from all methods\nare presented in Fig. 5 (b). The conventional L2 -CG method\nproduced a reconstruction where the volume of LN-3 was\noverestimated, and the signals from LN-1, LN-2, and the vein\nmerged into a single, indistinguishable cluster. The L1 -FISTA\nreconstruction was highly fragmented, making it impossible\nto discern the shape or count of the lymph nodes accurately.\nAlso, the baseline NeuFMT failed to produce a physiologically plausible reconstruction. In contrast, NeuFMT was\nthe only method that successfully and distinctly resolved all\nthree lymph nodes (LN-1, LN-2, LN-3) and the vei", "n, clearly\nidentifying each as separate, localized regions of fluorescence.\nFor quantitative validation, the mouse was sacrificed, and\nthe lymph nodes were excised to be imaged by ex vivo FRI\n\nLN-1\n\nx\ny\n\nLN-3 LN-2\n\n10 mm\n\n0\n\n1\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.8\n\n0.6\n\nLN-1\n\n0.4\n\n0.6\n\nLN-2\n\n0.4\n\n0.2\n\n0.6\n\n0.2\n\n0\n2\n\n4\n\n6\n\nL2-CG\n\n8\n\n10\n\n12\nmm\n\nLN-3\n\n0.4\n\n0.2\n\n0\n0\n\nD. In Vivo Lymph Node FMT Imaging Experiments\n\nConcentration of Cy5 (a.u.)\n\nCase 2\n1\n0.8\n\nSlice z = 8 mm\n\nCase 1\n1\n0.8\n\nx\ny\n\nSlice z = 11 mm\n\n(f)\nNorm.int (a.u.)\n\nL1-FISTA\n\nR\n\n1\n\nProfiles\n\ny\nx\n\n15\n\nL2-CG\n\nLN-3\n\nL\n\n0\nz\n\n0\n\nR\n\ny\n\nConcentration of Cy5 (a.u.)\n\nCase 4\n\n(e)\n\n1\n\n(b)\n\nLN-1\n\nL\n\n3D Segmentation\n\nx\n\nNorm.int (a.u.)\n\nCase 3\n\n(d)\n\n1\n\ny\n\nIn vivo FRI\n\nNorm.int (a.u.)\n\nCase 2\n\n(c)\n\n1\n\n0\n0\n\n2\n\nL1-FISTA\n\n4\n\n6\n\n8\n\n10\n\n12\nmm\n\n0\n\n2\n\nNeuFMT\n\n4\n\n6\n\n8\n\n1", "0\n\n12\nmm\n\nμNeuFMT\n\nFig. 5. In vivo lymph node FMT imaging and reconstruction results. (a) The\nwhite-light image and preview via 2D fluorescence reflectance imaging (FRI)\noverlaid on the white-light image with the red aera indicating the concentrated\ndistribution of Cy5 probe on the cites of three lymph nodes (LN-1, LN-2, LN3) and the vein. (b) Comparison of FMT reconstruction results from different\nmethods. The 3D segmentation, along with two slices at z = 8 and 11 mm,\nare displayed. (c) Intensity profiles along the dashed lines in b. are compared\nfor each ex vivo images of lymph nodes after sacrificing the animal. The gray\nzone represents the estimated size of LN, based on the ex vivo fluorescence\nimages.\n\nIV. D ISCUSSION AND C ONCLUSION\nIn this study, we introduced NeuFMT, an optical-pro", "pertyadaptive FMT reconstruction framework that integrates INR\nwith an explicitly differentiable FEM-based light propagation model. By unifying a continuous fluorescence field parameterized by an INR and a physics-based forward model\namenable to end-to-end optimization, NeuFMT addresses\ntwo fundamental limitations of existing FMT reconstruction\ntechniques: their inability to efficiently adapt to complex and\nheterogeneous fluorescence distribution, and their reliance on\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nfixed, often inaccurate, optical properties, which significantly\nexacerbates the inherent ill-posedness of the inverse problem.\nUnlike supervised deep learning approaches which are constrained by the diversit", "y and scale of training datasets and\noften fail under domain shift, NeuFMT operates in a selfsupervised, physics-informed regime. It does not require paired\ntraining data; instead, it directly minimizes the discrepancy between measured and simulated boundary fluxes. This not only\neliminates the need for extensive experimental datasets but also\nensures generalizability across different imaging geometries\nand target configurations. The continuous, coordinate-based\nrepresentation provided by the INR further ensures that our\nreconstructions are free from discretization artifacts and inherently resolution-agnostic.\nA central contribution of our work is the introduction of\nan optical property adaptation mechanism, which enables the\ndynamic optimization of absorption and scattering coefficients\n(", "a , s ) concurrently with the fluorescence distribution. Our\nframework demonstrates that the integration of a differentiable\nphysics-based forward model is the key to enabling this\nself-supervised adaptation. The FEM-based light propagation\nmodel is not merely a component of the loss function, but\nan active and adaptive part of the inverse solver. This stands\nin contrast to both traditional iterative methods, which hold\noptical properties static and thus aggravate the problem s illposedness, and conventional end-to-end deep learning approaches, which struggle to generalize beyond their training\ndata. The adaptivity of our model is thus its core strength,\nproviding a principled way to refine the physical model itself\nbased on the measured data, which is crucial for practical\napplications w", "here precise prior knowledge of tissue optics\nis unavailable.\nOur results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate\nthat NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1 ) and deep learningbased (U-Net) benchmarks. In particular, the method consistently localized fluorescent targets with higher spatial accuracy, improved contrast, and more realistic morphological\nfeatures especially under challenging conditions involving\nbackground fluorescence and complex geometry.\nDespite these promising results, several aspects of\n NeuFMT merit further investigation. First, the current implementation assumes a homogeneous optical background a\ncommon simplification in FMT studies. Extending the model\nto incor", "porate spatially varying optical properties represents\na logical next step, potentially by representing a (r) and\n s (r) with additional INRs, though this would significantly\nincrease the complexity of the inverse problem. Nevertheless,\nthe proposed NeuFMT can be validated or even combined\nwith time-domain near-infrared spectroscopy (fNIRS) [44],\n[45] or diffuse optical tomography (DOT) [46] techniques,\nwhere the complex optical properties related with absorption\nand scattering can disentangled and calibrated. More importantly, the integration of NeuFMT with emerging imaging\ntechnologies holds particular promise. The inherent adaptivity\nof our framework is well-suited to the distinct scattering\nand absorption landscapes of NIR-II fluorescence tomography\n\n9\n\n[47], [48], where our optical pr", "operty optimization could be\ncrucial for accurately modeling the increased photon penetration and achieving higher-resolution reconstruction at depth.\nFurthermore, the framework can be naturally extended to\nhyperspectral FMT, using a single INR to output both fluorophore concentration and spectral signature, thereby disentangling multiple probes or accounting for wavelength-dependent\noptical properties. Finally, translating NeuFMT into clinical\nsettings, such as intraoperative fluorescence-guided surgery\n[8], [9], represents an exciting frontier where its adaptability\ncould overcome patient-specific variations in tissue optics.\nIn conclusion, by harmonizing a differentiable physics\nmodel with a continuous INR, NeuFMT provides a robust,\nself-supervised, and adaptive framework for FMT recons", "truction. It effectively mitigates the ill-posedness inherent to\ninverse problems with uncertain parameters, setting a new\nparadigm for practical, high-resolution fluorescence molecular\nimaging. We believe this physics-in-the-loop INR approach\noffers a generalizable template for tackling a wide range of\ntomographic and inverse problems in biomedical imaging.\nR EFERENCES\n[1] F. Song, P. Zhang, H. Wu, C. Ma, Z. Liu, R. Cai, Y. Feng, Y. He,\nX. Dong, Y. Tian, and G. Zhang, Advances of fluorescence molecular\nimaging: NIR-II window, probes, and tomography, Laser & Photonics\nReviews, vol. 19, no. 10, p. 2400275, 2025.\n[2] B. Zhu, J. Hendricks, J. E. Morton, J. C. Rasmussen, C. Janssen,\nM. N. Shah, and E. M. Sevick-Muraca, Near-infrared fluorescence\ntomography and imaging of ventricular cerebrospi", "nal fluid flow and\nextracranial outflow in non-human primates, IEEE Transactions on\nMedical Imaging, vol. 42, no. 12, pp. 3555 3565, 2023.\n[3] M. S. Ozturk and et al., High-resolution tomographic analysis of in\nvitro 3D glioblastoma tumor model under long-term drug treatment, \nScience Advances, vol. 6, no. 10, p. eaay7513, 2020.\n[4] M. Cai, Z. Zhang, X. Shi, Z. Hu, and J. Tian, NIR-II/NIR-I fluorescence molecular tomography of heterogeneous mice based on gaussian\nweighted neighborhood fused lasso method, IEEE Transactions on\nMedical Imaging, vol. 39, no. 6, pp. 2213 2222, 2020.\n[5] S. R. Arridge and J. C. Schotland, Optical tomography: forward and\ninverse problems, Inverse problems, vol. 25, no. 12, p. 123010, 2009.\n[6] L. V. Wang and H.-i. Wu, Biomedical optics: principles and imaging.\nJo", "hn Wiley & Sons, 2007.\n[7] F. Stuker, J. Ripoll, and M. Rudin, Fluorescence molecular tomography:\nprinciples and potential for pharmaceutical research, Pharmaceutics,\nvol. 3, no. 2, pp. 229 274, 2011.\n[8] J. S. D. Mieog, F. B. Achterberg, A. Zlitni, M. Hutteman, J. Burggraaf,\nR.-J. Swijnenburg, S. Gioux, and A. L. Vahrmeijer, Fundamentals and\ndevelopments in fluorescence-guided cancer surgery, Nature Reviews\nClinical Oncology, vol. 19, no. 1, pp. 9 22, 2022.\n[9] K. Wang, Y. Du, Z. Zhang, K. He, Z. Cheng, L. Yin, D. Dong, C. Li,\nW. Li, Z. Hu et al., Fluorescence image-guided tumour surgery, Nature\nReviews Bioengineering, vol. 1, no. 3, pp. 161 179, 2023.\n[10] D. Zhu et al., Comparison of regularization methods in fluorescence\nmolecular tomography, Photonics, vol. 1, no. 2, pp. 95 109, 2014.", "[11] H. Yi et al., Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography:\na comparative study, Journal of Biomedical Optics, vol. 18, no. 5, p.\n56013, 2013.\n[12] J. Shi, B. Zhang, F. Liu, J. Luo, and J. Bai, Efficient L1 regularizationbased reconstruction for fluorescent molecular tomography using\nrestarted nonlinear conjugate gradient, Optics letters, vol. 38, no. 18,\npp. 3696 3699, 2013.\n[13] D. Zhu and C. Li, Nonconvex regularizations in fluorescence molecular\ntomography for sparsity enhancement, Physics in Medicine & Biology,\nvol. 59, no. 12, p. 2901, 2014.\n[14] J. Zhang, L. Li, Q. Hu, J. Zhang, Y. Wu, L. Gu, J. Li, F. Li, X. Zhu,\nJ. Jiang et al., High-fidelity solution decomposition fluorescence tomography in the presence of", "background interference, Laser & Photonics\nReviews, p. e01013, 2025.\n\n10\n\n[15] C. Huang, H. Meng, Y. Gao, S. Jiang, K. Wang, and J. Tian, Fast and\nrobust reconstruction method for fluorescence molecular tomography\nbased on deep neural network, in Imaging, Manipulation, and Analysis\nof Biomolecules, Cells, and Tissues XVII, vol. 10881. SPIE, 2019, pp.\n257 262.\n[16] L. Guo, F. Liu, C. Cai, J. Liu, and G. Zhang, 3D deep encoder decoder\nnetwork for fluorescence molecular tomography, Optics letters, vol. 44,\nno. 8, pp. 1892 1895, 2019.\n[17] P. Zhang, G. Fan, T. Xing, F. Song, and G. Zhang, UHR-DeepFMT:\nultra-high spatial resolution reconstruction of fluorescence molecular\ntomography based on 3-d fusion dual-sampling deep neural network, \nIEEE Transactions on Medical Imaging, vol. 40, no. 11, p", "p. 3217 3228,\n2021.\n[18] J. Cheng, P. Zhang, F. Liu, J. Liu, H. Hui, J. Tian, and J. Luo, Encoderdecoder deep learning network for simultaneous reconstruction of fluorescence yield and lifetime distributions, Biomedical Optics Express,\nvol. 13, no. 9, pp. 4693 4705, 2022.\n[19] P. Zhang, C. Ma, F. Song, Z. Liu, Y. Feng, Y. Sun, Y. He,\nF. Liu, D. Wang, and G. Zhang, Multi-branch attention prior based\nparameterized generative adversarial network for fast and accurate\nlimited-projection reconstruction in fluorescence molecular tomography, Biomedical Optics Express, vol. 13, no. 10, pp. 5327 5343, 2022.\n[20] P. Zhang, F. Song, C. Ma, Z. Liu, H. Wu, Y. Sun, Y. Feng, Y. He, and\nG. Zhang, Robust reconstruction of fluorescence molecular tomography\nbased on adaptive adversarial learning strategy, Ph", "ysics in Medicine &\nBiology, vol. 68, no. 4, p. 04LT01, 2023.\n[21] P. Zhang, X. Liu, Q. Xue, Y. Shang, C. Liu, R. Chen, H. Gao, J. Liang,\nW. Wang, and G. Zhang, PAH2T-Former: Paired-attention hybrid\nhierarchical transformer for synergistically enhanced fmt reconstruction\nquality and efficiency, IEEE Transactions on Computational Imaging,\n2025.\n[22] H. Meng, Y. Gao, X. Yang, K. Wang, and J. Tian, K-nearest neighbor\nbased locally connected network for fast morphological reconstruction\nin fluorescence molecular tomography, IEEE transactions on medical\nimaging, vol. 39, no. 10, pp. 3019 3028, 2020.\n[23] D. Li, C. Chen, J. Li, and Q. Yan, Reconstruction of fluorescence\nmolecular tomography based on graph convolution networks, Journal\nof Optics, vol. 22, no. 4, p. 045602, 2020.\n[24] Y. Wang, C.", "Bian, Y. An, H. Wang, Q. Liang, Y. Du, and J. Tian,\n Graph convolution based residual connected network for morphological reconstruction in fluorescence molecular tomography, in Medical\nImaging 2022: Biomedical Applications in Molecular, Structural, and\nFunctional Imaging, vol. 12036. SPIE, 2022, pp. 527 533.\n[25] Y. Sun, J. Liu, M. Xie, B. Wohlberg, and U. S. Kamilov, Coil:\nCoordinate-based internal learning for tomographic imaging, IEEE\nTransactions on Computational Imaging, vol. 7, pp. 1400 1412, 2021.\n[26] L. Lozenski, M. A. Anastasio, and U. Villa, A memory-efficient selfsupervised dynamic image reconstruction method using neural fields, \nIEEE Transactions on Computational Imaging, vol. 8, pp. 879 892,\n2022.\n[27] A. W. Reed, H. Kim, R. Anirudh, K. A. Mohan, K. Champley, J. Kang,\nand S", ". Jayasuriya, Dynamic CT reconstruction from limited views\nwith implicit neural representations and parametric motion fields, in\nProceedings of the IEEE/CVF International Conference on Computer\nVision, 2021, pp. 2258 2268.\n[28] L. Shen, J. Pauly, and L. Xing, NeRP: implicit neural representation\nlearning with prior embedding for sparsely sampled image reconstruction, IEEE Transactions on Neural Networks and Learning Systems,\nvol. 35, no. 1, pp. 770 782, 2022.\n[29] R. Liu, Y. Sun, J. Zhu, L. Tian, and U. S. Kamilov, Recovery\nof continuous 3D refractive index maps from discrete intensity-only\nmeasurements using neural fields, Nature Machine Intelligence, vol. 4,\nno. 9, pp. 781 791, 2022.\n[30] S. Shen, L. Li, S. Gao, Y. Wang, L. Gu, S. Li, X. Zhu, J. Jiang, J. Yu, and\nW. Ren, High resolution", "diffuse optical tomography via neural fields, \nIEEE Transactions on Computational Imaging, 2024.\n[31] K. Han, C. Li, A. Xiao, Y. Tian, J. Tian, and Z. Hu, TSPE: Reconstruction of multi-morphological tumors of NIR-II fluorescence molecular\ntomography based on positional encoding, Computer Methods and\nPrograms in Biomedicine, vol. 261, p. 108554, 2025.\n[32] S. R. Arridge, Optical tomography in medical imaging, Inverse problems, vol. 15, no. 2, p. R41, 1999.\n[33] , Photon-measurement density functions. part I: Analytical forms, \nApplied Optics, vol. 34, no. 31, pp. 7395 7409, 1995.\n[34] S. R. Arridge and M. Schweiger, Photon-measurement density functions. part 2: Finite-element-method calculations, Applied Optics,\nvol. 34, no. 34, pp. 8026 8037, 1995.\n\nPREPRINT VERSION 2025\n\n[35] O. C. Zienki", "ewicz, R. L. Taylor, P. Nithiarasu, and J. Zhu, The finite\nelement method. Elsevier, 1977, vol. 3.\n[36] V. Ntziachristos, C. Bremer, and R. Weissleder, Fluorescence molecular\ntomography resolves protease activity in vivo, Nature Medicine, vol. 8,\nno. 7, pp. 757 760, 2002.\n[37] M. Schweiger and S. Arridge, The Toast++ software suite for forward\nand inverse modeling in optical tomography, Journal of biomedical\noptics, vol. 19, no. 4, pp. 040 801 040 801, 2014.\n[38] W. Ren, H. Isler, M. Wolf, J. Ripoll, and M. Rudin, Smart toolkit\nfor fluorescence tomography: simulation, reconstruction, and validation, \nIEEE Transactions on Biomedical Engineering, vol. 67, no. 1, pp. 16 \n26, 2019.\n[39] S. Gao, J. Zhang, Y. Hu, Y. Wu, L. Li, Q. Hu, X. Lou, X. Zhu, J. Jiang,\nand W. Ren, Multifunctional optical", "tomography system with highfidelity surface extraction based on a single programmable scanner and\nunified pinhole modeling, IEEE Transactions on Biomedical Engineering, 2023.\n[40] Y. Hu, Y. Wu, L. Li, L. Gu, X. Zhu, J. Jiang, and W. Ren, Simultaneous\nreconstruction of 3D fluorescence distribution and object surface using\nstructured light illumination and dual-camera detection, Optics Express,\nvol. 32, no. 9, pp. 15 760 15 773, 2024.\n[41] C. Ji, M. Zhao, C. Wang, R. Liu, S. Zhu, X. Dong, C. Su, and Z. Gu,\n Biocompatible tantalum nanoparticles as radiosensitizers for enhancing\ntherapy efficacy in primary tumor and metastatic sentinel lymph nodes, \nACS nano, vol. 16, no. 6, pp. 9428 9441, 2022.\n[42] S. Kawata and O. Nalcioglu, Constrained iterative reconstruction by\nthe conjugate gradient met", "hod, IEEE Transactions on Medical Imaging,\nvol. 4, no. 2, pp. 65 71, 1985.\n[43] A. Beck and M. Teboulle, A fast iterative shrinkage-thresholding algorithm for linear inverse problems, SIAM Journal on Imaging Sciences,\nvol. 2, no. 1, pp. 183 202, 2009.\n[44] Y. Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared\nspectroscopy and imaging: a review, Applied Sciences, vol. 9, no. 6, p.\n1127, 2019.\n[45] H. Y. Ban, G. M. Barrett, A. Borisevich, A. Chaturvedi, J. L. Dahle,\nH. Dehghani, J. Dubois, R. M. Field, V. Gopalakrishnan, A. Gundran\net al., Kernel flow: a high channel count scalable time-domain functional near-infrared spectroscopy system, Journal of biomedical optics,\nvol. 27, no. 7, p. 074710, 2022.\n[46] A. Pifferi, D. Contini, A. D. Mora, A. Farina, L. Spinelli, and A. Torricel", "li, New frontiers in time-domain diffuse optics, a review, Journal\nof Biomedical Optics, vol. 21, no. 9, pp. 091 310 091 310, 2016.\n[47] F. Wang, Y. Zhong, O. Bruns, Y. Liang, and H. Dai, In vivo NIRII fluorescence imaging for biology and medicine, Nature Photonics,\nvol. 18, no. 6, pp. 535 547, 2024.\n[48] Z. Zhang, Y. Du, X. Shi, K. Wang, Q. Qu, Q. Liang, X. Ma, K. He,\nC. Chi, J. Tang et al., NIR-II light in clinical oncology: opportunities\nand challenges, Nature Reviews Clinical Oncology, vol. 21, no. 6, pp.\n449 467, 2024."]}
{"method": "sliding", "num_chunks": 147, "avg_chunk_len": 797.8299319727892, "std_chunk_len": 22.256199671212876, "max_chunk_len": 800, "min_chunk_len": 529, "total_chars": 117281, "compression_ratio": 0.5024684305215679, "chunks": ["PREPRINT VERSION 2025\n\n1\n\n NeuFMT: Optical-Property-Adaptive Fluorescence\nMolecular Tomography via Implicit\nNeural Representation\n\narXiv:2511.04510v1 [eess.IV] 6 Nov 2025\n\nShihan Zhao, Jianru Zhang, Yanan Wu, Linlin Li, Siyuan Shen, Xingjun Zhu, Guoyan Zheng, Member IEEE,\nJiahua Jiang, and Wuwei Ren\n\nAbstract Fluorescence Molecular Tomography (FMT) is a\npromising technique for non-invasive 3D visualization of fluorescent probes, but its reconstruction remains challenging due to\nthe inherent ill-posedness and reliance on inaccurate or oftenunknown tissue optical properties. While deep learning methods\nhave shown promise, their supervised nature limits generalization\nbeyond training data. To address these problems, we propose\n NeuFMT, a self-supervised FMT reconstruction framework that\ninteg", "alization of fluorescent probes, but its reconstruction remains challenging due to\nthe inherent ill-posedness and reliance on inaccurate or oftenunknown tissue optical properties. While deep learning methods\nhave shown promise, their supervised nature limits generalization\nbeyond training data. To address these problems, we propose\n NeuFMT, a self-supervised FMT reconstruction framework that\nintegrates implicit neural-based scene representation with explicit\nphysical modeling of photon propagation. Its key innovation lies\nin jointly optimize both the fluorescence distribution and the\noptical properties ( ) during reconstruction, eliminating the need\nfor precise prior knowledge of tissue optics or pre-conditioned\ntraining data. We demonstrate that NeuFMT robustly recovers\naccurate fluoropho", "rates implicit neural-based scene representation with explicit\nphysical modeling of photon propagation. Its key innovation lies\nin jointly optimize both the fluorescence distribution and the\noptical properties ( ) during reconstruction, eliminating the need\nfor precise prior knowledge of tissue optics or pre-conditioned\ntraining data. We demonstrate that NeuFMT robustly recovers\naccurate fluorophore distributions and optical coefficients even\nwith severely erroneous initial values (0.5 to 2 of ground\ntruth). Extensive numerical, phantom, and in vivo validations\nshow that NeuFMT outperforms conventional and supervised\ndeep learning approaches across diverse heterogeneous scenarios.\nOur work establishes a new paradigm for robust and accurate\nFMT reconstruction, paving the way for more reliab", "re distributions and optical coefficients even\nwith severely erroneous initial values (0.5 to 2 of ground\ntruth). Extensive numerical, phantom, and in vivo validations\nshow that NeuFMT outperforms conventional and supervised\ndeep learning approaches across diverse heterogeneous scenarios.\nOur work establishes a new paradigm for robust and accurate\nFMT reconstruction, paving the way for more reliable molecular\nimaging in complex clinically related scenarios, such as fluorescence guided surgery.\nIndex Terms fluorescence molecular tomography, image reconstruction, optical properties, implicit neural representation,\nfluorescence guided surgery\n\nThe work was supported by Science and Technology Commission of Shanghai Municipality under Grant 25JS2830300 (Wuwei Ren), National Natural\nScience Foun", "le molecular\nimaging in complex clinically related scenarios, such as fluorescence guided surgery.\nIndex Terms fluorescence molecular tomography, image reconstruction, optical properties, implicit neural representation,\nfluorescence guided surgery\n\nThe work was supported by Science and Technology Commission of Shanghai Municipality under Grant 25JS2830300 (Wuwei Ren), National Natural\nScience Foundation of China under Grants 62105205 (Wuwei Ren), and\nShanghai Clinical Research and Trial Center (Wuwei Ren). (Corresponding\nauthor: Wuwei Ren.)\nShihan Zhao and Jianru Zhang contributed equally to this work.\nShihan Zhao, Yanan Wu, Linlin Li and Siyuan Shen are with\nthe School of Information Science and Technology, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: zhaoshh, wuyn1, lill,\nshe", "dation of China under Grants 62105205 (Wuwei Ren), and\nShanghai Clinical Research and Trial Center (Wuwei Ren). (Corresponding\nauthor: Wuwei Ren.)\nShihan Zhao and Jianru Zhang contributed equally to this work.\nShihan Zhao, Yanan Wu, Linlin Li and Siyuan Shen are with\nthe School of Information Science and Technology, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: zhaoshh, wuyn1, lill,\nshensy2023@shanghaitech.edu.cn).\nJianru Zhang and Jiahua Jiang are with the School of Mathematics,\nUniversity of Birmingham, Edgbaston, B15 2QN, United Kingdom (e-mail:\njxz389@student.bham.ac.uk; j.jiang.3@bham.ac.uk).\nXingjun Zhu is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail:\nzhuxj1@shanghaitech.edu.cn).\nGuoyan Zheng is with the Instit", "nsy2023@shanghaitech.edu.cn).\nJianru Zhang and Jiahua Jiang are with the School of Mathematics,\nUniversity of Birmingham, Edgbaston, B15 2QN, United Kingdom (e-mail:\njxz389@student.bham.ac.uk; j.jiang.3@bham.ac.uk).\nXingjun Zhu is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail:\nzhuxj1@shanghaitech.edu.cn).\nGuoyan Zheng is with the Institute of Medical Robotics, School of\nBiomedical Engineering, Shanghai Jiao Tong University, Shanghai 200240,\nChina (e-mail: guoyan.zheng@sjtu.edu.cn)\nWuwei Ren is with the School of Information Science and Technology,\nShanghaiTech University, Shanghai 201210, China, and also with State\nKey Laboratory of Advanced Medical Materials and Devices, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail:", "ute of Medical Robotics, School of\nBiomedical Engineering, Shanghai Jiao Tong University, Shanghai 200240,\nChina (e-mail: guoyan.zheng@sjtu.edu.cn)\nWuwei Ren is with the School of Information Science and Technology,\nShanghaiTech University, Shanghai 201210, China, and also with State\nKey Laboratory of Advanced Medical Materials and Devices, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: renww@shanghaitech.edu.cn).\n\nI. INTRODUCTION\nFluorescence Molecular Tomography (FMT) has emerged\nas a promising molecular imaging modality, enabling noninvasive 3D visualization of fluorescent probe distribution\nin highly turbid media [1]. Owning to its high sensitivity,\ncost-effectiveness, and non-ionizing radiation, FMT has found\nbroad applications in preclinical research and clinical practice,", "renww@shanghaitech.edu.cn).\n\nI. INTRODUCTION\nFluorescence Molecular Tomography (FMT) has emerged\nas a promising molecular imaging modality, enabling noninvasive 3D visualization of fluorescent probe distribution\nin highly turbid media [1]. Owning to its high sensitivity,\ncost-effectiveness, and non-ionizing radiation, FMT has found\nbroad applications in preclinical research and clinical practice, e.g., brain imaging [2], in vitro cell culture monitoring\n[3] and tumor detection [4]. FMT reconstructs the internal\nfluorescence distribution by measuring the photon distribution\non the object surface and minimizing the discrepancy between\nreal measurements and the simulated results. A canonic framework of FMT reconstruction employs an iterative optimization\nstrategy with a forward model typicall", "e.g., brain imaging [2], in vitro cell culture monitoring\n[3] and tumor detection [4]. FMT reconstructs the internal\nfluorescence distribution by measuring the photon distribution\non the object surface and minimizing the discrepancy between\nreal measurements and the simulated results. A canonic framework of FMT reconstruction employs an iterative optimization\nstrategy with a forward model typically based on the\nRadiation Transfer Equation (RTE) or the diffusion equation\n(DE) and an inverse model that refines fluorescence distribution prediction until convergence [5], [6]. However, FMT\nreconstruction is inherently ill-posed due to insufficient surface measurements and strong photon scattering effect within\ntissues. Development of high-precision FMT reconstruction\nalgorithms is highly attrac", "y based on the\nRadiation Transfer Equation (RTE) or the diffusion equation\n(DE) and an inverse model that refines fluorescence distribution prediction until convergence [5], [6]. However, FMT\nreconstruction is inherently ill-posed due to insufficient surface measurements and strong photon scattering effect within\ntissues. Development of high-precision FMT reconstruction\nalgorithms is highly attractive for further improvement of\nthe spatial resolution and detection depth of this technology,\nwhich ultimately broaden the biological applications in drug\ndiscovery [7] and clinical use such as fluorescence guided\nsurgery [8], [9].\nTo address the ill-posed nature of FMT reconstruction,\nregularization techniques that incorporate prior knowledge are\napplied. Conventional approaches include Tikhonov", "tive for further improvement of\nthe spatial resolution and detection depth of this technology,\nwhich ultimately broaden the biological applications in drug\ndiscovery [7] and clinical use such as fluorescence guided\nsurgery [8], [9].\nTo address the ill-posed nature of FMT reconstruction,\nregularization techniques that incorporate prior knowledge are\napplied. Conventional approaches include Tikhonov (L2 norm)\nregularization for smoothing the results [10], [11], and sparsepromoting regularization (L1 , Lp norm) or total variation (TV)\nregularization for enhancing the spatial resolution [12], [13].\nRecent advancements in regularization techniques, such as\nthe solution-decomposition algorithm, utilize an advanced\nstochastic prior model that improves the differentiation of\nfluorescence targets f", "(L2 norm)\nregularization for smoothing the results [10], [11], and sparsepromoting regularization (L1 , Lp norm) or total variation (TV)\nregularization for enhancing the spatial resolution [12], [13].\nRecent advancements in regularization techniques, such as\nthe solution-decomposition algorithm, utilize an advanced\nstochastic prior model that improves the differentiation of\nfluorescence targets from background interference, thereby\nenhancing reconstruction quality [14]. While these methods\nstabilize solutions, their reliance on time-consuming iterative\noptimization and idealized assumptions about optical parameters often results in slow convergence and limited accuracy in\nheterogeneous tissues. Deep learning (DL) methods, particularly en-decoder-based neural networks [15] [21] and graphba", "rom background interference, thereby\nenhancing reconstruction quality [14]. While these methods\nstabilize solutions, their reliance on time-consuming iterative\noptimization and idealized assumptions about optical parameters often results in slow convergence and limited accuracy in\nheterogeneous tissues. Deep learning (DL) methods, particularly en-decoder-based neural networks [15] [21] and graphbased networks [22] [24], have recently been used in FMT\nreconstruction by learning direct mappings from boundary\nmeasurements to fluorescence distributions. These approaches\n\n2\n\nencode physical priors within network parameters, enabling\noverwhelmingly rapid inference. However, their dependence\non supervised training with large, scenario-specific datasets restricts generalizability across variable e", "sed networks [22] [24], have recently been used in FMT\nreconstruction by learning direct mappings from boundary\nmeasurements to fluorescence distributions. These approaches\n\n2\n\nencode physical priors within network parameters, enabling\noverwhelmingly rapid inference. However, their dependence\non supervised training with large, scenario-specific datasets restricts generalizability across variable experimental conditions\n(e.g., tissue object geometry and optical properties), leading\nto significant accuracy degradation when the object properties\ndeviate from training assumptions.\nRecently, implicit neural representation (INR) models have\nemerged as a powerful alternative for medical image reconstruction. By mapping arbitrary spatial coordinates to certain\nunknown physical quantities via a coo", "xperimental conditions\n(e.g., tissue object geometry and optical properties), leading\nto significant accuracy degradation when the object properties\ndeviate from training assumptions.\nRecently, implicit neural representation (INR) models have\nemerged as a powerful alternative for medical image reconstruction. By mapping arbitrary spatial coordinates to certain\nunknown physical quantities via a coordinate-based multilayer perceptron network (MLP), INRs achieve continuous\n3D representations, self-supervised training, and memory efficiency. Originally popularized in computer vision and medical imaging, INRs have demonstrated remarkable success\nin modalities such as computed tomography (CT), magnetic\nresonance imaging (MRI) [25] [29], and notably in diffuse\noptical tomography (DOT), where INR", "rdinate-based multilayer perceptron network (MLP), INRs achieve continuous\n3D representations, self-supervised training, and memory efficiency. Originally popularized in computer vision and medical imaging, INRs have demonstrated remarkable success\nin modalities such as computed tomography (CT), magnetic\nresonance imaging (MRI) [25] [29], and notably in diffuse\noptical tomography (DOT), where INR has been proven to be\nable to capture a high-resolution, continuous optical absorption\nmap that account for light scattering in complex tissues [30].\nINR captures continuous spatial information and integrates\nphysical priors makes it particularly suited for various imaging problems. In the context of FMT, preliminary work has\nexplored position encoding strategies to enhance spatial resolution and", "has been proven to be\nable to capture a high-resolution, continuous optical absorption\nmap that account for light scattering in complex tissues [30].\nINR captures continuous spatial information and integrates\nphysical priors makes it particularly suited for various imaging problems. In the context of FMT, preliminary work has\nexplored position encoding strategies to enhance spatial resolution and improve the quality of FMT reconstructions [31].\nNevertheless, systematic studies integrating optical diffusion\nphysics within an INR framework remain scarce. This gap\npresents an opportunity to harness the strengths of implicit\nmodeling for robust and data-efficient FMT reconstruction.\nTo bridge this gap, we propose neural-field-based FMT, or\nNeuFMT, a physics-driven reconstruction framework unif", "improve the quality of FMT reconstructions [31].\nNevertheless, systematic studies integrating optical diffusion\nphysics within an INR framework remain scarce. This gap\npresents an opportunity to harness the strengths of implicit\nmodeling for robust and data-efficient FMT reconstruction.\nTo bridge this gap, we propose neural-field-based FMT, or\nNeuFMT, a physics-driven reconstruction framework unifying\nINR with explicit physical models. Unlike conventional DLbased FMT reconstruction algorithms that couple explicit\nfluorescence predictions to implicit physical model, NeuFMT\nintegrates the DE-based forward model in the network loss,\nenabling self-supervised training without paired data. The\ndifferentiability of the forward model is achieved via finite\nelement method (FEM). This inversion-free", "ying\nINR with explicit physical models. Unlike conventional DLbased FMT reconstruction algorithms that couple explicit\nfluorescence predictions to implicit physical model, NeuFMT\nintegrates the DE-based forward model in the network loss,\nenabling self-supervised training without paired data. The\ndifferentiability of the forward model is achieved via finite\nelement method (FEM). This inversion-free approach ensures\nrapid, continuous reconstruction across diverse geometries\nwhile inherently addressing scattering effects. Another critical\nlimitation of both traditional and DL methods lies in the\npresumed optical properties of the object during reconstruction, which largely aggravate the ill-posedness of the inverse\nproblem given the optical parameters were initially biased. To\novercome this,", "approach ensures\nrapid, continuous reconstruction across diverse geometries\nwhile inherently addressing scattering effects. Another critical\nlimitation of both traditional and DL methods lies in the\npresumed optical properties of the object during reconstruction, which largely aggravate the ill-posedness of the inverse\nproblem given the optical parameters were initially biased. To\novercome this, we further introduce optical-property-adaptive\nNeuFMT, or NeuFMT, an adaptive extension of NeuFMT\nthat dynamically optimizes scattering / absorption coefficients\nand fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations, NeuFMT achieves robust accuracy even when provided\nwith erroneous initial guess of the optical coefficient valu", "we further introduce optical-property-adaptive\nNeuFMT, or NeuFMT, an adaptive extension of NeuFMT\nthat dynamically optimizes scattering / absorption coefficients\nand fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations, NeuFMT achieves robust accuracy even when provided\nwith erroneous initial guess of the optical coefficient values,\naddressing the problem of unrealistic assumption prior to\nFMT reconstruction. Both proposed INR-based FMT reconstruction algorithms were thoroughly compared and validated\nby simulations and phantom experiments along with other\nmethods. Furthermore, in vivo lymph node imaging in mice\nwas performed, further demonstrating the advantages of the\nproposed methods.\n\nPREPRINT VERSION 2025\n\nII. M ETHOD", "es,\naddressing the problem of unrealistic assumption prior to\nFMT reconstruction. Both proposed INR-based FMT reconstruction algorithms were thoroughly compared and validated\nby simulations and phantom experiments along with other\nmethods. Furthermore, in vivo lymph node imaging in mice\nwas performed, further demonstrating the advantages of the\nproposed methods.\n\nPREPRINT VERSION 2025\n\nII. M ETHODS\nA. Forward Modeling of FMT\nModel-based FMT reconstruction comprises two fundamental steps: forward modeling and inversion. The former predicts\nsurface photon density measurements based on an assumed\nfluorescence distribution. At the macroscopic scale, we employ\nthe first-order approximation of the radiative transport equation (RTE), known as the diffusion equation (DE) [32]. The\nexcitation and f", "S\nA. Forward Modeling of FMT\nModel-based FMT reconstruction comprises two fundamental steps: forward modeling and inversion. The former predicts\nsurface photon density measurements based on an assumed\nfluorescence distribution. At the macroscopic scale, we employ\nthe first-order approximation of the radiative transport equation (RTE), known as the diffusion equation (DE) [32]. The\nexcitation and fluorescence emission processes in continuouswave (CW) mode form a coupled pair of DEs expressed as\n[33], [34]:\n κ ϕx (r) + a ϕx (r) = qx (r),\n\nr , (1)\n\n κ ϕm (r) + a ϕm (r) = η C(r) ϕx (r),\n\nr , (2)\n\nwhere ϕx and ϕm denote the excitation and emission photon\ndensity, qx is the excitation source, C(r) is the fluorophore\nconcentration to be reconstructed in the inversion, and η\ncollects quantum-yield", "luorescence emission processes in continuouswave (CW) mode form a coupled pair of DEs expressed as\n[33], [34]:\n κ ϕx (r) + a ϕx (r) = qx (r),\n\nr , (1)\n\n κ ϕm (r) + a ϕm (r) = η C(r) ϕx (r),\n\nr , (2)\n\nwhere ϕx and ϕm denote the excitation and emission photon\ndensity, qx is the excitation source, C(r) is the fluorophore\nconcentration to be reconstructed in the inversion, and η\ncollects quantum-yield factors in the CW source term. κ\nrepresents the diffusion coefficient, calculated by [33]\n1\n,\n(3)\nκ=\n3 ( a + s )\nwith the absorption coefficient a and the reduced scattering\ncoefficient s . In a non-contact setting of FMT, to calculate\nthe value of ϕ (r) on the object surface as the measurement, a Robin-type boundary condition is added alongside the\nequation pair (1 2):\n ϕ (r)\n= 0, {x, m}, r , (4", "factors in the CW source term. κ\nrepresents the diffusion coefficient, calculated by [33]\n1\n,\n(3)\nκ=\n3 ( a + s )\nwith the absorption coefficient a and the reduced scattering\ncoefficient s . In a non-contact setting of FMT, to calculate\nthe value of ϕ (r) on the object surface as the measurement, a Robin-type boundary condition is added alongside the\nequation pair (1 2):\n ϕ (r)\n= 0, {x, m}, r , (4)\n ν\nwhere ζ(c) is the refractive index mismatch parameter that\naccounts for the light reflection on the boundary surface, with\nc representing the light speed inside the medium. ν denotes\nthe outward normal on the boundary. Notably, to simplified the\nproblem setting, we only consider a homogeneous medium\ncase and the difference of a , s values under different\nwavelengths are neglected.\nϕ (r) + 2 ζ", ")\n ν\nwhere ζ(c) is the refractive index mismatch parameter that\naccounts for the light reflection on the boundary surface, with\nc representing the light speed inside the medium. ν denotes\nthe outward normal on the boundary. Notably, to simplified the\nproblem setting, we only consider a homogeneous medium\ncase and the difference of a , s values under different\nwavelengths are neglected.\nϕ (r) + 2 ζ(c) κ\n\nB. Finite Element Discretization and System Matrix Construction\nWe apply the finite element method (FEM) [35] to the\ndiffusion model (1) - (4). Discretizing with a tetrahedral\nN\nmesh of N\ni }i=1 , we approximate\nP nodes and nodal basis {ψP\nϕ (r) i Φ ,i ψi (r) and qx (r) i (Qx )i ψi (r), which\ntransforms the continuous-form equations into a linear system\nfor excitation and emission photon pr", "(c) κ\n\nB. Finite Element Discretization and System Matrix Construction\nWe apply the finite element method (FEM) [35] to the\ndiffusion model (1) - (4). Discretizing with a tetrahedral\nN\nmesh of N\ni }i=1 , we approximate\nP nodes and nodal basis {ψP\nϕ (r) i Φ ,i ψi (r) and qx (r) i (Qx )i ψi (r), which\ntransforms the continuous-form equations into a linear system\nfor excitation and emission photon propagation:\nS Φx = Qx\n\n(5)\n\nS Φm = Qm\n\n(6)\n\nwhere S RN N is the system matrix and Φ , Q RN\nare discretized form (coefficient vectors) for ϕ and q , respectively. In particular, the excitation field ϕx interacts with\nfluorophores C RN to produce the emission source term\nQm = C Φx\n\n(7)\n\nwith denoting element-wise multiplication. The equation\n(7) physically describes how fluorophores absorb excitation", "opagation:\nS Φx = Qx\n\n(5)\n\nS Φm = Qm\n\n(6)\n\nwhere S RN N is the system matrix and Φ , Q RN\nare discretized form (coefficient vectors) for ϕ and q , respectively. In particular, the excitation field ϕx interacts with\nfluorophores C RN to produce the emission source term\nQm = C Φx\n\n(7)\n\nwith denoting element-wise multiplication. The equation\n(7) physically describes how fluorophores absorb excitation\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nexplicitly reveals the functional dependence of S on the\noptical parameters a and s , which forms the mathematical\nfoundation for our adaptive optimization approach introduced\nin Subsection II-C.\n\n(b)\n\n(a)\n\n3\n\nCamera\nFilter Wheel\nReal Measurement\nSample\n\nC. INR-based FMT reconstru", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nexplicitly reveals the functional dependence of S on the\noptical parameters a and s , which forms the mathematical\nfoundation for our adaptive optimization approach introduced\nin Subsection II-C.\n\n(b)\n\n(a)\n\n3\n\nCamera\nFilter Wheel\nReal Measurement\nSample\n\nC. INR-based FMT reconstruction: NeuFMT / NeuFMT\nScanners\n\nLaser\nPredicted\nMeasurement\n\nFocal Lens OD Filter\n(c)\n\n(d)\n\nAdaption Module\n\nForward Model\nBased on DE\n\nAbsorption Term\nHigh Absorption\n\nLow Absorption\n\ninv\nDi usion Term\n\nHigh Scattering\n\nSti ness Matrix\n\nLow Scattering\nBoundary Term\n\n(e)\n\nForward Data\nBackward Gradient\n\nFluorescence Distribution Encoded with INR\nNode Coordinate\n\n3D Mesh with\n\nNodes\n\nsine\n\ncosine", "ction: NeuFMT / NeuFMT\nScanners\n\nLaser\nPredicted\nMeasurement\n\nFocal Lens OD Filter\n(c)\n\n(d)\n\nAdaption Module\n\nForward Model\nBased on DE\n\nAbsorption Term\nHigh Absorption\n\nLow Absorption\n\ninv\nDi usion Term\n\nHigh Scattering\n\nSti ness Matrix\n\nLow Scattering\nBoundary Term\n\n(e)\n\nForward Data\nBackward Gradient\n\nFluorescence Distribution Encoded with INR\nNode Coordinate\n\n3D Mesh with\n\nNodes\n\nsine\n\ncosine\n\nPositional\nEncoding\n\nMLP\n\nFig. 1. Conceptual illustration of NeuFMT. (a) The FMT setup: a scanned\nlaser illuminates the sample while a CMOS camera with filter wheel on the\nopposite side records boundary images. The raster scanning method yields\nthe raw 2D image stack M real , serving as the input to the subsequent FMT\nreconstruction. (b) The difference between M real and the simulated meac( a , ,", "Positional\nEncoding\n\nMLP\n\nFig. 1. Conceptual illustration of NeuFMT. (a) The FMT setup: a scanned\nlaser illuminates the sample while a CMOS camera with filter wheel on the\nopposite side records boundary images. The raster scanning method yields\nthe raw 2D image stack M real , serving as the input to the subsequent FMT\nreconstruction. (b) The difference between M real and the simulated meac( a , , Cθ ) is iteratively minimized until an optimized value\nsurement M\ns\nof unknown fluorescence distribution C is found. R(C) is a regularization\nterm and { a , s } is the intrinsic optical properties consisting of\nabsorption coefficient a and scattering coefficient s . (c) A -adaption\nmodule is integrated into the FMT reconstruction. The stiffness matrix S is\ndetermined by both a and s . (d) The FEM", "Cθ ) is iteratively minimized until an optimized value\nsurement M\ns\nof unknown fluorescence distribution C is found. R(C) is a regularization\nterm and { a , s } is the intrinsic optical properties consisting of\nabsorption coefficient a and scattering coefficient s . (c) A -adaption\nmodule is integrated into the FMT reconstruction. The stiffness matrix S is\ndetermined by both a and s . (d) The FEM-based simulator predicts virtual\nc( a , , Cθ ) based on the operator S 1 ( ) and predicted\nmeasurement M\ns\nfluorescence distribution C. (e) Fluorescence distribution encoded in an INR.\n3D node coordinate serves as input, while a continuous C map is generated\nthrough positional encoding and an MLP network.\n\nUnlike traditional voxel-based or mesh-dependent representations, INR provides a continuous", "-based simulator predicts virtual\nc( a , , Cθ ) based on the operator S 1 ( ) and predicted\nmeasurement M\ns\nfluorescence distribution C. (e) Fluorescence distribution encoded in an INR.\n3D node coordinate serves as input, while a continuous C map is generated\nthrough positional encoding and an MLP network.\n\nUnlike traditional voxel-based or mesh-dependent representations, INR provides a continuous, memory-efficient framework for modeling complex physical fields. The basic variant,\nNeuFMT, learns only the fluorophore Cθ with fixed optical\nproperties; the proposed adaptive NeuFMT jointly optimizes\nthe optical coefficients ( a , s ) with Cθ for enhancing the\nreconstruction accuracy and robustness. In this section, we\ndescribe the NeuFMT representation, formulate the learning\nobjective, introd", ", memory-efficient framework for modeling complex physical fields. The basic variant,\nNeuFMT, learns only the fluorophore Cθ with fixed optical\nproperties; the proposed adaptive NeuFMT jointly optimizes\nthe optical coefficients ( a , s ) with Cθ for enhancing the\nreconstruction accuracy and robustness. In this section, we\ndescribe the NeuFMT representation, formulate the learning\nobjective, introduce optical-property adaptation, and summarize the network architecture and implementation.\n1) INR representation of the unknown fluorescence: Our\n NeuFMT model the 3D fluorescence field as an INR, i.e., a\ncoordinate-conditioned MLP:\n\nCθ (r) = fθ Γ (r) ,\n(10)\nwhere r = (x, y, z) R3 , Γ : Rd is a highdimensional positional encoding of spatial coordinates, and\nfθ : Rd R is an MLP with parameters θ.", "uce optical-property adaptation, and summarize the network architecture and implementation.\n1) INR representation of the unknown fluorescence: Our\n NeuFMT model the 3D fluorescence field as an INR, i.e., a\ncoordinate-conditioned MLP:\n\nCθ (r) = fθ Γ (r) ,\n(10)\nwhere r = (x, y, z) R3 , Γ : Rd is a highdimensional positional encoding of spatial coordinates, and\nfθ : Rd R is an MLP with parameters θ. This INR formulation (10) enables resolution-independent reconstruction and\nnaturally accommodates arbitrary spatial queries without being\nconstrained by the conventional discrete grid structure.\nTo enhance the network s ability to represent high-frequency\ndetails, which is crucial for resolving complex in vivo fluorescence patterns, we apply a sinusoidal positional encoding to\neach coordinate com", "This INR formulation (10) enables resolution-independent reconstruction and\nnaturally accommodates arbitrary spatial queries without being\nconstrained by the conventional discrete grid structure.\nTo enhance the network s ability to represent high-frequency\ndetails, which is crucial for resolving complex in vivo fluorescence patterns, we apply a sinusoidal positional encoding to\neach coordinate component. Let γ : R R2L be\nγ(p) = sin(20 πp), cos(20 πp), ,\nL 1\n\nsin(2\n\nπp), cos(2\n\nL 1\n\n(11)\n\nπp) ,\n\np {x, y, z},\n\nphotons and re-emit light at longer wavelengths. The emission\nsource Qm then propagates through the same medium to\nproduce the emission photon density Φm , which is finally\ndetected at the boundary, which is computed as\n\nwhere L is the number of frequency bands. The\n 3D position\nis the", "ponent. Let γ : R R2L be\nγ(p) = sin(20 πp), cos(20 πp), ,\nL 1\n\nsin(2\n\nπp), cos(2\n\nL 1\n\n(11)\n\nπp) ,\n\np {x, y, z},\n\nphotons and re-emit light at longer wavelengths. The emission\nsource Qm then propagates through the same medium to\nproduce the emission photon density Φm , which is finally\ndetected at the boundary, which is computed as\n\nwhere L is the number of frequency bands. The\n 3D position\nis then encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that\nd = 6L. Feeding Γ (r) into fθ enables compact representation\nof both low- and high-frequency variations in Cθ .\n2) Learning objective: We estimate the fluorescence field\nCθ and, in NeuFMT, the optical properties { a , s } by\nminimizing a data-fidelity term plus regularization:\n\nM = P Φm\n\nc( a , , Cθ ) M real 2 + λ R(Cθ ), (12)\nL( a , s , θ) = M\ns", "n encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that\nd = 6L. Feeding Γ (r) into fθ enables compact representation\nof both low- and high-frequency variations in Cθ .\n2) Learning objective: We estimate the fluorescence field\nCθ and, in NeuFMT, the optical properties { a , s } by\nminimizing a data-fidelity term plus regularization:\n\nM = P Φm\n\nc( a , , Cθ ) M real 2 + λ R(Cθ ), (12)\nL( a , s , θ) = M\ns\n2\n\n(8)\n\nwhere P represents the transfer function, which maps the\nboundary photon density Φm the measurement data M acquired by the camera. The above linearized forward model\nprovides the physical foundation for the inversion procedure.\nCrucially, the SPD FEM stiffness matrix S( a , s ) \nN N\nR\nin (5) (6) encode the optical properties and boundary\ngeometry, generating from a linear combination of m", "2\n\n(8)\n\nwhere P represents the transfer function, which maps the\nboundary photon density Φm the measurement data M acquired by the camera. The above linearized forward model\nprovides the physical foundation for the inversion procedure.\nCrucially, the SPD FEM stiffness matrix S( a , s ) \nN N\nR\nin (5) (6) encode the optical properties and boundary\ngeometry, generating from a linear combination of matrices\ncorresponding to distinct physical components [33], [36]\n\n1\n\n Sd + Sb . (9)\nS( a , s ) = c a Sa +\n3( a + s )\nwith Sa , Sd , and Sb the assembled absorption, diffusion, and\nRobin-boundary matrices, respectively. This decomposition\n\nc denotes the boundary measurements, and R(Cθ ) is\nwhere M\na regularization term applied to the fluorescence distribution.\nThe hyperparameter λ controls the regu", "atrices\ncorresponding to distinct physical components [33], [36]\n\n1\n\n Sd + Sb . (9)\nS( a , s ) = c a Sa +\n3( a + s )\nwith Sa , Sd , and Sb the assembled absorption, diffusion, and\nRobin-boundary matrices, respectively. This decomposition\n\nc denotes the boundary measurements, and R(Cθ ) is\nwhere M\na regularization term applied to the fluorescence distribution.\nThe hyperparameter λ controls the regularization strength,\nbalancing data fidelity with sparsity constraints. The training of\n NeuFMT / NeuFMT follows a fully self-supervised paradigm\nthat explicitly integrates the DE-based physical model into\nthe optimization loop. Note that NeuFMT uses fixed optical\nparameters ( a , s ), whereas NeuFMT updates jointly.\n3) Alternating optical-property adaptation: A fundamental\ninnovation of NeuFMT li", "larization strength,\nbalancing data fidelity with sparsity constraints. The training of\n NeuFMT / NeuFMT follows a fully self-supervised paradigm\nthat explicitly integrates the DE-based physical model into\nthe optimization loop. Note that NeuFMT uses fixed optical\nparameters ( a , s ), whereas NeuFMT updates jointly.\n3) Alternating optical-property adaptation: A fundamental\ninnovation of NeuFMT lies in formulating the entire photon propagation process from excitation to emission as an\nend-to-end differentiable map. The forward model follows a\n\n4\n\nPREPRINT VERSION 2025\n\nprecise physical sequence from excitation source to surface\nmeasurements, as described in Subsection II-B:\n\nc( a , s , Cθ ) = P S( a , s ) 1 Cθ S( a , s ) 1 Qx ,\nM\n(13)\nWe optimize the introduced objective L( a , s , θ) in (", "es in formulating the entire photon propagation process from excitation to emission as an\nend-to-end differentiable map. The forward model follows a\n\n4\n\nPREPRINT VERSION 2025\n\nprecise physical sequence from excitation source to surface\nmeasurements, as described in Subsection II-B:\n\nc( a , s , Cθ ) = P S( a , s ) 1 Cθ S( a , s ) 1 Qx ,\nM\n(13)\nWe optimize the introduced objective L( a , s , θ) in (12),\njointly updating network parameters θ and optical coefficients\n( a , s ). The chain in (13) contains only differentiable operations, including linear solves, elementwise products, and linear\nc is differentiable w.r.t. both Cθ (hence θ)\nprojections. Thus M\n\nand ( a , s ), enabling standard gradient-based training. For\ncompleteness, we state the chain-rule decomposition of the\nloss gradient wit", "12),\njointly updating network parameters θ and optical coefficients\n( a , s ). The chain in (13) contains only differentiable operations, including linear solves, elementwise products, and linear\nc is differentiable w.r.t. both Cθ (hence θ)\nprojections. Thus M\n\nand ( a , s ), enabling standard gradient-based training. For\ncompleteness, we state the chain-rule decomposition of the\nloss gradient with respect to ( a , s ). Based on (13), the\ngradient splits into an emission term and an excitation term:\n\nc \n S\n L M\n L\n S 1\n=\nΦm +\nc Φm\n\n{z\n}\n| M\nEmission pathway\n\nc Φm Qm \n L M\n S\nΦx\n S 1\nc Φm Qm Φx\n\n| M\n{z\n}\n\n(14)\n\nExcitation pathway\n\n { a , s }.\nThe only model-specific ingredient of a and s is the\nJacobian of S( a , s ). According to (9), the partial derivatives\nare\n\n S\n1\n= c Sa \nSd ,\n a\n3( a", "h respect to ( a , s ). Based on (13), the\ngradient splits into an emission term and an excitation term:\n\nc \n S\n L M\n L\n S 1\n=\nΦm +\nc Φm\n\n{z\n}\n| M\nEmission pathway\n\nc Φm Qm \n L M\n S\nΦx\n S 1\nc Φm Qm Φx\n\n| M\n{z\n}\n\n(14)\n\nExcitation pathway\n\n { a , s }.\nThe only model-specific ingredient of a and s is the\nJacobian of S( a , s ). According to (9), the partial derivatives\nare\n\n S\n1\n= c Sa \nSd ,\n a\n3( a + s )2\n\n S\n1\n=c \nSd .\n(15)\n s\n3( a + s )2\nThis allows a and s to be optimized directly using gradient\ndescent, and then be updated together with θ, bridging the\nlearning process with the underlying physical model.\nTo mitigate potential coupling effects between a and s\nduring optimization, we propose an alternating update strategy,\nwhich periodically updates one optical parameter with the\nother fix", "+ s )2\n\n S\n1\n=c \nSd .\n(15)\n s\n3( a + s )2\nThis allows a and s to be optimized directly using gradient\ndescent, and then be updated together with θ, bridging the\nlearning process with the underlying physical model.\nTo mitigate potential coupling effects between a and s\nduring optimization, we propose an alternating update strategy,\nwhich periodically updates one optical parameter with the\nother fixed. The alternating framework largely promotes training stability to avoid oscillations with sufficient computational\nefficiency. The complete NeuFMT algorithm is described in\nAlgorithm 1. Overall, the alternating -adaption module ensures that each optical parameter receives dedicated optimization attention while maintaining the physical consistency of\nthe forward model, yielding more accurate FMT", "ed. The alternating framework largely promotes training stability to avoid oscillations with sufficient computational\nefficiency. The complete NeuFMT algorithm is described in\nAlgorithm 1. Overall, the alternating -adaption module ensures that each optical parameter receives dedicated optimization attention while maintaining the physical consistency of\nthe forward model, yielding more accurate FMT reconstruction\nresults even in the presence of mismatch between the initial\nguess and ground truth of the optical properties.\n4) Network architecture and implementation: We adopt\nMLP for the NeuFMT / NeuFMT, comprising 8 fullyconnected layers with 512 hidden units each, followed by\na final layer with 128 units. ReLU activation functions are\nemployed throughout the network. A critical skip connect", "reconstruction\nresults even in the presence of mismatch between the initial\nguess and ground truth of the optical properties.\n4) Network architecture and implementation: We adopt\nMLP for the NeuFMT / NeuFMT, comprising 8 fullyconnected layers with 512 hidden units each, followed by\na final layer with 128 units. ReLU activation functions are\nemployed throughout the network. A critical skip connection\nbridges the input Γ (r) to the 4th hidden layer, facilitating\ngradient flow and enhancing the ability to learn fine-grained\ndetails. This architectural choice is particularly suited for FMT\napplications where accurately reconstructing high-contrast targets against complex backgrounds is essential.\nWe implement the NeuFMT / NeuFMT framework with\nPyTorch, leveraging its automatic differentiation", "ion\nbridges the input Γ (r) to the 4th hidden layer, facilitating\ngradient flow and enhancing the ability to learn fine-grained\ndetails. This architectural choice is particularly suited for FMT\napplications where accurately reconstructing high-contrast targets against complex backgrounds is essential.\nWe implement the NeuFMT / NeuFMT framework with\nPyTorch, leveraging its automatic differentiation capability to\n\ncompute the gradient through both MLP and the physical\nmodel. Adam optimizer is used with the initial learning rates\nof 10 4 for θ update, 10 3 for scattering coefficient and\n10 5 for absorption coefficient. To improve the computational\nefficiency, a learning rate decay is applied for MLP update.\nThese rates are determined empirically to ensure stable convergence. The L1 regulariza", "capability to\n\ncompute the gradient through both MLP and the physical\nmodel. Adam optimizer is used with the initial learning rates\nof 10 4 for θ update, 10 3 for scattering coefficient and\n10 5 for absorption coefficient. To improve the computational\nefficiency, a learning rate decay is applied for MLP update.\nThese rates are determined empirically to ensure stable convergence. The L1 regularization parameter λ is set to 10 6\nbased on cross validation. The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality,\nwith the entire process completing within 3 30 minutes on\na single NVIDIA RTX 3090 GPU for problems of varying\nscales. The FEM discretization is built on TOAST++ toolkit\n[37], and the FMT simulation is based on a modular software\nplatform S", "tion parameter λ is set to 10 6\nbased on cross validation. The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality,\nwith the entire process completing within 3 30 minutes on\na single NVIDIA RTX 3090 GPU for problems of varying\nscales. The FEM discretization is built on TOAST++ toolkit\n[37], and the FMT simulation is based on a modular software\nplatform STIFT [38] in MATLAB (R2024b, MathWorks, MA,\nUS) using a desktop computer (Intel Core i5-12600 CPU @\n3.30 GHz, 128 GB RAM).\nAlgorithm 1 NeuFMT\nRequire: Real measurements M real , light speed c, stepsizes\nαθ , αa , αs , alternation period T , total iterations K\n1: Initialize θ, a , s ;\n2: Precompute Sa , Sd , Sb , Qx , P\n3: Compute S via (9);\n4: for i = 1 to K do \n5:\nC = fθ Γ (r)\n6:\nSolve Φx RN sati", "TIFT [38] in MATLAB (R2024b, MathWorks, MA,\nUS) using a desktop computer (Intel Core i5-12600 CPU @\n3.30 GHz, 128 GB RAM).\nAlgorithm 1 NeuFMT\nRequire: Real measurements M real , light speed c, stepsizes\nαθ , αa , αs , alternation period T , total iterations K\n1: Initialize θ, a , s ;\n2: Precompute Sa , Sd , Sb , Qx , P\n3: Compute S via (9);\n4: for i = 1 to K do \n5:\nC = fθ Γ (r)\n6:\nSolve Φx RN satisfying S Φx = Qx\n7:\nQm = C Φx\n8:\nSolve Φm RN satisfying S Φm = Qm\nc = P Φm\n9:\nCompute predicted measurements: M\nreal 2\nc\n10:\nCompute loss: L = M M 2 + R(C)\n11:\nUpdate MLP parameters: θ = θ αθ L\n θ\n12:\nif i mod\n T = 0 then\n13:\nif i/T is even then\n L\n14:\nUpdate absorption: a = a αa \na\n15:\nelse\n L\n16:\nUpdate diffusion: s = s αs \n\ns\n17:\nend if\n\n1\n18:\nUpdate S = c a Sa +\nS\n+\nS\nd\nb ;\n3( a + s )\n19:\nend", "sfying S Φx = Qx\n7:\nQm = C Φx\n8:\nSolve Φm RN satisfying S Φm = Qm\nc = P Φm\n9:\nCompute predicted measurements: M\nreal 2\nc\n10:\nCompute loss: L = M M 2 + R(C)\n11:\nUpdate MLP parameters: θ = θ αθ L\n θ\n12:\nif i mod\n T = 0 then\n13:\nif i/T is even then\n L\n14:\nUpdate absorption: a = a αa \na\n15:\nelse\n L\n16:\nUpdate diffusion: s = s αs \n\ns\n17:\nend if\n\n1\n18:\nUpdate S = c a Sa +\nS\n+\nS\nd\nb ;\n3( a + s )\n19:\nend if\n20: end for\n21: Output: fluorescence C, optical parameters a , s\n\nD. FMT System Setup\nWe devised a continuous-wave (CW) FMT system\n(SHMOT) [39], [40] as depicted in Fig. 1 (a), which incorporates a 16-bit CMOS camera (Edge 4.2, PCO, Germany) with\n2048 2048 pixel resolution and a filter wheel (FW102C,\nThorlabs, NJ, US) for selective wavelength detection. A\ntunable laser source (SuperK EXTREME, N", "if\n20: end for\n21: Output: fluorescence C, optical parameters a , s\n\nD. FMT System Setup\nWe devised a continuous-wave (CW) FMT system\n(SHMOT) [39], [40] as depicted in Fig. 1 (a), which incorporates a 16-bit CMOS camera (Edge 4.2, PCO, Germany) with\n2048 2048 pixel resolution and a filter wheel (FW102C,\nThorlabs, NJ, US) for selective wavelength detection. A\ntunable laser source (SuperK EXTREME, NKT, Denmark),\nspanning 400-890 nm, provides fluorescence excitation with a\npower density of approximately 2 mW/mm2 at the sample\nplane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube, Germany) mounted aside steers\nthe laser beam to raster-scan either the top or bottom object\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERT", "KT, Denmark),\nspanning 400-890 nm, provides fluorescence excitation with a\npower density of approximately 2 mW/mm2 at the sample\nplane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube, Germany) mounted aside steers\nthe laser beam to raster-scan either the top or bottom object\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nsurface, enabling switchable reflection-/transmission-mode detection. During experiments, the camera exposure time was\nfixed at 500 ms, with pixel binning applied to improve the\nsignal-to-noise ratio. The acquired raw 2D image data serve\nas supervision target for NeuFMT / NeuFMT reconstruction\n(Fig. 1 (b)). It worth m", "Y-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nsurface, enabling switchable reflection-/transmission-mode detection. During experiments, the camera exposure time was\nfixed at 500 ms, with pixel binning applied to improve the\nsignal-to-noise ratio. The acquired raw 2D image data serve\nas supervision target for NeuFMT / NeuFMT reconstruction\n(Fig. 1 (b)). It worth mentioning that our FMT system also\nintegrates a programmable line-scanning illumination, which\nenables high-precision extraction of the surface geometry\nwith approximated maximum error of 0.1 mm. The extracted\nsurface information is then leveraged as prior knowledge for\nFEM meshing and improving reconstruction accuracy.\n\nE. Phantom preparation and optical calibration\nIn our validation, the slab ph", "entioning that our FMT system also\nintegrates a programmable line-scanning illumination, which\nenables high-precision extraction of the surface geometry\nwith approximated maximum error of 0.1 mm. The extracted\nsurface information is then leveraged as prior knowledge for\nFEM meshing and improving reconstruction accuracy.\n\nE. Phantom preparation and optical calibration\nIn our validation, the slab phantomswere cast from silicone (SYLGARDTM 184; DOW, CA, USA) to emulate softtissue matrix. Optical properties were tuned by dispersing\ntitanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon\nblack powder (Colins, Shanghai, China) as scattering and\nabsorbing additives, respectively. In all phantoms, TiO2 and\ncarbon black were uniformly distributed. All the designs\nshown in Fig. 4 (a) used the s", "antomswere cast from silicone (SYLGARDTM 184; DOW, CA, USA) to emulate softtissue matrix. Optical properties were tuned by dispersing\ntitanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon\nblack powder (Colins, Shanghai, China) as scattering and\nabsorbing additives, respectively. In all phantoms, TiO2 and\ncarbon black were uniformly distributed. All the designs\nshown in Fig. 4 (a) used the same TiO2 /carbon-black mixing\nratio, yielding isotropic media with identical absorption and\nscattering parameters.\n\nF. In Vivo Lymph Node FMT Imaging\nFollowing numerical simulations and phantom experiments,\nwe evaluated the proposed method in vivo in a murine lymph\nnode imaging task. In cancer diagnostics, lymph node metastasis is a key prognostic indicator of tumor progression. Fluorescence imagi", "ame TiO2 /carbon-black mixing\nratio, yielding isotropic media with identical absorption and\nscattering parameters.\n\nF. In Vivo Lymph Node FMT Imaging\nFollowing numerical simulations and phantom experiments,\nwe evaluated the proposed method in vivo in a murine lymph\nnode imaging task. In cancer diagnostics, lymph node metastasis is a key prognostic indicator of tumor progression. Fluorescence imaging enables rapid screening of sentinel lymph\nnodes [41].\nIn our experiment, all animal procedures were approved by\nthe Institutional Animal Care and Use Committee of ShanghaiTech University (Approval No. 20211115001). 5 female\nBALB/c mice (8 weeks old) were obtained from Shanghai\nJihui Laboratory Animal Breeding Co. Ltd. and housed under\na circadian rhythm of 12 hours of day and night alternation.", "ng enables rapid screening of sentinel lymph\nnodes [41].\nIn our experiment, all animal procedures were approved by\nthe Institutional Animal Care and Use Committee of ShanghaiTech University (Approval No. 20211115001). 5 female\nBALB/c mice (8 weeks old) were obtained from Shanghai\nJihui Laboratory Animal Breeding Co. Ltd. and housed under\na circadian rhythm of 12 hours of day and night alternation.\nBefore taking imaging experiments, fur was removed over the\nwhole body. For FMT reconstruction, we assumed an optically\nhomogeneous medium with properties calibrated during the\nexcitation step with ( a = 0.0055 mm 1 , s = 1.1 mm 1 ).\nWe followed a three-stage protocol fluorescent-dye injection, imaging, and ex vivo validation. Prior to FMT imaging, Cy5-saline solution (1.2146 mol mL 1 , 40 L) was", "Before taking imaging experiments, fur was removed over the\nwhole body. For FMT reconstruction, we assumed an optically\nhomogeneous medium with properties calibrated during the\nexcitation step with ( a = 0.0055 mm 1 , s = 1.1 mm 1 ).\nWe followed a three-stage protocol fluorescent-dye injection, imaging, and ex vivo validation. Prior to FMT imaging, Cy5-saline solution (1.2146 mol mL 1 , 40 L) was injected subcutaneously into the left forepaw to drive lymphatic\ndrainage toward the sentinel lymph nodes and create a highintensity target. Next, follow-up FMT measurements were\nacquired using the system setup in Subsection II-D. Finally,\nafter data collection, ex vivo verification was performed using\na fluorescent stereoscopic microscope (MVX10, Olympus,\nJapan; 6.3 objective). Illumination was", "injected subcutaneously into the left forepaw to drive lymphatic\ndrainage toward the sentinel lymph nodes and create a highintensity target. Next, follow-up FMT measurements were\nacquired using the system setup in Subsection II-D. Finally,\nafter data collection, ex vivo verification was performed using\na fluorescent stereoscopic microscope (MVX10, Olympus,\nJapan; 6.3 objective). Illumination was provided by a heightadjustable 630 nm LED at 20 mW cm 2 . White-light and\nCy5-channel fluorescence images were recorded using filters\nmatched to the Cy5 spectrum, and the lymph nodes were\nidentified, excised, and imaged to validate the in vivo findings.\n\n5\n\nIII. R ESULTS\nA. Convergence Verification of Optical Property Adaptive\nOptimization\nTo validate our proposed optical property adaptation mecha", "provided by a heightadjustable 630 nm LED at 20 mW cm 2 . White-light and\nCy5-channel fluorescence images were recorded using filters\nmatched to the Cy5 spectrum, and the lymph nodes were\nidentified, excised, and imaged to validate the in vivo findings.\n\n5\n\nIII. R ESULTS\nA. Convergence Verification of Optical Property Adaptive\nOptimization\nTo validate our proposed optical property adaptation mechanism, we conducted a series of numerical experiments on\na digital phantom. The primary objective was to demonstrate\nthat the -adaption module can robustly recover absorption a\nand s coefficients from severely erroneous initial estimates,\nthereby enabling high-fidelity fluorescence reconstruction.\nWe constructed a homogeneous digital slab phantom of size\n55 55 15 mm3 featuring an S -shaped fluoresc", "nism, we conducted a series of numerical experiments on\na digital phantom. The primary objective was to demonstrate\nthat the -adaption module can robustly recover absorption a\nand s coefficients from severely erroneous initial estimates,\nthereby enabling high-fidelity fluorescence reconstruction.\nWe constructed a homogeneous digital slab phantom of size\n55 55 15 mm3 featuring an S -shaped fluorescent target at\nits geometric center. The ground-truth optical properties were\n 1\nset to true\nand s true = 1.0 mm 1 . To rigorously\na = 0.1 mm\ntest the correction capability, we initialized the reconstruction\nwith significantly mismatched scattering coefficients ( s init =\n0.5, 1.5, 2.0 mm 1 ) while keeping the absorption coefficient\nfixed at its true value for this specific test.\nAs summarized in F", "ent target at\nits geometric center. The ground-truth optical properties were\n 1\nset to true\nand s true = 1.0 mm 1 . To rigorously\na = 0.1 mm\ntest the correction capability, we initialized the reconstruction\nwith significantly mismatched scattering coefficients ( s init =\n0.5, 1.5, 2.0 mm 1 ) while keeping the absorption coefficient\nfixed at its true value for this specific test.\nAs summarized in Fig. 2 (a), without the -adaption module, the reconstructed fluorescence distributions suffered from\nsubstantial errors in both depth localization and morphological accuracy. The mismatched s value led to an incorrect\nmodel of photon propagation, which directly translated to\ndistorted reconstructions. In contrast, when the -adaption\nmodule was enabled, the proposed NeuFMT successfully\nrecovered flu", "ig. 2 (a), without the -adaption module, the reconstructed fluorescence distributions suffered from\nsubstantial errors in both depth localization and morphological accuracy. The mismatched s value led to an incorrect\nmodel of photon propagation, which directly translated to\ndistorted reconstructions. In contrast, when the -adaption\nmodule was enabled, the proposed NeuFMT successfully\nrecovered fluorescence distributions that closely matched the\nground truth obtained with the correct optical properties.\nCrucially, the evolution of the scattering coefficient during\noptimization, plotted in Fig. 2 (b), demonstrates the module s\nrobust convergence. Regardless of the initial value whether\nhalved or doubled the estimated s reliably converged to the\nneighborhood of the true value (1.0 mm 1 ).\nA s", "orescence distributions that closely matched the\nground truth obtained with the correct optical properties.\nCrucially, the evolution of the scattering coefficient during\noptimization, plotted in Fig. 2 (b), demonstrates the module s\nrobust convergence. Regardless of the initial value whether\nhalved or doubled the estimated s reliably converged to the\nneighborhood of the true value (1.0 mm 1 ).\nA similar convergence behavior was observed for the absorption coefficient a . When initialized with biased values\n 1\n( init\n) against a fixed true s , the a = 0.05, 0.15, 0.2 mm\nadaption module corrected a with an average error of only\n1.5% (Fig. 2 (d)), and its convergence curves are shown in\nFig. 2 (e). This convergence robustness was maintained across\na range of true a and s values, confirming th", "imilar convergence behavior was observed for the absorption coefficient a . When initialized with biased values\n 1\n( init\n) against a fixed true s , the a = 0.05, 0.15, 0.2 mm\nadaption module corrected a with an average error of only\n1.5% (Fig. 2 (d)), and its convergence curves are shown in\nFig. 2 (e). This convergence robustness was maintained across\na range of true a and s values, confirming the general\nefficacy of our alternating optimization strategy in mitigating\nparameter coupling (Fig. 2 (c), (f)).\nWe further extended the validation to the most challenging\nscenario, where both optical parameters were simultaneously\ninitialized with substantial errors. In this experiment, the initial\nvalues for both a and s were set to 50% higher than\ntheir GT values. Remarkably, even under these hi", "e general\nefficacy of our alternating optimization strategy in mitigating\nparameter coupling (Fig. 2 (c), (f)).\nWe further extended the validation to the most challenging\nscenario, where both optical parameters were simultaneously\ninitialized with substantial errors. In this experiment, the initial\nvalues for both a and s were set to 50% higher than\ntheir GT values. Remarkably, even under these highly adverse\nconditions, the -adaption module successfully drove both\nparameters towards their true values. The convergence trajectories remained stable and ultimately reached a neighborhood\nof the true parameter pair. These results collectively verify\nthat the integrated -adaption module empowers NeuFMT\nto jointly recover accurate optical properties and fluorescence\ndistributions even from profou", "ghly adverse\nconditions, the -adaption module successfully drove both\nparameters towards their true values. The convergence trajectories remained stable and ultimately reached a neighborhood\nof the true parameter pair. These results collectively verify\nthat the integrated -adaption module empowers NeuFMT\nto jointly recover accurate optical properties and fluorescence\ndistributions even from profoundly inaccurate initial guesses,\neffectively addressing a critical source of ill-posedness in\npractical FMT scenarios.\n\n6\n\nPREPRINT VERSION 2025\n\n0.995\n\n1.0\n\n0.996\n\n1.5\n\n1.007\n\n2.0\n\n1.006\n\nGT\ny\nx\n\nDICE =\n0.0257\n\n0.7337\n\n0.4660\n\nNorm.int (a.u.)\n\n= 1.0\n= 0.1\n\nNon-Adaptive\n\n1\n\n0.3967\n\n(b)\n\n1.2\n1.0\n\n(c)\n\n1.6\n\nAdaptive\n\ny\n\n0.7198\n\n0.7230\n\n0.6964\n\nNorm.int (a.u.)\n\nz\n\n0.7796\n\n 0.9\n 0.8\n 0.5\nAsym.\nLine\n\n0", "ndly inaccurate initial guesses,\neffectively addressing a critical source of ill-posedness in\npractical FMT scenarios.\n\n6\n\nPREPRINT VERSION 2025\n\n0.995\n\n1.0\n\n0.996\n\n1.5\n\n1.007\n\n2.0\n\n1.006\n\nGT\ny\nx\n\nDICE =\n0.0257\n\n0.7337\n\n0.4660\n\nNorm.int (a.u.)\n\n= 1.0\n= 0.1\n\nNon-Adaptive\n\n1\n\n0.3967\n\n(b)\n\n1.2\n1.0\n\n(c)\n\n1.6\n\nAdaptive\n\ny\n\n0.7198\n\n0.7230\n\n0.6964\n\nNorm.int (a.u.)\n\nz\n\n0.7796\n\n 0.9\n 0.8\n 0.5\nAsym.\nLine\n\n0.8\n0.4\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n14\n\n 0.12\n 0.11\n\n1.4\n\nPredicted\n\nz=8\n\n 2.0\n 1.5\n 1.2\n 1.1\n\n1.6\n\n0\n1\n\n2.0\n\nPredicted\n\n0.5\n\n(a)\n\n 0.10\n 0.09\n\n1.2\n\n 0.08\n1.0\n\n0\n\nAsym.\nLine\n1\n\n2\n\n4\n\n8\n\n16\n\n32\n\n64\n\niterations\n0.10\n\n0.100\n\n0.15\n\n0.101\n\n0.20\n\n0.102\n\ny\nx\n\n0.0281\n\n0.7337\n\n0.7390\n\nNorm.int (a.u.)\n\nGT\n\n0.5991\n\nz=8\nz\n\nAdaptive\n\ny\n\n0.6718\n\n0.7642\n\n0.8740\n\n0.8708\n\n(e)\n\n0.2\n\n= 1.0\n= 0.1\n\nGT\n\n 0.11\n 0.09\n\n0.12\n0.1\n0", ".8\n0.4\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n14\n\n 0.12\n 0.11\n\n1.4\n\nPredicted\n\nz=8\n\n 2.0\n 1.5\n 1.2\n 1.1\n\n1.6\n\n0\n1\n\n2.0\n\nPredicted\n\n0.5\n\n(a)\n\n 0.10\n 0.09\n\n1.2\n\n 0.08\n1.0\n\n0\n\nAsym.\nLine\n1\n\n2\n\n4\n\n8\n\n16\n\n32\n\n64\n\niterations\n0.10\n\n0.100\n\n0.15\n\n0.101\n\n0.20\n\n0.102\n\ny\nx\n\n0.0281\n\n0.7337\n\n0.7390\n\nNorm.int (a.u.)\n\nGT\n\n0.5991\n\nz=8\nz\n\nAdaptive\n\ny\n\n0.6718\n\n0.7642\n\n0.8740\n\n0.8708\n\n(e)\n\n0.2\n\n= 1.0\n= 0.1\n\nGT\n\n 0.11\n 0.09\n\n0.12\n0.1\n0.08\n\n0\n\n0.04\n\n1\n\n(f) 0.16\n0.14\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n 0.08\n 0.05\nAsym.\nLine\n\n14\n\n 1.2\n 1.1\n 1.0\n 0.9\n\n0.12\n\n 0.8\n0.1\n\n0\n\n(g)\n\n 0.20\n 0.15\n 0.12\n\n0.16\n\nNorm.int (a.u.)\n\n= 1.0\n= 0.1\n\nNon-Adaptive\n\n1\n\nPredicted\n\n(d)\n\n0.097\n\nPredicted\n\n0.05\n\nAsym.\nLine\n1\n\n2\n\n4\n\n8\n\n16\n\n32\n\n64\n\niterations\n2000 iters\n\n5000 iters\n\n10000 iters\n\n20000 iters\n1\n\ny\n\n(h)\n\n1.6\n\n0.16\n\n1.4\n\n0.14\n\n1.2\n\n0.12\n\n1.0\n\n0.1\n\n0.8125\n\n0.8651", ".08\n\n0\n\n0.04\n\n1\n\n(f) 0.16\n0.14\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n 0.08\n 0.05\nAsym.\nLine\n\n14\n\n 1.2\n 1.1\n 1.0\n 0.9\n\n0.12\n\n 0.8\n0.1\n\n0\n\n(g)\n\n 0.20\n 0.15\n 0.12\n\n0.16\n\nNorm.int (a.u.)\n\n= 1.0\n= 0.1\n\nNon-Adaptive\n\n1\n\nPredicted\n\n(d)\n\n0.097\n\nPredicted\n\n0.05\n\nAsym.\nLine\n1\n\n2\n\n4\n\n8\n\n16\n\n32\n\n64\n\niterations\n2000 iters\n\n5000 iters\n\n10000 iters\n\n20000 iters\n1\n\ny\n\n(h)\n\n1.6\n\n0.16\n\n1.4\n\n0.14\n\n1.2\n\n0.12\n\n1.0\n\n0.1\n\n0.8125\n\n0.8651\n\n0.8691\n\nz\ny\n\n= 1.5\n= 0.15\n\n1.333\n0.1332\n\n1.177\n0.1156\n\n1.050\n0.1045\n\n1.001\n0.0995\n\n0\n\n0.8\n\n2\n\n5\n\n8\n\n11\n\n14\n\n17\n\nPredicted\n\n0.6481\n\nNorm.int (a.u.)\n\nz=8\n\nPredicted\n\nx\n\n0.08\n20\n\niterations\n\nFig. 2. Ablation test for the optical-property-adaption ( -adaption) module in NeuFMT. (a-c) Effective test for the correction of s . (a) For a homogeneous\nphantom simulation with a S -shaped fluorescence inclu", "0.8691\n\nz\ny\n\n= 1.5\n= 0.15\n\n1.333\n0.1332\n\n1.177\n0.1156\n\n1.050\n0.1045\n\n1.001\n0.0995\n\n0\n\n0.8\n\n2\n\n5\n\n8\n\n11\n\n14\n\n17\n\nPredicted\n\n0.6481\n\nNorm.int (a.u.)\n\nz=8\n\nPredicted\n\nx\n\n0.08\n20\n\niterations\n\nFig. 2. Ablation test for the optical-property-adaption ( -adaption) module in NeuFMT. (a-c) Effective test for the correction of s . (a) For a homogeneous\nphantom simulation with a S -shaped fluorescence inclusion, the ground truth (GT) of a and s values are 0.1 mm-1 and 1.0 mm-1 respectively. A\nmismatched initial guess of s was assumed for FMT reconstruction. The -adaption module successfully corrects s with an average error of 0.55%,\nleading to significantly improved FMT reconstruction results compared to non-adaptive NeuFMT. (b) Convergence curve of s given more initial s values\nranging from 0.5 to", "sion, the ground truth (GT) of a and s values are 0.1 mm-1 and 1.0 mm-1 respectively. A\nmismatched initial guess of s was assumed for FMT reconstruction. The -adaption module successfully corrects s with an average error of 0.55%,\nleading to significantly improved FMT reconstruction results compared to non-adaptive NeuFMT. (b) Convergence curve of s given more initial s values\nranging from 0.5 to 2 GT value under the same setting of (a). (c) Convergence curve of s value across all cases with different a values, given\ninitial s = 1.5 mm-1 . (d-f) Effective test for the correction of the absorption coefficient ( a ). (d) For the same phantom in (a), a (mismatched) a initial\nvalue is assumed for FMT reconstruction. The -adaption module successfully corrects a with an average error of 1.5%, le", "2 GT value under the same setting of (a). (c) Convergence curve of s value across all cases with different a values, given\ninitial s = 1.5 mm-1 . (d-f) Effective test for the correction of the absorption coefficient ( a ). (d) For the same phantom in (a), a (mismatched) a initial\nvalue is assumed for FMT reconstruction. The -adaption module successfully corrects a with an average error of 1.5%, leading to significantly improved\nFMT reconstruction results. (e) Convergence curve of a given more initial a values ranging from 0.5 to 2 GT value under the same setting of (d).\n(f) Convergence curve of a value across all cases with different s values, given initial a = 0.15 mm-1 . (g-h) Effective test for the correction of both\nabsorption and diffusion coefficients. (g) For the same phantom in (a)", "ading to significantly improved\nFMT reconstruction results. (e) Convergence curve of a given more initial a values ranging from 0.5 to 2 GT value under the same setting of (d).\n(f) Convergence curve of a value across all cases with different s values, given initial a = 0.15 mm-1 . (g-h) Effective test for the correction of both\nabsorption and diffusion coefficients. (g) For the same phantom in (a), given mismatched initial a = 1.5 and s = 0.15, both of which are 50% higher than\nGT, the -adaption module successfully corrects both a and s at the same time. (h) Convergence curve given the iteration process in (g) for both optical\ncoefficients.\n\nB. Numerical Simulations\nTo comprehensively evaluate the performance of the proposed NeuFMT under controlled conditions, we designed\nfour distinct num", ", given mismatched initial a = 1.5 and s = 0.15, both of which are 50% higher than\nGT, the -adaption module successfully corrects both a and s at the same time. (h) Convergence curve given the iteration process in (g) for both optical\ncoefficients.\n\nB. Numerical Simulations\nTo comprehensively evaluate the performance of the proposed NeuFMT under controlled conditions, we designed\nfour distinct numerical phantoms (Fig. 3 (a) (d) respectively)\nto systematically increase the reconstruction challenge:\n Case 1 - single small target: a 3 mm-diameter spherical\nfluorescence target embedded in a homogeneous cuboid\nphantom (55 55 15 mm3 ), serving as a baseline\nfor evaluating localization and quantitative accuracy of\na simple, isolated inclusion.\n Case 2 - complex surface geometry: a 2 mm-diameter\ns", "erical phantoms (Fig. 3 (a) (d) respectively)\nto systematically increase the reconstruction challenge:\n Case 1 - single small target: a 3 mm-diameter spherical\nfluorescence target embedded in a homogeneous cuboid\nphantom (55 55 15 mm3 ), serving as a baseline\nfor evaluating localization and quantitative accuracy of\na simple, isolated inclusion.\n Case 2 - complex surface geometry: a 2 mm-diameter\nspherical target inside a phantom with a curved surface\ngeometry, featuring a spherical cap top (base: 50 50 4\nmm, cap height = 5 mm, total height = 9 mm). This\ncase tests the method s robustness to non-planar surface\ntopography.\n\nCase 3 - complex target shape: a large peanut-shaped fluorescence region with uniform concentration embedded in\na standard cuboid phantom same as Case 1. This scenario\nas", "pherical target inside a phantom with a curved surface\ngeometry, featuring a spherical cap top (base: 50 50 4\nmm, cap height = 5 mm, total height = 9 mm). This\ncase tests the method s robustness to non-planar surface\ntopography.\n\nCase 3 - complex target shape: a large peanut-shaped fluorescence region with uniform concentration embedded in\na standard cuboid phantom same as Case 1. This scenario\nassesses the capability to recover intricate morphological\ndetails beyond simple spheres.\n Case 4 - multi-target with background: the same peanutshaped region as in Case 3, but with the addition of\na small, high-concentration spherical target inside. This\nrepresents a highly realistic and challenging condition,\ntesting the ability to resolve targets of different concentrations and shapes against a n", "sesses the capability to recover intricate morphological\ndetails beyond simple spheres.\n Case 4 - multi-target with background: the same peanutshaped region as in Case 3, but with the addition of\na small, high-concentration spherical target inside. This\nrepresents a highly realistic and challenging condition,\ntesting the ability to resolve targets of different concentrations and shapes against a noisy background.\n\nThe ground-truth optical properties for all simulated measurements in this test were set to a = 0.1 mm 1 and s = 1.0\nmm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against\nfour established methods: conventional Tikhonov-regularized\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IM", "oisy background.\n\nThe ground-truth optical properties for all simulated measurements in this test were set to a = 0.1 mm 1 and s = 1.0\nmm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against\nfour established methods: conventional Tikhonov-regularized\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nGT\n\nL2-CG\n\nL1-FISTA\n\nU-Net\n\nNeuFMT\n\nμNeuFMT\n1\n\ny\nx\n\ny\n\nz\n\nDICE =\n0.6581\n\nz=8\n\n0.4956\n\n0.6446\n\nNorm.int (a.u.)\n\nCase 1\n\n(a)\n\n0.8800\n\n0.5128\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.6286\n\nz=2\n\n0.7500\n\n0.0000\n\nNorm.int (a.u.)\n\nCase 2\n\n(b)\n\n1\n\n0.7586\n\n0.2041\n\n0\nz\n\ny\nx\n\nx\n\ny\n\nz\n\nz=8\n\n0.6938\n\n0.0828\n\n0.6153\n\nNorm.int (a.u.)\n\nCase 3\n\n(c)\n\n1\n\ny\n\n0.9751\n\n0.4766\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.5435\n\nz=", "PLICIT NEURAL REPRESENTATION\n\nGT\n\nL2-CG\n\nL1-FISTA\n\nU-Net\n\nNeuFMT\n\nμNeuFMT\n1\n\ny\nx\n\ny\n\nz\n\nDICE =\n0.6581\n\nz=8\n\n0.4956\n\n0.6446\n\nNorm.int (a.u.)\n\nCase 1\n\n(a)\n\n0.8800\n\n0.5128\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.6286\n\nz=2\n\n0.7500\n\n0.0000\n\nNorm.int (a.u.)\n\nCase 2\n\n(b)\n\n1\n\n0.7586\n\n0.2041\n\n0\nz\n\ny\nx\n\nx\n\ny\n\nz\n\nz=8\n\n0.6938\n\n0.0828\n\n0.6153\n\nNorm.int (a.u.)\n\nCase 3\n\n(c)\n\n1\n\ny\n\n0.9751\n\n0.4766\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.5435\n\nz=8\n\n0.5908\n\n0.2637\n\nNorm.int (a.u.)\n\nCase 4\n\n(d)\n\n1\n\n0.8983\n\n0.7645\n\n0\nz\n\ny\nx\n\nNorm.int (a.u.)\n\n(e)\n\nCase 1\n\nCase 2\n\nCase 3\n\nCase 4\n\n1\n\n1\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.8\n\n0.8\n\n0.6\n\n0.6\n\n0.6\n\n0.6\n\n0.4\n\n0.4\n\n0.4\n\n0.4\n\n0.2\n\n0.2\n\n0.2\n\n0\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n0\n15\n\n0\n20\n\n25\n\n30\n\nmm\n\nGT\n\nL2-CG\n\n35\n\n0.2\n0\n\n10\n\nmm\n\nL1-FISTA\n\n20\n\n30\n\n40\n\n50\n\n0\n\n15\n\n20\n\n25\n\n30\n\n35\n\nmm\n\nU-Net\n\nNeuFMT\n\n40\n\nmm\n\nμNeuFMT\n\nFig. 3. Results", "8\n\n0.5908\n\n0.2637\n\nNorm.int (a.u.)\n\nCase 4\n\n(d)\n\n1\n\n0.8983\n\n0.7645\n\n0\nz\n\ny\nx\n\nNorm.int (a.u.)\n\n(e)\n\nCase 1\n\nCase 2\n\nCase 3\n\nCase 4\n\n1\n\n1\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.8\n\n0.8\n\n0.6\n\n0.6\n\n0.6\n\n0.6\n\n0.4\n\n0.4\n\n0.4\n\n0.4\n\n0.2\n\n0.2\n\n0.2\n\n0\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n0\n15\n\n0\n20\n\n25\n\n30\n\nmm\n\nGT\n\nL2-CG\n\n35\n\n0.2\n0\n\n10\n\nmm\n\nL1-FISTA\n\n20\n\n30\n\n40\n\n50\n\n0\n\n15\n\n20\n\n25\n\n30\n\n35\n\nmm\n\nU-Net\n\nNeuFMT\n\n40\n\nmm\n\nμNeuFMT\n\nFig. 3. Results of numerical phantom simulations. (a) (d) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (e) Intensity profiles along the dashed lines\nin the XY slices are compared for the four", "of numerical phantom simulations. (a) (d) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (e) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.\n\nconjugate gradients (L2 -CG) [42] and L1 -regularized nonnegative least squares (L1 -FISTA) [43], a pretrained supervised U-Net, and our baseline method NeuFMT without adaption. The U-Net was trained on a large, synthetically\ngenerated dataset of 5,488 samples. For each sample, the\ninput was a boundary measurement simulated using the DEbased forward model under the ground-truth properties", "cases.\n\nconjugate gradients (L2 -CG) [42] and L1 -regularized nonnegative least squares (L1 -FISTA) [43], a pretrained supervised U-Net, and our baseline method NeuFMT without adaption. The U-Net was trained on a large, synthetically\ngenerated dataset of 5,488 samples. For each sample, the\ninput was a boundary measurement simulated using the DEbased forward model under the ground-truth properties in a\ncuboid phantom (55 55 15 mm3 ), and the label was the\ncorresponding 3D fluorescence map of 1 2 ellipsoids with\nrandom sizes and spatial positions. To clearly demonstrate the\neffect of the -adaption module, we focused on adapting s\nwhile fixing a at its true value during reconstruction. For all\nmethods, the initial s was set to an erroneous value of 1.2\nmm 1 , which is 20% higher than the gro", "in a\ncuboid phantom (55 55 15 mm3 ), and the label was the\ncorresponding 3D fluorescence map of 1 2 ellipsoids with\nrandom sizes and spatial positions. To clearly demonstrate the\neffect of the -adaption module, we focused on adapting s\nwhile fixing a at its true value during reconstruction. For all\nmethods, the initial s was set to an erroneous value of 1.2\nmm 1 , which is 20% higher than the ground truth.\nThe results presented in Fig. 3 (a) (d) demonstrate the\nconsistent superiority of NeuFMT across all four numerical cases. We observe that the conventional methods were\nadversely affected by the optical property mismatch: L2 -CG\nreconstructions were characteristically blurred and exhibited\nsignificant depth errors, such as full-depth penetration in\nCases 3 and 4 and depth-wise expansion", "und truth.\nThe results presented in Fig. 3 (a) (d) demonstrate the\nconsistent superiority of NeuFMT across all four numerical cases. We observe that the conventional methods were\nadversely affected by the optical property mismatch: L2 -CG\nreconstructions were characteristically blurred and exhibited\nsignificant depth errors, such as full-depth penetration in\nCases 3 and 4 and depth-wise expansion in Case 1. L1 -FISTA\nfrequently introduced non-physical, fragmented artifacts, such\nas staircase patterns in Case 1 and hollow structures in Case 3,\nwhile it also suffered from severe depth inaccuracy. The\nsupervised U-Net, though performed well in Case 1, showed\nlimited generalization beyond its training data, as seen in its\nlocalization failure in the complex surface geometry of Case 2\n\n7\n\nand n", "in Case 1. L1 -FISTA\nfrequently introduced non-physical, fragmented artifacts, such\nas staircase patterns in Case 1 and hollow structures in Case 3,\nwhile it also suffered from severe depth inaccuracy. The\nsupervised U-Net, though performed well in Case 1, showed\nlimited generalization beyond its training data, as seen in its\nlocalization failure in the complex surface geometry of Case 2\n\n7\n\nand noticeable shape distortion in the unseen peanut-shaped\ntarget of Case 3 and 4. The direct NeuFMT provided better\ndepth prediction than the traditional methods but remained\nsensitive to the erroneous s , resulting in substantial shape\nexpansion in the x-y plane (Cases 1, 2) and axial splitting\n(Case 3). In contrast, NeuFMT successfully rectified the\noptical properties and overcame these limitations", "oticeable shape distortion in the unseen peanut-shaped\ntarget of Case 3 and 4. The direct NeuFMT provided better\ndepth prediction than the traditional methods but remained\nsensitive to the erroneous s , resulting in substantial shape\nexpansion in the x-y plane (Cases 1, 2) and axial splitting\n(Case 3). In contrast, NeuFMT successfully rectified the\noptical properties and overcame these limitations. It achieved\nthe most accurate spatial localization and shape fidelity, as\nevidenced by its 3D isosurfaces tightly conforming to the\nground truth in both simple and complex targets, and it clearly\nresolved both the small target and the complex background in\nCase 4. Quantitatively, NeuFMT consistently achieved the\nhighest Dice coefficients, and its intensity profiles (Fig. 3 (e))\nmost closely matc", ". It achieved\nthe most accurate spatial localization and shape fidelity, as\nevidenced by its 3D isosurfaces tightly conforming to the\nground truth in both simple and complex targets, and it clearly\nresolved both the small target and the complex background in\nCase 4. Quantitatively, NeuFMT consistently achieved the\nhighest Dice coefficients, and its intensity profiles (Fig. 3 (e))\nmost closely matched the ground truth in terms of peak\nlocation, width, and background suppression.\nC. Phantom Experiments\nWe further evaluated the performance of all methods using\nphysical phantom experiments to assess their practicality under real-world conditions, including measurement noise. The\nphantoms were fabricated from silicone, with their optical\nproperties calibrated to be approximately a = 0.0055 mm 1", "hed the ground truth in terms of peak\nlocation, width, and background suppression.\nC. Phantom Experiments\nWe further evaluated the performance of all methods using\nphysical phantom experiments to assess their practicality under real-world conditions, including measurement noise. The\nphantoms were fabricated from silicone, with their optical\nproperties calibrated to be approximately a = 0.0055 mm 1\nand s = 1.1 mm 1 at 680 nm. Fluorescent targets were embedded within the phantoms to create the four cases previously\ndefined in the simulations. The initial value of s was set identically for all reconstruction methods as the calibrated value,\nand also the U-Net was retrained accordingly. Consistent with\nthe simulation study, we focused on the adaptive recovery of\nthe reduced scattering coeffici", "and s = 1.1 mm 1 at 680 nm. Fluorescent targets were embedded within the phantoms to create the four cases previously\ndefined in the simulations. The initial value of s was set identically for all reconstruction methods as the calibrated value,\nand also the U-Net was retrained accordingly. Consistent with\nthe simulation study, we focused on the adaptive recovery of\nthe reduced scattering coefficient s .\nThe reconstruction results are summarized in Fig. 4. Under\nthese challenging real-world conditions, the limitations of the\nbaseline methods became evident: conventional approaches\n(L2 -CG, L1 -FISTA) produced blurry or fragmented reconstructions with significant depth errors, while the supervised\nU-Net, susceptible to domain shift and noise, failed to generalize, resulting in complete loca", "ent s .\nThe reconstruction results are summarized in Fig. 4. Under\nthese challenging real-world conditions, the limitations of the\nbaseline methods became evident: conventional approaches\n(L2 -CG, L1 -FISTA) produced blurry or fragmented reconstructions with significant depth errors, while the supervised\nU-Net, susceptible to domain shift and noise, failed to generalize, resulting in complete localization failures (Case 1)\nor severely distorted shapes (Cases 3 and 4). In contrast,\nthe INR-based frameworks, NeuFMT and NeuFMT, demonstrated markedly superior robustness, consistently yielding\nphysically plausible and continuous reconstructions where\nother methods failed. A detailed comparison between the two\nreveals that NeuFMT provided critical refinements toward\nenhanced physical consistency", "lization failures (Case 1)\nor severely distorted shapes (Cases 3 and 4). In contrast,\nthe INR-based frameworks, NeuFMT and NeuFMT, demonstrated markedly superior robustness, consistently yielding\nphysically plausible and continuous reconstructions where\nother methods failed. A detailed comparison between the two\nreveals that NeuFMT provided critical refinements toward\nenhanced physical consistency. In Cases 1 and 3, NeuFMT\nachieved better depth sensitivity and more uniform fluorophore\ndistribution, more faithfully representing the homogeneous\nnature of the true targets. In the complex geometry of Case 2,\nit uniquely achieved accurate localization, whereas direct\nNeuFMT produced a solution with an aberrant depth shift. For\nthe multi-target scenario in Case 4, NeuFMT reconstructed\nthe backgr", ". In Cases 1 and 3, NeuFMT\nachieved better depth sensitivity and more uniform fluorophore\ndistribution, more faithfully representing the homogeneous\nnature of the true targets. In the complex geometry of Case 2,\nit uniquely achieved accurate localization, whereas direct\nNeuFMT produced a solution with an aberrant depth shift. For\nthe multi-target scenario in Case 4, NeuFMT reconstructed\nthe background region with improved morphological accuracy.\nAlthough the performance gap in quantitative metrics such\nas the Dice coefficient was occasionally narrow, which reflects the inherent robustness of the shared INR architecture,\n NeuFMT provided consistent, subtle refinements, particularly\nin depth accuracy. The phantom experiments confirm that the\nadaptive physical correction mechanism in NeuFMT c", "ound region with improved morphological accuracy.\nAlthough the performance gap in quantitative metrics such\nas the Dice coefficient was occasionally narrow, which reflects the inherent robustness of the shared INR architecture,\n NeuFMT provided consistent, subtle refinements, particularly\nin depth accuracy. The phantom experiments confirm that the\nadaptive physical correction mechanism in NeuFMT can enhance reconstruction fidelity under practical conditions where\nthe exact coefficient in most real experiments is uncertain.\n\n8\n\nPREPRINT VERSION 2025\n\n(a)\n\nSilicone Phantoms\nGT\n\nL2-CG\n\nL1-FISTA\n\nU-Net\n\nNeuFMT\n\nμNeuFMT\n1\n\ny\nx\n\ny\n\nz\n\nDICE =\n0.5895\n\nz=8\n\n0.6154\n\n0.0762\n\nNorm.int (a.u.)\n\nCase 1\n\n(b)\n\nFluorescence Inclusions\n\n0.7023\n\n0.6615\n\n0\nz\n\n(Fig. 5 (c)). The reconstructed target lengths from", "an enhance reconstruction fidelity under practical conditions where\nthe exact coefficient in most real experiments is uncertain.\n\n8\n\nPREPRINT VERSION 2025\n\n(a)\n\nSilicone Phantoms\nGT\n\nL2-CG\n\nL1-FISTA\n\nU-Net\n\nNeuFMT\n\nμNeuFMT\n1\n\ny\nx\n\ny\n\nz\n\nDICE =\n0.5895\n\nz=8\n\n0.6154\n\n0.0762\n\nNorm.int (a.u.)\n\nCase 1\n\n(b)\n\nFluorescence Inclusions\n\n0.7023\n\n0.6615\n\n0\nz\n\n(Fig. 5 (c)). The reconstructed target lengths from NeuFMT\nshowed the closest agreement with the physical measurements\ntaken from the ex vivo lymph nodes, as visualized by the\nintensity profiles in Fig. 5 (c). These results demonstrate that\n NeuFMT provides a definitive advantage in practical in vivo\nscenarios, enabling robust and accurate target segmentation\nand localization under complex clinically related scenarios,\nsuch as fluorescence guided", "NeuFMT\nshowed the closest agreement with the physical measurements\ntaken from the ex vivo lymph nodes, as visualized by the\nintensity profiles in Fig. 5 (c). These results demonstrate that\n NeuFMT provides a definitive advantage in practical in vivo\nscenarios, enabling robust and accurate target segmentation\nand localization under complex clinically related scenarios,\nsuch as fluorescence guided surgery.\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.3371\n\nz=2\n\n0.3810\n\n0.4000\n\n0.5200\n\n0.2586\n\nWhite Light Image\n\n(a)\n\nvein\n\nLN-2\n\n0\nz\n\ny\nx\n\ny\n\nz\n\nz=8\n\n0.5413\n\n0.3358\n\n0.7011\n\n0.8230\n\n0.8050\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.5193\n\nz=8\n\n0.4319\n\n0.6601\n\n0.2849\n\nNorm.int (a.u.)\n\n0.6240\n\nNeuFMT\n\nμNeuFMT\nz\nx\n\nvein\n\nLN-3\nLN-2\nLN-1\n\nCase 3\n\nCase 4\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.6\n\n0.6\n\n0.6\n\n0.6\n\n0.4\n\n0.4\n\n0.4\n\n0.4\n\n0.2\n\n0.2\n20\n\n25\n\n30\n\n35\n\n40\n\n0\n15", "surgery.\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.3371\n\nz=2\n\n0.3810\n\n0.4000\n\n0.5200\n\n0.2586\n\nWhite Light Image\n\n(a)\n\nvein\n\nLN-2\n\n0\nz\n\ny\nx\n\ny\n\nz\n\nz=8\n\n0.5413\n\n0.3358\n\n0.7011\n\n0.8230\n\n0.8050\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.5193\n\nz=8\n\n0.4319\n\n0.6601\n\n0.2849\n\nNorm.int (a.u.)\n\n0.6240\n\nNeuFMT\n\nμNeuFMT\nz\nx\n\nvein\n\nLN-3\nLN-2\nLN-1\n\nCase 3\n\nCase 4\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.6\n\n0.6\n\n0.6\n\n0.6\n\n0.4\n\n0.4\n\n0.4\n\n0.4\n\n0.2\n\n0.2\n20\n\n25\n\n30\n\n35\n\n40\n\n0\n15\n\n0.2\n20\n\n25\n\n30\n\nmm\n\nGT\n\nL2-CG\n\n35\n\n0.2\n\n0\n\n0\n0\n\n10\n\nmm\n\nL1-FISTA\n\n20\n\n30\n\n40\n\n50\n\n15\n\n20\n\n25\n\n30\n\n35\n\nmm\n\nU-Net\n\nNeuFMT\n\n40\n\nmm\n\nNeuFMT-Ada\n\nFig. 4. Results of real phantom experiments. (a) Photograph of the real\nsilicone phantoms and fluorescence inclusions. (b) (e) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four", "0.2\n20\n\n25\n\n30\n\nmm\n\nGT\n\nL2-CG\n\n35\n\n0.2\n\n0\n\n0\n0\n\n10\n\nmm\n\nL1-FISTA\n\n20\n\n30\n\n40\n\n50\n\n15\n\n20\n\n25\n\n30\n\n35\n\nmm\n\nU-Net\n\nNeuFMT\n\n40\n\nmm\n\nNeuFMT-Ada\n\nFig. 4. Results of real phantom experiments. (a) Photograph of the real\nsilicone phantoms and fluorescence inclusions. (b) (e) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (f) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.\n\n10 mm\n\n(c)\n\nWe performed an in vivo imaging experiment on mice.\nFollowing the protocol described in Subsection II-F, Cy5\nfluorescent dye accumulated primarily at the", "numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (f) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.\n\n10 mm\n\n(c)\n\nWe performed an in vivo imaging experiment on mice.\nFollowing the protocol described in Subsection II-F, Cy5\nfluorescent dye accumulated primarily at the sentinel lymph\nnodes (LN), with some residual signal at the vein (Fig. 5 (a)).\nOur task was to reconstruct the spatial location and shape of\nthe sentinel lymph nodes.\nThe 3D FMT reconstruction results from all methods\nare presented in Fig. 5 (b). The conventional L2 -CG method\nproduced a reconstruction where the volume of LN-3 was\noverestimated, and the signals from LN-1, LN-2, and the vein\nmerge", "sentinel lymph\nnodes (LN), with some residual signal at the vein (Fig. 5 (a)).\nOur task was to reconstruct the spatial location and shape of\nthe sentinel lymph nodes.\nThe 3D FMT reconstruction results from all methods\nare presented in Fig. 5 (b). The conventional L2 -CG method\nproduced a reconstruction where the volume of LN-3 was\noverestimated, and the signals from LN-1, LN-2, and the vein\nmerged into a single, indistinguishable cluster. The L1 -FISTA\nreconstruction was highly fragmented, making it impossible\nto discern the shape or count of the lymph nodes accurately.\nAlso, the baseline NeuFMT failed to produce a physiologically plausible reconstruction. In contrast, NeuFMT was\nthe only method that successfully and distinctly resolved all\nthree lymph nodes (LN-1, LN-2, LN-3) and the vei", "d into a single, indistinguishable cluster. The L1 -FISTA\nreconstruction was highly fragmented, making it impossible\nto discern the shape or count of the lymph nodes accurately.\nAlso, the baseline NeuFMT failed to produce a physiologically plausible reconstruction. In contrast, NeuFMT was\nthe only method that successfully and distinctly resolved all\nthree lymph nodes (LN-1, LN-2, LN-3) and the vein, clearly\nidentifying each as separate, localized regions of fluorescence.\nFor quantitative validation, the mouse was sacrificed, and\nthe lymph nodes were excised to be imaged by ex vivo FRI\n\nLN-1\n\nx\ny\n\nLN-3 LN-2\n\n10 mm\n\n0\n\n1\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.8\n\n0.6\n\nLN-1\n\n0.4\n\n0.6\n\nLN-2\n\n0.4\n\n0.2\n\n0.6\n\n0.2\n\n0\n2\n\n4\n\n6\n\nL2-CG\n\n8\n\n10\n\n12\nmm\n\nLN-3\n\n0.4\n\n0.2\n\n0\n0\n\nD. In Vivo Lymph Node FMT Imaging Experiments\n\nConc", "n, clearly\nidentifying each as separate, localized regions of fluorescence.\nFor quantitative validation, the mouse was sacrificed, and\nthe lymph nodes were excised to be imaged by ex vivo FRI\n\nLN-1\n\nx\ny\n\nLN-3 LN-2\n\n10 mm\n\n0\n\n1\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.8\n\n0.6\n\nLN-1\n\n0.4\n\n0.6\n\nLN-2\n\n0.4\n\n0.2\n\n0.6\n\n0.2\n\n0\n2\n\n4\n\n6\n\nL2-CG\n\n8\n\n10\n\n12\nmm\n\nLN-3\n\n0.4\n\n0.2\n\n0\n0\n\nD. In Vivo Lymph Node FMT Imaging Experiments\n\nConcentration of Cy5 (a.u.)\n\nCase 2\n1\n0.8\n\nSlice z = 8 mm\n\nCase 1\n1\n0.8\n\nx\ny\n\nSlice z = 11 mm\n\n(f)\nNorm.int (a.u.)\n\nL1-FISTA\n\nR\n\n1\n\nProfiles\n\ny\nx\n\n15\n\nL2-CG\n\nLN-3\n\nL\n\n0\nz\n\n0\n\nR\n\ny\n\nConcentration of Cy5 (a.u.)\n\nCase 4\n\n(e)\n\n1\n\n(b)\n\nLN-1\n\nL\n\n3D Segmentation\n\nx\n\nNorm.int (a.u.)\n\nCase 3\n\n(d)\n\n1\n\ny\n\nIn vivo FRI\n\nNorm.int (a.u.)\n\nCase 2\n\n(c)\n\n1\n\n0\n0\n\n2\n\nL1-FISTA\n\n4\n\n6\n\n8\n\n10\n\n12\nmm\n\n0\n\n2\n\nNeuFMT\n\n4\n\n6\n\n8\n\n1", "entration of Cy5 (a.u.)\n\nCase 2\n1\n0.8\n\nSlice z = 8 mm\n\nCase 1\n1\n0.8\n\nx\ny\n\nSlice z = 11 mm\n\n(f)\nNorm.int (a.u.)\n\nL1-FISTA\n\nR\n\n1\n\nProfiles\n\ny\nx\n\n15\n\nL2-CG\n\nLN-3\n\nL\n\n0\nz\n\n0\n\nR\n\ny\n\nConcentration of Cy5 (a.u.)\n\nCase 4\n\n(e)\n\n1\n\n(b)\n\nLN-1\n\nL\n\n3D Segmentation\n\nx\n\nNorm.int (a.u.)\n\nCase 3\n\n(d)\n\n1\n\ny\n\nIn vivo FRI\n\nNorm.int (a.u.)\n\nCase 2\n\n(c)\n\n1\n\n0\n0\n\n2\n\nL1-FISTA\n\n4\n\n6\n\n8\n\n10\n\n12\nmm\n\n0\n\n2\n\nNeuFMT\n\n4\n\n6\n\n8\n\n10\n\n12\nmm\n\nμNeuFMT\n\nFig. 5. In vivo lymph node FMT imaging and reconstruction results. (a) The\nwhite-light image and preview via 2D fluorescence reflectance imaging (FRI)\noverlaid on the white-light image with the red aera indicating the concentrated\ndistribution of Cy5 probe on the cites of three lymph nodes (LN-1, LN-2, LN3) and the vein. (b) Comparison of FMT reconstruction results from differen", "0\n\n12\nmm\n\nμNeuFMT\n\nFig. 5. In vivo lymph node FMT imaging and reconstruction results. (a) The\nwhite-light image and preview via 2D fluorescence reflectance imaging (FRI)\noverlaid on the white-light image with the red aera indicating the concentrated\ndistribution of Cy5 probe on the cites of three lymph nodes (LN-1, LN-2, LN3) and the vein. (b) Comparison of FMT reconstruction results from different\nmethods. The 3D segmentation, along with two slices at z = 8 and 11 mm,\nare displayed. (c) Intensity profiles along the dashed lines in b. are compared\nfor each ex vivo images of lymph nodes after sacrificing the animal. The gray\nzone represents the estimated size of LN, based on the ex vivo fluorescence\nimages.\n\nIV. D ISCUSSION AND C ONCLUSION\nIn this study, we introduced NeuFMT, an optical-pro", "t\nmethods. The 3D segmentation, along with two slices at z = 8 and 11 mm,\nare displayed. (c) Intensity profiles along the dashed lines in b. are compared\nfor each ex vivo images of lymph nodes after sacrificing the animal. The gray\nzone represents the estimated size of LN, based on the ex vivo fluorescence\nimages.\n\nIV. D ISCUSSION AND C ONCLUSION\nIn this study, we introduced NeuFMT, an optical-propertyadaptive FMT reconstruction framework that integrates INR\nwith an explicitly differentiable FEM-based light propagation model. By unifying a continuous fluorescence field parameterized by an INR and a physics-based forward model\namenable to end-to-end optimization, NeuFMT addresses\ntwo fundamental limitations of existing FMT reconstruction\ntechniques: their inability to efficiently adapt to c", "pertyadaptive FMT reconstruction framework that integrates INR\nwith an explicitly differentiable FEM-based light propagation model. By unifying a continuous fluorescence field parameterized by an INR and a physics-based forward model\namenable to end-to-end optimization, NeuFMT addresses\ntwo fundamental limitations of existing FMT reconstruction\ntechniques: their inability to efficiently adapt to complex and\nheterogeneous fluorescence distribution, and their reliance on\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nfixed, often inaccurate, optical properties, which significantly\nexacerbates the inherent ill-posedness of the inverse problem.\nUnlike supervised deep learning approaches which are constrained by the diversit", "omplex and\nheterogeneous fluorescence distribution, and their reliance on\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nfixed, often inaccurate, optical properties, which significantly\nexacerbates the inherent ill-posedness of the inverse problem.\nUnlike supervised deep learning approaches which are constrained by the diversity and scale of training datasets and\noften fail under domain shift, NeuFMT operates in a selfsupervised, physics-informed regime. It does not require paired\ntraining data; instead, it directly minimizes the discrepancy between measured and simulated boundary fluxes. This not only\neliminates the need for extensive experimental datasets but also\nensures generalizability across different imaging geom", "y and scale of training datasets and\noften fail under domain shift, NeuFMT operates in a selfsupervised, physics-informed regime. It does not require paired\ntraining data; instead, it directly minimizes the discrepancy between measured and simulated boundary fluxes. This not only\neliminates the need for extensive experimental datasets but also\nensures generalizability across different imaging geometries\nand target configurations. The continuous, coordinate-based\nrepresentation provided by the INR further ensures that our\nreconstructions are free from discretization artifacts and inherently resolution-agnostic.\nA central contribution of our work is the introduction of\nan optical property adaptation mechanism, which enables the\ndynamic optimization of absorption and scattering coefficients\n(", "etries\nand target configurations. The continuous, coordinate-based\nrepresentation provided by the INR further ensures that our\nreconstructions are free from discretization artifacts and inherently resolution-agnostic.\nA central contribution of our work is the introduction of\nan optical property adaptation mechanism, which enables the\ndynamic optimization of absorption and scattering coefficients\n( a , s ) concurrently with the fluorescence distribution. Our\nframework demonstrates that the integration of a differentiable\nphysics-based forward model is the key to enabling this\nself-supervised adaptation. The FEM-based light propagation\nmodel is not merely a component of the loss function, but\nan active and adaptive part of the inverse solver. This stands\nin contrast to both traditional itera", "a , s ) concurrently with the fluorescence distribution. Our\nframework demonstrates that the integration of a differentiable\nphysics-based forward model is the key to enabling this\nself-supervised adaptation. The FEM-based light propagation\nmodel is not merely a component of the loss function, but\nan active and adaptive part of the inverse solver. This stands\nin contrast to both traditional iterative methods, which hold\noptical properties static and thus aggravate the problem s illposedness, and conventional end-to-end deep learning approaches, which struggle to generalize beyond their training\ndata. The adaptivity of our model is thus its core strength,\nproviding a principled way to refine the physical model itself\nbased on the measured data, which is crucial for practical\napplications w", "tive methods, which hold\noptical properties static and thus aggravate the problem s illposedness, and conventional end-to-end deep learning approaches, which struggle to generalize beyond their training\ndata. The adaptivity of our model is thus its core strength,\nproviding a principled way to refine the physical model itself\nbased on the measured data, which is crucial for practical\napplications where precise prior knowledge of tissue optics\nis unavailable.\nOur results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate\nthat NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1 ) and deep learningbased (U-Net) benchmarks. In particular, the method consistently localized fluorescent targets with higher spatial", "here precise prior knowledge of tissue optics\nis unavailable.\nOur results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate\nthat NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1 ) and deep learningbased (U-Net) benchmarks. In particular, the method consistently localized fluorescent targets with higher spatial accuracy, improved contrast, and more realistic morphological\nfeatures especially under challenging conditions involving\nbackground fluorescence and complex geometry.\nDespite these promising results, several aspects of\n NeuFMT merit further investigation. First, the current implementation assumes a homogeneous optical background a\ncommon simplification in FMT studies. Extending the model\nto incor", "accuracy, improved contrast, and more realistic morphological\nfeatures especially under challenging conditions involving\nbackground fluorescence and complex geometry.\nDespite these promising results, several aspects of\n NeuFMT merit further investigation. First, the current implementation assumes a homogeneous optical background a\ncommon simplification in FMT studies. Extending the model\nto incorporate spatially varying optical properties represents\na logical next step, potentially by representing a (r) and\n s (r) with additional INRs, though this would significantly\nincrease the complexity of the inverse problem. Nevertheless,\nthe proposed NeuFMT can be validated or even combined\nwith time-domain near-infrared spectroscopy (fNIRS) [44],\n[45] or diffuse optical tomography (DOT) [46] techn", "porate spatially varying optical properties represents\na logical next step, potentially by representing a (r) and\n s (r) with additional INRs, though this would significantly\nincrease the complexity of the inverse problem. Nevertheless,\nthe proposed NeuFMT can be validated or even combined\nwith time-domain near-infrared spectroscopy (fNIRS) [44],\n[45] or diffuse optical tomography (DOT) [46] techniques,\nwhere the complex optical properties related with absorption\nand scattering can disentangled and calibrated. More importantly, the integration of NeuFMT with emerging imaging\ntechnologies holds particular promise. The inherent adaptivity\nof our framework is well-suited to the distinct scattering\nand absorption landscapes of NIR-II fluorescence tomography\n\n9\n\n[47], [48], where our optical pr", "iques,\nwhere the complex optical properties related with absorption\nand scattering can disentangled and calibrated. More importantly, the integration of NeuFMT with emerging imaging\ntechnologies holds particular promise. The inherent adaptivity\nof our framework is well-suited to the distinct scattering\nand absorption landscapes of NIR-II fluorescence tomography\n\n9\n\n[47], [48], where our optical property optimization could be\ncrucial for accurately modeling the increased photon penetration and achieving higher-resolution reconstruction at depth.\nFurthermore, the framework can be naturally extended to\nhyperspectral FMT, using a single INR to output both fluorophore concentration and spectral signature, thereby disentangling multiple probes or accounting for wavelength-dependent\noptical prope", "operty optimization could be\ncrucial for accurately modeling the increased photon penetration and achieving higher-resolution reconstruction at depth.\nFurthermore, the framework can be naturally extended to\nhyperspectral FMT, using a single INR to output both fluorophore concentration and spectral signature, thereby disentangling multiple probes or accounting for wavelength-dependent\noptical properties. Finally, translating NeuFMT into clinical\nsettings, such as intraoperative fluorescence-guided surgery\n[8], [9], represents an exciting frontier where its adaptability\ncould overcome patient-specific variations in tissue optics.\nIn conclusion, by harmonizing a differentiable physics\nmodel with a continuous INR, NeuFMT provides a robust,\nself-supervised, and adaptive framework for FMT recons", "rties. Finally, translating NeuFMT into clinical\nsettings, such as intraoperative fluorescence-guided surgery\n[8], [9], represents an exciting frontier where its adaptability\ncould overcome patient-specific variations in tissue optics.\nIn conclusion, by harmonizing a differentiable physics\nmodel with a continuous INR, NeuFMT provides a robust,\nself-supervised, and adaptive framework for FMT reconstruction. It effectively mitigates the ill-posedness inherent to\ninverse problems with uncertain parameters, setting a new\nparadigm for practical, high-resolution fluorescence molecular\nimaging. We believe this physics-in-the-loop INR approach\noffers a generalizable template for tackling a wide range of\ntomographic and inverse problems in biomedical imaging.\nR EFERENCES\n[1] F. Song, P. Zhang, H. W", "truction. It effectively mitigates the ill-posedness inherent to\ninverse problems with uncertain parameters, setting a new\nparadigm for practical, high-resolution fluorescence molecular\nimaging. We believe this physics-in-the-loop INR approach\noffers a generalizable template for tackling a wide range of\ntomographic and inverse problems in biomedical imaging.\nR EFERENCES\n[1] F. Song, P. Zhang, H. Wu, C. Ma, Z. Liu, R. Cai, Y. Feng, Y. He,\nX. Dong, Y. Tian, and G. Zhang, Advances of fluorescence molecular\nimaging: NIR-II window, probes, and tomography, Laser & Photonics\nReviews, vol. 19, no. 10, p. 2400275, 2025.\n[2] B. Zhu, J. Hendricks, J. E. Morton, J. C. Rasmussen, C. Janssen,\nM. N. Shah, and E. M. Sevick-Muraca, Near-infrared fluorescence\ntomography and imaging of ventricular cerebrospi", "u, C. Ma, Z. Liu, R. Cai, Y. Feng, Y. He,\nX. Dong, Y. Tian, and G. Zhang, Advances of fluorescence molecular\nimaging: NIR-II window, probes, and tomography, Laser & Photonics\nReviews, vol. 19, no. 10, p. 2400275, 2025.\n[2] B. Zhu, J. Hendricks, J. E. Morton, J. C. Rasmussen, C. Janssen,\nM. N. Shah, and E. M. Sevick-Muraca, Near-infrared fluorescence\ntomography and imaging of ventricular cerebrospinal fluid flow and\nextracranial outflow in non-human primates, IEEE Transactions on\nMedical Imaging, vol. 42, no. 12, pp. 3555 3565, 2023.\n[3] M. S. Ozturk and et al., High-resolution tomographic analysis of in\nvitro 3D glioblastoma tumor model under long-term drug treatment, \nScience Advances, vol. 6, no. 10, p. eaay7513, 2020.\n[4] M. Cai, Z. Zhang, X. Shi, Z. Hu, and J. Tian, NIR-II/NIR-I fluore", "nal fluid flow and\nextracranial outflow in non-human primates, IEEE Transactions on\nMedical Imaging, vol. 42, no. 12, pp. 3555 3565, 2023.\n[3] M. S. Ozturk and et al., High-resolution tomographic analysis of in\nvitro 3D glioblastoma tumor model under long-term drug treatment, \nScience Advances, vol. 6, no. 10, p. eaay7513, 2020.\n[4] M. Cai, Z. Zhang, X. Shi, Z. Hu, and J. Tian, NIR-II/NIR-I fluorescence molecular tomography of heterogeneous mice based on gaussian\nweighted neighborhood fused lasso method, IEEE Transactions on\nMedical Imaging, vol. 39, no. 6, pp. 2213 2222, 2020.\n[5] S. R. Arridge and J. C. Schotland, Optical tomography: forward and\ninverse problems, Inverse problems, vol. 25, no. 12, p. 123010, 2009.\n[6] L. V. Wang and H.-i. Wu, Biomedical optics: principles and imaging.\nJo", "scence molecular tomography of heterogeneous mice based on gaussian\nweighted neighborhood fused lasso method, IEEE Transactions on\nMedical Imaging, vol. 39, no. 6, pp. 2213 2222, 2020.\n[5] S. R. Arridge and J. C. Schotland, Optical tomography: forward and\ninverse problems, Inverse problems, vol. 25, no. 12, p. 123010, 2009.\n[6] L. V. Wang and H.-i. Wu, Biomedical optics: principles and imaging.\nJohn Wiley & Sons, 2007.\n[7] F. Stuker, J. Ripoll, and M. Rudin, Fluorescence molecular tomography:\nprinciples and potential for pharmaceutical research, Pharmaceutics,\nvol. 3, no. 2, pp. 229 274, 2011.\n[8] J. S. D. Mieog, F. B. Achterberg, A. Zlitni, M. Hutteman, J. Burggraaf,\nR.-J. Swijnenburg, S. Gioux, and A. L. Vahrmeijer, Fundamentals and\ndevelopments in fluorescence-guided cancer surgery, Nat", "hn Wiley & Sons, 2007.\n[7] F. Stuker, J. Ripoll, and M. Rudin, Fluorescence molecular tomography:\nprinciples and potential for pharmaceutical research, Pharmaceutics,\nvol. 3, no. 2, pp. 229 274, 2011.\n[8] J. S. D. Mieog, F. B. Achterberg, A. Zlitni, M. Hutteman, J. Burggraaf,\nR.-J. Swijnenburg, S. Gioux, and A. L. Vahrmeijer, Fundamentals and\ndevelopments in fluorescence-guided cancer surgery, Nature Reviews\nClinical Oncology, vol. 19, no. 1, pp. 9 22, 2022.\n[9] K. Wang, Y. Du, Z. Zhang, K. He, Z. Cheng, L. Yin, D. Dong, C. Li,\nW. Li, Z. Hu et al., Fluorescence image-guided tumour surgery, Nature\nReviews Bioengineering, vol. 1, no. 3, pp. 161 179, 2023.\n[10] D. Zhu et al., Comparison of regularization methods in fluorescence\nmolecular tomography, Photonics, vol. 1, no. 2, pp. 95 109, 2014.", "ure Reviews\nClinical Oncology, vol. 19, no. 1, pp. 9 22, 2022.\n[9] K. Wang, Y. Du, Z. Zhang, K. He, Z. Cheng, L. Yin, D. Dong, C. Li,\nW. Li, Z. Hu et al., Fluorescence image-guided tumour surgery, Nature\nReviews Bioengineering, vol. 1, no. 3, pp. 161 179, 2023.\n[10] D. Zhu et al., Comparison of regularization methods in fluorescence\nmolecular tomography, Photonics, vol. 1, no. 2, pp. 95 109, 2014.\n[11] H. Yi et al., Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography:\na comparative study, Journal of Biomedical Optics, vol. 18, no. 5, p.\n56013, 2013.\n[12] J. Shi, B. Zhang, F. Liu, J. Luo, and J. Bai, Efficient L1 regularizationbased reconstruction for fluorescent molecular tomography using\nrestarted nonlinear conjugate gradient,", "[11] H. Yi et al., Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography:\na comparative study, Journal of Biomedical Optics, vol. 18, no. 5, p.\n56013, 2013.\n[12] J. Shi, B. Zhang, F. Liu, J. Luo, and J. Bai, Efficient L1 regularizationbased reconstruction for fluorescent molecular tomography using\nrestarted nonlinear conjugate gradient, Optics letters, vol. 38, no. 18,\npp. 3696 3699, 2013.\n[13] D. Zhu and C. Li, Nonconvex regularizations in fluorescence molecular\ntomography for sparsity enhancement, Physics in Medicine & Biology,\nvol. 59, no. 12, p. 2901, 2014.\n[14] J. Zhang, L. Li, Q. Hu, J. Zhang, Y. Wu, L. Gu, J. Li, F. Li, X. Zhu,\nJ. Jiang et al., High-fidelity solution decomposition fluorescence tomography in the presence of", "Optics letters, vol. 38, no. 18,\npp. 3696 3699, 2013.\n[13] D. Zhu and C. Li, Nonconvex regularizations in fluorescence molecular\ntomography for sparsity enhancement, Physics in Medicine & Biology,\nvol. 59, no. 12, p. 2901, 2014.\n[14] J. Zhang, L. Li, Q. Hu, J. Zhang, Y. Wu, L. Gu, J. Li, F. Li, X. Zhu,\nJ. Jiang et al., High-fidelity solution decomposition fluorescence tomography in the presence of background interference, Laser & Photonics\nReviews, p. e01013, 2025.\n\n10\n\n[15] C. Huang, H. Meng, Y. Gao, S. Jiang, K. Wang, and J. Tian, Fast and\nrobust reconstruction method for fluorescence molecular tomography\nbased on deep neural network, in Imaging, Manipulation, and Analysis\nof Biomolecules, Cells, and Tissues XVII, vol. 10881. SPIE, 2019, pp.\n257 262.\n[16] L. Guo, F. Liu, C. Cai, J. Liu,", "background interference, Laser & Photonics\nReviews, p. e01013, 2025.\n\n10\n\n[15] C. Huang, H. Meng, Y. Gao, S. Jiang, K. Wang, and J. Tian, Fast and\nrobust reconstruction method for fluorescence molecular tomography\nbased on deep neural network, in Imaging, Manipulation, and Analysis\nof Biomolecules, Cells, and Tissues XVII, vol. 10881. SPIE, 2019, pp.\n257 262.\n[16] L. Guo, F. Liu, C. Cai, J. Liu, and G. Zhang, 3D deep encoder decoder\nnetwork for fluorescence molecular tomography, Optics letters, vol. 44,\nno. 8, pp. 1892 1895, 2019.\n[17] P. Zhang, G. Fan, T. Xing, F. Song, and G. Zhang, UHR-DeepFMT:\nultra-high spatial resolution reconstruction of fluorescence molecular\ntomography based on 3-d fusion dual-sampling deep neural network, \nIEEE Transactions on Medical Imaging, vol. 40, no. 11, p", "and G. Zhang, 3D deep encoder decoder\nnetwork for fluorescence molecular tomography, Optics letters, vol. 44,\nno. 8, pp. 1892 1895, 2019.\n[17] P. Zhang, G. Fan, T. Xing, F. Song, and G. Zhang, UHR-DeepFMT:\nultra-high spatial resolution reconstruction of fluorescence molecular\ntomography based on 3-d fusion dual-sampling deep neural network, \nIEEE Transactions on Medical Imaging, vol. 40, no. 11, pp. 3217 3228,\n2021.\n[18] J. Cheng, P. Zhang, F. Liu, J. Liu, H. Hui, J. Tian, and J. Luo, Encoderdecoder deep learning network for simultaneous reconstruction of fluorescence yield and lifetime distributions, Biomedical Optics Express,\nvol. 13, no. 9, pp. 4693 4705, 2022.\n[19] P. Zhang, C. Ma, F. Song, Z. Liu, Y. Feng, Y. Sun, Y. He,\nF. Liu, D. Wang, and G. Zhang, Multi-branch attention prior base", "p. 3217 3228,\n2021.\n[18] J. Cheng, P. Zhang, F. Liu, J. Liu, H. Hui, J. Tian, and J. Luo, Encoderdecoder deep learning network for simultaneous reconstruction of fluorescence yield and lifetime distributions, Biomedical Optics Express,\nvol. 13, no. 9, pp. 4693 4705, 2022.\n[19] P. Zhang, C. Ma, F. Song, Z. Liu, Y. Feng, Y. Sun, Y. He,\nF. Liu, D. Wang, and G. Zhang, Multi-branch attention prior based\nparameterized generative adversarial network for fast and accurate\nlimited-projection reconstruction in fluorescence molecular tomography, Biomedical Optics Express, vol. 13, no. 10, pp. 5327 5343, 2022.\n[20] P. Zhang, F. Song, C. Ma, Z. Liu, H. Wu, Y. Sun, Y. Feng, Y. He, and\nG. Zhang, Robust reconstruction of fluorescence molecular tomography\nbased on adaptive adversarial learning strategy, Ph", "d\nparameterized generative adversarial network for fast and accurate\nlimited-projection reconstruction in fluorescence molecular tomography, Biomedical Optics Express, vol. 13, no. 10, pp. 5327 5343, 2022.\n[20] P. Zhang, F. Song, C. Ma, Z. Liu, H. Wu, Y. Sun, Y. Feng, Y. He, and\nG. Zhang, Robust reconstruction of fluorescence molecular tomography\nbased on adaptive adversarial learning strategy, Physics in Medicine &\nBiology, vol. 68, no. 4, p. 04LT01, 2023.\n[21] P. Zhang, X. Liu, Q. Xue, Y. Shang, C. Liu, R. Chen, H. Gao, J. Liang,\nW. Wang, and G. Zhang, PAH2T-Former: Paired-attention hybrid\nhierarchical transformer for synergistically enhanced fmt reconstruction\nquality and efficiency, IEEE Transactions on Computational Imaging,\n2025.\n[22] H. Meng, Y. Gao, X. Yang, K. Wang, and J. Tian, K", "ysics in Medicine &\nBiology, vol. 68, no. 4, p. 04LT01, 2023.\n[21] P. Zhang, X. Liu, Q. Xue, Y. Shang, C. Liu, R. Chen, H. Gao, J. Liang,\nW. Wang, and G. Zhang, PAH2T-Former: Paired-attention hybrid\nhierarchical transformer for synergistically enhanced fmt reconstruction\nquality and efficiency, IEEE Transactions on Computational Imaging,\n2025.\n[22] H. Meng, Y. Gao, X. Yang, K. Wang, and J. Tian, K-nearest neighbor\nbased locally connected network for fast morphological reconstruction\nin fluorescence molecular tomography, IEEE transactions on medical\nimaging, vol. 39, no. 10, pp. 3019 3028, 2020.\n[23] D. Li, C. Chen, J. Li, and Q. Yan, Reconstruction of fluorescence\nmolecular tomography based on graph convolution networks, Journal\nof Optics, vol. 22, no. 4, p. 045602, 2020.\n[24] Y. Wang, C.", "-nearest neighbor\nbased locally connected network for fast morphological reconstruction\nin fluorescence molecular tomography, IEEE transactions on medical\nimaging, vol. 39, no. 10, pp. 3019 3028, 2020.\n[23] D. Li, C. Chen, J. Li, and Q. Yan, Reconstruction of fluorescence\nmolecular tomography based on graph convolution networks, Journal\nof Optics, vol. 22, no. 4, p. 045602, 2020.\n[24] Y. Wang, C. Bian, Y. An, H. Wang, Q. Liang, Y. Du, and J. Tian,\n Graph convolution based residual connected network for morphological reconstruction in fluorescence molecular tomography, in Medical\nImaging 2022: Biomedical Applications in Molecular, Structural, and\nFunctional Imaging, vol. 12036. SPIE, 2022, pp. 527 533.\n[25] Y. Sun, J. Liu, M. Xie, B. Wohlberg, and U. S. Kamilov, Coil:\nCoordinate-based inter", "Bian, Y. An, H. Wang, Q. Liang, Y. Du, and J. Tian,\n Graph convolution based residual connected network for morphological reconstruction in fluorescence molecular tomography, in Medical\nImaging 2022: Biomedical Applications in Molecular, Structural, and\nFunctional Imaging, vol. 12036. SPIE, 2022, pp. 527 533.\n[25] Y. Sun, J. Liu, M. Xie, B. Wohlberg, and U. S. Kamilov, Coil:\nCoordinate-based internal learning for tomographic imaging, IEEE\nTransactions on Computational Imaging, vol. 7, pp. 1400 1412, 2021.\n[26] L. Lozenski, M. A. Anastasio, and U. Villa, A memory-efficient selfsupervised dynamic image reconstruction method using neural fields, \nIEEE Transactions on Computational Imaging, vol. 8, pp. 879 892,\n2022.\n[27] A. W. Reed, H. Kim, R. Anirudh, K. A. Mohan, K. Champley, J. Kang,\nand S", "nal learning for tomographic imaging, IEEE\nTransactions on Computational Imaging, vol. 7, pp. 1400 1412, 2021.\n[26] L. Lozenski, M. A. Anastasio, and U. Villa, A memory-efficient selfsupervised dynamic image reconstruction method using neural fields, \nIEEE Transactions on Computational Imaging, vol. 8, pp. 879 892,\n2022.\n[27] A. W. Reed, H. Kim, R. Anirudh, K. A. Mohan, K. Champley, J. Kang,\nand S. Jayasuriya, Dynamic CT reconstruction from limited views\nwith implicit neural representations and parametric motion fields, in\nProceedings of the IEEE/CVF International Conference on Computer\nVision, 2021, pp. 2258 2268.\n[28] L. Shen, J. Pauly, and L. Xing, NeRP: implicit neural representation\nlearning with prior embedding for sparsely sampled image reconstruction, IEEE Transactions on Neural Ne", ". Jayasuriya, Dynamic CT reconstruction from limited views\nwith implicit neural representations and parametric motion fields, in\nProceedings of the IEEE/CVF International Conference on Computer\nVision, 2021, pp. 2258 2268.\n[28] L. Shen, J. Pauly, and L. Xing, NeRP: implicit neural representation\nlearning with prior embedding for sparsely sampled image reconstruction, IEEE Transactions on Neural Networks and Learning Systems,\nvol. 35, no. 1, pp. 770 782, 2022.\n[29] R. Liu, Y. Sun, J. Zhu, L. Tian, and U. S. Kamilov, Recovery\nof continuous 3D refractive index maps from discrete intensity-only\nmeasurements using neural fields, Nature Machine Intelligence, vol. 4,\nno. 9, pp. 781 791, 2022.\n[30] S. Shen, L. Li, S. Gao, Y. Wang, L. Gu, S. Li, X. Zhu, J. Jiang, J. Yu, and\nW. Ren, High resolution", "tworks and Learning Systems,\nvol. 35, no. 1, pp. 770 782, 2022.\n[29] R. Liu, Y. Sun, J. Zhu, L. Tian, and U. S. Kamilov, Recovery\nof continuous 3D refractive index maps from discrete intensity-only\nmeasurements using neural fields, Nature Machine Intelligence, vol. 4,\nno. 9, pp. 781 791, 2022.\n[30] S. Shen, L. Li, S. Gao, Y. Wang, L. Gu, S. Li, X. Zhu, J. Jiang, J. Yu, and\nW. Ren, High resolution diffuse optical tomography via neural fields, \nIEEE Transactions on Computational Imaging, 2024.\n[31] K. Han, C. Li, A. Xiao, Y. Tian, J. Tian, and Z. Hu, TSPE: Reconstruction of multi-morphological tumors of NIR-II fluorescence molecular\ntomography based on positional encoding, Computer Methods and\nPrograms in Biomedicine, vol. 261, p. 108554, 2025.\n[32] S. R. Arridge, Optical tomography in medic", "diffuse optical tomography via neural fields, \nIEEE Transactions on Computational Imaging, 2024.\n[31] K. Han, C. Li, A. Xiao, Y. Tian, J. Tian, and Z. Hu, TSPE: Reconstruction of multi-morphological tumors of NIR-II fluorescence molecular\ntomography based on positional encoding, Computer Methods and\nPrograms in Biomedicine, vol. 261, p. 108554, 2025.\n[32] S. R. Arridge, Optical tomography in medical imaging, Inverse problems, vol. 15, no. 2, p. R41, 1999.\n[33] , Photon-measurement density functions. part I: Analytical forms, \nApplied Optics, vol. 34, no. 31, pp. 7395 7409, 1995.\n[34] S. R. Arridge and M. Schweiger, Photon-measurement density functions. part 2: Finite-element-method calculations, Applied Optics,\nvol. 34, no. 34, pp. 8026 8037, 1995.\n\nPREPRINT VERSION 2025\n\n[35] O. C. Zienki", "al imaging, Inverse problems, vol. 15, no. 2, p. R41, 1999.\n[33] , Photon-measurement density functions. part I: Analytical forms, \nApplied Optics, vol. 34, no. 31, pp. 7395 7409, 1995.\n[34] S. R. Arridge and M. Schweiger, Photon-measurement density functions. part 2: Finite-element-method calculations, Applied Optics,\nvol. 34, no. 34, pp. 8026 8037, 1995.\n\nPREPRINT VERSION 2025\n\n[35] O. C. Zienkiewicz, R. L. Taylor, P. Nithiarasu, and J. Zhu, The finite\nelement method. Elsevier, 1977, vol. 3.\n[36] V. Ntziachristos, C. Bremer, and R. Weissleder, Fluorescence molecular\ntomography resolves protease activity in vivo, Nature Medicine, vol. 8,\nno. 7, pp. 757 760, 2002.\n[37] M. Schweiger and S. Arridge, The Toast++ software suite for forward\nand inverse modeling in optical tomography, Journal of", "ewicz, R. L. Taylor, P. Nithiarasu, and J. Zhu, The finite\nelement method. Elsevier, 1977, vol. 3.\n[36] V. Ntziachristos, C. Bremer, and R. Weissleder, Fluorescence molecular\ntomography resolves protease activity in vivo, Nature Medicine, vol. 8,\nno. 7, pp. 757 760, 2002.\n[37] M. Schweiger and S. Arridge, The Toast++ software suite for forward\nand inverse modeling in optical tomography, Journal of biomedical\noptics, vol. 19, no. 4, pp. 040 801 040 801, 2014.\n[38] W. Ren, H. Isler, M. Wolf, J. Ripoll, and M. Rudin, Smart toolkit\nfor fluorescence tomography: simulation, reconstruction, and validation, \nIEEE Transactions on Biomedical Engineering, vol. 67, no. 1, pp. 16 \n26, 2019.\n[39] S. Gao, J. Zhang, Y. Hu, Y. Wu, L. Li, Q. Hu, X. Lou, X. Zhu, J. Jiang,\nand W. Ren, Multifunctional optical", "biomedical\noptics, vol. 19, no. 4, pp. 040 801 040 801, 2014.\n[38] W. Ren, H. Isler, M. Wolf, J. Ripoll, and M. Rudin, Smart toolkit\nfor fluorescence tomography: simulation, reconstruction, and validation, \nIEEE Transactions on Biomedical Engineering, vol. 67, no. 1, pp. 16 \n26, 2019.\n[39] S. Gao, J. Zhang, Y. Hu, Y. Wu, L. Li, Q. Hu, X. Lou, X. Zhu, J. Jiang,\nand W. Ren, Multifunctional optical tomography system with highfidelity surface extraction based on a single programmable scanner and\nunified pinhole modeling, IEEE Transactions on Biomedical Engineering, 2023.\n[40] Y. Hu, Y. Wu, L. Li, L. Gu, X. Zhu, J. Jiang, and W. Ren, Simultaneous\nreconstruction of 3D fluorescence distribution and object surface using\nstructured light illumination and dual-camera detection, Optics Express,\nvol.", "tomography system with highfidelity surface extraction based on a single programmable scanner and\nunified pinhole modeling, IEEE Transactions on Biomedical Engineering, 2023.\n[40] Y. Hu, Y. Wu, L. Li, L. Gu, X. Zhu, J. Jiang, and W. Ren, Simultaneous\nreconstruction of 3D fluorescence distribution and object surface using\nstructured light illumination and dual-camera detection, Optics Express,\nvol. 32, no. 9, pp. 15 760 15 773, 2024.\n[41] C. Ji, M. Zhao, C. Wang, R. Liu, S. Zhu, X. Dong, C. Su, and Z. Gu,\n Biocompatible tantalum nanoparticles as radiosensitizers for enhancing\ntherapy efficacy in primary tumor and metastatic sentinel lymph nodes, \nACS nano, vol. 16, no. 6, pp. 9428 9441, 2022.\n[42] S. Kawata and O. Nalcioglu, Constrained iterative reconstruction by\nthe conjugate gradient met", "32, no. 9, pp. 15 760 15 773, 2024.\n[41] C. Ji, M. Zhao, C. Wang, R. Liu, S. Zhu, X. Dong, C. Su, and Z. Gu,\n Biocompatible tantalum nanoparticles as radiosensitizers for enhancing\ntherapy efficacy in primary tumor and metastatic sentinel lymph nodes, \nACS nano, vol. 16, no. 6, pp. 9428 9441, 2022.\n[42] S. Kawata and O. Nalcioglu, Constrained iterative reconstruction by\nthe conjugate gradient method, IEEE Transactions on Medical Imaging,\nvol. 4, no. 2, pp. 65 71, 1985.\n[43] A. Beck and M. Teboulle, A fast iterative shrinkage-thresholding algorithm for linear inverse problems, SIAM Journal on Imaging Sciences,\nvol. 2, no. 1, pp. 183 202, 2009.\n[44] Y. Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared\nspectroscopy and imaging: a review, Applied Sciences, vol. 9, no. 6, p.\n1127,", "hod, IEEE Transactions on Medical Imaging,\nvol. 4, no. 2, pp. 65 71, 1985.\n[43] A. Beck and M. Teboulle, A fast iterative shrinkage-thresholding algorithm for linear inverse problems, SIAM Journal on Imaging Sciences,\nvol. 2, no. 1, pp. 183 202, 2009.\n[44] Y. Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared\nspectroscopy and imaging: a review, Applied Sciences, vol. 9, no. 6, p.\n1127, 2019.\n[45] H. Y. Ban, G. M. Barrett, A. Borisevich, A. Chaturvedi, J. L. Dahle,\nH. Dehghani, J. Dubois, R. M. Field, V. Gopalakrishnan, A. Gundran\net al., Kernel flow: a high channel count scalable time-domain functional near-infrared spectroscopy system, Journal of biomedical optics,\nvol. 27, no. 7, p. 074710, 2022.\n[46] A. Pifferi, D. Contini, A. D. Mora, A. Farina, L. Spinelli, and A. Torricel", "2019.\n[45] H. Y. Ban, G. M. Barrett, A. Borisevich, A. Chaturvedi, J. L. Dahle,\nH. Dehghani, J. Dubois, R. M. Field, V. Gopalakrishnan, A. Gundran\net al., Kernel flow: a high channel count scalable time-domain functional near-infrared spectroscopy system, Journal of biomedical optics,\nvol. 27, no. 7, p. 074710, 2022.\n[46] A. Pifferi, D. Contini, A. D. Mora, A. Farina, L. Spinelli, and A. Torricelli, New frontiers in time-domain diffuse optics, a review, Journal\nof Biomedical Optics, vol. 21, no. 9, pp. 091 310 091 310, 2016.\n[47] F. Wang, Y. Zhong, O. Bruns, Y. Liang, and H. Dai, In vivo NIRII fluorescence imaging for biology and medicine, Nature Photonics,\nvol. 18, no. 6, pp. 535 547, 2024.\n[48] Z. Zhang, Y. Du, X. Shi, K. Wang, Q. Qu, Q. Liang, X. Ma, K. He,\nC. Chi, J. Tang et al., NIR-", "li, New frontiers in time-domain diffuse optics, a review, Journal\nof Biomedical Optics, vol. 21, no. 9, pp. 091 310 091 310, 2016.\n[47] F. Wang, Y. Zhong, O. Bruns, Y. Liang, and H. Dai, In vivo NIRII fluorescence imaging for biology and medicine, Nature Photonics,\nvol. 18, no. 6, pp. 535 547, 2024.\n[48] Z. Zhang, Y. Du, X. Shi, K. Wang, Q. Qu, Q. Liang, X. Ma, K. He,\nC. Chi, J. Tang et al., NIR-II light in clinical oncology: opportunities\nand challenges, Nature Reviews Clinical Oncology, vol. 21, no. 6, pp.\n449 467, 2024."]}
{"method": "sentence", "num_chunks": 355, "avg_chunk_len": 165.8225352112676, "std_chunk_len": 194.93933920847658, "max_chunk_len": 997, "min_chunk_len": 15, "total_chars": 58867, "compression_ratio": 1.0010702091154637, "chunks": ["PREPRINT VERSION 2025\n\n1\n\n NeuFMT: Optical-Property-Adaptive Fluorescence\nMolecular Tomography via Implicit\nNeural Representation\n\narXiv:2511. 04510v1 [eess. IV] 6 Nov 2025\n\nShihan Zhao, Jianru Zhang, Yanan Wu, Linlin Li, Siyuan Shen, Xingjun Zhu, Guoyan Zheng, Member IEEE,\nJiahua Jiang, and Wuwei Ren\n\nAbstract Fluorescence Molecular Tomography (FMT) is a\npromising technique for non-invasive 3D visualization of fluorescent probes, but its reconstruction remains challenging due to\nthe inherent ill-posedness and reliance on inaccurate or oftenunknown tissue optical properties.", "While deep learning methods\nhave shown promise, their supervised nature limits generalization\nbeyond training data. To address these problems, we propose\n NeuFMT, a self-supervised FMT reconstruction framework that\nintegrates implicit neural-based scene representation with explicit\nphysical modeling of photon propagation. Its key innovation lies\nin jointly optimize both the fluorescence distribution and the\noptical properties ( ) during reconstruction, eliminating the need\nfor precise prior knowledge of tissue optics or pre-conditioned\ntraining data.", "We demonstrate that NeuFMT robustly recovers\naccurate fluorophore distributions and optical coefficients even\nwith severely erroneous initial values (0. 5 to 2 of ground\ntruth). Extensive numerical, phantom, and in vivo validations\nshow that NeuFMT outperforms conventional and supervised\ndeep learning approaches across diverse heterogeneous scenarios.", "Our work establishes a new paradigm for robust and accurate\nFMT reconstruction, paving the way for more reliable molecular\nimaging in complex clinically related scenarios, such as fluorescence guided surgery. Index Terms fluorescence molecular tomography, image reconstruction, optical properties, implicit neural representation,\nfluorescence guided surgery\n\nThe work was supported by Science and Technology Commission of Shanghai Municipality under Grant 25JS2830300 (Wuwei Ren), National Natural\nScience Foundation of China under Grants 62105205 (Wuwei Ren), and\nShanghai Clinical Research and Trial Center (Wuwei Ren). (Corresponding\nauthor: Wuwei Ren.", ")\nShihan Zhao and Jianru Zhang contributed equally to this work. Shihan Zhao, Yanan Wu, Linlin Li and Siyuan Shen are with\nthe School of Information Science and Technology, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: zhaoshh, wuyn1, lill,\nshensy2023@shanghaitech. edu.", "cn). Jianru Zhang and Jiahua Jiang are with the School of Mathematics,\nUniversity of Birmingham, Edgbaston, B15 2QN, United Kingdom (e-mail:\njxz389@student. bham.", "ac. uk; j. jiang.", "3@bham. ac. uk).", "Xingjun Zhu is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail:\nzhuxj1@shanghaitech. edu. cn).", "Guoyan Zheng is with the Institute of Medical Robotics, School of\nBiomedical Engineering, Shanghai Jiao Tong University, Shanghai 200240,\nChina (e-mail: guoyan. zheng@sjtu. edu.", "cn)\nWuwei Ren is with the School of Information Science and Technology,\nShanghaiTech University, Shanghai 201210, China, and also with State\nKey Laboratory of Advanced Medical Materials and Devices, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: renww@shanghaitech. edu. cn).", "I. INTRODUCTION\nFluorescence Molecular Tomography (FMT) has emerged\nas a promising molecular imaging modality, enabling noninvasive 3D visualization of fluorescent probe distribution\nin highly turbid media [1]. Owning to its high sensitivity,\ncost-effectiveness, and non-ionizing radiation, FMT has found\nbroad applications in preclinical research and clinical practice, e.", "g. , brain imaging [2], in vitro cell culture monitoring\n[3] and tumor detection [4]. FMT reconstructs the internal\nfluorescence distribution by measuring the photon distribution\non the object surface and minimizing the discrepancy between\nreal measurements and the simulated results.", "A canonic framework of FMT reconstruction employs an iterative optimization\nstrategy with a forward model typically based on the\nRadiation Transfer Equation (RTE) or the diffusion equation\n(DE) and an inverse model that refines fluorescence distribution prediction until convergence [5], [6]. However, FMT\nreconstruction is inherently ill-posed due to insufficient surface measurements and strong photon scattering effect within\ntissues. Development of high-precision FMT reconstruction\nalgorithms is highly attractive for further improvement of\nthe spatial resolution and detection depth of this technology,\nwhich ultimately broaden the biological applications in drug\ndiscovery [7] and clinical use such as fluorescence guided\nsurgery [8], [9].", "To address the ill-posed nature of FMT reconstruction,\nregularization techniques that incorporate prior knowledge are\napplied. Conventional approaches include Tikhonov (L2 norm)\nregularization for smoothing the results [10], [11], and sparsepromoting regularization (L1 , Lp norm) or total variation (TV)\nregularization for enhancing the spatial resolution [12], [13]. Recent advancements in regularization techniques, such as\nthe solution-decomposition algorithm, utilize an advanced\nstochastic prior model that improves the differentiation of\nfluorescence targets from background interference, thereby\nenhancing reconstruction quality [14].", "While these methods\nstabilize solutions, their reliance on time-consuming iterative\noptimization and idealized assumptions about optical parameters often results in slow convergence and limited accuracy in\nheterogeneous tissues. Deep learning (DL) methods, particularly en-decoder-based neural networks [15] [21] and graphbased networks [22] [24], have recently been used in FMT\nreconstruction by learning direct mappings from boundary\nmeasurements to fluorescence distributions. These approaches\n\n2\n\nencode physical priors within network parameters, enabling\noverwhelmingly rapid inference.", "However, their dependence\non supervised training with large, scenario-specific datasets restricts generalizability across variable experimental conditions\n(e. g. , tissue object geometry and optical properties), leading\nto significant accuracy degradation when the object properties\ndeviate from training assumptions.", "Recently, implicit neural representation (INR) models have\nemerged as a powerful alternative for medical image reconstruction. By mapping arbitrary spatial coordinates to certain\nunknown physical quantities via a coordinate-based multilayer perceptron network (MLP), INRs achieve continuous\n3D representations, self-supervised training, and memory efficiency. Originally popularized in computer vision and medical imaging, INRs have demonstrated remarkable success\nin modalities such as computed tomography (CT), magnetic\nresonance imaging (MRI) [25] [29], and notably in diffuse\noptical tomography (DOT), where INR has been proven to be\nable to capture a high-resolution, continuous optical absorption\nmap that account for light scattering in complex tissues [30].", "INR captures continuous spatial information and integrates\nphysical priors makes it particularly suited for various imaging problems. In the context of FMT, preliminary work has\nexplored position encoding strategies to enhance spatial resolution and improve the quality of FMT reconstructions [31]. Nevertheless, systematic studies integrating optical diffusion\nphysics within an INR framework remain scarce.", "This gap\npresents an opportunity to harness the strengths of implicit\nmodeling for robust and data-efficient FMT reconstruction. To bridge this gap, we propose neural-field-based FMT, or\nNeuFMT, a physics-driven reconstruction framework unifying\nINR with explicit physical models. Unlike conventional DLbased FMT reconstruction algorithms that couple explicit\nfluorescence predictions to implicit physical model, NeuFMT\nintegrates the DE-based forward model in the network loss,\nenabling self-supervised training without paired data.", "The\ndifferentiability of the forward model is achieved via finite\nelement method (FEM). This inversion-free approach ensures\nrapid, continuous reconstruction across diverse geometries\nwhile inherently addressing scattering effects. Another critical\nlimitation of both traditional and DL methods lies in the\npresumed optical properties of the object during reconstruction, which largely aggravate the ill-posedness of the inverse\nproblem given the optical parameters were initially biased.", "To\novercome this, we further introduce optical-property-adaptive\nNeuFMT, or NeuFMT, an adaptive extension of NeuFMT\nthat dynamically optimizes scattering / absorption coefficients\nand fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations, NeuFMT achieves robust accuracy even when provided\nwith erroneous initial guess of the optical coefficient values,\naddressing the problem of unrealistic assumption prior to\nFMT reconstruction. Both proposed INR-based FMT reconstruction algorithms were thoroughly compared and validated\nby simulations and phantom experiments along with other\nmethods.", "Furthermore, in vivo lymph node imaging in mice\nwas performed, further demonstrating the advantages of the\nproposed methods. PREPRINT VERSION 2025\n\nII. M ETHODS\nA.", "Forward Modeling of FMT\nModel-based FMT reconstruction comprises two fundamental steps: forward modeling and inversion. The former predicts\nsurface photon density measurements based on an assumed\nfluorescence distribution. At the macroscopic scale, we employ\nthe first-order approximation of the radiative transport equation (RTE), known as the diffusion equation (DE) [32].", "The\nexcitation and fluorescence emission processes in continuouswave (CW) mode form a coupled pair of DEs expressed as\n[33], [34]:\n κ ϕx (r) + a ϕx (r) = qx (r),\n\nr , (1)\n\n κ ϕm (r) + a ϕm (r) = η C(r) ϕx (r),\n\nr , (2)\n\nwhere ϕx and ϕm denote the excitation and emission photon\ndensity, qx is the excitation source, C(r) is the fluorophore\nconcentration to be reconstructed in the inversion, and η\ncollects quantum-yield factors in the CW source term. κ\nrepresents the diffusion coefficient, calculated by [33]\n1\n,\n(3)\nκ=\n3 ( a + s )\nwith the absorption coefficient a and the reduced scattering\ncoefficient s . In a non-contact setting of FMT, to calculate\nthe value of ϕ (r) on the object surface as the measurement, a Robin-type boundary condition is added alongside the\nequation pair (1 2):\n ϕ (r)\n= 0, {x, m}, r , (4)\n ν\nwhere ζ(c) is the refractive index mismatch parameter that\naccounts for the light reflection on the boundary surface, with\nc representing the light speed inside the medium.", "ν denotes\nthe outward normal on the boundary. Notably, to simplified the\nproblem setting, we only consider a homogeneous medium\ncase and the difference of a , s values under different\nwavelengths are neglected. ϕ (r) + 2 ζ(c) κ\n\nB.", "Finite Element Discretization and System Matrix Construction\nWe apply the finite element method (FEM) [35] to the\ndiffusion model (1) - (4). Discretizing with a tetrahedral\nN\nmesh of N\ni }i=1 , we approximate\nP nodes and nodal basis {ψP\nϕ (r) i Φ ,i ψi (r) and qx (r) i (Qx )i ψi (r), which\ntransforms the continuous-form equations into a linear system\nfor excitation and emission photon propagation:\nS Φx = Qx\n\n(5)\n\nS Φm = Qm\n\n(6)\n\nwhere S RN N is the system matrix and Φ , Q RN\nare discretized form (coefficient vectors) for ϕ and q , respectively. In particular, the excitation field ϕx interacts with\nfluorophores C RN to produce the emission source term\nQm = C Φx\n\n(7)\n\nwith denoting element-wise multiplication.", "The equation\n(7) physically describes how fluorophores absorb excitation\n\nZHAO et al. : NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nexplicitly reveals the functional dependence of S on the\noptical parameters a and s , which forms the mathematical\nfoundation for our adaptive optimization approach introduced\nin Subsection II-C. (b)\n\n(a)\n\n3\n\nCamera\nFilter Wheel\nReal Measurement\nSample\n\nC.", "INR-based FMT reconstruction: NeuFMT / NeuFMT\nScanners\n\nLaser\nPredicted\nMeasurement\n\nFocal Lens OD Filter\n(c)\n\n(d)\n\nAdaption Module\n\nForward Model\nBased on DE\n\nAbsorption Term\nHigh Absorption\n\nLow Absorption\n\ninv\nDi usion Term\n\nHigh Scattering\n\nSti ness Matrix\n\nLow Scattering\nBoundary Term\n\n(e)\n\nForward Data\nBackward Gradient\n\nFluorescence Distribution Encoded with INR\nNode Coordinate\n\n3D Mesh with\n\nNodes\n\nsine\n\ncosine\n\nPositional\nEncoding\n\nMLP\n\nFig. 1. Conceptual illustration of NeuFMT.", "(a) The FMT setup: a scanned\nlaser illuminates the sample while a CMOS camera with filter wheel on the\nopposite side records boundary images. The raster scanning method yields\nthe raw 2D image stack M real , serving as the input to the subsequent FMT\nreconstruction. (b) The difference between M real and the simulated meac( a , , Cθ ) is iteratively minimized until an optimized value\nsurement M\ns\nof unknown fluorescence distribution C is found.", "R(C) is a regularization\nterm and { a , s } is the intrinsic optical properties consisting of\nabsorption coefficient a and scattering coefficient s . (c) A -adaption\nmodule is integrated into the FMT reconstruction. The stiffness matrix S is\ndetermined by both a and s .", "(d) The FEM-based simulator predicts virtual\nc( a , , Cθ ) based on the operator S 1 ( ) and predicted\nmeasurement M\ns\nfluorescence distribution C. (e) Fluorescence distribution encoded in an INR. 3D node coordinate serves as input, while a continuous C map is generated\nthrough positional encoding and an MLP network.", "Unlike traditional voxel-based or mesh-dependent representations, INR provides a continuous, memory-efficient framework for modeling complex physical fields. The basic variant,\nNeuFMT, learns only the fluorophore Cθ with fixed optical\nproperties; the proposed adaptive NeuFMT jointly optimizes\nthe optical coefficients ( a , s ) with Cθ for enhancing the\nreconstruction accuracy and robustness. In this section, we\ndescribe the NeuFMT representation, formulate the learning\nobjective, introduce optical-property adaptation, and summarize the network architecture and implementation.", "1) INR representation of the unknown fluorescence: Our\n NeuFMT model the 3D fluorescence field as an INR, i. e. , a\ncoordinate-conditioned MLP:\n\nCθ (r) = fθ Γ (r) ,\n(10)\nwhere r = (x, y, z) R3 , Γ : Rd is a highdimensional positional encoding of spatial coordinates, and\nfθ : Rd R is an MLP with parameters θ.", "This INR formulation (10) enables resolution-independent reconstruction and\nnaturally accommodates arbitrary spatial queries without being\nconstrained by the conventional discrete grid structure. To enhance the network s ability to represent high-frequency\ndetails, which is crucial for resolving complex in vivo fluorescence patterns, we apply a sinusoidal positional encoding to\neach coordinate component. Let γ : R R2L be\nγ(p) = sin(20 πp), cos(20 πp), ,\nL 1\n\nsin(2\n\nπp), cos(2\n\nL 1\n\n(11)\n\nπp) ,\n\np {x, y, z},\n\nphotons and re-emit light at longer wavelengths.", "The emission\nsource Qm then propagates through the same medium to\nproduce the emission photon density Φm , which is finally\ndetected at the boundary, which is computed as\n\nwhere L is the number of frequency bands. The\n 3D position\nis then encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that\nd = 6L. Feeding Γ (r) into fθ enables compact representation\nof both low- and high-frequency variations in Cθ .", "2) Learning objective: We estimate the fluorescence field\nCθ and, in NeuFMT, the optical properties { a , s } by\nminimizing a data-fidelity term plus regularization:\n\nM = P Φm\n\nc( a , , Cθ ) M real 2 + λ R(Cθ ), (12)\nL( a , s , θ) = M\ns\n2\n\n(8)\n\nwhere P represents the transfer function, which maps the\nboundary photon density Φm the measurement data M acquired by the camera. The above linearized forward model\nprovides the physical foundation for the inversion procedure. Crucially, the SPD FEM stiffness matrix S( a , s ) \nN N\nR\nin (5) (6) encode the optical properties and boundary\ngeometry, generating from a linear combination of matrices\ncorresponding to distinct physical components [33], [36]\n\n1\n\n Sd + Sb .", "(9)\nS( a , s ) = c a Sa +\n3( a + s )\nwith Sa , Sd , and Sb the assembled absorption, diffusion, and\nRobin-boundary matrices, respectively. This decomposition\n\nc denotes the boundary measurements, and R(Cθ ) is\nwhere M\na regularization term applied to the fluorescence distribution. The hyperparameter λ controls the regularization strength,\nbalancing data fidelity with sparsity constraints.", "The training of\n NeuFMT / NeuFMT follows a fully self-supervised paradigm\nthat explicitly integrates the DE-based physical model into\nthe optimization loop. Note that NeuFMT uses fixed optical\nparameters ( a , s ), whereas NeuFMT updates jointly. 3) Alternating optical-property adaptation: A fundamental\ninnovation of NeuFMT lies in formulating the entire photon propagation process from excitation to emission as an\nend-to-end differentiable map.", "The forward model follows a\n\n4\n\nPREPRINT VERSION 2025\n\nprecise physical sequence from excitation source to surface\nmeasurements, as described in Subsection II-B:\n\nc( a , s , Cθ ) = P S( a , s ) 1 Cθ S( a , s ) 1 Qx ,\nM\n(13)\nWe optimize the introduced objective L( a , s , θ) in (12),\njointly updating network parameters θ and optical coefficients\n( a , s ). The chain in (13) contains only differentiable operations, including linear solves, elementwise products, and linear\nc is differentiable w. r.", "t. both Cθ (hence θ)\nprojections. Thus M\n\nand ( a , s ), enabling standard gradient-based training.", "For\ncompleteness, we state the chain-rule decomposition of the\nloss gradient with respect to ( a , s ). Based on (13), the\ngradient splits into an emission term and an excitation term:\n\nc \n S\n L M\n L\n S 1\n=\nΦm +\nc Φm\n\n{z\n}\n| M\nEmission pathway\n\nc Φm Qm \n L M\n S\nΦx\n S 1\nc Φm Qm Φx\n\n| M\n{z\n}\n\n(14)\n\nExcitation pathway\n\n { a , s }. The only model-specific ingredient of a and s is the\nJacobian of S( a , s ).", "According to (9), the partial derivatives\nare\n\n S\n1\n= c Sa \nSd ,\n a\n3( a + s )2\n\n S\n1\n=c \nSd . (15)\n s\n3( a + s )2\nThis allows a and s to be optimized directly using gradient\ndescent, and then be updated together with θ, bridging the\nlearning process with the underlying physical model. To mitigate potential coupling effects between a and s\nduring optimization, we propose an alternating update strategy,\nwhich periodically updates one optical parameter with the\nother fixed.", "The alternating framework largely promotes training stability to avoid oscillations with sufficient computational\nefficiency. The complete NeuFMT algorithm is described in\nAlgorithm 1. Overall, the alternating -adaption module ensures that each optical parameter receives dedicated optimization attention while maintaining the physical consistency of\nthe forward model, yielding more accurate FMT reconstruction\nresults even in the presence of mismatch between the initial\nguess and ground truth of the optical properties.", "4) Network architecture and implementation: We adopt\nMLP for the NeuFMT / NeuFMT, comprising 8 fullyconnected layers with 512 hidden units each, followed by\na final layer with 128 units. ReLU activation functions are\nemployed throughout the network. A critical skip connection\nbridges the input Γ (r) to the 4th hidden layer, facilitating\ngradient flow and enhancing the ability to learn fine-grained\ndetails.", "This architectural choice is particularly suited for FMT\napplications where accurately reconstructing high-contrast targets against complex backgrounds is essential. We implement the NeuFMT / NeuFMT framework with\nPyTorch, leveraging its automatic differentiation capability to\n\ncompute the gradient through both MLP and the physical\nmodel. Adam optimizer is used with the initial learning rates\nof 10 4 for θ update, 10 3 for scattering coefficient and\n10 5 for absorption coefficient.", "To improve the computational\nefficiency, a learning rate decay is applied for MLP update. These rates are determined empirically to ensure stable convergence. The L1 regularization parameter λ is set to 10 6\nbased on cross validation.", "The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality,\nwith the entire process completing within 3 30 minutes on\na single NVIDIA RTX 3090 GPU for problems of varying\nscales. The FEM discretization is built on TOAST++ toolkit\n[37], and the FMT simulation is based on a modular software\nplatform STIFT [38] in MATLAB (R2024b, MathWorks, MA,\nUS) using a desktop computer (Intel Core i5-12600 CPU @\n3. 30 GHz, 128 GB RAM).", "Algorithm 1 NeuFMT\nRequire: Real measurements M real , light speed c, stepsizes\nαθ , αa , αs , alternation period T , total iterations K\n1: Initialize θ, a , s ;\n2: Precompute Sa , Sd , Sb , Qx , P\n3: Compute S via (9);\n4: for i = 1 to K do \n5:\nC = fθ Γ (r)\n6:\nSolve Φx RN satisfying S Φx = Qx\n7:\nQm = C Φx\n8:\nSolve Φm RN satisfying S Φm = Qm\nc = P Φm\n9:\nCompute predicted measurements: M\nreal 2\nc\n10:\nCompute loss: L = M M 2 + R(C)\n11:\nUpdate MLP parameters: θ = θ αθ L\n θ\n12:\nif i mod\n T = 0 then\n13:\nif i/T is even then\n L\n14:\nUpdate absorption: a = a αa \na\n15:\nelse\n L\n16:\nUpdate diffusion: s = s αs \n\ns\n17:\nend if\n\n1\n18:\nUpdate S = c a Sa +\nS\n+\nS\nd\nb ;\n3( a + s )\n19:\nend if\n20: end for\n21: Output: fluorescence C, optical parameters a , s\n\nD. FMT System Setup\nWe devised a continuous-wave (CW) FMT system\n(SHMOT) [39], [40] as depicted in Fig. 1 (a), which incorporates a 16-bit CMOS camera (Edge 4.", "2, PCO, Germany) with\n2048 2048 pixel resolution and a filter wheel (FW102C,\nThorlabs, NJ, US) for selective wavelength detection. A\ntunable laser source (SuperK EXTREME, NKT, Denmark),\nspanning 400-890 nm, provides fluorescence excitation with a\npower density of approximately 2 mW/mm2 at the sample\nplane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube, Germany) mounted aside steers\nthe laser beam to raster-scan either the top or bottom object\n\nZHAO et al.", ": NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nsurface, enabling switchable reflection-/transmission-mode detection. During experiments, the camera exposure time was\nfixed at 500 ms, with pixel binning applied to improve the\nsignal-to-noise ratio. The acquired raw 2D image data serve\nas supervision target for NeuFMT / NeuFMT reconstruction\n(Fig.", "1 (b)). It worth mentioning that our FMT system also\nintegrates a programmable line-scanning illumination, which\nenables high-precision extraction of the surface geometry\nwith approximated maximum error of 0. 1 mm.", "The extracted\nsurface information is then leveraged as prior knowledge for\nFEM meshing and improving reconstruction accuracy. E. Phantom preparation and optical calibration\nIn our validation, the slab phantomswere cast from silicone (SYLGARDTM 184; DOW, CA, USA) to emulate softtissue matrix.", "Optical properties were tuned by dispersing\ntitanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon\nblack powder (Colins, Shanghai, China) as scattering and\nabsorbing additives, respectively. In all phantoms, TiO2 and\ncarbon black were uniformly distributed. All the designs\nshown in Fig.", "4 (a) used the same TiO2 /carbon-black mixing\nratio, yielding isotropic media with identical absorption and\nscattering parameters. F. In Vivo Lymph Node FMT Imaging\nFollowing numerical simulations and phantom experiments,\nwe evaluated the proposed method in vivo in a murine lymph\nnode imaging task.", "In cancer diagnostics, lymph node metastasis is a key prognostic indicator of tumor progression. Fluorescence imaging enables rapid screening of sentinel lymph\nnodes [41]. In our experiment, all animal procedures were approved by\nthe Institutional Animal Care and Use Committee of ShanghaiTech University (Approval No.", "20211115001). 5 female\nBALB/c mice (8 weeks old) were obtained from Shanghai\nJihui Laboratory Animal Breeding Co. Ltd.", "and housed under\na circadian rhythm of 12 hours of day and night alternation. Before taking imaging experiments, fur was removed over the\nwhole body. For FMT reconstruction, we assumed an optically\nhomogeneous medium with properties calibrated during the\nexcitation step with ( a = 0.", "0055 mm 1 , s = 1. 1 mm 1 ). We followed a three-stage protocol fluorescent-dye injection, imaging, and ex vivo validation.", "Prior to FMT imaging, Cy5-saline solution (1. 2146 mol mL 1 , 40 L) was injected subcutaneously into the left forepaw to drive lymphatic\ndrainage toward the sentinel lymph nodes and create a highintensity target. Next, follow-up FMT measurements were\nacquired using the system setup in Subsection II-D.", "Finally,\nafter data collection, ex vivo verification was performed using\na fluorescent stereoscopic microscope (MVX10, Olympus,\nJapan; 6. 3 objective). Illumination was provided by a heightadjustable 630 nm LED at 20 mW cm 2 .", "White-light and\nCy5-channel fluorescence images were recorded using filters\nmatched to the Cy5 spectrum, and the lymph nodes were\nidentified, excised, and imaged to validate the in vivo findings. 5\n\nIII. R ESULTS\nA.", "Convergence Verification of Optical Property Adaptive\nOptimization\nTo validate our proposed optical property adaptation mechanism, we conducted a series of numerical experiments on\na digital phantom. The primary objective was to demonstrate\nthat the -adaption module can robustly recover absorption a\nand s coefficients from severely erroneous initial estimates,\nthereby enabling high-fidelity fluorescence reconstruction. We constructed a homogeneous digital slab phantom of size\n55 55 15 mm3 featuring an S -shaped fluorescent target at\nits geometric center.", "The ground-truth optical properties were\n 1\nset to true\nand s true = 1. 0 mm 1 . To rigorously\na = 0.", "1 mm\ntest the correction capability, we initialized the reconstruction\nwith significantly mismatched scattering coefficients ( s init =\n0. 5, 1. 5, 2.", "0 mm 1 ) while keeping the absorption coefficient\nfixed at its true value for this specific test. As summarized in Fig. 2 (a), without the -adaption module, the reconstructed fluorescence distributions suffered from\nsubstantial errors in both depth localization and morphological accuracy.", "The mismatched s value led to an incorrect\nmodel of photon propagation, which directly translated to\ndistorted reconstructions. In contrast, when the -adaption\nmodule was enabled, the proposed NeuFMT successfully\nrecovered fluorescence distributions that closely matched the\nground truth obtained with the correct optical properties. Crucially, the evolution of the scattering coefficient during\noptimization, plotted in Fig.", "2 (b), demonstrates the module s\nrobust convergence. Regardless of the initial value whether\nhalved or doubled the estimated s reliably converged to the\nneighborhood of the true value (1. 0 mm 1 ).", "A similar convergence behavior was observed for the absorption coefficient a . When initialized with biased values\n 1\n( init\n) against a fixed true s , the a = 0. 05, 0.", "15, 0. 2 mm\nadaption module corrected a with an average error of only\n1. 5% (Fig.", "2 (d)), and its convergence curves are shown in\nFig. 2 (e). This convergence robustness was maintained across\na range of true a and s values, confirming the general\nefficacy of our alternating optimization strategy in mitigating\nparameter coupling (Fig.", "2 (c), (f)). We further extended the validation to the most challenging\nscenario, where both optical parameters were simultaneously\ninitialized with substantial errors. In this experiment, the initial\nvalues for both a and s were set to 50% higher than\ntheir GT values.", "Remarkably, even under these highly adverse\nconditions, the -adaption module successfully drove both\nparameters towards their true values. The convergence trajectories remained stable and ultimately reached a neighborhood\nof the true parameter pair. These results collectively verify\nthat the integrated -adaption module empowers NeuFMT\nto jointly recover accurate optical properties and fluorescence\ndistributions even from profoundly inaccurate initial guesses,\neffectively addressing a critical source of ill-posedness in\npractical FMT scenarios.", "6\n\nPREPRINT VERSION 2025\n\n0. 995\n\n1. 0\n\n0.", "996\n\n1. 5\n\n1. 007\n\n2.", "0\n\n1. 006\n\nGT\ny\nx\n\nDICE =\n0. 0257\n\n0.", "7337\n\n0. 4660\n\nNorm. int (a.", "u. )\n\n= 1. 0\n= 0.", "1\n\nNon-Adaptive\n\n1\n\n0. 3967\n\n(b)\n\n1. 2\n1.", "0\n\n(c)\n\n1. 6\n\nAdaptive\n\ny\n\n0. 7198\n\n0.", "7230\n\n0. 6964\n\nNorm. int (a.", "u. )\n\nz\n\n0. 7796\n\n 0.", "9\n 0. 8\n 0. 5\nAsym.", "Line\n\n0. 8\n0. 4\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n14\n\n 0.", "12\n 0. 11\n\n1. 4\n\nPredicted\n\nz=8\n\n 2.", "0\n 1. 5\n 1. 2\n 1.", "1\n\n1. 6\n\n0\n1\n\n2. 0\n\nPredicted\n\n0.", "5\n\n(a)\n\n 0. 10\n 0. 09\n\n1.", "2\n\n 0. 08\n1. 0\n\n0\n\nAsym.", "Line\n1\n\n2\n\n4\n\n8\n\n16\n\n32\n\n64\n\niterations\n0. 10\n\n0. 100\n\n0.", "15\n\n0. 101\n\n0. 20\n\n0.", "102\n\ny\nx\n\n0. 0281\n\n0. 7337\n\n0.", "7390\n\nNorm. int (a. u.", ")\n\nGT\n\n0. 5991\n\nz=8\nz\n\nAdaptive\n\ny\n\n0. 6718\n\n0.", "7642\n\n0. 8740\n\n0. 8708\n\n(e)\n\n0.", "2\n\n= 1. 0\n= 0. 1\n\nGT\n\n 0.", "11\n 0. 09\n\n0. 12\n0.", "1\n0. 08\n\n0\n\n0. 04\n\n1\n\n(f) 0.", "16\n0. 14\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n 0. 08\n 0.", "05\nAsym. Line\n\n14\n\n 1. 2\n 1.", "1\n 1. 0\n 0. 9\n\n0.", "12\n\n 0. 8\n0. 1\n\n0\n\n(g)\n\n 0.", "20\n 0. 15\n 0. 12\n\n0.", "16\n\nNorm. int (a. u.", ")\n\n= 1. 0\n= 0. 1\n\nNon-Adaptive\n\n1\n\nPredicted\n\n(d)\n\n0.", "097\n\nPredicted\n\n0. 05\n\nAsym. Line\n1\n\n2\n\n4\n\n8\n\n16\n\n32\n\n64\n\niterations\n2000 iters\n\n5000 iters\n\n10000 iters\n\n20000 iters\n1\n\ny\n\n(h)\n\n1.", "6\n\n0. 16\n\n1. 4\n\n0.", "14\n\n1. 2\n\n0. 12\n\n1.", "0\n\n0. 1\n\n0. 8125\n\n0.", "8651\n\n0. 8691\n\nz\ny\n\n= 1. 5\n= 0.", "15\n\n1. 333\n0. 1332\n\n1.", "177\n0. 1156\n\n1. 050\n0.", "1045\n\n1. 001\n0. 0995\n\n0\n\n0.", "8\n\n2\n\n5\n\n8\n\n11\n\n14\n\n17\n\nPredicted\n\n0. 6481\n\nNorm. int (a.", "u. )\n\nz=8\n\nPredicted\n\nx\n\n0. 08\n20\n\niterations\n\nFig.", "2. Ablation test for the optical-property-adaption ( -adaption) module in NeuFMT. (a-c) Effective test for the correction of s .", "(a) For a homogeneous\nphantom simulation with a S -shaped fluorescence inclusion, the ground truth (GT) of a and s values are 0. 1 mm-1 and 1. 0 mm-1 respectively.", "A\nmismatched initial guess of s was assumed for FMT reconstruction. The -adaption module successfully corrects s with an average error of 0. 55%,\nleading to significantly improved FMT reconstruction results compared to non-adaptive NeuFMT.", "(b) Convergence curve of s given more initial s values\nranging from 0. 5 to 2 GT value under the same setting of (a). (c) Convergence curve of s value across all cases with different a values, given\ninitial s = 1.", "5 mm-1 . (d-f) Effective test for the correction of the absorption coefficient ( a ). (d) For the same phantom in (a), a (mismatched) a initial\nvalue is assumed for FMT reconstruction.", "The -adaption module successfully corrects a with an average error of 1. 5%, leading to significantly improved\nFMT reconstruction results. (e) Convergence curve of a given more initial a values ranging from 0.", "5 to 2 GT value under the same setting of (d). (f) Convergence curve of a value across all cases with different s values, given initial a = 0. 15 mm-1 .", "(g-h) Effective test for the correction of both\nabsorption and diffusion coefficients. (g) For the same phantom in (a), given mismatched initial a = 1. 5 and s = 0.", "15, both of which are 50% higher than\nGT, the -adaption module successfully corrects both a and s at the same time. (h) Convergence curve given the iteration process in (g) for both optical\ncoefficients. B.", "Numerical Simulations\nTo comprehensively evaluate the performance of the proposed NeuFMT under controlled conditions, we designed\nfour distinct numerical phantoms (Fig. 3 (a) (d) respectively)\nto systematically increase the reconstruction challenge:\n Case 1 - single small target: a 3 mm-diameter spherical\nfluorescence target embedded in a homogeneous cuboid\nphantom (55 55 15 mm3 ), serving as a baseline\nfor evaluating localization and quantitative accuracy of\na simple, isolated inclusion. Case 2 - complex surface geometry: a 2 mm-diameter\nspherical target inside a phantom with a curved surface\ngeometry, featuring a spherical cap top (base: 50 50 4\nmm, cap height = 5 mm, total height = 9 mm).", "This\ncase tests the method s robustness to non-planar surface\ntopography. Case 3 - complex target shape: a large peanut-shaped fluorescence region with uniform concentration embedded in\na standard cuboid phantom same as Case 1. This scenario\nassesses the capability to recover intricate morphological\ndetails beyond simple spheres.", "Case 4 - multi-target with background: the same peanutshaped region as in Case 3, but with the addition of\na small, high-concentration spherical target inside. This\nrepresents a highly realistic and challenging condition,\ntesting the ability to resolve targets of different concentrations and shapes against a noisy background. The ground-truth optical properties for all simulated measurements in this test were set to a = 0.", "1 mm 1 and s = 1. 0\nmm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against\nfour established methods: conventional Tikhonov-regularized\n\nZHAO et al.", ": NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nGT\n\nL2-CG\n\nL1-FISTA\n\nU-Net\n\nNeuFMT\n\nμNeuFMT\n1\n\ny\nx\n\ny\n\nz\n\nDICE =\n0. 6581\n\nz=8\n\n0. 4956\n\n0.", "6446\n\nNorm. int (a. u.", ")\n\nCase 1\n\n(a)\n\n0. 8800\n\n0. 5128\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.", "6286\n\nz=2\n\n0. 7500\n\n0. 0000\n\nNorm.", "int (a. u. )\n\nCase 2\n\n(b)\n\n1\n\n0.", "7586\n\n0. 2041\n\n0\nz\n\ny\nx\n\nx\n\ny\n\nz\n\nz=8\n\n0. 6938\n\n0.", "0828\n\n0. 6153\n\nNorm. int (a.", "u. )\n\nCase 3\n\n(c)\n\n1\n\ny\n\n0. 9751\n\n0.", "4766\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0. 5435\n\nz=8\n\n0. 5908\n\n0.", "2637\n\nNorm. int (a. u.", ")\n\nCase 4\n\n(d)\n\n1\n\n0. 8983\n\n0. 7645\n\n0\nz\n\ny\nx\n\nNorm.", "int (a. u. )\n\n(e)\n\nCase 1\n\nCase 2\n\nCase 3\n\nCase 4\n\n1\n\n1\n\n1\n\n1\n\n0.", "8\n\n0. 8\n\n0. 8\n\n0.", "8\n\n0. 6\n\n0. 6\n\n0.", "6\n\n0. 6\n\n0. 4\n\n0.", "4\n\n0. 4\n\n0. 4\n\n0.", "2\n\n0. 2\n\n0. 2\n\n0\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n0\n15\n\n0\n20\n\n25\n\n30\n\nmm\n\nGT\n\nL2-CG\n\n35\n\n0.", "2\n0\n\n10\n\nmm\n\nL1-FISTA\n\n20\n\n30\n\n40\n\n50\n\n0\n\n15\n\n20\n\n25\n\n30\n\n35\n\nmm\n\nU-Net\n\nNeuFMT\n\n40\n\nmm\n\nμNeuFMT\n\nFig. 3. Results of numerical phantom simulations.", "(a) (d) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (e) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.", "conjugate gradients (L2 -CG) [42] and L1 -regularized nonnegative least squares (L1 -FISTA) [43], a pretrained supervised U-Net, and our baseline method NeuFMT without adaption. The U-Net was trained on a large, synthetically\ngenerated dataset of 5,488 samples. For each sample, the\ninput was a boundary measurement simulated using the DEbased forward model under the ground-truth properties in a\ncuboid phantom (55 55 15 mm3 ), and the label was the\ncorresponding 3D fluorescence map of 1 2 ellipsoids with\nrandom sizes and spatial positions.", "To clearly demonstrate the\neffect of the -adaption module, we focused on adapting s\nwhile fixing a at its true value during reconstruction. For all\nmethods, the initial s was set to an erroneous value of 1. 2\nmm 1 , which is 20% higher than the ground truth.", "The results presented in Fig. 3 (a) (d) demonstrate the\nconsistent superiority of NeuFMT across all four numerical cases. We observe that the conventional methods were\nadversely affected by the optical property mismatch: L2 -CG\nreconstructions were characteristically blurred and exhibited\nsignificant depth errors, such as full-depth penetration in\nCases 3 and 4 and depth-wise expansion in Case 1.", "L1 -FISTA\nfrequently introduced non-physical, fragmented artifacts, such\nas staircase patterns in Case 1 and hollow structures in Case 3,\nwhile it also suffered from severe depth inaccuracy. The\nsupervised U-Net, though performed well in Case 1, showed\nlimited generalization beyond its training data, as seen in its\nlocalization failure in the complex surface geometry of Case 2\n\n7\n\nand noticeable shape distortion in the unseen peanut-shaped\ntarget of Case 3 and 4. The direct NeuFMT provided better\ndepth prediction than the traditional methods but remained\nsensitive to the erroneous s , resulting in substantial shape\nexpansion in the x-y plane (Cases 1, 2) and axial splitting\n(Case 3).", "In contrast, NeuFMT successfully rectified the\noptical properties and overcame these limitations. It achieved\nthe most accurate spatial localization and shape fidelity, as\nevidenced by its 3D isosurfaces tightly conforming to the\nground truth in both simple and complex targets, and it clearly\nresolved both the small target and the complex background in\nCase 4. Quantitatively, NeuFMT consistently achieved the\nhighest Dice coefficients, and its intensity profiles (Fig.", "3 (e))\nmost closely matched the ground truth in terms of peak\nlocation, width, and background suppression. C. Phantom Experiments\nWe further evaluated the performance of all methods using\nphysical phantom experiments to assess their practicality under real-world conditions, including measurement noise.", "The\nphantoms were fabricated from silicone, with their optical\nproperties calibrated to be approximately a = 0. 0055 mm 1\nand s = 1. 1 mm 1 at 680 nm.", "Fluorescent targets were embedded within the phantoms to create the four cases previously\ndefined in the simulations. The initial value of s was set identically for all reconstruction methods as the calibrated value,\nand also the U-Net was retrained accordingly. Consistent with\nthe simulation study, we focused on the adaptive recovery of\nthe reduced scattering coefficient s .", "The reconstruction results are summarized in Fig. 4. Under\nthese challenging real-world conditions, the limitations of the\nbaseline methods became evident: conventional approaches\n(L2 -CG, L1 -FISTA) produced blurry or fragmented reconstructions with significant depth errors, while the supervised\nU-Net, susceptible to domain shift and noise, failed to generalize, resulting in complete localization failures (Case 1)\nor severely distorted shapes (Cases 3 and 4).", "In contrast,\nthe INR-based frameworks, NeuFMT and NeuFMT, demonstrated markedly superior robustness, consistently yielding\nphysically plausible and continuous reconstructions where\nother methods failed. A detailed comparison between the two\nreveals that NeuFMT provided critical refinements toward\nenhanced physical consistency. In Cases 1 and 3, NeuFMT\nachieved better depth sensitivity and more uniform fluorophore\ndistribution, more faithfully representing the homogeneous\nnature of the true targets.", "In the complex geometry of Case 2,\nit uniquely achieved accurate localization, whereas direct\nNeuFMT produced a solution with an aberrant depth shift. For\nthe multi-target scenario in Case 4, NeuFMT reconstructed\nthe background region with improved morphological accuracy. Although the performance gap in quantitative metrics such\nas the Dice coefficient was occasionally narrow, which reflects the inherent robustness of the shared INR architecture,\n NeuFMT provided consistent, subtle refinements, particularly\nin depth accuracy.", "The phantom experiments confirm that the\nadaptive physical correction mechanism in NeuFMT can enhance reconstruction fidelity under practical conditions where\nthe exact coefficient in most real experiments is uncertain. 8\n\nPREPRINT VERSION 2025\n\n(a)\n\nSilicone Phantoms\nGT\n\nL2-CG\n\nL1-FISTA\n\nU-Net\n\nNeuFMT\n\nμNeuFMT\n1\n\ny\nx\n\ny\n\nz\n\nDICE =\n0. 5895\n\nz=8\n\n0.", "6154\n\n0. 0762\n\nNorm. int (a.", "u. )\n\nCase 1\n\n(b)\n\nFluorescence Inclusions\n\n0. 7023\n\n0.", "6615\n\n0\nz\n\n(Fig. 5 (c)). The reconstructed target lengths from NeuFMT\nshowed the closest agreement with the physical measurements\ntaken from the ex vivo lymph nodes, as visualized by the\nintensity profiles in Fig.", "5 (c). These results demonstrate that\n NeuFMT provides a definitive advantage in practical in vivo\nscenarios, enabling robust and accurate target segmentation\nand localization under complex clinically related scenarios,\nsuch as fluorescence guided surgery. y\nx\n\ny\nx\n\ny\n\nz\n\n0.", "3371\n\nz=2\n\n0. 3810\n\n0. 4000\n\n0.", "5200\n\n0. 2586\n\nWhite Light Image\n\n(a)\n\nvein\n\nLN-2\n\n0\nz\n\ny\nx\n\ny\n\nz\n\nz=8\n\n0. 5413\n\n0.", "3358\n\n0. 7011\n\n0. 8230\n\n0.", "8050\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0. 5193\n\nz=8\n\n0. 4319\n\n0.", "6601\n\n0. 2849\n\nNorm. int (a.", "u. )\n\n0. 6240\n\nNeuFMT\n\nμNeuFMT\nz\nx\n\nvein\n\nLN-3\nLN-2\nLN-1\n\nCase 3\n\nCase 4\n\n1\n\n1\n\n0.", "8\n\n0. 8\n\n0. 6\n\n0.", "6\n\n0. 6\n\n0. 6\n\n0.", "4\n\n0. 4\n\n0. 4\n\n0.", "4\n\n0. 2\n\n0. 2\n20\n\n25\n\n30\n\n35\n\n40\n\n0\n15\n\n0.", "2\n20\n\n25\n\n30\n\nmm\n\nGT\n\nL2-CG\n\n35\n\n0. 2\n\n0\n\n0\n0\n\n10\n\nmm\n\nL1-FISTA\n\n20\n\n30\n\n40\n\n50\n\n15\n\n20\n\n25\n\n30\n\n35\n\nmm\n\nU-Net\n\nNeuFMT\n\n40\n\nmm\n\nNeuFMT-Ada\n\nFig. 4.", "Results of real phantom experiments. (a) Photograph of the real\nsilicone phantoms and fluorescence inclusions. (b) (e) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases.", "For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (f) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases. 10 mm\n\n(c)\n\nWe performed an in vivo imaging experiment on mice.", "Following the protocol described in Subsection II-F, Cy5\nfluorescent dye accumulated primarily at the sentinel lymph\nnodes (LN), with some residual signal at the vein (Fig. 5 (a)). Our task was to reconstruct the spatial location and shape of\nthe sentinel lymph nodes.", "The 3D FMT reconstruction results from all methods\nare presented in Fig. 5 (b). The conventional L2 -CG method\nproduced a reconstruction where the volume of LN-3 was\noverestimated, and the signals from LN-1, LN-2, and the vein\nmerged into a single, indistinguishable cluster.", "The L1 -FISTA\nreconstruction was highly fragmented, making it impossible\nto discern the shape or count of the lymph nodes accurately. Also, the baseline NeuFMT failed to produce a physiologically plausible reconstruction. In contrast, NeuFMT was\nthe only method that successfully and distinctly resolved all\nthree lymph nodes (LN-1, LN-2, LN-3) and the vein, clearly\nidentifying each as separate, localized regions of fluorescence.", "For quantitative validation, the mouse was sacrificed, and\nthe lymph nodes were excised to be imaged by ex vivo FRI\n\nLN-1\n\nx\ny\n\nLN-3 LN-2\n\n10 mm\n\n0\n\n1\n\n1\n\n1\n\n0. 8\n\n0. 8\n\n0.", "8\n\n0. 6\n\nLN-1\n\n0. 4\n\n0.", "6\n\nLN-2\n\n0. 4\n\n0. 2\n\n0.", "6\n\n0. 2\n\n0\n2\n\n4\n\n6\n\nL2-CG\n\n8\n\n10\n\n12\nmm\n\nLN-3\n\n0. 4\n\n0.", "2\n\n0\n0\n\nD. In Vivo Lymph Node FMT Imaging Experiments\n\nConcentration of Cy5 (a. u.", ")\n\nCase 2\n1\n0. 8\n\nSlice z = 8 mm\n\nCase 1\n1\n0. 8\n\nx\ny\n\nSlice z = 11 mm\n\n(f)\nNorm.", "int (a. u. )\n\nL1-FISTA\n\nR\n\n1\n\nProfiles\n\ny\nx\n\n15\n\nL2-CG\n\nLN-3\n\nL\n\n0\nz\n\n0\n\nR\n\ny\n\nConcentration of Cy5 (a.", "u. )\n\nCase 4\n\n(e)\n\n1\n\n(b)\n\nLN-1\n\nL\n\n3D Segmentation\n\nx\n\nNorm. int (a.", "u. )\n\nCase 3\n\n(d)\n\n1\n\ny\n\nIn vivo FRI\n\nNorm. int (a.", "u. )\n\nCase 2\n\n(c)\n\n1\n\n0\n0\n\n2\n\nL1-FISTA\n\n4\n\n6\n\n8\n\n10\n\n12\nmm\n\n0\n\n2\n\nNeuFMT\n\n4\n\n6\n\n8\n\n10\n\n12\nmm\n\nμNeuFMT\n\nFig. 5.", "In vivo lymph node FMT imaging and reconstruction results. (a) The\nwhite-light image and preview via 2D fluorescence reflectance imaging (FRI)\noverlaid on the white-light image with the red aera indicating the concentrated\ndistribution of Cy5 probe on the cites of three lymph nodes (LN-1, LN-2, LN3) and the vein. (b) Comparison of FMT reconstruction results from different\nmethods.", "The 3D segmentation, along with two slices at z = 8 and 11 mm,\nare displayed. (c) Intensity profiles along the dashed lines in b. are compared\nfor each ex vivo images of lymph nodes after sacrificing the animal.", "The gray\nzone represents the estimated size of LN, based on the ex vivo fluorescence\nimages. IV. D ISCUSSION AND C ONCLUSION\nIn this study, we introduced NeuFMT, an optical-propertyadaptive FMT reconstruction framework that integrates INR\nwith an explicitly differentiable FEM-based light propagation model.", "By unifying a continuous fluorescence field parameterized by an INR and a physics-based forward model\namenable to end-to-end optimization, NeuFMT addresses\ntwo fundamental limitations of existing FMT reconstruction\ntechniques: their inability to efficiently adapt to complex and\nheterogeneous fluorescence distribution, and their reliance on\n\nZHAO et al. : NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nfixed, often inaccurate, optical properties, which significantly\nexacerbates the inherent ill-posedness of the inverse problem. Unlike supervised deep learning approaches which are constrained by the diversity and scale of training datasets and\noften fail under domain shift, NeuFMT operates in a selfsupervised, physics-informed regime.", "It does not require paired\ntraining data; instead, it directly minimizes the discrepancy between measured and simulated boundary fluxes. This not only\neliminates the need for extensive experimental datasets but also\nensures generalizability across different imaging geometries\nand target configurations. The continuous, coordinate-based\nrepresentation provided by the INR further ensures that our\nreconstructions are free from discretization artifacts and inherently resolution-agnostic.", "A central contribution of our work is the introduction of\nan optical property adaptation mechanism, which enables the\ndynamic optimization of absorption and scattering coefficients\n( a , s ) concurrently with the fluorescence distribution. Our\nframework demonstrates that the integration of a differentiable\nphysics-based forward model is the key to enabling this\nself-supervised adaptation. The FEM-based light propagation\nmodel is not merely a component of the loss function, but\nan active and adaptive part of the inverse solver.", "This stands\nin contrast to both traditional iterative methods, which hold\noptical properties static and thus aggravate the problem s illposedness, and conventional end-to-end deep learning approaches, which struggle to generalize beyond their training\ndata. The adaptivity of our model is thus its core strength,\nproviding a principled way to refine the physical model itself\nbased on the measured data, which is crucial for practical\napplications where precise prior knowledge of tissue optics\nis unavailable. Our results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate\nthat NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1 ) and deep learningbased (U-Net) benchmarks.", "In particular, the method consistently localized fluorescent targets with higher spatial accuracy, improved contrast, and more realistic morphological\nfeatures especially under challenging conditions involving\nbackground fluorescence and complex geometry. Despite these promising results, several aspects of\n NeuFMT merit further investigation. First, the current implementation assumes a homogeneous optical background a\ncommon simplification in FMT studies.", "Extending the model\nto incorporate spatially varying optical properties represents\na logical next step, potentially by representing a (r) and\n s (r) with additional INRs, though this would significantly\nincrease the complexity of the inverse problem. Nevertheless,\nthe proposed NeuFMT can be validated or even combined\nwith time-domain near-infrared spectroscopy (fNIRS) [44],\n[45] or diffuse optical tomography (DOT) [46] techniques,\nwhere the complex optical properties related with absorption\nand scattering can disentangled and calibrated. More importantly, the integration of NeuFMT with emerging imaging\ntechnologies holds particular promise.", "The inherent adaptivity\nof our framework is well-suited to the distinct scattering\nand absorption landscapes of NIR-II fluorescence tomography\n\n9\n\n[47], [48], where our optical property optimization could be\ncrucial for accurately modeling the increased photon penetration and achieving higher-resolution reconstruction at depth. Furthermore, the framework can be naturally extended to\nhyperspectral FMT, using a single INR to output both fluorophore concentration and spectral signature, thereby disentangling multiple probes or accounting for wavelength-dependent\noptical properties. Finally, translating NeuFMT into clinical\nsettings, such as intraoperative fluorescence-guided surgery\n[8], [9], represents an exciting frontier where its adaptability\ncould overcome patient-specific variations in tissue optics.", "In conclusion, by harmonizing a differentiable physics\nmodel with a continuous INR, NeuFMT provides a robust,\nself-supervised, and adaptive framework for FMT reconstruction. It effectively mitigates the ill-posedness inherent to\ninverse problems with uncertain parameters, setting a new\nparadigm for practical, high-resolution fluorescence molecular\nimaging. We believe this physics-in-the-loop INR approach\noffers a generalizable template for tackling a wide range of\ntomographic and inverse problems in biomedical imaging.", "R EFERENCES\n[1] F. Song, P. Zhang, H.", "Wu, C. Ma, Z. Liu, R.", "Cai, Y. Feng, Y. He,\nX.", "Dong, Y. Tian, and G. Zhang, Advances of fluorescence molecular\nimaging: NIR-II window, probes, and tomography, Laser & Photonics\nReviews, vol.", "19, no. 10, p. 2400275, 2025.", "[2] B. Zhu, J. Hendricks, J.", "E. Morton, J. C.", "Rasmussen, C. Janssen,\nM. N.", "Shah, and E. M. Sevick-Muraca, Near-infrared fluorescence\ntomography and imaging of ventricular cerebrospinal fluid flow and\nextracranial outflow in non-human primates, IEEE Transactions on\nMedical Imaging, vol.", "42, no. 12, pp. 3555 3565, 2023.", "[3] M. S. Ozturk and et al.", ", High-resolution tomographic analysis of in\nvitro 3D glioblastoma tumor model under long-term drug treatment, \nScience Advances, vol. 6, no. 10, p.", "eaay7513, 2020. [4] M. Cai, Z.", "Zhang, X. Shi, Z. Hu, and J.", "Tian, NIR-II/NIR-I fluorescence molecular tomography of heterogeneous mice based on gaussian\nweighted neighborhood fused lasso method, IEEE Transactions on\nMedical Imaging, vol. 39, no. 6, pp.", "2213 2222, 2020. [5] S. R.", "Arridge and J. C. Schotland, Optical tomography: forward and\ninverse problems, Inverse problems, vol.", "25, no. 12, p. 123010, 2009.", "[6] L. V. Wang and H.", "-i. Wu, Biomedical optics: principles and imaging. John Wiley & Sons, 2007.", "[7] F. Stuker, J. Ripoll, and M.", "Rudin, Fluorescence molecular tomography:\nprinciples and potential for pharmaceutical research, Pharmaceutics,\nvol. 3, no. 2, pp.", "229 274, 2011. [8] J. S.", "D. Mieog, F. B.", "Achterberg, A. Zlitni, M. Hutteman, J.", "Burggraaf,\nR. -J. Swijnenburg, S.", "Gioux, and A. L. Vahrmeijer, Fundamentals and\ndevelopments in fluorescence-guided cancer surgery, Nature Reviews\nClinical Oncology, vol.", "19, no. 1, pp. 9 22, 2022.", "[9] K. Wang, Y. Du, Z.", "Zhang, K. He, Z. Cheng, L.", "Yin, D. Dong, C. Li,\nW.", "Li, Z. Hu et al. , Fluorescence image-guided tumour surgery, Nature\nReviews Bioengineering, vol.", "1, no. 3, pp. 161 179, 2023.", "[10] D. Zhu et al. , Comparison of regularization methods in fluorescence\nmolecular tomography, Photonics, vol.", "1, no. 2, pp. 95 109, 2014.", "[11] H. Yi et al. , Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography:\na comparative study, Journal of Biomedical Optics, vol.", "18, no. 5, p. 56013, 2013.", "[12] J. Shi, B. Zhang, F.", "Liu, J. Luo, and J. Bai, Efficient L1 regularizationbased reconstruction for fluorescent molecular tomography using\nrestarted nonlinear conjugate gradient, Optics letters, vol.", "38, no. 18,\npp. 3696 3699, 2013.", "[13] D. Zhu and C. Li, Nonconvex regularizations in fluorescence molecular\ntomography for sparsity enhancement, Physics in Medicine & Biology,\nvol.", "59, no. 12, p. 2901, 2014.", "[14] J. Zhang, L. Li, Q.", "Hu, J. Zhang, Y. Wu, L.", "Gu, J. Li, F. Li, X.", "Zhu,\nJ. Jiang et al. , High-fidelity solution decomposition fluorescence tomography in the presence of background interference, Laser & Photonics\nReviews, p.", "e01013, 2025. 10\n\n[15] C. Huang, H.", "Meng, Y. Gao, S. Jiang, K.", "Wang, and J. Tian, Fast and\nrobust reconstruction method for fluorescence molecular tomography\nbased on deep neural network, in Imaging, Manipulation, and Analysis\nof Biomolecules, Cells, and Tissues XVII, vol. 10881.", "SPIE, 2019, pp. 257 262. [16] L.", "Guo, F. Liu, C. Cai, J.", "Liu, and G. Zhang, 3D deep encoder decoder\nnetwork for fluorescence molecular tomography, Optics letters, vol. 44,\nno.", "8, pp. 1892 1895, 2019. [17] P.", "Zhang, G. Fan, T. Xing, F.", "Song, and G. Zhang, UHR-DeepFMT:\nultra-high spatial resolution reconstruction of fluorescence molecular\ntomography based on 3-d fusion dual-sampling deep neural network, \nIEEE Transactions on Medical Imaging, vol. 40, no.", "11, pp. 3217 3228,\n2021. [18] J.", "Cheng, P. Zhang, F. Liu, J.", "Liu, H. Hui, J. Tian, and J.", "Luo, Encoderdecoder deep learning network for simultaneous reconstruction of fluorescence yield and lifetime distributions, Biomedical Optics Express,\nvol. 13, no. 9, pp.", "4693 4705, 2022. [19] P. Zhang, C.", "Ma, F. Song, Z. Liu, Y.", "Feng, Y. Sun, Y. He,\nF.", "Liu, D. Wang, and G. Zhang, Multi-branch attention prior based\nparameterized generative adversarial network for fast and accurate\nlimited-projection reconstruction in fluorescence molecular tomography, Biomedical Optics Express, vol.", "13, no. 10, pp. 5327 5343, 2022.", "[20] P. Zhang, F. Song, C.", "Ma, Z. Liu, H. Wu, Y.", "Sun, Y. Feng, Y. He, and\nG.", "Zhang, Robust reconstruction of fluorescence molecular tomography\nbased on adaptive adversarial learning strategy, Physics in Medicine &\nBiology, vol. 68, no. 4, p.", "04LT01, 2023. [21] P. Zhang, X.", "Liu, Q. Xue, Y. Shang, C.", "Liu, R. Chen, H. Gao, J.", "Liang,\nW. Wang, and G. Zhang, PAH2T-Former: Paired-attention hybrid\nhierarchical transformer for synergistically enhanced fmt reconstruction\nquality and efficiency, IEEE Transactions on Computational Imaging,\n2025.", "[22] H. Meng, Y. Gao, X.", "Yang, K. Wang, and J. Tian, K-nearest neighbor\nbased locally connected network for fast morphological reconstruction\nin fluorescence molecular tomography, IEEE transactions on medical\nimaging, vol.", "39, no. 10, pp. 3019 3028, 2020.", "[23] D. Li, C. Chen, J.", "Li, and Q. Yan, Reconstruction of fluorescence\nmolecular tomography based on graph convolution networks, Journal\nof Optics, vol. 22, no.", "4, p. 045602, 2020. [24] Y.", "Wang, C. Bian, Y. An, H.", "Wang, Q. Liang, Y. Du, and J.", "Tian,\n Graph convolution based residual connected network for morphological reconstruction in fluorescence molecular tomography, in Medical\nImaging 2022: Biomedical Applications in Molecular, Structural, and\nFunctional Imaging, vol. 12036. SPIE, 2022, pp.", "527 533. [25] Y. Sun, J.", "Liu, M. Xie, B. Wohlberg, and U.", "S. Kamilov, Coil:\nCoordinate-based internal learning for tomographic imaging, IEEE\nTransactions on Computational Imaging, vol. 7, pp.", "1400 1412, 2021. [26] L. Lozenski, M.", "A. Anastasio, and U. Villa, A memory-efficient selfsupervised dynamic image reconstruction method using neural fields, \nIEEE Transactions on Computational Imaging, vol.", "8, pp. 879 892,\n2022. [27] A.", "W. Reed, H. Kim, R.", "Anirudh, K. A. Mohan, K.", "Champley, J. Kang,\nand S. Jayasuriya, Dynamic CT reconstruction from limited views\nwith implicit neural representations and parametric motion fields, in\nProceedings of the IEEE/CVF International Conference on Computer\nVision, 2021, pp.", "2258 2268. [28] L. Shen, J.", "Pauly, and L. Xing, NeRP: implicit neural representation\nlearning with prior embedding for sparsely sampled image reconstruction, IEEE Transactions on Neural Networks and Learning Systems,\nvol. 35, no.", "1, pp. 770 782, 2022. [29] R.", "Liu, Y. Sun, J. Zhu, L.", "Tian, and U. S. Kamilov, Recovery\nof continuous 3D refractive index maps from discrete intensity-only\nmeasurements using neural fields, Nature Machine Intelligence, vol.", "4,\nno. 9, pp. 781 791, 2022.", "[30] S. Shen, L. Li, S.", "Gao, Y. Wang, L. Gu, S.", "Li, X. Zhu, J. Jiang, J.", "Yu, and\nW. Ren, High resolution diffuse optical tomography via neural fields, \nIEEE Transactions on Computational Imaging, 2024. [31] K.", "Han, C. Li, A. Xiao, Y.", "Tian, J. Tian, and Z. Hu, TSPE: Reconstruction of multi-morphological tumors of NIR-II fluorescence molecular\ntomography based on positional encoding, Computer Methods and\nPrograms in Biomedicine, vol.", "261, p. 108554, 2025. [32] S.", "R. Arridge, Optical tomography in medical imaging, Inverse problems, vol. 15, no.", "2, p. R41, 1999. [33] , Photon-measurement density functions.", "part I: Analytical forms, \nApplied Optics, vol. 34, no. 31, pp.", "7395 7409, 1995. [34] S. R.", "Arridge and M. Schweiger, Photon-measurement density functions. part 2: Finite-element-method calculations, Applied Optics,\nvol.", "34, no. 34, pp. 8026 8037, 1995.", "PREPRINT VERSION 2025\n\n[35] O. C. Zienkiewicz, R.", "L. Taylor, P. Nithiarasu, and J.", "Zhu, The finite\nelement method. Elsevier, 1977, vol. 3.", "[36] V. Ntziachristos, C. Bremer, and R.", "Weissleder, Fluorescence molecular\ntomography resolves protease activity in vivo, Nature Medicine, vol. 8,\nno. 7, pp.", "757 760, 2002. [37] M. Schweiger and S.", "Arridge, The Toast++ software suite for forward\nand inverse modeling in optical tomography, Journal of biomedical\noptics, vol. 19, no. 4, pp.", "040 801 040 801, 2014. [38] W. Ren, H.", "Isler, M. Wolf, J. Ripoll, and M.", "Rudin, Smart toolkit\nfor fluorescence tomography: simulation, reconstruction, and validation, \nIEEE Transactions on Biomedical Engineering, vol. 67, no. 1, pp.", "16 \n26, 2019. [39] S. Gao, J.", "Zhang, Y. Hu, Y. Wu, L.", "Li, Q. Hu, X. Lou, X.", "Zhu, J. Jiang,\nand W. Ren, Multifunctional optical tomography system with highfidelity surface extraction based on a single programmable scanner and\nunified pinhole modeling, IEEE Transactions on Biomedical Engineering, 2023.", "[40] Y. Hu, Y. Wu, L.", "Li, L. Gu, X. Zhu, J.", "Jiang, and W. Ren, Simultaneous\nreconstruction of 3D fluorescence distribution and object surface using\nstructured light illumination and dual-camera detection, Optics Express,\nvol. 32, no.", "9, pp. 15 760 15 773, 2024. [41] C.", "Ji, M. Zhao, C. Wang, R.", "Liu, S. Zhu, X. Dong, C.", "Su, and Z. Gu,\n Biocompatible tantalum nanoparticles as radiosensitizers for enhancing\ntherapy efficacy in primary tumor and metastatic sentinel lymph nodes, \nACS nano, vol. 16, no.", "6, pp. 9428 9441, 2022. [42] S.", "Kawata and O. Nalcioglu, Constrained iterative reconstruction by\nthe conjugate gradient method, IEEE Transactions on Medical Imaging,\nvol. 4, no.", "2, pp. 65 71, 1985. [43] A.", "Beck and M. Teboulle, A fast iterative shrinkage-thresholding algorithm for linear inverse problems, SIAM Journal on Imaging Sciences,\nvol. 2, no.", "1, pp. 183 202, 2009. [44] Y.", "Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared\nspectroscopy and imaging: a review, Applied Sciences, vol.", "9, no. 6, p. 1127, 2019.", "[45] H. Y. Ban, G.", "M. Barrett, A. Borisevich, A.", "Chaturvedi, J. L. Dahle,\nH.", "Dehghani, J. Dubois, R. M.", "Field, V. Gopalakrishnan, A. Gundran\net al.", ", Kernel flow: a high channel count scalable time-domain functional near-infrared spectroscopy system, Journal of biomedical optics,\nvol. 27, no. 7, p.", "074710, 2022. [46] A. Pifferi, D.", "Contini, A. D. Mora, A.", "Farina, L. Spinelli, and A. Torricelli, New frontiers in time-domain diffuse optics, a review, Journal\nof Biomedical Optics, vol.", "21, no. 9, pp. 091 310 091 310, 2016.", "[47] F. Wang, Y. Zhong, O.", "Bruns, Y. Liang, and H. Dai, In vivo NIRII fluorescence imaging for biology and medicine, Nature Photonics,\nvol.", "18, no. 6, pp. 535 547, 2024.", "[48] Z. Zhang, Y. Du, X.", "Shi, K. Wang, Q. Qu, Q.", "Liang, X. Ma, K. He,\nC.", "Chi, J. Tang et al. , NIR-II light in clinical oncology: opportunities\nand challenges, Nature Reviews Clinical Oncology, vol.", "21, no. 6, pp. 449 467, 2024."]}
{"method": "paragraph", "num_chunks": 603, "avg_chunk_len": 95.70149253731343, "std_chunk_len": 444.39281300799865, "max_chunk_len": 4683, "min_chunk_len": 1, "total_chars": 57708, "compression_ratio": 1.0211755735773203, "chunks": ["PREPRINT VERSION 2025", "1", "NeuFMT: Optical-Property-Adaptive Fluorescence\nMolecular Tomography via Implicit\nNeural Representation", "arXiv:2511.04510v1 [eess.IV] 6 Nov 2025", "Shihan Zhao, Jianru Zhang, Yanan Wu, Linlin Li, Siyuan Shen, Xingjun Zhu, Guoyan Zheng, Member IEEE,\nJiahua Jiang, and Wuwei Ren", "Abstract Fluorescence Molecular Tomography (FMT) is a\npromising technique for non-invasive 3D visualization of fluorescent probes, but its reconstruction remains challenging due to\nthe inherent ill-posedness and reliance on inaccurate or oftenunknown tissue optical properties. While deep learning methods\nhave shown promise, their supervised nature limits generalization\nbeyond training data. To address these problems, we propose\n NeuFMT, a self-supervised FMT reconstruction framework that\nintegrates implicit neural-based scene representation with explicit\nphysical modeling of photon propagation. Its key innovation lies\nin jointly optimize both the fluorescence distribution and the\noptical properties ( ) during reconstruction, eliminating the need\nfor precise prior knowledge of tissue optics or pre-conditioned\ntraining data. We demonstrate that NeuFMT robustly recovers\naccurate fluorophore distributions and optical coefficients even\nwith severely erroneous initial values (0.5 to 2 of ground\ntruth). Extensive numerical, phantom, and in vivo validations\nshow that NeuFMT outperforms conventional and supervised\ndeep learning approaches across diverse heterogeneous scenarios.\nOur work establishes a new paradigm for robust and accurate\nFMT reconstruction, paving the way for more reliable molecular\nimaging in complex clinically related scenarios, such as fluorescence guided surgery.\nIndex Terms fluorescence molecular tomography, image reconstruction, optical properties, implicit neural representation,\nfluorescence guided surgery", "The work was supported by Science and Technology Commission of Shanghai Municipality under Grant 25JS2830300 (Wuwei Ren), National Natural\nScience Foundation of China under Grants 62105205 (Wuwei Ren), and\nShanghai Clinical Research and Trial Center (Wuwei Ren). (Corresponding\nauthor: Wuwei Ren.)\nShihan Zhao and Jianru Zhang contributed equally to this work.\nShihan Zhao, Yanan Wu, Linlin Li and Siyuan Shen are with\nthe School of Information Science and Technology, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: zhaoshh, wuyn1, lill,\nshensy2023@shanghaitech.edu.cn).\nJianru Zhang and Jiahua Jiang are with the School of Mathematics,\nUniversity of Birmingham, Edgbaston, B15 2QN, United Kingdom (e-mail:\njxz389@student.bham.ac.uk; j.jiang.3@bham.ac.uk).\nXingjun Zhu is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail:\nzhuxj1@shanghaitech.edu.cn).\nGuoyan Zheng is with the Institute of Medical Robotics, School of\nBiomedical Engineering, Shanghai Jiao Tong University, Shanghai 200240,\nChina (e-mail: guoyan.zheng@sjtu.edu.cn)\nWuwei Ren is with the School of Information Science and Technology,\nShanghaiTech University, Shanghai 201210, China, and also with State\nKey Laboratory of Advanced Medical Materials and Devices, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: renww@shanghaitech.edu.cn).", "I. INTRODUCTION\nFluorescence Molecular Tomography (FMT) has emerged\nas a promising molecular imaging modality, enabling noninvasive 3D visualization of fluorescent probe distribution\nin highly turbid media [1]. Owning to its high sensitivity,\ncost-effectiveness, and non-ionizing radiation, FMT has found\nbroad applications in preclinical research and clinical practice, e.g., brain imaging [2], in vitro cell culture monitoring\n[3] and tumor detection [4]. FMT reconstructs the internal\nfluorescence distribution by measuring the photon distribution\non the object surface and minimizing the discrepancy between\nreal measurements and the simulated results. A canonic framework of FMT reconstruction employs an iterative optimization\nstrategy with a forward model typically based on the\nRadiation Transfer Equation (RTE) or the diffusion equation\n(DE) and an inverse model that refines fluorescence distribution prediction until convergence [5], [6]. However, FMT\nreconstruction is inherently ill-posed due to insufficient surface measurements and strong photon scattering effect within\ntissues. Development of high-precision FMT reconstruction\nalgorithms is highly attractive for further improvement of\nthe spatial resolution and detection depth of this technology,\nwhich ultimately broaden the biological applications in drug\ndiscovery [7] and clinical use such as fluorescence guided\nsurgery [8], [9].\nTo address the ill-posed nature of FMT reconstruction,\nregularization techniques that incorporate prior knowledge are\napplied. Conventional approaches include Tikhonov (L2 norm)\nregularization for smoothing the results [10], [11], and sparsepromoting regularization (L1 , Lp norm) or total variation (TV)\nregularization for enhancing the spatial resolution [12], [13].\nRecent advancements in regularization techniques, such as\nthe solution-decomposition algorithm, utilize an advanced\nstochastic prior model that improves the differentiation of\nfluorescence targets from background interference, thereby\nenhancing reconstruction quality [14]. While these methods\nstabilize solutions, their reliance on time-consuming iterative\noptimization and idealized assumptions about optical parameters often results in slow convergence and limited accuracy in\nheterogeneous tissues. Deep learning (DL) methods, particularly en-decoder-based neural networks [15] [21] and graphbased networks [22] [24], have recently been used in FMT\nreconstruction by learning direct mappings from boundary\nmeasurements to fluorescence distributions. These approaches", "2", "encode physical priors within network parameters, enabling\noverwhelmingly rapid inference. However, their dependence\non supervised training with large, scenario-specific datasets restricts generalizability across variable experimental conditions\n(e.g., tissue object geometry and optical properties), leading\nto significant accuracy degradation when the object properties\ndeviate from training assumptions.\nRecently, implicit neural representation (INR) models have\nemerged as a powerful alternative for medical image reconstruction. By mapping arbitrary spatial coordinates to certain\nunknown physical quantities via a coordinate-based multilayer perceptron network (MLP), INRs achieve continuous\n3D representations, self-supervised training, and memory efficiency. Originally popularized in computer vision and medical imaging, INRs have demonstrated remarkable success\nin modalities such as computed tomography (CT), magnetic\nresonance imaging (MRI) [25] [29], and notably in diffuse\noptical tomography (DOT), where INR has been proven to be\nable to capture a high-resolution, continuous optical absorption\nmap that account for light scattering in complex tissues [30].\nINR captures continuous spatial information and integrates\nphysical priors makes it particularly suited for various imaging problems. In the context of FMT, preliminary work has\nexplored position encoding strategies to enhance spatial resolution and improve the quality of FMT reconstructions [31].\nNevertheless, systematic studies integrating optical diffusion\nphysics within an INR framework remain scarce. This gap\npresents an opportunity to harness the strengths of implicit\nmodeling for robust and data-efficient FMT reconstruction.\nTo bridge this gap, we propose neural-field-based FMT, or\nNeuFMT, a physics-driven reconstruction framework unifying\nINR with explicit physical models. Unlike conventional DLbased FMT reconstruction algorithms that couple explicit\nfluorescence predictions to implicit physical model, NeuFMT\nintegrates the DE-based forward model in the network loss,\nenabling self-supervised training without paired data. The\ndifferentiability of the forward model is achieved via finite\nelement method (FEM). This inversion-free approach ensures\nrapid, continuous reconstruction across diverse geometries\nwhile inherently addressing scattering effects. Another critical\nlimitation of both traditional and DL methods lies in the\npresumed optical properties of the object during reconstruction, which largely aggravate the ill-posedness of the inverse\nproblem given the optical parameters were initially biased. To\novercome this, we further introduce optical-property-adaptive\nNeuFMT, or NeuFMT, an adaptive extension of NeuFMT\nthat dynamically optimizes scattering / absorption coefficients\nand fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations, NeuFMT achieves robust accuracy even when provided\nwith erroneous initial guess of the optical coefficient values,\naddressing the problem of unrealistic assumption prior to\nFMT reconstruction. Both proposed INR-based FMT reconstruction algorithms were thoroughly compared and validated\nby simulations and phantom experiments along with other\nmethods. Furthermore, in vivo lymph node imaging in mice\nwas performed, further demonstrating the advantages of the\nproposed methods.", "PREPRINT VERSION 2025", "II. M ETHODS\nA. Forward Modeling of FMT\nModel-based FMT reconstruction comprises two fundamental steps: forward modeling and inversion. The former predicts\nsurface photon density measurements based on an assumed\nfluorescence distribution. At the macroscopic scale, we employ\nthe first-order approximation of the radiative transport equation (RTE), known as the diffusion equation (DE) [32]. The\nexcitation and fluorescence emission processes in continuouswave (CW) mode form a coupled pair of DEs expressed as\n[33], [34]:\n κ ϕx (r) + a ϕx (r) = qx (r),", "r , (1)", "κ ϕm (r) + a ϕm (r) = η C(r) ϕx (r),", "r , (2)", "where ϕx and ϕm denote the excitation and emission photon\ndensity, qx is the excitation source, C(r) is the fluorophore\nconcentration to be reconstructed in the inversion, and η\ncollects quantum-yield factors in the CW source term. κ\nrepresents the diffusion coefficient, calculated by [33]\n1\n,\n(3)\nκ=\n3 ( a + s )\nwith the absorption coefficient a and the reduced scattering\ncoefficient s . In a non-contact setting of FMT, to calculate\nthe value of ϕ (r) on the object surface as the measurement, a Robin-type boundary condition is added alongside the\nequation pair (1 2):\n ϕ (r)\n= 0, {x, m}, r , (4)\n ν\nwhere ζ(c) is the refractive index mismatch parameter that\naccounts for the light reflection on the boundary surface, with\nc representing the light speed inside the medium. ν denotes\nthe outward normal on the boundary. Notably, to simplified the\nproblem setting, we only consider a homogeneous medium\ncase and the difference of a , s values under different\nwavelengths are neglected.\nϕ (r) + 2 ζ(c) κ", "B. Finite Element Discretization and System Matrix Construction\nWe apply the finite element method (FEM) [35] to the\ndiffusion model (1) - (4). Discretizing with a tetrahedral\nN\nmesh of N\ni }i=1 , we approximate\nP nodes and nodal basis {ψP\nϕ (r) i Φ ,i ψi (r) and qx (r) i (Qx )i ψi (r), which\ntransforms the continuous-form equations into a linear system\nfor excitation and emission photon propagation:\nS Φx = Qx", "(5)", "S Φm = Qm", "(6)", "where S RN N is the system matrix and Φ , Q RN\nare discretized form (coefficient vectors) for ϕ and q , respectively. In particular, the excitation field ϕx interacts with\nfluorophores C RN to produce the emission source term\nQm = C Φx", "(7)", "with denoting element-wise multiplication. The equation\n(7) physically describes how fluorophores absorb excitation", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "explicitly reveals the functional dependence of S on the\noptical parameters a and s , which forms the mathematical\nfoundation for our adaptive optimization approach introduced\nin Subsection II-C.", "(b)", "(a)", "3", "Camera\nFilter Wheel\nReal Measurement\nSample", "C. INR-based FMT reconstruction: NeuFMT / NeuFMT\nScanners", "Laser\nPredicted\nMeasurement", "Focal Lens OD Filter\n(c)", "(d)", "Adaption Module", "Forward Model\nBased on DE", "Absorption Term\nHigh Absorption", "Low Absorption", "inv\nDi usion Term", "High Scattering", "Sti ness Matrix", "Low Scattering\nBoundary Term", "(e)", "Forward Data\nBackward Gradient", "Fluorescence Distribution Encoded with INR\nNode Coordinate", "3D Mesh with", "Nodes", "sine", "cosine", "Positional\nEncoding", "MLP", "Fig. 1. Conceptual illustration of NeuFMT. (a) The FMT setup: a scanned\nlaser illuminates the sample while a CMOS camera with filter wheel on the\nopposite side records boundary images. The raster scanning method yields\nthe raw 2D image stack M real , serving as the input to the subsequent FMT\nreconstruction. (b) The difference between M real and the simulated meac( a , , Cθ ) is iteratively minimized until an optimized value\nsurement M\ns\nof unknown fluorescence distribution C is found. R(C) is a regularization\nterm and { a , s } is the intrinsic optical properties consisting of\nabsorption coefficient a and scattering coefficient s . (c) A -adaption\nmodule is integrated into the FMT reconstruction. The stiffness matrix S is\ndetermined by both a and s . (d) The FEM-based simulator predicts virtual\nc( a , , Cθ ) based on the operator S 1 ( ) and predicted\nmeasurement M\ns\nfluorescence distribution C. (e) Fluorescence distribution encoded in an INR.\n3D node coordinate serves as input, while a continuous C map is generated\nthrough positional encoding and an MLP network.", "Unlike traditional voxel-based or mesh-dependent representations, INR provides a continuous, memory-efficient framework for modeling complex physical fields. The basic variant,\nNeuFMT, learns only the fluorophore Cθ with fixed optical\nproperties; the proposed adaptive NeuFMT jointly optimizes\nthe optical coefficients ( a , s ) with Cθ for enhancing the\nreconstruction accuracy and robustness. In this section, we\ndescribe the NeuFMT representation, formulate the learning\nobjective, introduce optical-property adaptation, and summarize the network architecture and implementation.\n1) INR representation of the unknown fluorescence: Our\n NeuFMT model the 3D fluorescence field as an INR, i.e., a\ncoordinate-conditioned MLP:", "Cθ (r) = fθ Γ (r) ,\n(10)\nwhere r = (x, y, z) R3 , Γ : Rd is a highdimensional positional encoding of spatial coordinates, and\nfθ : Rd R is an MLP with parameters θ. This INR formulation (10) enables resolution-independent reconstruction and\nnaturally accommodates arbitrary spatial queries without being\nconstrained by the conventional discrete grid structure.\nTo enhance the network s ability to represent high-frequency\ndetails, which is crucial for resolving complex in vivo fluorescence patterns, we apply a sinusoidal positional encoding to\neach coordinate component. Let γ : R R2L be\nγ(p) = sin(20 πp), cos(20 πp), ,\nL 1", "sin(2", "πp), cos(2", "L 1", "(11)", "πp) ,", "p {x, y, z},", "photons and re-emit light at longer wavelengths. The emission\nsource Qm then propagates through the same medium to\nproduce the emission photon density Φm , which is finally\ndetected at the boundary, which is computed as", "where L is the number of frequency bands. The\n 3D position\nis then encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that\nd = 6L. Feeding Γ (r) into fθ enables compact representation\nof both low- and high-frequency variations in Cθ .\n2) Learning objective: We estimate the fluorescence field\nCθ and, in NeuFMT, the optical properties { a , s } by\nminimizing a data-fidelity term plus regularization:", "M = P Φm", "c( a , , Cθ ) M real 2 + λ R(Cθ ), (12)\nL( a , s , θ) = M\ns\n2", "(8)", "where P represents the transfer function, which maps the\nboundary photon density Φm the measurement data M acquired by the camera. The above linearized forward model\nprovides the physical foundation for the inversion procedure.\nCrucially, the SPD FEM stiffness matrix S( a , s ) \nN N\nR\nin (5) (6) encode the optical properties and boundary\ngeometry, generating from a linear combination of matrices\ncorresponding to distinct physical components [33], [36]", "1", "Sd + Sb . (9)\nS( a , s ) = c a Sa +\n3( a + s )\nwith Sa , Sd , and Sb the assembled absorption, diffusion, and\nRobin-boundary matrices, respectively. This decomposition", "c denotes the boundary measurements, and R(Cθ ) is\nwhere M\na regularization term applied to the fluorescence distribution.\nThe hyperparameter λ controls the regularization strength,\nbalancing data fidelity with sparsity constraints. The training of\n NeuFMT / NeuFMT follows a fully self-supervised paradigm\nthat explicitly integrates the DE-based physical model into\nthe optimization loop. Note that NeuFMT uses fixed optical\nparameters ( a , s ), whereas NeuFMT updates jointly.\n3) Alternating optical-property adaptation: A fundamental\ninnovation of NeuFMT lies in formulating the entire photon propagation process from excitation to emission as an\nend-to-end differentiable map. The forward model follows a", "4", "PREPRINT VERSION 2025", "precise physical sequence from excitation source to surface\nmeasurements, as described in Subsection II-B:", "c( a , s , Cθ ) = P S( a , s ) 1 Cθ S( a , s ) 1 Qx ,\nM\n(13)\nWe optimize the introduced objective L( a , s , θ) in (12),\njointly updating network parameters θ and optical coefficients\n( a , s ). The chain in (13) contains only differentiable operations, including linear solves, elementwise products, and linear\nc is differentiable w.r.t. both Cθ (hence θ)\nprojections. Thus M", "and ( a , s ), enabling standard gradient-based training. For\ncompleteness, we state the chain-rule decomposition of the\nloss gradient with respect to ( a , s ). Based on (13), the\ngradient splits into an emission term and an excitation term:", "c \n S\n L M\n L\n S 1\n=\nΦm +\nc Φm", "{z\n}\n| M\nEmission pathway", "c Φm Qm \n L M\n S\nΦx\n S 1\nc Φm Qm Φx", "| M\n{z\n}", "(14)", "Excitation pathway", "{ a , s }.\nThe only model-specific ingredient of a and s is the\nJacobian of S( a , s ). According to (9), the partial derivatives\nare", "S\n1\n= c Sa \nSd ,\n a\n3( a + s )2", "S\n1\n=c \nSd .\n(15)\n s\n3( a + s )2\nThis allows a and s to be optimized directly using gradient\ndescent, and then be updated together with θ, bridging the\nlearning process with the underlying physical model.\nTo mitigate potential coupling effects between a and s\nduring optimization, we propose an alternating update strategy,\nwhich periodically updates one optical parameter with the\nother fixed. The alternating framework largely promotes training stability to avoid oscillations with sufficient computational\nefficiency. The complete NeuFMT algorithm is described in\nAlgorithm 1. Overall, the alternating -adaption module ensures that each optical parameter receives dedicated optimization attention while maintaining the physical consistency of\nthe forward model, yielding more accurate FMT reconstruction\nresults even in the presence of mismatch between the initial\nguess and ground truth of the optical properties.\n4) Network architecture and implementation: We adopt\nMLP for the NeuFMT / NeuFMT, comprising 8 fullyconnected layers with 512 hidden units each, followed by\na final layer with 128 units. ReLU activation functions are\nemployed throughout the network. A critical skip connection\nbridges the input Γ (r) to the 4th hidden layer, facilitating\ngradient flow and enhancing the ability to learn fine-grained\ndetails. This architectural choice is particularly suited for FMT\napplications where accurately reconstructing high-contrast targets against complex backgrounds is essential.\nWe implement the NeuFMT / NeuFMT framework with\nPyTorch, leveraging its automatic differentiation capability to", "compute the gradient through both MLP and the physical\nmodel. Adam optimizer is used with the initial learning rates\nof 10 4 for θ update, 10 3 for scattering coefficient and\n10 5 for absorption coefficient. To improve the computational\nefficiency, a learning rate decay is applied for MLP update.\nThese rates are determined empirically to ensure stable convergence. The L1 regularization parameter λ is set to 10 6\nbased on cross validation. The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality,\nwith the entire process completing within 3 30 minutes on\na single NVIDIA RTX 3090 GPU for problems of varying\nscales. The FEM discretization is built on TOAST++ toolkit\n[37], and the FMT simulation is based on a modular software\nplatform STIFT [38] in MATLAB (R2024b, MathWorks, MA,\nUS) using a desktop computer (Intel Core i5-12600 CPU @\n3.30 GHz, 128 GB RAM).\nAlgorithm 1 NeuFMT\nRequire: Real measurements M real , light speed c, stepsizes\nαθ , αa , αs , alternation period T , total iterations K\n1: Initialize θ, a , s ;\n2: Precompute Sa , Sd , Sb , Qx , P\n3: Compute S via (9);\n4: for i = 1 to K do \n5:\nC = fθ Γ (r)\n6:\nSolve Φx RN satisfying S Φx = Qx\n7:\nQm = C Φx\n8:\nSolve Φm RN satisfying S Φm = Qm\nc = P Φm\n9:\nCompute predicted measurements: M\nreal 2\nc\n10:\nCompute loss: L = M M 2 + R(C)\n11:\nUpdate MLP parameters: θ = θ αθ L\n θ\n12:\nif i mod\n T = 0 then\n13:\nif i/T is even then\n L\n14:\nUpdate absorption: a = a αa \na\n15:\nelse\n L\n16:\nUpdate diffusion: s = s αs", "s\n17:\nend if", "1\n18:\nUpdate S = c a Sa +\nS\n+\nS\nd\nb ;\n3( a + s )\n19:\nend if\n20: end for\n21: Output: fluorescence C, optical parameters a , s", "D. FMT System Setup\nWe devised a continuous-wave (CW) FMT system\n(SHMOT) [39], [40] as depicted in Fig. 1 (a), which incorporates a 16-bit CMOS camera (Edge 4.2, PCO, Germany) with\n2048 2048 pixel resolution and a filter wheel (FW102C,\nThorlabs, NJ, US) for selective wavelength detection. A\ntunable laser source (SuperK EXTREME, NKT, Denmark),\nspanning 400-890 nm, provides fluorescence excitation with a\npower density of approximately 2 mW/mm2 at the sample\nplane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube, Germany) mounted aside steers\nthe laser beam to raster-scan either the top or bottom object", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "surface, enabling switchable reflection-/transmission-mode detection. During experiments, the camera exposure time was\nfixed at 500 ms, with pixel binning applied to improve the\nsignal-to-noise ratio. The acquired raw 2D image data serve\nas supervision target for NeuFMT / NeuFMT reconstruction\n(Fig. 1 (b)). It worth mentioning that our FMT system also\nintegrates a programmable line-scanning illumination, which\nenables high-precision extraction of the surface geometry\nwith approximated maximum error of 0.1 mm. The extracted\nsurface information is then leveraged as prior knowledge for\nFEM meshing and improving reconstruction accuracy.", "E. Phantom preparation and optical calibration\nIn our validation, the slab phantomswere cast from silicone (SYLGARDTM 184; DOW, CA, USA) to emulate softtissue matrix. Optical properties were tuned by dispersing\ntitanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon\nblack powder (Colins, Shanghai, China) as scattering and\nabsorbing additives, respectively. In all phantoms, TiO2 and\ncarbon black were uniformly distributed. All the designs\nshown in Fig. 4 (a) used the same TiO2 /carbon-black mixing\nratio, yielding isotropic media with identical absorption and\nscattering parameters.", "F. In Vivo Lymph Node FMT Imaging\nFollowing numerical simulations and phantom experiments,\nwe evaluated the proposed method in vivo in a murine lymph\nnode imaging task. In cancer diagnostics, lymph node metastasis is a key prognostic indicator of tumor progression. Fluorescence imaging enables rapid screening of sentinel lymph\nnodes [41].\nIn our experiment, all animal procedures were approved by\nthe Institutional Animal Care and Use Committee of ShanghaiTech University (Approval No. 20211115001). 5 female\nBALB/c mice (8 weeks old) were obtained from Shanghai\nJihui Laboratory Animal Breeding Co. Ltd. and housed under\na circadian rhythm of 12 hours of day and night alternation.\nBefore taking imaging experiments, fur was removed over the\nwhole body. For FMT reconstruction, we assumed an optically\nhomogeneous medium with properties calibrated during the\nexcitation step with ( a = 0.0055 mm 1 , s = 1.1 mm 1 ).\nWe followed a three-stage protocol fluorescent-dye injection, imaging, and ex vivo validation. Prior to FMT imaging, Cy5-saline solution (1.2146 mol mL 1 , 40 L) was injected subcutaneously into the left forepaw to drive lymphatic\ndrainage toward the sentinel lymph nodes and create a highintensity target. Next, follow-up FMT measurements were\nacquired using the system setup in Subsection II-D. Finally,\nafter data collection, ex vivo verification was performed using\na fluorescent stereoscopic microscope (MVX10, Olympus,\nJapan; 6.3 objective). Illumination was provided by a heightadjustable 630 nm LED at 20 mW cm 2 . White-light and\nCy5-channel fluorescence images were recorded using filters\nmatched to the Cy5 spectrum, and the lymph nodes were\nidentified, excised, and imaged to validate the in vivo findings.", "5", "III. R ESULTS\nA. Convergence Verification of Optical Property Adaptive\nOptimization\nTo validate our proposed optical property adaptation mechanism, we conducted a series of numerical experiments on\na digital phantom. The primary objective was to demonstrate\nthat the -adaption module can robustly recover absorption a\nand s coefficients from severely erroneous initial estimates,\nthereby enabling high-fidelity fluorescence reconstruction.\nWe constructed a homogeneous digital slab phantom of size\n55 55 15 mm3 featuring an S -shaped fluorescent target at\nits geometric center. The ground-truth optical properties were\n 1\nset to true\nand s true = 1.0 mm 1 . To rigorously\na = 0.1 mm\ntest the correction capability, we initialized the reconstruction\nwith significantly mismatched scattering coefficients ( s init =\n0.5, 1.5, 2.0 mm 1 ) while keeping the absorption coefficient\nfixed at its true value for this specific test.\nAs summarized in Fig. 2 (a), without the -adaption module, the reconstructed fluorescence distributions suffered from\nsubstantial errors in both depth localization and morphological accuracy. The mismatched s value led to an incorrect\nmodel of photon propagation, which directly translated to\ndistorted reconstructions. In contrast, when the -adaption\nmodule was enabled, the proposed NeuFMT successfully\nrecovered fluorescence distributions that closely matched the\nground truth obtained with the correct optical properties.\nCrucially, the evolution of the scattering coefficient during\noptimization, plotted in Fig. 2 (b), demonstrates the module s\nrobust convergence. Regardless of the initial value whether\nhalved or doubled the estimated s reliably converged to the\nneighborhood of the true value (1.0 mm 1 ).\nA similar convergence behavior was observed for the absorption coefficient a . When initialized with biased values\n 1\n( init\n) against a fixed true s , the a = 0.05, 0.15, 0.2 mm\nadaption module corrected a with an average error of only\n1.5% (Fig. 2 (d)), and its convergence curves are shown in\nFig. 2 (e). This convergence robustness was maintained across\na range of true a and s values, confirming the general\nefficacy of our alternating optimization strategy in mitigating\nparameter coupling (Fig. 2 (c), (f)).\nWe further extended the validation to the most challenging\nscenario, where both optical parameters were simultaneously\ninitialized with substantial errors. In this experiment, the initial\nvalues for both a and s were set to 50% higher than\ntheir GT values. Remarkably, even under these highly adverse\nconditions, the -adaption module successfully drove both\nparameters towards their true values. The convergence trajectories remained stable and ultimately reached a neighborhood\nof the true parameter pair. These results collectively verify\nthat the integrated -adaption module empowers NeuFMT\nto jointly recover accurate optical properties and fluorescence\ndistributions even from profoundly inaccurate initial guesses,\neffectively addressing a critical source of ill-posedness in\npractical FMT scenarios.", "6", "PREPRINT VERSION 2025", "0.995", "1.0", "0.996", "1.5", "1.007", "2.0", "1.006", "GT\ny\nx", "DICE =\n0.0257", "0.7337", "0.4660", "Norm.int (a.u.)", "= 1.0\n= 0.1", "Non-Adaptive", "1", "0.3967", "(b)", "1.2\n1.0", "(c)", "1.6", "Adaptive", "y", "0.7198", "0.7230", "0.6964", "Norm.int (a.u.)", "z", "0.7796", "0.9\n 0.8\n 0.5\nAsym.\nLine", "0.8\n0.4", "2", "4", "6", "8", "10", "12", "14", "0.12\n 0.11", "1.4", "Predicted", "z=8", "2.0\n 1.5\n 1.2\n 1.1", "1.6", "0\n1", "2.0", "Predicted", "0.5", "(a)", "0.10\n 0.09", "1.2", "0.08\n1.0", "0", "Asym.\nLine\n1", "2", "4", "8", "16", "32", "64", "iterations\n0.10", "0.100", "0.15", "0.101", "0.20", "0.102", "y\nx", "0.0281", "0.7337", "0.7390", "Norm.int (a.u.)", "GT", "0.5991", "z=8\nz", "Adaptive", "y", "0.6718", "0.7642", "0.8740", "0.8708", "(e)", "0.2", "= 1.0\n= 0.1", "GT", "0.11\n 0.09", "0.12\n0.1\n0.08", "0", "0.04", "1", "(f) 0.16\n0.14", "2", "4", "6", "8", "10", "12", "0.08\n 0.05\nAsym.\nLine", "14", "1.2\n 1.1\n 1.0\n 0.9", "0.12", "0.8\n0.1", "0", "(g)", "0.20\n 0.15\n 0.12", "0.16", "Norm.int (a.u.)", "= 1.0\n= 0.1", "Non-Adaptive", "1", "Predicted", "(d)", "0.097", "Predicted", "0.05", "Asym.\nLine\n1", "2", "4", "8", "16", "32", "64", "iterations\n2000 iters", "5000 iters", "10000 iters", "20000 iters\n1", "y", "(h)", "1.6", "0.16", "1.4", "0.14", "1.2", "0.12", "1.0", "0.1", "0.8125", "0.8651", "0.8691", "z\ny", "= 1.5\n= 0.15", "1.333\n0.1332", "1.177\n0.1156", "1.050\n0.1045", "1.001\n0.0995", "0", "0.8", "2", "5", "8", "11", "14", "17", "Predicted", "0.6481", "Norm.int (a.u.)", "z=8", "Predicted", "x", "0.08\n20", "iterations", "Fig. 2. Ablation test for the optical-property-adaption ( -adaption) module in NeuFMT. (a-c) Effective test for the correction of s . (a) For a homogeneous\nphantom simulation with a S -shaped fluorescence inclusion, the ground truth (GT) of a and s values are 0.1 mm-1 and 1.0 mm-1 respectively. A\nmismatched initial guess of s was assumed for FMT reconstruction. The -adaption module successfully corrects s with an average error of 0.55%,\nleading to significantly improved FMT reconstruction results compared to non-adaptive NeuFMT. (b) Convergence curve of s given more initial s values\nranging from 0.5 to 2 GT value under the same setting of (a). (c) Convergence curve of s value across all cases with different a values, given\ninitial s = 1.5 mm-1 . (d-f) Effective test for the correction of the absorption coefficient ( a ). (d) For the same phantom in (a), a (mismatched) a initial\nvalue is assumed for FMT reconstruction. The -adaption module successfully corrects a with an average error of 1.5%, leading to significantly improved\nFMT reconstruction results. (e) Convergence curve of a given more initial a values ranging from 0.5 to 2 GT value under the same setting of (d).\n(f) Convergence curve of a value across all cases with different s values, given initial a = 0.15 mm-1 . (g-h) Effective test for the correction of both\nabsorption and diffusion coefficients. (g) For the same phantom in (a), given mismatched initial a = 1.5 and s = 0.15, both of which are 50% higher than\nGT, the -adaption module successfully corrects both a and s at the same time. (h) Convergence curve given the iteration process in (g) for both optical\ncoefficients.", "B. Numerical Simulations\nTo comprehensively evaluate the performance of the proposed NeuFMT under controlled conditions, we designed\nfour distinct numerical phantoms (Fig. 3 (a) (d) respectively)\nto systematically increase the reconstruction challenge:\n Case 1 - single small target: a 3 mm-diameter spherical\nfluorescence target embedded in a homogeneous cuboid\nphantom (55 55 15 mm3 ), serving as a baseline\nfor evaluating localization and quantitative accuracy of\na simple, isolated inclusion.\n Case 2 - complex surface geometry: a 2 mm-diameter\nspherical target inside a phantom with a curved surface\ngeometry, featuring a spherical cap top (base: 50 50 4\nmm, cap height = 5 mm, total height = 9 mm). This\ncase tests the method s robustness to non-planar surface\ntopography.", "Case 3 - complex target shape: a large peanut-shaped fluorescence region with uniform concentration embedded in\na standard cuboid phantom same as Case 1. This scenario\nassesses the capability to recover intricate morphological\ndetails beyond simple spheres.\n Case 4 - multi-target with background: the same peanutshaped region as in Case 3, but with the addition of\na small, high-concentration spherical target inside. This\nrepresents a highly realistic and challenging condition,\ntesting the ability to resolve targets of different concentrations and shapes against a noisy background.", "The ground-truth optical properties for all simulated measurements in this test were set to a = 0.1 mm 1 and s = 1.0\nmm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against\nfour established methods: conventional Tikhonov-regularized", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "GT", "L2-CG", "L1-FISTA", "U-Net", "NeuFMT", "μNeuFMT\n1", "y\nx", "y", "z", "DICE =\n0.6581", "z=8", "0.4956", "0.6446", "Norm.int (a.u.)", "Case 1", "(a)", "0.8800", "0.5128", "0\nz", "y\nx", "y\nx", "y", "z", "0.6286", "z=2", "0.7500", "0.0000", "Norm.int (a.u.)", "Case 2", "(b)", "1", "0.7586", "0.2041", "0\nz", "y\nx", "x", "y", "z", "z=8", "0.6938", "0.0828", "0.6153", "Norm.int (a.u.)", "Case 3", "(c)", "1", "y", "0.9751", "0.4766", "0\nz", "y\nx", "y\nx", "y", "z", "0.5435", "z=8", "0.5908", "0.2637", "Norm.int (a.u.)", "Case 4", "(d)", "1", "0.8983", "0.7645", "0\nz", "y\nx", "Norm.int (a.u.)", "(e)", "Case 1", "Case 2", "Case 3", "Case 4", "1", "1", "1", "1", "0.8", "0.8", "0.8", "0.8", "0.6", "0.6", "0.6", "0.6", "0.4", "0.4", "0.4", "0.4", "0.2", "0.2", "0.2", "0", "15", "20", "25", "30", "35", "40", "0\n15", "0\n20", "25", "30", "mm", "GT", "L2-CG", "35", "0.2\n0", "10", "mm", "L1-FISTA", "20", "30", "40", "50", "0", "15", "20", "25", "30", "35", "mm", "U-Net", "NeuFMT", "40", "mm", "μNeuFMT", "Fig. 3. Results of numerical phantom simulations. (a) (d) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (e) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.", "conjugate gradients (L2 -CG) [42] and L1 -regularized nonnegative least squares (L1 -FISTA) [43], a pretrained supervised U-Net, and our baseline method NeuFMT without adaption. The U-Net was trained on a large, synthetically\ngenerated dataset of 5,488 samples. For each sample, the\ninput was a boundary measurement simulated using the DEbased forward model under the ground-truth properties in a\ncuboid phantom (55 55 15 mm3 ), and the label was the\ncorresponding 3D fluorescence map of 1 2 ellipsoids with\nrandom sizes and spatial positions. To clearly demonstrate the\neffect of the -adaption module, we focused on adapting s\nwhile fixing a at its true value during reconstruction. For all\nmethods, the initial s was set to an erroneous value of 1.2\nmm 1 , which is 20% higher than the ground truth.\nThe results presented in Fig. 3 (a) (d) demonstrate the\nconsistent superiority of NeuFMT across all four numerical cases. We observe that the conventional methods were\nadversely affected by the optical property mismatch: L2 -CG\nreconstructions were characteristically blurred and exhibited\nsignificant depth errors, such as full-depth penetration in\nCases 3 and 4 and depth-wise expansion in Case 1. L1 -FISTA\nfrequently introduced non-physical, fragmented artifacts, such\nas staircase patterns in Case 1 and hollow structures in Case 3,\nwhile it also suffered from severe depth inaccuracy. The\nsupervised U-Net, though performed well in Case 1, showed\nlimited generalization beyond its training data, as seen in its\nlocalization failure in the complex surface geometry of Case 2", "7", "and noticeable shape distortion in the unseen peanut-shaped\ntarget of Case 3 and 4. The direct NeuFMT provided better\ndepth prediction than the traditional methods but remained\nsensitive to the erroneous s , resulting in substantial shape\nexpansion in the x-y plane (Cases 1, 2) and axial splitting\n(Case 3). In contrast, NeuFMT successfully rectified the\noptical properties and overcame these limitations. It achieved\nthe most accurate spatial localization and shape fidelity, as\nevidenced by its 3D isosurfaces tightly conforming to the\nground truth in both simple and complex targets, and it clearly\nresolved both the small target and the complex background in\nCase 4. Quantitatively, NeuFMT consistently achieved the\nhighest Dice coefficients, and its intensity profiles (Fig. 3 (e))\nmost closely matched the ground truth in terms of peak\nlocation, width, and background suppression.\nC. Phantom Experiments\nWe further evaluated the performance of all methods using\nphysical phantom experiments to assess their practicality under real-world conditions, including measurement noise. The\nphantoms were fabricated from silicone, with their optical\nproperties calibrated to be approximately a = 0.0055 mm 1\nand s = 1.1 mm 1 at 680 nm. Fluorescent targets were embedded within the phantoms to create the four cases previously\ndefined in the simulations. The initial value of s was set identically for all reconstruction methods as the calibrated value,\nand also the U-Net was retrained accordingly. Consistent with\nthe simulation study, we focused on the adaptive recovery of\nthe reduced scattering coefficient s .\nThe reconstruction results are summarized in Fig. 4. Under\nthese challenging real-world conditions, the limitations of the\nbaseline methods became evident: conventional approaches\n(L2 -CG, L1 -FISTA) produced blurry or fragmented reconstructions with significant depth errors, while the supervised\nU-Net, susceptible to domain shift and noise, failed to generalize, resulting in complete localization failures (Case 1)\nor severely distorted shapes (Cases 3 and 4). In contrast,\nthe INR-based frameworks, NeuFMT and NeuFMT, demonstrated markedly superior robustness, consistently yielding\nphysically plausible and continuous reconstructions where\nother methods failed. A detailed comparison between the two\nreveals that NeuFMT provided critical refinements toward\nenhanced physical consistency. In Cases 1 and 3, NeuFMT\nachieved better depth sensitivity and more uniform fluorophore\ndistribution, more faithfully representing the homogeneous\nnature of the true targets. In the complex geometry of Case 2,\nit uniquely achieved accurate localization, whereas direct\nNeuFMT produced a solution with an aberrant depth shift. For\nthe multi-target scenario in Case 4, NeuFMT reconstructed\nthe background region with improved morphological accuracy.\nAlthough the performance gap in quantitative metrics such\nas the Dice coefficient was occasionally narrow, which reflects the inherent robustness of the shared INR architecture,\n NeuFMT provided consistent, subtle refinements, particularly\nin depth accuracy. The phantom experiments confirm that the\nadaptive physical correction mechanism in NeuFMT can enhance reconstruction fidelity under practical conditions where\nthe exact coefficient in most real experiments is uncertain.", "8", "PREPRINT VERSION 2025", "(a)", "Silicone Phantoms\nGT", "L2-CG", "L1-FISTA", "U-Net", "NeuFMT", "μNeuFMT\n1", "y\nx", "y", "z", "DICE =\n0.5895", "z=8", "0.6154", "0.0762", "Norm.int (a.u.)", "Case 1", "(b)", "Fluorescence Inclusions", "0.7023", "0.6615", "0\nz", "(Fig. 5 (c)). The reconstructed target lengths from NeuFMT\nshowed the closest agreement with the physical measurements\ntaken from the ex vivo lymph nodes, as visualized by the\nintensity profiles in Fig. 5 (c). These results demonstrate that\n NeuFMT provides a definitive advantage in practical in vivo\nscenarios, enabling robust and accurate target segmentation\nand localization under complex clinically related scenarios,\nsuch as fluorescence guided surgery.", "y\nx", "y\nx", "y", "z", "0.3371", "z=2", "0.3810", "0.4000", "0.5200", "0.2586", "White Light Image", "(a)", "vein", "LN-2", "0\nz", "y\nx", "y", "z", "z=8", "0.5413", "0.3358", "0.7011", "0.8230", "0.8050", "0\nz", "y\nx", "y\nx", "y", "z", "0.5193", "z=8", "0.4319", "0.6601", "0.2849", "Norm.int (a.u.)", "0.6240", "NeuFMT", "μNeuFMT\nz\nx", "vein", "LN-3\nLN-2\nLN-1", "Case 3", "Case 4", "1", "1", "0.8", "0.8", "0.6", "0.6", "0.6", "0.6", "0.4", "0.4", "0.4", "0.4", "0.2", "0.2\n20", "25", "30", "35", "40", "0\n15", "0.2\n20", "25", "30", "mm", "GT", "L2-CG", "35", "0.2", "0", "0\n0", "10", "mm", "L1-FISTA", "20", "30", "40", "50", "15", "20", "25", "30", "35", "mm", "U-Net", "NeuFMT", "40", "mm", "NeuFMT-Ada", "Fig. 4. Results of real phantom experiments. (a) Photograph of the real\nsilicone phantoms and fluorescence inclusions. (b) (e) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (f) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.", "10 mm", "(c)", "We performed an in vivo imaging experiment on mice.\nFollowing the protocol described in Subsection II-F, Cy5\nfluorescent dye accumulated primarily at the sentinel lymph\nnodes (LN), with some residual signal at the vein (Fig. 5 (a)).\nOur task was to reconstruct the spatial location and shape of\nthe sentinel lymph nodes.\nThe 3D FMT reconstruction results from all methods\nare presented in Fig. 5 (b). The conventional L2 -CG method\nproduced a reconstruction where the volume of LN-3 was\noverestimated, and the signals from LN-1, LN-2, and the vein\nmerged into a single, indistinguishable cluster. The L1 -FISTA\nreconstruction was highly fragmented, making it impossible\nto discern the shape or count of the lymph nodes accurately.\nAlso, the baseline NeuFMT failed to produce a physiologically plausible reconstruction. In contrast, NeuFMT was\nthe only method that successfully and distinctly resolved all\nthree lymph nodes (LN-1, LN-2, LN-3) and the vein, clearly\nidentifying each as separate, localized regions of fluorescence.\nFor quantitative validation, the mouse was sacrificed, and\nthe lymph nodes were excised to be imaged by ex vivo FRI", "LN-1", "x\ny", "LN-3 LN-2", "10 mm", "0", "1", "1", "1", "0.8", "0.8", "0.8", "0.6", "LN-1", "0.4", "0.6", "LN-2", "0.4", "0.2", "0.6", "0.2", "0\n2", "4", "6", "L2-CG", "8", "10", "12\nmm", "LN-3", "0.4", "0.2", "0\n0", "D. In Vivo Lymph Node FMT Imaging Experiments", "Concentration of Cy5 (a.u.)", "Case 2\n1\n0.8", "Slice z = 8 mm", "Case 1\n1\n0.8", "x\ny", "Slice z = 11 mm", "(f)\nNorm.int (a.u.)", "L1-FISTA", "R", "1", "Profiles", "y\nx", "15", "L2-CG", "LN-3", "L", "0\nz", "0", "R", "y", "Concentration of Cy5 (a.u.)", "Case 4", "(e)", "1", "(b)", "LN-1", "L", "3D Segmentation", "x", "Norm.int (a.u.)", "Case 3", "(d)", "1", "y", "In vivo FRI", "Norm.int (a.u.)", "Case 2", "(c)", "1", "0\n0", "2", "L1-FISTA", "4", "6", "8", "10", "12\nmm", "0", "2", "NeuFMT", "4", "6", "8", "10", "12\nmm", "μNeuFMT", "Fig. 5. In vivo lymph node FMT imaging and reconstruction results. (a) The\nwhite-light image and preview via 2D fluorescence reflectance imaging (FRI)\noverlaid on the white-light image with the red aera indicating the concentrated\ndistribution of Cy5 probe on the cites of three lymph nodes (LN-1, LN-2, LN3) and the vein. (b) Comparison of FMT reconstruction results from different\nmethods. The 3D segmentation, along with two slices at z = 8 and 11 mm,\nare displayed. (c) Intensity profiles along the dashed lines in b. are compared\nfor each ex vivo images of lymph nodes after sacrificing the animal. The gray\nzone represents the estimated size of LN, based on the ex vivo fluorescence\nimages.", "IV. D ISCUSSION AND C ONCLUSION\nIn this study, we introduced NeuFMT, an optical-propertyadaptive FMT reconstruction framework that integrates INR\nwith an explicitly differentiable FEM-based light propagation model. By unifying a continuous fluorescence field parameterized by an INR and a physics-based forward model\namenable to end-to-end optimization, NeuFMT addresses\ntwo fundamental limitations of existing FMT reconstruction\ntechniques: their inability to efficiently adapt to complex and\nheterogeneous fluorescence distribution, and their reliance on", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "fixed, often inaccurate, optical properties, which significantly\nexacerbates the inherent ill-posedness of the inverse problem.\nUnlike supervised deep learning approaches which are constrained by the diversity and scale of training datasets and\noften fail under domain shift, NeuFMT operates in a selfsupervised, physics-informed regime. It does not require paired\ntraining data; instead, it directly minimizes the discrepancy between measured and simulated boundary fluxes. This not only\neliminates the need for extensive experimental datasets but also\nensures generalizability across different imaging geometries\nand target configurations. The continuous, coordinate-based\nrepresentation provided by the INR further ensures that our\nreconstructions are free from discretization artifacts and inherently resolution-agnostic.\nA central contribution of our work is the introduction of\nan optical property adaptation mechanism, which enables the\ndynamic optimization of absorption and scattering coefficients\n( a , s ) concurrently with the fluorescence distribution. Our\nframework demonstrates that the integration of a differentiable\nphysics-based forward model is the key to enabling this\nself-supervised adaptation. The FEM-based light propagation\nmodel is not merely a component of the loss function, but\nan active and adaptive part of the inverse solver. This stands\nin contrast to both traditional iterative methods, which hold\noptical properties static and thus aggravate the problem s illposedness, and conventional end-to-end deep learning approaches, which struggle to generalize beyond their training\ndata. The adaptivity of our model is thus its core strength,\nproviding a principled way to refine the physical model itself\nbased on the measured data, which is crucial for practical\napplications where precise prior knowledge of tissue optics\nis unavailable.\nOur results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate\nthat NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1 ) and deep learningbased (U-Net) benchmarks. In particular, the method consistently localized fluorescent targets with higher spatial accuracy, improved contrast, and more realistic morphological\nfeatures especially under challenging conditions involving\nbackground fluorescence and complex geometry.\nDespite these promising results, several aspects of\n NeuFMT merit further investigation. First, the current implementation assumes a homogeneous optical background a\ncommon simplification in FMT studies. Extending the model\nto incorporate spatially varying optical properties represents\na logical next step, potentially by representing a (r) and\n s (r) with additional INRs, though this would significantly\nincrease the complexity of the inverse problem. Nevertheless,\nthe proposed NeuFMT can be validated or even combined\nwith time-domain near-infrared spectroscopy (fNIRS) [44],\n[45] or diffuse optical tomography (DOT) [46] techniques,\nwhere the complex optical properties related with absorption\nand scattering can disentangled and calibrated. More importantly, the integration of NeuFMT with emerging imaging\ntechnologies holds particular promise. The inherent adaptivity\nof our framework is well-suited to the distinct scattering\nand absorption landscapes of NIR-II fluorescence tomography", "9", "[47], [48], where our optical property optimization could be\ncrucial for accurately modeling the increased photon penetration and achieving higher-resolution reconstruction at depth.\nFurthermore, the framework can be naturally extended to\nhyperspectral FMT, using a single INR to output both fluorophore concentration and spectral signature, thereby disentangling multiple probes or accounting for wavelength-dependent\noptical properties. Finally, translating NeuFMT into clinical\nsettings, such as intraoperative fluorescence-guided surgery\n[8], [9], represents an exciting frontier where its adaptability\ncould overcome patient-specific variations in tissue optics.\nIn conclusion, by harmonizing a differentiable physics\nmodel with a continuous INR, NeuFMT provides a robust,\nself-supervised, and adaptive framework for FMT reconstruction. It effectively mitigates the ill-posedness inherent to\ninverse problems with uncertain parameters, setting a new\nparadigm for practical, high-resolution fluorescence molecular\nimaging. We believe this physics-in-the-loop INR approach\noffers a generalizable template for tackling a wide range of\ntomographic and inverse problems in biomedical imaging.\nR EFERENCES\n[1] F. Song, P. Zhang, H. Wu, C. Ma, Z. Liu, R. Cai, Y. Feng, Y. He,\nX. Dong, Y. Tian, and G. Zhang, Advances of fluorescence molecular\nimaging: NIR-II window, probes, and tomography, Laser & Photonics\nReviews, vol. 19, no. 10, p. 2400275, 2025.\n[2] B. Zhu, J. Hendricks, J. E. Morton, J. C. Rasmussen, C. Janssen,\nM. N. Shah, and E. M. Sevick-Muraca, Near-infrared fluorescence\ntomography and imaging of ventricular cerebrospinal fluid flow and\nextracranial outflow in non-human primates, IEEE Transactions on\nMedical Imaging, vol. 42, no. 12, pp. 3555 3565, 2023.\n[3] M. S. Ozturk and et al., High-resolution tomographic analysis of in\nvitro 3D glioblastoma tumor model under long-term drug treatment, \nScience Advances, vol. 6, no. 10, p. eaay7513, 2020.\n[4] M. Cai, Z. Zhang, X. Shi, Z. Hu, and J. Tian, NIR-II/NIR-I fluorescence molecular tomography of heterogeneous mice based on gaussian\nweighted neighborhood fused lasso method, IEEE Transactions on\nMedical Imaging, vol. 39, no. 6, pp. 2213 2222, 2020.\n[5] S. R. Arridge and J. C. Schotland, Optical tomography: forward and\ninverse problems, Inverse problems, vol. 25, no. 12, p. 123010, 2009.\n[6] L. V. Wang and H.-i. Wu, Biomedical optics: principles and imaging.\nJohn Wiley & Sons, 2007.\n[7] F. Stuker, J. Ripoll, and M. Rudin, Fluorescence molecular tomography:\nprinciples and potential for pharmaceutical research, Pharmaceutics,\nvol. 3, no. 2, pp. 229 274, 2011.\n[8] J. S. D. Mieog, F. B. Achterberg, A. Zlitni, M. Hutteman, J. Burggraaf,\nR.-J. Swijnenburg, S. Gioux, and A. L. Vahrmeijer, Fundamentals and\ndevelopments in fluorescence-guided cancer surgery, Nature Reviews\nClinical Oncology, vol. 19, no. 1, pp. 9 22, 2022.\n[9] K. Wang, Y. Du, Z. Zhang, K. He, Z. Cheng, L. Yin, D. Dong, C. Li,\nW. Li, Z. Hu et al., Fluorescence image-guided tumour surgery, Nature\nReviews Bioengineering, vol. 1, no. 3, pp. 161 179, 2023.\n[10] D. Zhu et al., Comparison of regularization methods in fluorescence\nmolecular tomography, Photonics, vol. 1, no. 2, pp. 95 109, 2014.\n[11] H. Yi et al., Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography:\na comparative study, Journal of Biomedical Optics, vol. 18, no. 5, p.\n56013, 2013.\n[12] J. Shi, B. Zhang, F. Liu, J. Luo, and J. Bai, Efficient L1 regularizationbased reconstruction for fluorescent molecular tomography using\nrestarted nonlinear conjugate gradient, Optics letters, vol. 38, no. 18,\npp. 3696 3699, 2013.\n[13] D. Zhu and C. Li, Nonconvex regularizations in fluorescence molecular\ntomography for sparsity enhancement, Physics in Medicine & Biology,\nvol. 59, no. 12, p. 2901, 2014.\n[14] J. Zhang, L. Li, Q. Hu, J. Zhang, Y. Wu, L. Gu, J. Li, F. Li, X. Zhu,\nJ. Jiang et al., High-fidelity solution decomposition fluorescence tomography in the presence of background interference, Laser & Photonics\nReviews, p. e01013, 2025.", "10", "[15] C. Huang, H. Meng, Y. Gao, S. Jiang, K. Wang, and J. Tian, Fast and\nrobust reconstruction method for fluorescence molecular tomography\nbased on deep neural network, in Imaging, Manipulation, and Analysis\nof Biomolecules, Cells, and Tissues XVII, vol. 10881. SPIE, 2019, pp.\n257 262.\n[16] L. Guo, F. Liu, C. Cai, J. Liu, and G. Zhang, 3D deep encoder decoder\nnetwork for fluorescence molecular tomography, Optics letters, vol. 44,\nno. 8, pp. 1892 1895, 2019.\n[17] P. Zhang, G. Fan, T. Xing, F. Song, and G. Zhang, UHR-DeepFMT:\nultra-high spatial resolution reconstruction of fluorescence molecular\ntomography based on 3-d fusion dual-sampling deep neural network, \nIEEE Transactions on Medical Imaging, vol. 40, no. 11, pp. 3217 3228,\n2021.\n[18] J. Cheng, P. Zhang, F. Liu, J. Liu, H. Hui, J. Tian, and J. Luo, Encoderdecoder deep learning network for simultaneous reconstruction of fluorescence yield and lifetime distributions, Biomedical Optics Express,\nvol. 13, no. 9, pp. 4693 4705, 2022.\n[19] P. Zhang, C. Ma, F. Song, Z. Liu, Y. Feng, Y. Sun, Y. He,\nF. Liu, D. Wang, and G. Zhang, Multi-branch attention prior based\nparameterized generative adversarial network for fast and accurate\nlimited-projection reconstruction in fluorescence molecular tomography, Biomedical Optics Express, vol. 13, no. 10, pp. 5327 5343, 2022.\n[20] P. Zhang, F. Song, C. Ma, Z. Liu, H. Wu, Y. Sun, Y. Feng, Y. He, and\nG. Zhang, Robust reconstruction of fluorescence molecular tomography\nbased on adaptive adversarial learning strategy, Physics in Medicine &\nBiology, vol. 68, no. 4, p. 04LT01, 2023.\n[21] P. Zhang, X. Liu, Q. Xue, Y. Shang, C. Liu, R. Chen, H. Gao, J. Liang,\nW. Wang, and G. Zhang, PAH2T-Former: Paired-attention hybrid\nhierarchical transformer for synergistically enhanced fmt reconstruction\nquality and efficiency, IEEE Transactions on Computational Imaging,\n2025.\n[22] H. Meng, Y. Gao, X. Yang, K. Wang, and J. Tian, K-nearest neighbor\nbased locally connected network for fast morphological reconstruction\nin fluorescence molecular tomography, IEEE transactions on medical\nimaging, vol. 39, no. 10, pp. 3019 3028, 2020.\n[23] D. Li, C. Chen, J. Li, and Q. Yan, Reconstruction of fluorescence\nmolecular tomography based on graph convolution networks, Journal\nof Optics, vol. 22, no. 4, p. 045602, 2020.\n[24] Y. Wang, C. Bian, Y. An, H. Wang, Q. Liang, Y. Du, and J. Tian,\n Graph convolution based residual connected network for morphological reconstruction in fluorescence molecular tomography, in Medical\nImaging 2022: Biomedical Applications in Molecular, Structural, and\nFunctional Imaging, vol. 12036. SPIE, 2022, pp. 527 533.\n[25] Y. Sun, J. Liu, M. Xie, B. Wohlberg, and U. S. Kamilov, Coil:\nCoordinate-based internal learning for tomographic imaging, IEEE\nTransactions on Computational Imaging, vol. 7, pp. 1400 1412, 2021.\n[26] L. Lozenski, M. A. Anastasio, and U. Villa, A memory-efficient selfsupervised dynamic image reconstruction method using neural fields, \nIEEE Transactions on Computational Imaging, vol. 8, pp. 879 892,\n2022.\n[27] A. W. Reed, H. Kim, R. Anirudh, K. A. Mohan, K. Champley, J. Kang,\nand S. Jayasuriya, Dynamic CT reconstruction from limited views\nwith implicit neural representations and parametric motion fields, in\nProceedings of the IEEE/CVF International Conference on Computer\nVision, 2021, pp. 2258 2268.\n[28] L. Shen, J. Pauly, and L. Xing, NeRP: implicit neural representation\nlearning with prior embedding for sparsely sampled image reconstruction, IEEE Transactions on Neural Networks and Learning Systems,\nvol. 35, no. 1, pp. 770 782, 2022.\n[29] R. Liu, Y. Sun, J. Zhu, L. Tian, and U. S. Kamilov, Recovery\nof continuous 3D refractive index maps from discrete intensity-only\nmeasurements using neural fields, Nature Machine Intelligence, vol. 4,\nno. 9, pp. 781 791, 2022.\n[30] S. Shen, L. Li, S. Gao, Y. Wang, L. Gu, S. Li, X. Zhu, J. Jiang, J. Yu, and\nW. Ren, High resolution diffuse optical tomography via neural fields, \nIEEE Transactions on Computational Imaging, 2024.\n[31] K. Han, C. Li, A. Xiao, Y. Tian, J. Tian, and Z. Hu, TSPE: Reconstruction of multi-morphological tumors of NIR-II fluorescence molecular\ntomography based on positional encoding, Computer Methods and\nPrograms in Biomedicine, vol. 261, p. 108554, 2025.\n[32] S. R. Arridge, Optical tomography in medical imaging, Inverse problems, vol. 15, no. 2, p. R41, 1999.\n[33] , Photon-measurement density functions. part I: Analytical forms, \nApplied Optics, vol. 34, no. 31, pp. 7395 7409, 1995.\n[34] S. R. Arridge and M. Schweiger, Photon-measurement density functions. part 2: Finite-element-method calculations, Applied Optics,\nvol. 34, no. 34, pp. 8026 8037, 1995.", "PREPRINT VERSION 2025", "[35] O. C. Zienkiewicz, R. L. Taylor, P. Nithiarasu, and J. Zhu, The finite\nelement method. Elsevier, 1977, vol. 3.\n[36] V. Ntziachristos, C. Bremer, and R. Weissleder, Fluorescence molecular\ntomography resolves protease activity in vivo, Nature Medicine, vol. 8,\nno. 7, pp. 757 760, 2002.\n[37] M. Schweiger and S. Arridge, The Toast++ software suite for forward\nand inverse modeling in optical tomography, Journal of biomedical\noptics, vol. 19, no. 4, pp. 040 801 040 801, 2014.\n[38] W. Ren, H. Isler, M. Wolf, J. Ripoll, and M. Rudin, Smart toolkit\nfor fluorescence tomography: simulation, reconstruction, and validation, \nIEEE Transactions on Biomedical Engineering, vol. 67, no. 1, pp. 16 \n26, 2019.\n[39] S. Gao, J. Zhang, Y. Hu, Y. Wu, L. Li, Q. Hu, X. Lou, X. Zhu, J. Jiang,\nand W. Ren, Multifunctional optical tomography system with highfidelity surface extraction based on a single programmable scanner and\nunified pinhole modeling, IEEE Transactions on Biomedical Engineering, 2023.\n[40] Y. Hu, Y. Wu, L. Li, L. Gu, X. Zhu, J. Jiang, and W. Ren, Simultaneous\nreconstruction of 3D fluorescence distribution and object surface using\nstructured light illumination and dual-camera detection, Optics Express,\nvol. 32, no. 9, pp. 15 760 15 773, 2024.\n[41] C. Ji, M. Zhao, C. Wang, R. Liu, S. Zhu, X. Dong, C. Su, and Z. Gu,\n Biocompatible tantalum nanoparticles as radiosensitizers for enhancing\ntherapy efficacy in primary tumor and metastatic sentinel lymph nodes, \nACS nano, vol. 16, no. 6, pp. 9428 9441, 2022.\n[42] S. Kawata and O. Nalcioglu, Constrained iterative reconstruction by\nthe conjugate gradient method, IEEE Transactions on Medical Imaging,\nvol. 4, no. 2, pp. 65 71, 1985.\n[43] A. Beck and M. Teboulle, A fast iterative shrinkage-thresholding algorithm for linear inverse problems, SIAM Journal on Imaging Sciences,\nvol. 2, no. 1, pp. 183 202, 2009.\n[44] Y. Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared\nspectroscopy and imaging: a review, Applied Sciences, vol. 9, no. 6, p.\n1127, 2019.\n[45] H. Y. Ban, G. M. Barrett, A. Borisevich, A. Chaturvedi, J. L. Dahle,\nH. Dehghani, J. Dubois, R. M. Field, V. Gopalakrishnan, A. Gundran\net al., Kernel flow: a high channel count scalable time-domain functional near-infrared spectroscopy system, Journal of biomedical optics,\nvol. 27, no. 7, p. 074710, 2022.\n[46] A. Pifferi, D. Contini, A. D. Mora, A. Farina, L. Spinelli, and A. Torricelli, New frontiers in time-domain diffuse optics, a review, Journal\nof Biomedical Optics, vol. 21, no. 9, pp. 091 310 091 310, 2016.\n[47] F. Wang, Y. Zhong, O. Bruns, Y. Liang, and H. Dai, In vivo NIRII fluorescence imaging for biology and medicine, Nature Photonics,\nvol. 18, no. 6, pp. 535 547, 2024.\n[48] Z. Zhang, Y. Du, X. Shi, K. Wang, Q. Qu, Q. Liang, X. Ma, K. He,\nC. Chi, J. Tang et al., NIR-II light in clinical oncology: opportunities\nand challenges, Nature Reviews Clinical Oncology, vol. 21, no. 6, pp.\n449 467, 2024."]}
{"method": "recursive", "num_chunks": 830, "avg_chunk_len": 69.32530120481928, "std_chunk_len": 146.6956038987622, "max_chunk_len": 799, "min_chunk_len": 1, "total_chars": 57540, "compression_ratio": 1.024157108098714, "chunks": ["PREPRINT VERSION 2025", "1", "NeuFMT: Optical-Property-Adaptive Fluorescence\nMolecular Tomography via Implicit\nNeural Representation", "arXiv:2511.04510v1 [eess.IV] 6 Nov 2025", "Shihan Zhao, Jianru Zhang, Yanan Wu, Linlin Li, Siyuan Shen, Xingjun Zhu, Guoyan Zheng, Member IEEE,\nJiahua Jiang, and Wuwei Ren", "Abstract Fluorescence Molecular Tomography (FMT) is a\npromising technique for non-invasive 3D visualization of fluorescent probes, but its reconstruction remains challenging due to\nthe inherent ill-posedness and reliance on inaccurate or oftenunknown tissue optical properties. While deep learning methods\nhave shown promise, their supervised nature limits generalization\nbeyond training data. To address these problems, we propose\n NeuFMT, a self-supervised FMT reconstruction framework that\nintegrates implicit neural-based scene representation with explicit\nphysical modeling of photon propagation.", "Its key innovation lies\nin jointly optimize both the fluorescence distribution and the\noptical properties ( ) during reconstruction, eliminating the need\nfor precise prior knowledge of tissue optics or pre-conditioned\ntraining data. We demonstrate that NeuFMT robustly recovers\naccurate fluorophore distributions and optical coefficients even\nwith severely erroneous initial values (0. 5 to 2 of ground\ntruth).", "Extensive numerical, phantom, and in vivo validations\nshow that NeuFMT outperforms conventional and supervised\ndeep learning approaches across diverse heterogeneous scenarios. Our work establishes a new paradigm for robust and accurate\nFMT reconstruction, paving the way for more reliable molecular\nimaging in complex clinically related scenarios, such as fluorescence guided surgery. Index Terms fluorescence molecular tomography, image reconstruction, optical properties, implicit neural representation,\nfluorescence guided surgery", "The work was supported by Science and Technology Commission of Shanghai Municipality under Grant 25JS2830300 (Wuwei Ren), National Natural\nScience Foundation of China under Grants 62105205 (Wuwei Ren), and\nShanghai Clinical Research and Trial Center (Wuwei Ren). (Corresponding\nauthor: Wuwei Ren. )\nShihan Zhao and Jianru Zhang contributed equally to this work.", "Shihan Zhao, Yanan Wu, Linlin Li and Siyuan Shen are with\nthe School of Information Science and Technology, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: zhaoshh, wuyn1, lill,\nshensy2023@shanghaitech. edu. cn).", "Jianru Zhang and Jiahua Jiang are with the School of Mathematics,\nUniversity of Birmingham, Edgbaston, B15 2QN, United Kingdom (e-mail:\njxz389@student. bham. ac.", "uk; j. jiang. 3@bham.", "ac. uk). Xingjun Zhu is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail:\nzhuxj1@shanghaitech.", "edu. cn). Guoyan Zheng is with the Institute of Medical Robotics, School of\nBiomedical Engineering, Shanghai Jiao Tong University, Shanghai 200240,\nChina (e-mail: guoyan.", "zheng@sjtu. edu. cn)\nWuwei Ren is with the School of Information Science and Technology,\nShanghaiTech University, Shanghai 201210, China, and also with State\nKey Laboratory of Advanced Medical Materials and Devices, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: renww@shanghaitech.", "edu. cn).", "I. INTRODUCTION\nFluorescence Molecular Tomography (FMT) has emerged\nas a promising molecular imaging modality, enabling noninvasive 3D visualization of fluorescent probe distribution\nin highly turbid media [1]. Owning to its high sensitivity,\ncost-effectiveness, and non-ionizing radiation, FMT has found\nbroad applications in preclinical research and clinical practice, e.", "g. , brain imaging [2], in vitro cell culture monitoring\n[3] and tumor detection [4]. FMT reconstructs the internal\nfluorescence distribution by measuring the photon distribution\non the object surface and minimizing the discrepancy between\nreal measurements and the simulated results.", "A canonic framework of FMT reconstruction employs an iterative optimization\nstrategy with a forward model typically based on the\nRadiation Transfer Equation (RTE) or the diffusion equation\n(DE) and an inverse model that refines fluorescence distribution prediction until convergence [5], [6]. However, FMT\nreconstruction is inherently ill-posed due to insufficient surface measurements and strong photon scattering effect within\ntissues. Development of high-precision FMT reconstruction\nalgorithms is highly attractive for further improvement of\nthe spatial resolution and detection depth of this technology,\nwhich ultimately broaden the biological applications in drug\ndiscovery [7] and clinical use such as fluorescence guided\nsurgery [8], [9].", "To address the ill-posed nature of FMT reconstruction,\nregularization techniques that incorporate prior knowledge are\napplied. Conventional approaches include Tikhonov (L2 norm)\nregularization for smoothing the results [10], [11], and sparsepromoting regularization (L1 , Lp norm) or total variation (TV)\nregularization for enhancing the spatial resolution [12], [13]. Recent advancements in regularization techniques, such as\nthe solution-decomposition algorithm, utilize an advanced\nstochastic prior model that improves the differentiation of\nfluorescence targets from background interference, thereby\nenhancing reconstruction quality [14].", "While these methods\nstabilize solutions, their reliance on time-consuming iterative\noptimization and idealized assumptions about optical parameters often results in slow convergence and limited accuracy in\nheterogeneous tissues. Deep learning (DL) methods, particularly en-decoder-based neural networks [15] [21] and graphbased networks [22] [24], have recently been used in FMT\nreconstruction by learning direct mappings from boundary\nmeasurements to fluorescence distributions. These approaches", "2", "encode physical priors within network parameters, enabling\noverwhelmingly rapid inference. However, their dependence\non supervised training with large, scenario-specific datasets restricts generalizability across variable experimental conditions\n(e. g.", ", tissue object geometry and optical properties), leading\nto significant accuracy degradation when the object properties\ndeviate from training assumptions. Recently, implicit neural representation (INR) models have\nemerged as a powerful alternative for medical image reconstruction. By mapping arbitrary spatial coordinates to certain\nunknown physical quantities via a coordinate-based multilayer perceptron network (MLP), INRs achieve continuous\n3D representations, self-supervised training, and memory efficiency.", "Originally popularized in computer vision and medical imaging, INRs have demonstrated remarkable success\nin modalities such as computed tomography (CT), magnetic\nresonance imaging (MRI) [25] [29], and notably in diffuse\noptical tomography (DOT), where INR has been proven to be\nable to capture a high-resolution, continuous optical absorption\nmap that account for light scattering in complex tissues [30]. INR captures continuous spatial information and integrates\nphysical priors makes it particularly suited for various imaging problems. In the context of FMT, preliminary work has\nexplored position encoding strategies to enhance spatial resolution and improve the quality of FMT reconstructions [31].", "Nevertheless, systematic studies integrating optical diffusion\nphysics within an INR framework remain scarce. This gap\npresents an opportunity to harness the strengths of implicit\nmodeling for robust and data-efficient FMT reconstruction. To bridge this gap, we propose neural-field-based FMT, or\nNeuFMT, a physics-driven reconstruction framework unifying\nINR with explicit physical models.", "Unlike conventional DLbased FMT reconstruction algorithms that couple explicit\nfluorescence predictions to implicit physical model, NeuFMT\nintegrates the DE-based forward model in the network loss,\nenabling self-supervised training without paired data. The\ndifferentiability of the forward model is achieved via finite\nelement method (FEM). This inversion-free approach ensures\nrapid, continuous reconstruction across diverse geometries\nwhile inherently addressing scattering effects.", "Another critical\nlimitation of both traditional and DL methods lies in the\npresumed optical properties of the object during reconstruction, which largely aggravate the ill-posedness of the inverse\nproblem given the optical parameters were initially biased. To\novercome this, we further introduce optical-property-adaptive\nNeuFMT, or NeuFMT, an adaptive extension of NeuFMT\nthat dynamically optimizes scattering / absorption coefficients\nand fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations, NeuFMT achieves robust accuracy even when provided\nwith erroneous initial guess of the optical coefficient values,\naddressing the problem of unrealistic assumption prior to\nFMT reconstruction.", "Both proposed INR-based FMT reconstruction algorithms were thoroughly compared and validated\nby simulations and phantom experiments along with other\nmethods. Furthermore, in vivo lymph node imaging in mice\nwas performed, further demonstrating the advantages of the\nproposed methods.", "PREPRINT VERSION 2025", "II. M ETHODS\nA. Forward Modeling of FMT\nModel-based FMT reconstruction comprises two fundamental steps: forward modeling and inversion. The former predicts\nsurface photon density measurements based on an assumed\nfluorescence distribution. At the macroscopic scale, we employ\nthe first-order approximation of the radiative transport equation (RTE), known as the diffusion equation (DE) [32]. The\nexcitation and fluorescence emission processes in continuouswave (CW) mode form a coupled pair of DEs expressed as\n[33], [34]:\n κ ϕx (r) + a ϕx (r) = qx (r),", "r , (1)", "κ ϕm (r) + a ϕm (r) = η C(r) ϕx (r),", "r , (2)", "where ϕx and ϕm denote the excitation and emission photon\ndensity, qx is the excitation source, C(r) is the fluorophore\nconcentration to be reconstructed in the inversion, and η\ncollects quantum-yield factors in the CW source term. κ\nrepresents the diffusion coefficient, calculated by [33]\n1\n,\n(3)\nκ=\n3 ( a + s )\nwith the absorption coefficient a and the reduced scattering\ncoefficient s . In a non-contact setting of FMT, to calculate\nthe value of ϕ (r) on the object surface as the measurement, a Robin-type boundary condition is added alongside the\nequation pair (1 2):\n ϕ (r)\n= 0, {x, m}, r , (4)\n ν\nwhere ζ(c) is the refractive index mismatch parameter that\naccounts for the light reflection on the boundary surface, with\nc representing the light speed inside the medium.", "ν denotes\nthe outward normal on the boundary. Notably, to simplified the\nproblem setting, we only consider a homogeneous medium\ncase and the difference of a , s values under different\nwavelengths are neglected. ϕ (r) + 2 ζ(c) κ", "B. Finite Element Discretization and System Matrix Construction\nWe apply the finite element method (FEM) [35] to the\ndiffusion model (1) - (4). Discretizing with a tetrahedral\nN\nmesh of N\ni }i=1 , we approximate\nP nodes and nodal basis {ψP\nϕ (r) i Φ ,i ψi (r) and qx (r) i (Qx )i ψi (r), which\ntransforms the continuous-form equations into a linear system\nfor excitation and emission photon propagation:\nS Φx = Qx", "(5)", "S Φm = Qm", "(6)", "where S RN N is the system matrix and Φ , Q RN\nare discretized form (coefficient vectors) for ϕ and q , respectively. In particular, the excitation field ϕx interacts with\nfluorophores C RN to produce the emission source term\nQm = C Φx", "(7)", "with denoting element-wise multiplication. The equation\n(7) physically describes how fluorophores absorb excitation", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "explicitly reveals the functional dependence of S on the\noptical parameters a and s , which forms the mathematical\nfoundation for our adaptive optimization approach introduced\nin Subsection II-C.", "(b)", "(a)", "3", "Camera\nFilter Wheel\nReal Measurement\nSample", "C. INR-based FMT reconstruction: NeuFMT / NeuFMT\nScanners", "Laser\nPredicted\nMeasurement", "Focal Lens OD Filter\n(c)", "(d)", "Adaption Module", "Forward Model\nBased on DE", "Absorption Term\nHigh Absorption", "Low Absorption", "inv\nDi usion Term", "High Scattering", "Sti ness Matrix", "Low Scattering\nBoundary Term", "(e)", "Forward Data\nBackward Gradient", "Fluorescence Distribution Encoded with INR\nNode Coordinate", "3D Mesh with", "Nodes", "sine", "cosine", "Positional\nEncoding", "MLP", "Fig. 1. Conceptual illustration of NeuFMT.", "(a) The FMT setup: a scanned\nlaser illuminates the sample while a CMOS camera with filter wheel on the\nopposite side records boundary images. The raster scanning method yields\nthe raw 2D image stack M real , serving as the input to the subsequent FMT\nreconstruction. (b) The difference between M real and the simulated meac( a , , Cθ ) is iteratively minimized until an optimized value\nsurement M\ns\nof unknown fluorescence distribution C is found.", "R(C) is a regularization\nterm and { a , s } is the intrinsic optical properties consisting of\nabsorption coefficient a and scattering coefficient s . (c) A -adaption\nmodule is integrated into the FMT reconstruction. The stiffness matrix S is\ndetermined by both a and s .", "(d) The FEM-based simulator predicts virtual\nc( a , , Cθ ) based on the operator S 1 ( ) and predicted\nmeasurement M\ns\nfluorescence distribution C. (e) Fluorescence distribution encoded in an INR. 3D node coordinate serves as input, while a continuous C map is generated\nthrough positional encoding and an MLP network.", "Unlike traditional voxel-based or mesh-dependent representations, INR provides a continuous, memory-efficient framework for modeling complex physical fields. The basic variant,\nNeuFMT, learns only the fluorophore Cθ with fixed optical\nproperties; the proposed adaptive NeuFMT jointly optimizes\nthe optical coefficients ( a , s ) with Cθ for enhancing the\nreconstruction accuracy and robustness. In this section, we\ndescribe the NeuFMT representation, formulate the learning\nobjective, introduce optical-property adaptation, and summarize the network architecture and implementation.\n1) INR representation of the unknown fluorescence: Our\n NeuFMT model the 3D fluorescence field as an INR, i.e., a\ncoordinate-conditioned MLP:", "Cθ (r) = fθ Γ (r) ,\n(10)\nwhere r = (x, y, z) R3 , Γ : Rd is a highdimensional positional encoding of spatial coordinates, and\nfθ : Rd R is an MLP with parameters θ. This INR formulation (10) enables resolution-independent reconstruction and\nnaturally accommodates arbitrary spatial queries without being\nconstrained by the conventional discrete grid structure.\nTo enhance the network s ability to represent high-frequency\ndetails, which is crucial for resolving complex in vivo fluorescence patterns, we apply a sinusoidal positional encoding to\neach coordinate component. Let γ : R R2L be\nγ(p) = sin(20 πp), cos(20 πp), ,\nL 1", "sin(2", "πp), cos(2", "L 1", "(11)", "πp) ,", "p {x, y, z},", "photons and re-emit light at longer wavelengths. The emission\nsource Qm then propagates through the same medium to\nproduce the emission photon density Φm , which is finally\ndetected at the boundary, which is computed as", "where L is the number of frequency bands. The\n 3D position\nis then encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that\nd = 6L. Feeding Γ (r) into fθ enables compact representation\nof both low- and high-frequency variations in Cθ .\n2) Learning objective: We estimate the fluorescence field\nCθ and, in NeuFMT, the optical properties { a , s } by\nminimizing a data-fidelity term plus regularization:", "M = P Φm", "c( a , , Cθ ) M real 2 + λ R(Cθ ), (12)\nL( a , s , θ) = M\ns\n2", "(8)", "where P represents the transfer function, which maps the\nboundary photon density Φm the measurement data M acquired by the camera. The above linearized forward model\nprovides the physical foundation for the inversion procedure.\nCrucially, the SPD FEM stiffness matrix S( a , s ) \nN N\nR\nin (5) (6) encode the optical properties and boundary\ngeometry, generating from a linear combination of matrices\ncorresponding to distinct physical components [33], [36]", "1", "Sd + Sb . (9)\nS( a , s ) = c a Sa +\n3( a + s )\nwith Sa , Sd , and Sb the assembled absorption, diffusion, and\nRobin-boundary matrices, respectively. This decomposition", "c denotes the boundary measurements, and R(Cθ ) is\nwhere M\na regularization term applied to the fluorescence distribution.\nThe hyperparameter λ controls the regularization strength,\nbalancing data fidelity with sparsity constraints. The training of\n NeuFMT / NeuFMT follows a fully self-supervised paradigm\nthat explicitly integrates the DE-based physical model into\nthe optimization loop. Note that NeuFMT uses fixed optical\nparameters ( a , s ), whereas NeuFMT updates jointly.\n3) Alternating optical-property adaptation: A fundamental\ninnovation of NeuFMT lies in formulating the entire photon propagation process from excitation to emission as an\nend-to-end differentiable map. The forward model follows a", "4", "PREPRINT VERSION 2025", "precise physical sequence from excitation source to surface\nmeasurements, as described in Subsection II-B:", "c( a , s , Cθ ) = P S( a , s ) 1 Cθ S( a , s ) 1 Qx ,\nM\n(13)\nWe optimize the introduced objective L( a , s , θ) in (12),\njointly updating network parameters θ and optical coefficients\n( a , s ). The chain in (13) contains only differentiable operations, including linear solves, elementwise products, and linear\nc is differentiable w.r.t. both Cθ (hence θ)\nprojections. Thus M", "and ( a , s ), enabling standard gradient-based training. For\ncompleteness, we state the chain-rule decomposition of the\nloss gradient with respect to ( a , s ). Based on (13), the\ngradient splits into an emission term and an excitation term:", "c \n S\n L M\n L\n S 1\n=\nΦm +\nc Φm", "{z\n}\n| M\nEmission pathway", "c Φm Qm \n L M\n S\nΦx\n S 1\nc Φm Qm Φx", "| M\n{z\n}", "(14)", "Excitation pathway", "{ a , s }.\nThe only model-specific ingredient of a and s is the\nJacobian of S( a , s ). According to (9), the partial derivatives\nare", "S\n1\n= c Sa \nSd ,\n a\n3( a + s )2", "S\n1\n=c \nSd . (15)\n s\n3( a + s )2\nThis allows a and s to be optimized directly using gradient\ndescent, and then be updated together with θ, bridging the\nlearning process with the underlying physical model. To mitigate potential coupling effects between a and s\nduring optimization, we propose an alternating update strategy,\nwhich periodically updates one optical parameter with the\nother fixed.", "The alternating framework largely promotes training stability to avoid oscillations with sufficient computational\nefficiency. The complete NeuFMT algorithm is described in\nAlgorithm 1. Overall, the alternating -adaption module ensures that each optical parameter receives dedicated optimization attention while maintaining the physical consistency of\nthe forward model, yielding more accurate FMT reconstruction\nresults even in the presence of mismatch between the initial\nguess and ground truth of the optical properties.", "4) Network architecture and implementation: We adopt\nMLP for the NeuFMT / NeuFMT, comprising 8 fullyconnected layers with 512 hidden units each, followed by\na final layer with 128 units. ReLU activation functions are\nemployed throughout the network. A critical skip connection\nbridges the input Γ (r) to the 4th hidden layer, facilitating\ngradient flow and enhancing the ability to learn fine-grained\ndetails.", "This architectural choice is particularly suited for FMT\napplications where accurately reconstructing high-contrast targets against complex backgrounds is essential. We implement the NeuFMT / NeuFMT framework with\nPyTorch, leveraging its automatic differentiation capability to", "compute the gradient through both MLP and the physical\nmodel. Adam optimizer is used with the initial learning rates\nof 10 4 for θ update, 10 3 for scattering coefficient and\n10 5 for absorption coefficient. To improve the computational\nefficiency, a learning rate decay is applied for MLP update.", "These rates are determined empirically to ensure stable convergence. The L1 regularization parameter λ is set to 10 6\nbased on cross validation. The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality,\nwith the entire process completing within 3 30 minutes on\na single NVIDIA RTX 3090 GPU for problems of varying\nscales.", "The FEM discretization is built on TOAST++ toolkit\n[37], and the FMT simulation is based on a modular software\nplatform STIFT [38] in MATLAB (R2024b, MathWorks, MA,\nUS) using a desktop computer (Intel Core i5-12600 CPU @\n3. 30 GHz, 128 GB RAM). Algorithm 1 NeuFMT\nRequire: Real measurements M real , light speed c, stepsizes\nαθ , αa , αs , alternation period T , total iterations K\n1: Initialize θ, a , s ;\n2: Precompute Sa , Sd , Sb , Qx , P\n3: Compute S via (9);\n4: for i = 1 to K do \n5:\nC = fθ Γ (r)\n6:\nSolve Φx RN satisfying S Φx = Qx\n7:\nQm = C Φx\n8:\nSolve Φm RN satisfying S Φm = Qm\nc = P Φm\n9:\nCompute predicted measurements: M\nreal 2\nc\n10:\nCompute loss: L = M M 2 + R(C)\n11:\nUpdate MLP parameters: θ = θ αθ L\n θ\n12:\nif i mod\n T = 0 then\n13:\nif i/T is even then\n L\n14:\nUpdate absorption: a = a", "αa \na\n15:\nelse\n L\n16:\nUpdate diffusion: s = s αs", "s\n17:\nend if", "1\n18:\nUpdate S = c a Sa +\nS\n+\nS\nd\nb ;\n3( a + s )\n19:\nend if\n20: end for\n21: Output: fluorescence C, optical parameters a , s", "D. FMT System Setup\nWe devised a continuous-wave (CW) FMT system\n(SHMOT) [39], [40] as depicted in Fig. 1 (a), which incorporates a 16-bit CMOS camera (Edge 4.2, PCO, Germany) with\n2048 2048 pixel resolution and a filter wheel (FW102C,\nThorlabs, NJ, US) for selective wavelength detection. A\ntunable laser source (SuperK EXTREME, NKT, Denmark),\nspanning 400-890 nm, provides fluorescence excitation with a\npower density of approximately 2 mW/mm2 at the sample\nplane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube, Germany) mounted aside steers\nthe laser beam to raster-scan either the top or bottom object", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "surface, enabling switchable reflection-/transmission-mode detection. During experiments, the camera exposure time was\nfixed at 500 ms, with pixel binning applied to improve the\nsignal-to-noise ratio. The acquired raw 2D image data serve\nas supervision target for NeuFMT / NeuFMT reconstruction\n(Fig. 1 (b)). It worth mentioning that our FMT system also\nintegrates a programmable line-scanning illumination, which\nenables high-precision extraction of the surface geometry\nwith approximated maximum error of 0.1 mm. The extracted\nsurface information is then leveraged as prior knowledge for\nFEM meshing and improving reconstruction accuracy.", "E. Phantom preparation and optical calibration\nIn our validation, the slab phantomswere cast from silicone (SYLGARDTM 184; DOW, CA, USA) to emulate softtissue matrix. Optical properties were tuned by dispersing\ntitanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon\nblack powder (Colins, Shanghai, China) as scattering and\nabsorbing additives, respectively. In all phantoms, TiO2 and\ncarbon black were uniformly distributed. All the designs\nshown in Fig. 4 (a) used the same TiO2 /carbon-black mixing\nratio, yielding isotropic media with identical absorption and\nscattering parameters.", "F. In Vivo Lymph Node FMT Imaging\nFollowing numerical simulations and phantom experiments,\nwe evaluated the proposed method in vivo in a murine lymph\nnode imaging task. In cancer diagnostics, lymph node metastasis is a key prognostic indicator of tumor progression.", "Fluorescence imaging enables rapid screening of sentinel lymph\nnodes [41]. In our experiment, all animal procedures were approved by\nthe Institutional Animal Care and Use Committee of ShanghaiTech University (Approval No. 20211115001).", "5 female\nBALB/c mice (8 weeks old) were obtained from Shanghai\nJihui Laboratory Animal Breeding Co. Ltd. and housed under\na circadian rhythm of 12 hours of day and night alternation.", "Before taking imaging experiments, fur was removed over the\nwhole body. For FMT reconstruction, we assumed an optically\nhomogeneous medium with properties calibrated during the\nexcitation step with ( a = 0. 0055 mm 1 , s = 1.", "1 mm 1 ). We followed a three-stage protocol fluorescent-dye injection, imaging, and ex vivo validation. Prior to FMT imaging, Cy5-saline solution (1.", "2146 mol mL 1 , 40 L) was injected subcutaneously into the left forepaw to drive lymphatic\ndrainage toward the sentinel lymph nodes and create a highintensity target. Next, follow-up FMT measurements were\nacquired using the system setup in Subsection II-D. Finally,\nafter data collection, ex vivo verification was performed using\na fluorescent stereoscopic microscope (MVX10, Olympus,\nJapan; 6.", "3 objective). Illumination was provided by a heightadjustable 630 nm LED at 20 mW cm 2 . White-light and\nCy5-channel fluorescence images were recorded using filters\nmatched to the Cy5 spectrum, and the lymph nodes were\nidentified, excised, and imaged to validate the in vivo findings.", "5", "III. R ESULTS\nA. Convergence Verification of Optical Property Adaptive\nOptimization\nTo validate our proposed optical property adaptation mechanism, we conducted a series of numerical experiments on\na digital phantom.", "The primary objective was to demonstrate\nthat the -adaption module can robustly recover absorption a\nand s coefficients from severely erroneous initial estimates,\nthereby enabling high-fidelity fluorescence reconstruction. We constructed a homogeneous digital slab phantom of size\n55 55 15 mm3 featuring an S -shaped fluorescent target at\nits geometric center. The ground-truth optical properties were\n 1\nset to true\nand s true = 1.", "0 mm 1 . To rigorously\na = 0. 1 mm\ntest the correction capability, we initialized the reconstruction\nwith significantly mismatched scattering coefficients ( s init =\n0.", "5, 1. 5, 2. 0 mm 1 ) while keeping the absorption coefficient\nfixed at its true value for this specific test.", "As summarized in Fig. 2 (a), without the -adaption module, the reconstructed fluorescence distributions suffered from\nsubstantial errors in both depth localization and morphological accuracy. The mismatched s value led to an incorrect\nmodel of photon propagation, which directly translated to\ndistorted reconstructions.", "In contrast, when the -adaption\nmodule was enabled, the proposed NeuFMT successfully\nrecovered fluorescence distributions that closely matched the\nground truth obtained with the correct optical properties. Crucially, the evolution of the scattering coefficient during\noptimization, plotted in Fig. 2 (b), demonstrates the module s\nrobust convergence.", "Regardless of the initial value whether\nhalved or doubled the estimated s reliably converged to the\nneighborhood of the true value (1. 0 mm 1 ). A similar convergence behavior was observed for the absorption coefficient a .", "When initialized with biased values\n 1\n( init\n) against a fixed true s , the a = 0. 05, 0. 15, 0.", "2 mm\nadaption module corrected a with an average error of only\n1. 5% (Fig. 2 (d)), and its convergence curves are shown in\nFig.", "2 (e). This convergence robustness was maintained across\na range of true a and s values, confirming the general\nefficacy of our alternating optimization strategy in mitigating\nparameter coupling (Fig. 2 (c), (f)).", "We further extended the validation to the most challenging\nscenario, where both optical parameters were simultaneously\ninitialized with substantial errors. In this experiment, the initial\nvalues for both a and s were set to 50% higher than\ntheir GT values. Remarkably, even under these highly adverse\nconditions, the -adaption module successfully drove both\nparameters towards their true values.", "The convergence trajectories remained stable and ultimately reached a neighborhood\nof the true parameter pair. These results collectively verify\nthat the integrated -adaption module empowers NeuFMT\nto jointly recover accurate optical properties and fluorescence\ndistributions even from profoundly inaccurate initial guesses,\neffectively addressing a critical source of ill-posedness in\npractical FMT scenarios.", "6", "PREPRINT VERSION 2025", "0.995", "1.0", "0.996", "1.5", "1.007", "2.0", "1.006", "GT\ny\nx", "DICE =\n0.0257", "0.7337", "0.4660", "Norm.int (a.u.)", "= 1.0\n= 0.1", "Non-Adaptive", "1", "0.3967", "(b)", "1.2\n1.0", "(c)", "1.6", "Adaptive", "y", "0.7198", "0.7230", "0.6964", "Norm.int (a.u.)", "z", "0.7796", "0.9\n 0.8\n 0.5\nAsym.\nLine", "0.8\n0.4", "2", "4", "6", "8", "10", "12", "14", "0.12\n 0.11", "1.4", "Predicted", "z=8", "2.0\n 1.5\n 1.2\n 1.1", "1.6", "0\n1", "2.0", "Predicted", "0.5", "(a)", "0.10\n 0.09", "1.2", "0.08\n1.0", "0", "Asym.\nLine\n1", "2", "4", "8", "16", "32", "64", "iterations\n0.10", "0.100", "0.15", "0.101", "0.20", "0.102", "y\nx", "0.0281", "0.7337", "0.7390", "Norm.int (a.u.)", "GT", "0.5991", "z=8\nz", "Adaptive", "y", "0.6718", "0.7642", "0.8740", "0.8708", "(e)", "0.2", "= 1.0\n= 0.1", "GT", "0.11\n 0.09", "0.12\n0.1\n0.08", "0", "0.04", "1", "(f) 0.16\n0.14", "2", "4", "6", "8", "10", "12", "0.08\n 0.05\nAsym.\nLine", "14", "1.2\n 1.1\n 1.0\n 0.9", "0.12", "0.8\n0.1", "0", "(g)", "0.20\n 0.15\n 0.12", "0.16", "Norm.int (a.u.)", "= 1.0\n= 0.1", "Non-Adaptive", "1", "Predicted", "(d)", "0.097", "Predicted", "0.05", "Asym.\nLine\n1", "2", "4", "8", "16", "32", "64", "iterations\n2000 iters", "5000 iters", "10000 iters", "20000 iters\n1", "y", "(h)", "1.6", "0.16", "1.4", "0.14", "1.2", "0.12", "1.0", "0.1", "0.8125", "0.8651", "0.8691", "z\ny", "= 1.5\n= 0.15", "1.333\n0.1332", "1.177\n0.1156", "1.050\n0.1045", "1.001\n0.0995", "0", "0.8", "2", "5", "8", "11", "14", "17", "Predicted", "0.6481", "Norm.int (a.u.)", "z=8", "Predicted", "x", "0.08\n20", "iterations", "Fig. 2. Ablation test for the optical-property-adaption ( -adaption) module in NeuFMT.", "(a-c) Effective test for the correction of s . (a) For a homogeneous\nphantom simulation with a S -shaped fluorescence inclusion, the ground truth (GT) of a and s values are 0. 1 mm-1 and 1.", "0 mm-1 respectively. A\nmismatched initial guess of s was assumed for FMT reconstruction. The -adaption module successfully corrects s with an average error of 0.", "55%,\nleading to significantly improved FMT reconstruction results compared to non-adaptive NeuFMT. (b) Convergence curve of s given more initial s values\nranging from 0. 5 to 2 GT value under the same setting of (a).", "(c) Convergence curve of s value across all cases with different a values, given\ninitial s = 1. 5 mm-1 . (d-f) Effective test for the correction of the absorption coefficient ( a ).", "(d) For the same phantom in (a), a (mismatched) a initial\nvalue is assumed for FMT reconstruction. The -adaption module successfully corrects a with an average error of 1. 5%, leading to significantly improved\nFMT reconstruction results.", "(e) Convergence curve of a given more initial a values ranging from 0. 5 to 2 GT value under the same setting of (d). (f) Convergence curve of a value across all cases with different s values, given initial a = 0.", "15 mm-1 . (g-h) Effective test for the correction of both\nabsorption and diffusion coefficients. (g) For the same phantom in (a), given mismatched initial a = 1.", "5 and s = 0. 15, both of which are 50% higher than\nGT, the -adaption module successfully corrects both a and s at the same time. (h) Convergence curve given the iteration process in (g) for both optical\ncoefficients.", "B. Numerical Simulations\nTo comprehensively evaluate the performance of the proposed NeuFMT under controlled conditions, we designed\nfour distinct numerical phantoms (Fig. 3 (a) (d) respectively)\nto systematically increase the reconstruction challenge:\n Case 1 - single small target: a 3 mm-diameter spherical\nfluorescence target embedded in a homogeneous cuboid\nphantom (55 55 15 mm3 ), serving as a baseline\nfor evaluating localization and quantitative accuracy of\na simple, isolated inclusion.\n Case 2 - complex surface geometry: a 2 mm-diameter\nspherical target inside a phantom with a curved surface\ngeometry, featuring a spherical cap top (base: 50 50 4\nmm, cap height = 5 mm, total height = 9 mm). This\ncase tests the method s robustness to non-planar surface\ntopography.", "Case 3 - complex target shape: a large peanut-shaped fluorescence region with uniform concentration embedded in\na standard cuboid phantom same as Case 1. This scenario\nassesses the capability to recover intricate morphological\ndetails beyond simple spheres.\n Case 4 - multi-target with background: the same peanutshaped region as in Case 3, but with the addition of\na small, high-concentration spherical target inside. This\nrepresents a highly realistic and challenging condition,\ntesting the ability to resolve targets of different concentrations and shapes against a noisy background.", "The ground-truth optical properties for all simulated measurements in this test were set to a = 0.1 mm 1 and s = 1.0\nmm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against\nfour established methods: conventional Tikhonov-regularized", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "GT", "L2-CG", "L1-FISTA", "U-Net", "NeuFMT", "μNeuFMT\n1", "y\nx", "y", "z", "DICE =\n0.6581", "z=8", "0.4956", "0.6446", "Norm.int (a.u.)", "Case 1", "(a)", "0.8800", "0.5128", "0\nz", "y\nx", "y\nx", "y", "z", "0.6286", "z=2", "0.7500", "0.0000", "Norm.int (a.u.)", "Case 2", "(b)", "1", "0.7586", "0.2041", "0\nz", "y\nx", "x", "y", "z", "z=8", "0.6938", "0.0828", "0.6153", "Norm.int (a.u.)", "Case 3", "(c)", "1", "y", "0.9751", "0.4766", "0\nz", "y\nx", "y\nx", "y", "z", "0.5435", "z=8", "0.5908", "0.2637", "Norm.int (a.u.)", "Case 4", "(d)", "1", "0.8983", "0.7645", "0\nz", "y\nx", "Norm.int (a.u.)", "(e)", "Case 1", "Case 2", "Case 3", "Case 4", "1", "1", "1", "1", "0.8", "0.8", "0.8", "0.8", "0.6", "0.6", "0.6", "0.6", "0.4", "0.4", "0.4", "0.4", "0.2", "0.2", "0.2", "0", "15", "20", "25", "30", "35", "40", "0\n15", "0\n20", "25", "30", "mm", "GT", "L2-CG", "35", "0.2\n0", "10", "mm", "L1-FISTA", "20", "30", "40", "50", "0", "15", "20", "25", "30", "35", "mm", "U-Net", "NeuFMT", "40", "mm", "μNeuFMT", "Fig. 3. Results of numerical phantom simulations. (a) (d) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (e) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.", "conjugate gradients (L2 -CG) [42] and L1 -regularized nonnegative least squares (L1 -FISTA) [43], a pretrained supervised U-Net, and our baseline method NeuFMT without adaption. The U-Net was trained on a large, synthetically\ngenerated dataset of 5,488 samples. For each sample, the\ninput was a boundary measurement simulated using the DEbased forward model under the ground-truth properties in a\ncuboid phantom (55 55 15 mm3 ), and the label was the\ncorresponding 3D fluorescence map of 1 2 ellipsoids with\nrandom sizes and spatial positions.", "To clearly demonstrate the\neffect of the -adaption module, we focused on adapting s\nwhile fixing a at its true value during reconstruction. For all\nmethods, the initial s was set to an erroneous value of 1. 2\nmm 1 , which is 20% higher than the ground truth.", "The results presented in Fig. 3 (a) (d) demonstrate the\nconsistent superiority of NeuFMT across all four numerical cases. We observe that the conventional methods were\nadversely affected by the optical property mismatch: L2 -CG\nreconstructions were characteristically blurred and exhibited\nsignificant depth errors, such as full-depth penetration in\nCases 3 and 4 and depth-wise expansion in Case 1.", "L1 -FISTA\nfrequently introduced non-physical, fragmented artifacts, such\nas staircase patterns in Case 1 and hollow structures in Case 3,\nwhile it also suffered from severe depth inaccuracy. The\nsupervised U-Net, though performed well in Case 1, showed\nlimited generalization beyond its training data, as seen in its\nlocalization failure in the complex surface geometry of Case 2", "7", "and noticeable shape distortion in the unseen peanut-shaped\ntarget of Case 3 and 4. The direct NeuFMT provided better\ndepth prediction than the traditional methods but remained\nsensitive to the erroneous s , resulting in substantial shape\nexpansion in the x-y plane (Cases 1, 2) and axial splitting\n(Case 3). In contrast, NeuFMT successfully rectified the\noptical properties and overcame these limitations.", "It achieved\nthe most accurate spatial localization and shape fidelity, as\nevidenced by its 3D isosurfaces tightly conforming to the\nground truth in both simple and complex targets, and it clearly\nresolved both the small target and the complex background in\nCase 4. Quantitatively, NeuFMT consistently achieved the\nhighest Dice coefficients, and its intensity profiles (Fig. 3 (e))\nmost closely matched the ground truth in terms of peak\nlocation, width, and background suppression.", "C. Phantom Experiments\nWe further evaluated the performance of all methods using\nphysical phantom experiments to assess their practicality under real-world conditions, including measurement noise. The\nphantoms were fabricated from silicone, with their optical\nproperties calibrated to be approximately a = 0.", "0055 mm 1\nand s = 1. 1 mm 1 at 680 nm. Fluorescent targets were embedded within the phantoms to create the four cases previously\ndefined in the simulations.", "The initial value of s was set identically for all reconstruction methods as the calibrated value,\nand also the U-Net was retrained accordingly. Consistent with\nthe simulation study, we focused on the adaptive recovery of\nthe reduced scattering coefficient s . The reconstruction results are summarized in Fig.", "4. Under\nthese challenging real-world conditions, the limitations of the\nbaseline methods became evident: conventional approaches\n(L2 -CG, L1 -FISTA) produced blurry or fragmented reconstructions with significant depth errors, while the supervised\nU-Net, susceptible to domain shift and noise, failed to generalize, resulting in complete localization failures (Case 1)\nor severely distorted shapes (Cases 3 and 4). In contrast,\nthe INR-based frameworks, NeuFMT and NeuFMT, demonstrated markedly superior robustness, consistently yielding\nphysically plausible and continuous reconstructions where\nother methods failed.", "A detailed comparison between the two\nreveals that NeuFMT provided critical refinements toward\nenhanced physical consistency. In Cases 1 and 3, NeuFMT\nachieved better depth sensitivity and more uniform fluorophore\ndistribution, more faithfully representing the homogeneous\nnature of the true targets. In the complex geometry of Case 2,\nit uniquely achieved accurate localization, whereas direct\nNeuFMT produced a solution with an aberrant depth shift.", "For\nthe multi-target scenario in Case 4, NeuFMT reconstructed\nthe background region with improved morphological accuracy. Although the performance gap in quantitative metrics such\nas the Dice coefficient was occasionally narrow, which reflects the inherent robustness of the shared INR architecture,\n NeuFMT provided consistent, subtle refinements, particularly\nin depth accuracy. The phantom experiments confirm that the\nadaptive physical correction mechanism in NeuFMT can enhance reconstruction fidelity under practical conditions where\nthe exact coefficient in most real experiments is uncertain.", "8", "PREPRINT VERSION 2025", "(a)", "Silicone Phantoms\nGT", "L2-CG", "L1-FISTA", "U-Net", "NeuFMT", "μNeuFMT\n1", "y\nx", "y", "z", "DICE =\n0.5895", "z=8", "0.6154", "0.0762", "Norm.int (a.u.)", "Case 1", "(b)", "Fluorescence Inclusions", "0.7023", "0.6615", "0\nz", "(Fig. 5 (c)). The reconstructed target lengths from NeuFMT\nshowed the closest agreement with the physical measurements\ntaken from the ex vivo lymph nodes, as visualized by the\nintensity profiles in Fig. 5 (c). These results demonstrate that\n NeuFMT provides a definitive advantage in practical in vivo\nscenarios, enabling robust and accurate target segmentation\nand localization under complex clinically related scenarios,\nsuch as fluorescence guided surgery.", "y\nx", "y\nx", "y", "z", "0.3371", "z=2", "0.3810", "0.4000", "0.5200", "0.2586", "White Light Image", "(a)", "vein", "LN-2", "0\nz", "y\nx", "y", "z", "z=8", "0.5413", "0.3358", "0.7011", "0.8230", "0.8050", "0\nz", "y\nx", "y\nx", "y", "z", "0.5193", "z=8", "0.4319", "0.6601", "0.2849", "Norm.int (a.u.)", "0.6240", "NeuFMT", "μNeuFMT\nz\nx", "vein", "LN-3\nLN-2\nLN-1", "Case 3", "Case 4", "1", "1", "0.8", "0.8", "0.6", "0.6", "0.6", "0.6", "0.4", "0.4", "0.4", "0.4", "0.2", "0.2\n20", "25", "30", "35", "40", "0\n15", "0.2\n20", "25", "30", "mm", "GT", "L2-CG", "35", "0.2", "0", "0\n0", "10", "mm", "L1-FISTA", "20", "30", "40", "50", "15", "20", "25", "30", "35", "mm", "U-Net", "NeuFMT", "40", "mm", "NeuFMT-Ada", "Fig. 4. Results of real phantom experiments. (a) Photograph of the real\nsilicone phantoms and fluorescence inclusions. (b) (e) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (f) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.", "10 mm", "(c)", "We performed an in vivo imaging experiment on mice. Following the protocol described in Subsection II-F, Cy5\nfluorescent dye accumulated primarily at the sentinel lymph\nnodes (LN), with some residual signal at the vein (Fig. 5 (a)).", "Our task was to reconstruct the spatial location and shape of\nthe sentinel lymph nodes. The 3D FMT reconstruction results from all methods\nare presented in Fig. 5 (b).", "The conventional L2 -CG method\nproduced a reconstruction where the volume of LN-3 was\noverestimated, and the signals from LN-1, LN-2, and the vein\nmerged into a single, indistinguishable cluster. The L1 -FISTA\nreconstruction was highly fragmented, making it impossible\nto discern the shape or count of the lymph nodes accurately. Also, the baseline NeuFMT failed to produce a physiologically plausible reconstruction.", "In contrast, NeuFMT was\nthe only method that successfully and distinctly resolved all\nthree lymph nodes (LN-1, LN-2, LN-3) and the vein, clearly\nidentifying each as separate, localized regions of fluorescence. For quantitative validation, the mouse was sacrificed, and\nthe lymph nodes were excised to be imaged by ex vivo FRI", "LN-1", "x\ny", "LN-3 LN-2", "10 mm", "0", "1", "1", "1", "0.8", "0.8", "0.8", "0.6", "LN-1", "0.4", "0.6", "LN-2", "0.4", "0.2", "0.6", "0.2", "0\n2", "4", "6", "L2-CG", "8", "10", "12\nmm", "LN-3", "0.4", "0.2", "0\n0", "D. In Vivo Lymph Node FMT Imaging Experiments", "Concentration of Cy5 (a.u.)", "Case 2\n1\n0.8", "Slice z = 8 mm", "Case 1\n1\n0.8", "x\ny", "Slice z = 11 mm", "(f)\nNorm.int (a.u.)", "L1-FISTA", "R", "1", "Profiles", "y\nx", "15", "L2-CG", "LN-3", "L", "0\nz", "0", "R", "y", "Concentration of Cy5 (a.u.)", "Case 4", "(e)", "1", "(b)", "LN-1", "L", "3D Segmentation", "x", "Norm.int (a.u.)", "Case 3", "(d)", "1", "y", "In vivo FRI", "Norm.int (a.u.)", "Case 2", "(c)", "1", "0\n0", "2", "L1-FISTA", "4", "6", "8", "10", "12\nmm", "0", "2", "NeuFMT", "4", "6", "8", "10", "12\nmm", "μNeuFMT", "Fig. 5. In vivo lymph node FMT imaging and reconstruction results. (a) The\nwhite-light image and preview via 2D fluorescence reflectance imaging (FRI)\noverlaid on the white-light image with the red aera indicating the concentrated\ndistribution of Cy5 probe on the cites of three lymph nodes (LN-1, LN-2, LN3) and the vein. (b) Comparison of FMT reconstruction results from different\nmethods. The 3D segmentation, along with two slices at z = 8 and 11 mm,\nare displayed. (c) Intensity profiles along the dashed lines in b. are compared\nfor each ex vivo images of lymph nodes after sacrificing the animal. The gray\nzone represents the estimated size of LN, based on the ex vivo fluorescence\nimages.", "IV. D ISCUSSION AND C ONCLUSION\nIn this study, we introduced NeuFMT, an optical-propertyadaptive FMT reconstruction framework that integrates INR\nwith an explicitly differentiable FEM-based light propagation model. By unifying a continuous fluorescence field parameterized by an INR and a physics-based forward model\namenable to end-to-end optimization, NeuFMT addresses\ntwo fundamental limitations of existing FMT reconstruction\ntechniques: their inability to efficiently adapt to complex and\nheterogeneous fluorescence distribution, and their reliance on", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "fixed, often inaccurate, optical properties, which significantly\nexacerbates the inherent ill-posedness of the inverse problem. Unlike supervised deep learning approaches which are constrained by the diversity and scale of training datasets and\noften fail under domain shift, NeuFMT operates in a selfsupervised, physics-informed regime. It does not require paired\ntraining data; instead, it directly minimizes the discrepancy between measured and simulated boundary fluxes.", "This not only\neliminates the need for extensive experimental datasets but also\nensures generalizability across different imaging geometries\nand target configurations. The continuous, coordinate-based\nrepresentation provided by the INR further ensures that our\nreconstructions are free from discretization artifacts and inherently resolution-agnostic. A central contribution of our work is the introduction of\nan optical property adaptation mechanism, which enables the\ndynamic optimization of absorption and scattering coefficients\n( a , s ) concurrently with the fluorescence distribution.", "Our\nframework demonstrates that the integration of a differentiable\nphysics-based forward model is the key to enabling this\nself-supervised adaptation. The FEM-based light propagation\nmodel is not merely a component of the loss function, but\nan active and adaptive part of the inverse solver. This stands\nin contrast to both traditional iterative methods, which hold\noptical properties static and thus aggravate the problem s illposedness, and conventional end-to-end deep learning approaches, which struggle to generalize beyond their training\ndata.", "The adaptivity of our model is thus its core strength,\nproviding a principled way to refine the physical model itself\nbased on the measured data, which is crucial for practical\napplications where precise prior knowledge of tissue optics\nis unavailable. Our results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate\nthat NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1 ) and deep learningbased (U-Net) benchmarks. In particular, the method consistently localized fluorescent targets with higher spatial accuracy, improved contrast, and more realistic morphological\nfeatures especially under challenging conditions involving\nbackground fluorescence and complex geometry.", "Despite these promising results, several aspects of\n NeuFMT merit further investigation. First, the current implementation assumes a homogeneous optical background a\ncommon simplification in FMT studies. Extending the model\nto incorporate spatially varying optical properties represents\na logical next step, potentially by representing a (r) and\n s (r) with additional INRs, though this would significantly\nincrease the complexity of the inverse problem.", "Nevertheless,\nthe proposed NeuFMT can be validated or even combined\nwith time-domain near-infrared spectroscopy (fNIRS) [44],\n[45] or diffuse optical tomography (DOT) [46] techniques,\nwhere the complex optical properties related with absorption\nand scattering can disentangled and calibrated. More importantly, the integration of NeuFMT with emerging imaging\ntechnologies holds particular promise. The inherent adaptivity\nof our framework is well-suited to the distinct scattering\nand absorption landscapes of NIR-II fluorescence tomography", "9", "[47], [48], where our optical property optimization could be\ncrucial for accurately modeling the increased photon penetration and achieving higher-resolution reconstruction at depth. Furthermore, the framework can be naturally extended to\nhyperspectral FMT, using a single INR to output both fluorophore concentration and spectral signature, thereby disentangling multiple probes or accounting for wavelength-dependent\noptical properties. Finally, translating NeuFMT into clinical\nsettings, such as intraoperative fluorescence-guided surgery\n[8], [9], represents an exciting frontier where its adaptability\ncould overcome patient-specific variations in tissue optics.", "In conclusion, by harmonizing a differentiable physics\nmodel with a continuous INR, NeuFMT provides a robust,\nself-supervised, and adaptive framework for FMT reconstruction. It effectively mitigates the ill-posedness inherent to\ninverse problems with uncertain parameters, setting a new\nparadigm for practical, high-resolution fluorescence molecular\nimaging. We believe this physics-in-the-loop INR approach\noffers a generalizable template for tackling a wide range of\ntomographic and inverse problems in biomedical imaging.", "R EFERENCES\n[1] F. Song, P. Zhang, H.", "Wu, C. Ma, Z. Liu, R.", "Cai, Y. Feng, Y. He,\nX.", "Dong, Y. Tian, and G. Zhang, Advances of fluorescence molecular\nimaging: NIR-II window, probes, and tomography, Laser & Photonics\nReviews, vol.", "19, no. 10, p. 2400275, 2025.", "[2] B. Zhu, J. Hendricks, J.", "E. Morton, J. C.", "Rasmussen, C. Janssen,\nM. N.", "Shah, and E. M. Sevick-Muraca, Near-infrared fluorescence\ntomography and imaging of ventricular cerebrospinal fluid flow and\nextracranial outflow in non-human primates, IEEE Transactions on\nMedical Imaging, vol.", "42, no. 12, pp. 3555 3565, 2023.", "[3] M. S. Ozturk and et al.", ", High-resolution tomographic analysis of in\nvitro 3D glioblastoma tumor model under long-term drug treatment, \nScience Advances, vol. 6, no. 10, p.", "eaay7513, 2020. [4] M. Cai, Z.", "Zhang, X. Shi, Z. Hu, and J.", "Tian, NIR-II/NIR-I fluorescence molecular tomography of heterogeneous mice based on gaussian\nweighted neighborhood fused lasso method, IEEE Transactions on\nMedical Imaging, vol. 39, no. 6, pp.", "2213 2222, 2020. [5] S. R.", "Arridge and J. C. Schotland, Optical tomography: forward and\ninverse problems, Inverse problems, vol.", "25, no. 12, p. 123010, 2009.", "[6] L. V. Wang and H.", "-i. Wu, Biomedical optics: principles and imaging. John Wiley & Sons, 2007.", "[7] F. Stuker, J. Ripoll, and M.", "Rudin, Fluorescence molecular tomography:\nprinciples and potential for pharmaceutical research, Pharmaceutics,\nvol. 3, no. 2, pp.", "229 274, 2011. [8] J. S.", "D. Mieog, F. B.", "Achterberg, A. Zlitni, M. Hutteman, J.", "Burggraaf,\nR. -J. Swijnenburg, S.", "Gioux, and A. L. Vahrmeijer, Fundamentals and\ndevelopments in fluorescence-guided cancer surgery, Nature Reviews\nClinical Oncology, vol.", "19, no. 1, pp. 9 22, 2022.", "[9] K. Wang, Y. Du, Z.", "Zhang, K. He, Z. Cheng, L.", "Yin, D. Dong, C. Li,\nW.", "Li, Z. Hu et al. , Fluorescence image-guided tumour surgery, Nature\nReviews Bioengineering, vol.", "1, no. 3, pp. 161 179, 2023.", "[10] D. Zhu et al. , Comparison of regularization methods in fluorescence\nmolecular tomography, Photonics, vol.", "1, no. 2, pp. 95 109, 2014.", "[11] H. Yi et al. , Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography:\na comparative study, Journal of Biomedical Optics, vol.", "18, no. 5, p. 56013, 2013.", "[12] J. Shi, B. Zhang, F.", "Liu, J. Luo, and J. Bai, Efficient L1 regularizationbased reconstruction for fluorescent molecular tomography using\nrestarted nonlinear conjugate gradient, Optics letters, vol.", "38, no. 18,\npp. 3696 3699, 2013.", "[13] D. Zhu and C. Li, Nonconvex regularizations in fluorescence molecular\ntomography for sparsity enhancement, Physics in Medicine & Biology,\nvol.", "59, no. 12, p. 2901, 2014.", "[14] J. Zhang, L. Li, Q.", "Hu, J. Zhang, Y. Wu, L.", "Gu, J. Li, F. Li, X.", "Zhu,\nJ. Jiang et al. , High-fidelity solution decomposition fluorescence tomography in the presence of background interference, Laser & Photonics\nReviews, p.", "e01013, 2025.", "10", "[15] C. Huang, H. Meng, Y.", "Gao, S. Jiang, K. Wang, and J.", "Tian, Fast and\nrobust reconstruction method for fluorescence molecular tomography\nbased on deep neural network, in Imaging, Manipulation, and Analysis\nof Biomolecules, Cells, and Tissues XVII, vol. 10881. SPIE, 2019, pp.", "257 262. [16] L. Guo, F.", "Liu, C. Cai, J. Liu, and G.", "Zhang, 3D deep encoder decoder\nnetwork for fluorescence molecular tomography, Optics letters, vol. 44,\nno. 8, pp.", "1892 1895, 2019. [17] P. Zhang, G.", "Fan, T. Xing, F. Song, and G.", "Zhang, UHR-DeepFMT:\nultra-high spatial resolution reconstruction of fluorescence molecular\ntomography based on 3-d fusion dual-sampling deep neural network, \nIEEE Transactions on Medical Imaging, vol. 40, no. 11, pp.", "3217 3228,\n2021. [18] J. Cheng, P.", "Zhang, F. Liu, J. Liu, H.", "Hui, J. Tian, and J. Luo, Encoderdecoder deep learning network for simultaneous reconstruction of fluorescence yield and lifetime distributions, Biomedical Optics Express,\nvol.", "13, no. 9, pp. 4693 4705, 2022.", "[19] P. Zhang, C. Ma, F.", "Song, Z. Liu, Y. Feng, Y.", "Sun, Y. He,\nF. Liu, D.", "Wang, and G. Zhang, Multi-branch attention prior based\nparameterized generative adversarial network for fast and accurate\nlimited-projection reconstruction in fluorescence molecular tomography, Biomedical Optics Express, vol. 13, no.", "10, pp. 5327 5343, 2022. [20] P.", "Zhang, F. Song, C. Ma, Z.", "Liu, H. Wu, Y. Sun, Y.", "Feng, Y. He, and\nG. Zhang, Robust reconstruction of fluorescence molecular tomography\nbased on adaptive adversarial learning strategy, Physics in Medicine &\nBiology, vol.", "68, no. 4, p. 04LT01, 2023.", "[21] P. Zhang, X. Liu, Q.", "Xue, Y. Shang, C. Liu, R.", "Chen, H. Gao, J. Liang,\nW.", "Wang, and G. Zhang, PAH2T-Former: Paired-attention hybrid\nhierarchical transformer for synergistically enhanced fmt reconstruction\nquality and efficiency, IEEE Transactions on Computational Imaging,\n2025. [22] H.", "Meng, Y. Gao, X. Yang, K.", "Wang, and J. Tian, K-nearest neighbor\nbased locally connected network for fast morphological reconstruction\nin fluorescence molecular tomography, IEEE transactions on medical\nimaging, vol. 39, no.", "10, pp. 3019 3028, 2020. [23] D.", "Li, C. Chen, J. Li, and Q.", "Yan, Reconstruction of fluorescence\nmolecular tomography based on graph convolution networks, Journal\nof Optics, vol. 22, no. 4, p.", "045602, 2020. [24] Y. Wang, C.", "Bian, Y. An, H. Wang, Q.", "Liang, Y. Du, and J. Tian,\n Graph convolution based residual connected network for morphological reconstruction in fluorescence molecular tomography, in Medical\nImaging 2022: Biomedical Applications in Molecular, Structural, and\nFunctional Imaging, vol.", "12036. SPIE, 2022, pp. 527 533.", "[25] Y. Sun, J. Liu, M.", "Xie, B. Wohlberg, and U. S.", "Kamilov, Coil:\nCoordinate-based internal learning for tomographic imaging, IEEE\nTransactions on Computational Imaging, vol. 7, pp. 1400 1412, 2021.", "[26] L. Lozenski, M. A.", "Anastasio, and U. Villa, A memory-efficient selfsupervised dynamic image reconstruction method using neural fields, \nIEEE Transactions on Computational Imaging, vol. 8, pp.", "879 892,\n2022. [27] A. W.", "Reed, H. Kim, R. Anirudh, K.", "A. Mohan, K. Champley, J.", "Kang,\nand S. Jayasuriya, Dynamic CT reconstruction from limited views\nwith implicit neural representations and parametric motion fields, in\nProceedings of the IEEE/CVF International Conference on Computer\nVision, 2021, pp. 2258 2268.", "[28] L. Shen, J. Pauly, and L.", "Xing, NeRP: implicit neural representation\nlearning with prior embedding for sparsely sampled image reconstruction, IEEE Transactions on Neural Networks and Learning Systems,\nvol. 35, no. 1, pp.", "770 782, 2022. [29] R. Liu, Y.", "Sun, J. Zhu, L. Tian, and U.", "S. Kamilov, Recovery\nof continuous 3D refractive index maps from discrete intensity-only\nmeasurements using neural fields, Nature Machine Intelligence, vol. 4,\nno.", "9, pp. 781 791, 2022. [30] S.", "Shen, L. Li, S. Gao, Y.", "Wang, L. Gu, S. Li, X.", "Zhu, J. Jiang, J. Yu, and\nW.", "Ren, High resolution diffuse optical tomography via neural fields, \nIEEE Transactions on Computational Imaging, 2024. [31] K. Han, C.", "Li, A. Xiao, Y. Tian, J.", "Tian, and Z. Hu, TSPE: Reconstruction of multi-morphological tumors of NIR-II fluorescence molecular\ntomography based on positional encoding, Computer Methods and\nPrograms in Biomedicine, vol. 261, p.", "108554, 2025. [32] S. R.", "Arridge, Optical tomography in medical imaging, Inverse problems, vol. 15, no. 2, p.", "R41, 1999. [33] , Photon-measurement density functions. part I: Analytical forms, \nApplied Optics, vol.", "34, no. 31, pp. 7395 7409, 1995.", "[34] S. R. Arridge and M.", "Schweiger, Photon-measurement density functions. part 2: Finite-element-method calculations, Applied Optics,\nvol. 34, no.", "34, pp. 8026 8037, 1995.", "PREPRINT VERSION 2025", "[35] O. C. Zienkiewicz, R.", "L. Taylor, P. Nithiarasu, and J.", "Zhu, The finite\nelement method. Elsevier, 1977, vol. 3.", "[36] V. Ntziachristos, C. Bremer, and R.", "Weissleder, Fluorescence molecular\ntomography resolves protease activity in vivo, Nature Medicine, vol. 8,\nno. 7, pp.", "757 760, 2002. [37] M. Schweiger and S.", "Arridge, The Toast++ software suite for forward\nand inverse modeling in optical tomography, Journal of biomedical\noptics, vol. 19, no. 4, pp.", "040 801 040 801, 2014. [38] W. Ren, H.", "Isler, M. Wolf, J. Ripoll, and M.", "Rudin, Smart toolkit\nfor fluorescence tomography: simulation, reconstruction, and validation, \nIEEE Transactions on Biomedical Engineering, vol. 67, no. 1, pp.", "16 \n26, 2019. [39] S. Gao, J.", "Zhang, Y. Hu, Y. Wu, L.", "Li, Q. Hu, X. Lou, X.", "Zhu, J. Jiang,\nand W. Ren, Multifunctional optical tomography system with highfidelity surface extraction based on a single programmable scanner and\nunified pinhole modeling, IEEE Transactions on Biomedical Engineering, 2023.", "[40] Y. Hu, Y. Wu, L.", "Li, L. Gu, X. Zhu, J.", "Jiang, and W. Ren, Simultaneous\nreconstruction of 3D fluorescence distribution and object surface using\nstructured light illumination and dual-camera detection, Optics Express,\nvol. 32, no.", "9, pp. 15 760 15 773, 2024. [41] C.", "Ji, M. Zhao, C. Wang, R.", "Liu, S. Zhu, X. Dong, C.", "Su, and Z. Gu,\n Biocompatible tantalum nanoparticles as radiosensitizers for enhancing\ntherapy efficacy in primary tumor and metastatic sentinel lymph nodes, \nACS nano, vol. 16, no.", "6, pp. 9428 9441, 2022. [42] S.", "Kawata and O. Nalcioglu, Constrained iterative reconstruction by\nthe conjugate gradient method, IEEE Transactions on Medical Imaging,\nvol. 4, no.", "2, pp. 65 71, 1985. [43] A.", "Beck and M. Teboulle, A fast iterative shrinkage-thresholding algorithm for linear inverse problems, SIAM Journal on Imaging Sciences,\nvol. 2, no.", "1, pp. 183 202, 2009. [44] Y.", "Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared\nspectroscopy and imaging: a review, Applied Sciences, vol.", "9, no. 6, p. 1127, 2019.", "[45] H. Y. Ban, G.", "M. Barrett, A. Borisevich, A.", "Chaturvedi, J. L. Dahle,\nH.", "Dehghani, J. Dubois, R. M.", "Field, V. Gopalakrishnan, A. Gundran\net al.", ", Kernel flow: a high channel count scalable time-domain functional near-infrared spectroscopy system, Journal of biomedical optics,\nvol. 27, no. 7, p.", "074710, 2022. [46] A. Pifferi, D.", "Contini, A. D. Mora, A.", "Farina, L. Spinelli, and A. Torricelli, New frontiers in time-domain diffuse optics, a review, Journal\nof Biomedical Optics, vol.", "21, no. 9, pp. 091 310 091 310, 2016.", "[47] F. Wang, Y. Zhong, O.", "Bruns, Y. Liang, and H. Dai, In vivo NIRII fluorescence imaging for biology and medicine, Nature Photonics,\nvol.", "18, no. 6, pp. 535 547, 2024.", "[48] Z. Zhang, Y. Du, X.", "Shi, K. Wang, Q. Qu, Q.", "Liang, X. Ma, K. He,\nC.", "Chi, J. Tang et al. , NIR-II light in clinical oncology: opportunities\nand challenges, Nature Reviews Clinical Oncology, vol.", "21, no. 6, pp. 449 467, 2024."]}
{"method": "semantic", "num_chunks": 23, "avg_chunk_len": 2178.2608695652175, "std_chunk_len": 1986.3599047195614, "max_chunk_len": 10539, "min_chunk_len": 148, "total_chars": 50100, "compression_ratio": 1.17624750499002, "chunks": ["PREPRINT VERSION 2025\n\n1\n\n NeuFMT: Optical-Property-Adaptive Fluorescence\nMolecular Tomography via Implicit\nNeural Representation\n\narXiv:2511.04510v1 [eess.IV] 6 Nov 2025\n\nShihan Zhao, Jianru Zhang, Yanan Wu, Linlin Li, Siyuan Shen, Xingjun Zhu, Guoyan Zheng, Member IEEE,\nJiahua Jiang, and Wuwei Ren", "Abstract Fluorescence Molecular Tomography (FMT) is a\npromising technique for non-invasive 3D visualization of fluorescent probes, but its reconstruction remains challenging due to\nthe inherent ill-posedness and reliance on inaccurate or oftenunknown tissue optical properties. While deep learning methods\nhave shown promise, their supervised nature limits generalization\nbeyond training data. To address these problems, we propose\n NeuFMT, a self-supervised FMT reconstruction framework that\nintegrates implicit neural-based scene representation with explicit\nphysical modeling of photon propagation. Its key innovation lies\nin jointly optimize both the fluorescence distribution and the\noptical properties ( ) during reconstruction, eliminating the need\nfor precise prior knowledge of tissue optics or pre-conditioned\ntraining data. We demonstrate that NeuFMT robustly recovers\naccurate fluorophore distributions and optical coefficients even\nwith severely erroneous initial values (0.5 to 2 of ground\ntruth). Extensive numerical, phantom, and in vivo validations\nshow that NeuFMT outperforms conventional and supervised\ndeep learning approaches across diverse heterogeneous scenarios.\nOur work establishes a new paradigm for robust and accurate\nFMT reconstruction, paving the way for more reliable molecular\nimaging in complex clinically related scenarios, such as fluorescence guided surgery.", "Index Terms fluorescence molecular tomography, image reconstruction, optical properties, implicit neural representation,\nfluorescence guided surgery", "The work was supported by Science and Technology Commission of Shanghai Municipality under Grant 25JS2830300 (Wuwei Ren), National Natural\nScience Foundation of China under Grants 62105205 (Wuwei Ren), and\nShanghai Clinical Research and Trial Center (Wuwei Ren). (Corresponding\nauthor: Wuwei Ren.)\nShihan Zhao and Jianru Zhang contributed equally to this work.\nShihan Zhao, Yanan Wu, Linlin Li and Siyuan Shen are with\nthe School of Information Science and Technology, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: zhaoshh, wuyn1, lill,\nshensy2023@shanghaitech.edu.cn).\nJianru Zhang and Jiahua Jiang are with the School of Mathematics,\nUniversity of Birmingham, Edgbaston, B15 2QN, United Kingdom (e-mail:\njxz389@student.bham.ac.uk; j.jiang.3@bham.ac.uk).\nXingjun Zhu is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail:\nzhuxj1@shanghaitech.edu.cn).\nGuoyan Zheng is with the Institute of Medical Robotics, School of\nBiomedical Engineering, Shanghai Jiao Tong University, Shanghai 200240,\nChina (e-mail: guoyan.zheng@sjtu.edu.cn)\nWuwei Ren is with the School of Information Science and Technology,\nShanghaiTech University, Shanghai 201210, China, and also with State\nKey Laboratory of Advanced Medical Materials and Devices, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: renww@shanghaitech.edu.cn).", "I. INTRODUCTION\nFluorescence Molecular Tomography (FMT) has emerged\nas a promising molecular imaging modality, enabling noninvasive 3D visualization of fluorescent probe distribution\nin highly turbid media [1]. Owning to its high sensitivity,\ncost-effectiveness, and non-ionizing radiation, FMT has found\nbroad applications in preclinical research and clinical practice, e.g., brain imaging [2], in vitro cell culture monitoring\n[3] and tumor detection [4]. FMT reconstructs the internal\nfluorescence distribution by measuring the photon distribution\non the object surface and minimizing the discrepancy between\nreal measurements and the simulated results. A canonic framework of FMT reconstruction employs an iterative optimization\nstrategy with a forward model typically based on the\nRadiation Transfer Equation (RTE) or the diffusion equation\n(DE) and an inverse model that refines fluorescence distribution prediction until convergence [5], [6]. However, FMT\nreconstruction is inherently ill-posed due to insufficient surface measurements and strong photon scattering effect within\ntissues. Development of high-precision FMT reconstruction\nalgorithms is highly attractive for further improvement of\nthe spatial resolution and detection depth of this technology,\nwhich ultimately broaden the biological applications in drug\ndiscovery [7] and clinical use such as fluorescence guided\nsurgery [8], [9].", "To address the ill-posed nature of FMT reconstruction,\nregularization techniques that incorporate prior knowledge are\napplied. Conventional approaches include Tikhonov (L2 norm)\nregularization for smoothing the results [10], [11], and sparsepromoting regularization (L1 , Lp norm) or total variation (TV)\nregularization for enhancing the spatial resolution [12], [13].\nRecent advancements in regularization techniques, such as\nthe solution-decomposition algorithm, utilize an advanced\nstochastic prior model that improves the differentiation of\nfluorescence targets from background interference, thereby\nenhancing reconstruction quality [14]. While these methods\nstabilize solutions, their reliance on time-consuming iterative\noptimization and idealized assumptions about optical parameters often results in slow convergence and limited accuracy in\nheterogeneous tissues. Deep learning (DL) methods, particularly en-decoder-based neural networks [15] [21] and graphbased networks [22] [24], have recently been used in FMT\nreconstruction by learning direct mappings from boundary\nmeasurements to fluorescence distributions. These approaches\nencode physical priors within network parameters, enabling\noverwhelmingly rapid inference. However, their dependence\non supervised training with large, scenario-specific datasets restricts generalizability across variable experimental conditions\n(e.g., tissue object geometry and optical properties), leading\nto significant accuracy degradation when the object properties\ndeviate from training assumptions.", "Recently, implicit neural representation (INR) models have\nemerged as a powerful alternative for medical image reconstruction. By mapping arbitrary spatial coordinates to certain\nunknown physical quantities via a coordinate-based multilayer perceptron network (MLP), INRs achieve continuous\n3D representations, self-supervised training, and memory efficiency. Originally popularized in computer vision and medical imaging, INRs have demonstrated remarkable success\nin modalities such as computed tomography (CT), magnetic\nresonance imaging (MRI) [25] [29], and notably in diffuse\noptical tomography (DOT), where INR has been proven to be\nable to capture a high-resolution, continuous optical absorption\nmap that account for light scattering in complex tissues [30].\nINR captures continuous spatial information and integrates\nphysical priors makes it particularly suited for various imaging problems. In the context of FMT, preliminary work has\nexplored position encoding strategies to enhance spatial resolution and improve the quality of FMT reconstructions [31].\nNevertheless, systematic studies integrating optical diffusion\nphysics within an INR framework remain scarce. This gap\npresents an opportunity to harness the strengths of implicit\nmodeling for robust and data-efficient FMT reconstruction.", "To bridge this gap, we propose neural-field-based FMT, or\nNeuFMT, a physics-driven reconstruction framework unifying\nINR with explicit physical models. Unlike conventional DLbased FMT reconstruction algorithms that couple explicit\nfluorescence predictions to implicit physical model, NeuFMT\nintegrates the DE-based forward model in the network loss,\nenabling self-supervised training without paired data. The\ndifferentiability of the forward model is achieved via finite\nelement method (FEM). This inversion-free approach ensures\nrapid, continuous reconstruction across diverse geometries\nwhile inherently addressing scattering effects. Another critical\nlimitation of both traditional and DL methods lies in the\npresumed optical properties of the object during reconstruction, which largely aggravate the ill-posedness of the inverse\nproblem given the optical parameters were initially biased. To\novercome this, we further introduce optical-property-adaptive\nNeuFMT, or NeuFMT, an adaptive extension of NeuFMT\nthat dynamically optimizes scattering / absorption coefficients\nand fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations,\nNeuFMT achieves robust accuracy even when provided\nwith erroneous initial guess of the optical coefficient values,\naddressing the problem of unrealistic assumption prior to\nFMT reconstruction. Both proposed INR-based FMT reconstruction algorithms were thoroughly compared and validated\nby simulations and phantom experiments along with other\nmethods. Furthermore, in vivo lymph node imaging in mice\nwas performed, further demonstrating the advantages of the\nproposed methods.", "II. M ETHODS\nA. Forward Modeling of FMT\nModel-based FMT reconstruction comprises two fundamental steps: forward modeling and inversion. The former predicts\nsurface photon density measurements based on an assumed\nfluorescence distribution. At the macroscopic scale, we employ\nthe first-order approximation of the radiative transport equation (RTE), known as the diffusion equation (DE) [32]. The\nexcitation and fluorescence emission processes in continuouswave (CW) mode form a coupled pair of DEs expressed as\n[33], [34]:\n κ ϕx (r) + a ϕx (r) = qx (r),\n\nr , (1)\n\n κ ϕm (r) + a ϕm (r) = η C(r) ϕx (r),\n\nr , (2)\n\nwhere ϕx and ϕm denote the excitation and emission photon\ndensity, qx is the excitation source, C(r) is the fluorophore\nconcentration to be reconstructed in the inversion, and η\ncollects quantum-yield factors in the CW source term. κ\nrepresents the diffusion coefficient, calculated by [33]\n1\n,\n(3)\nκ=\n3 ( a + s )\nwith the absorption coefficient a and the reduced scattering\ncoefficient s . In a non-contact setting of FMT, to calculate\nthe value of ϕ (r) on the object surface as the measurement,\na Robin-type boundary condition is added alongside the\nequation pair (1 2):\n ϕ (r) + 2 ζ(c) κ\n= 0, {x, m}, r , (4)\nν\nwhere ζ(c) is the refractive index mismatch parameter that\naccounts for the light reflection on the boundary surface, with\nc representing the light speed inside the medium. ν denotes\nthe outward normal on the boundary. Notably, to simplified the\nproblem setting, we only consider a homogeneous medium\ncase and the difference of a , s values under different\nwavelengths are neglected.", "B. Finite Element Discretization and System Matrix Construction\nWe apply the finite element method (FEM) [35] to the\ndiffusion model (1) - (4). Discretizing with a tetrahedral\nN\nmesh of N\ni }i=1 , we approximate\nP nodes and nodal basis {ψP\nϕ (r) i Φ ,i ψi (r) and qx (r) i (Qx )i ψi (r), which\ntransforms the continuous-form equations into a linear system\nfor excitation and emission photon propagation:\nS Φx = Qx\n\n(5)\n\nS Φm = Qm\n\n(6)\n\nwhere S RN N is the system matrix and Φ , Q RN\nare discretized form (coefficient vectors) for ϕ and q ,\nrespectively. In particular, the excitation field ϕx interacts with\nfluorophores C RN to produce the emission source term\nQm = C Φx\n\n(7)\n\nwith denoting element-wise multiplication. The equation\n(7) physically describes how fluorophores absorb excitation\nphotons and re-emit light at longer wavelengths. The emission\nsource Qm then propagates through the same medium to\nproduce the emission photon density Φm , which is finally\ndetected at the boundary, which is computed as\n\nM = P Φm\n\n(8)\n\nwhere P represents the transfer function, which maps the\nboundary photon density Φm the measurement data M\nacquired by the camera. The above linearized forward model\nprovides the physical foundation for the inversion procedure.\nCrucially, the SPD FEM stiffness matrix S( a , s )\nN N\nR\nin (5) (6) encode the optical properties and boundary\ngeometry, generating from a linear combination of matrices\ncorresponding to distinct physical components [33], [36]\n\n1\nSd + Sb . (9)\nS( a , s ) = c a Sa +\n3( a + s )\nwith Sa , Sd , and Sb the assembled absorption, diffusion, and\nRobin-boundary matrices, respectively. This decomposition\nexplicitly reveals the functional dependence of S on the\noptical parameters a and s , which forms the mathematical\nfoundation for our adaptive optimization approach introduced\nin Subsection II-C.", "C. INR-based FMT reconstruction: NeuFMT / NeuFMT\nScanners Unlike traditional voxel-based or mesh-dependent\nrepresentations, INR provides a continuous, memory-efficient\nframework for modeling complex physical fields. The basic\nvariant, NeuFMT, learns only the fluorophore Cθ with fixed\noptical properties; the proposed adaptive NeuFMT jointly\noptimizes the optical coefficients ( a , s ) with Cθ for enhancing the reconstruction accuracy and robustness. In this section,\nwe describe the NeuFMT representation, formulate the learning objective, introduce optical-property adaptation, and summarize the network architecture and implementation.\n1) INR representation of the unknown fluorescence: Our\n NeuFMT model the 3D fluorescence field as an INR:\n\nCθ (r) = fθ Γ (r) ,\n\n(10)\n\nwhere r = (x, y, z) R3 , Γ : Rd is a highdimensional positional encoding of spatial coordinates, and\nfθ : Rd R is an MLP with parameters θ. This INR formulation (10) enables resolution-independent reconstruction and\nnaturally accommodates arbitrary spatial queries without being\nconstrained by the conventional discrete grid structure.\nTo enhance the network s ability to represent high-frequency\ndetails, which is crucial for resolving complex in vivo fluorescence patterns, we apply a sinusoidal positional encoding to\neach coordinate component. Let γ : R R2L be\nγ(p) = sin(20 πp), cos(20 πp), ,\nL 1\n\nsin(2\n\nπp), cos(2\n\nL 1\n\n(11)\n\nπp) ,\n\np {x, y, z},\n\nwhere L is the number of frequency bands. The\n 3D position\nis then encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that\nd = 6L. Feeding Γ (r) into fθ enables compact representation\nof both low- and high-frequency variations in Cθ .", "2) Learning objective: We estimate the fluorescence field\nCθ and, in NeuFMT, the optical properties { a , s } by\nminimizing a data-fidelity term plus regularization:\nc( a , , Cθ ) M real 2 + λ R(Cθ ), (12)\nL( a , s , θ) = M\ns\n2\n\nc denotes the boundary measurements, and R(Cθ ) is\nwhere M\na regularization term applied to the fluorescence distribution.\nThe hyperparameter λ controls the regularization strength,\nbalancing data fidelity with sparsity constraints. The training of\n NeuFMT / NeuFMT follows a fully self-supervised paradigm\nthat explicitly integrates the DE-based physical model into\nthe optimization loop. Note that NeuFMT uses fixed optical\nparameters ( a , s ), whereas NeuFMT updates jointly.\n3) Alternating optical-property adaptation: A fundamental\ninnovation of NeuFMT lies in formulating the entire photon propagation process from excitation to emission as an\nend-to-end differentiable map. The forward model follows a\nprecise physical sequence from excitation source to surface\nmeasurements, as described in Subsection II-B:\nc( a , s , Cθ ) = P S( a , s ) 1 Cθ S( a , s ) 1 Qx ,\nM\n(13)\nWe optimize the introduced objective L( a , s , θ) in (12),\njointly updating network parameters θ and optical coefficients\n( a , s ). The chain in (13) contains only differentiable operations, including linear solves, elementwise products, and linear\nc is differentiable w.r.t. both Cθ (hence θ)\nprojections. Thus M\n\nand ( a , s ), enabling standard gradient-based training. For\ncompleteness, we state the chain-rule decomposition of the\nloss gradient with respect to ( a , s ). Based on (13), the\ngradient splits into an emission term and an excitation term:\nc \n S\n L M\n L\n S 1\n=\nΦm +\nc Φm\n\n{z\n}\n| M\nEmission pathway\n\nc Φm Qm \n L M\n S\nΦx\n S 1\nc Φm Qm Φx\n\n| M\n{z\n}\n\n(14)\n\nExcitation pathway\n\n { a , s }.\nThe only model-specific ingredient of a and s is the\nJacobian of S( a , s ). According to (9), the partial derivatives\nare\n\n S\n1\n= c Sa \nSd ,\n a\n3( a + s )2\n\n S\n1\n=c \nSd .\n(15)\n s\n3( a + s )2\nThis allows a and s to be optimized directly using gradient\ndescent, and then be updated together with θ, bridging the\nlearning process with the underlying physical model.\nTo mitigate potential coupling effects between a and s\nduring optimization, we propose an alternating update strategy,\nwhich periodically updates one optical parameter with the\nother fixed. The alternating framework largely promotes training stability to avoid oscillations with sufficient computational\nefficiency. The complete NeuFMT algorithm is described in\nAlgorithm 1. Overall, the alternating -adaption module ensures that each optical parameter receives dedicated optimization attention while maintaining the physical consistency of\nthe forward model, yielding more accurate FMT reconstruction\nresults even in the presence of mismatch between the initial\nguess and ground truth of the optical properties.", "4) Network architecture and implementation: We adopt\nMLP for the NeuFMT / NeuFMT, comprising 8 fullyconnected layers with 512 hidden units each, followed by\na final layer with 128 units. ReLU activation functions are\nemployed throughout the network. A critical skip connection\nbridges the input Γ (r) to the 4th hidden layer, facilitating\ngradient flow and enhancing the ability to learn fine-grained\ndetails. This architectural choice is particularly suited for FMT\napplications where accurately reconstructing high-contrast targets against complex backgrounds is essential.\nWe implement the NeuFMT / NeuFMT framework with\nPyTorch, leveraging its automatic differentiation capability to\ncompute the gradient through both MLP and the physical\nmodel. Adam optimizer is used with the initial learning rates\nof 10 4 for θ update, 10 3 for scattering coefficient and\n10 5 for absorption coefficient. To improve the computational\nefficiency, a learning rate decay is applied for MLP update.\nThese rates are determined empirically to ensure stable convergence. The L1 regularization parameter λ is set to 10 6\nbased on cross validation. The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality,\nwith the entire process completing within 3 30 minutes on\na single NVIDIA RTX 3090 GPU for problems of varying\nscales. The FEM discretization is built on TOAST++ toolkit\n[37], and the FMT simulation is based on a modular software\nplatform STIFT [38] in MATLAB (R2024b, MathWorks, MA,\nUS) using a desktop computer (Intel Core i5-12600 CPU @\n3.30 GHz, 128 GB RAM).\nAlgorithm 1 NeuFMT\nRequire: Real measurements M real , light speed c, stepsizes\nαθ , αa , αs , alternation period T , total iterations K\n1: Initialize θ, a , s ;\n2: Precompute Sa , Sd , Sb , Qx , P\n3: Compute S via (9);\n4: for i = 1 to K do \n5:\nC = fθ Γ (r)\n6:\nSolve Φx RN satisfying S Φx = Qx\n7:\nQm = C Φx\n8:\nSolve Φm RN satisfying S Φm = Qm\nc = P Φm\n9:\nCompute predicted measurements: M\nreal 2\nc\n10:\nCompute loss: L = M M 2 + R(C)\n11:\nUpdate MLP parameters: θ = θ αθ L\n θ\n12:\nif i mod\n T = 0 then\n13:\nif i/T is even then\n L\n14:\nUpdate absorption: a = a αa \na\n15:\nelse\n L\n16:\nUpdate diffusion: s = s αs \n\ns\n17:\nend if\n\n1\n18:\nUpdate S = c a Sa +\nS\n+\nS\nd\nb ;\n3( a + s )\n19:\nend if\n20: end for\n21: Output: fluorescence C, optical parameters a , s", "D. FMT System Setup\nWe devised a continuous-wave (CW) FMT system\n(SHMOT) [39], [40] as depicted in Fig. 1 (a), which incorporates a 16-bit CMOS camera (Edge 4.2, PCO, Germany) with\n2048 2048 pixel resolution and a filter wheel (FW102C,\nThorlabs, NJ, US) for selective wavelength detection. A\ntunable laser source (SuperK EXTREME, NKT, Denmark),\nspanning 400-890 nm, provides fluorescence excitation with a\npower density of approximately 2 mW/mm2 at the sample\nplane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube, Germany) mounted aside steers\nthe laser beam to raster-scan either the top or bottom object\nsurface, enabling switchable reflection-/transmission-mode detection. During experiments, the camera exposure time was\nfixed at 500 ms, with pixel binning applied to improve the\nsignal-to-noise ratio. The acquired raw 2D image data serve\nas supervision target for NeuFMT / NeuFMT reconstruction\n(Fig. 1 (b)). It worth mentioning that our FMT system also\nintegrates a programmable line-scanning illumination, which\nenables high-precision extraction of the surface geometry\nwith approximated maximum error of 0.1 mm. The extracted\nsurface information is then leveraged as prior knowledge for\nFEM meshing and improving reconstruction accuracy.", "E. Phantom preparation and optical calibration\nIn our validation, the slab phantomswere cast from silicone (SYLGARDTM 184; DOW, CA, USA) to emulate softtissue matrix. Optical properties were tuned by dispersing\ntitanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon\nblack powder (Colins, Shanghai, China) as scattering and\nabsorbing additives, respectively. In all phantoms, TiO2 and\ncarbon black were uniformly distributed. All the designs\nshown in Fig. 4 (a) used the same TiO2 /carbon-black mixing\nratio, yielding isotropic media with identical absorption and\nscattering parameters.", "F. In Vivo Lymph Node FMT Imaging\nFollowing numerical simulations and phantom experiments,\nwe evaluated the proposed method in vivo in a murine lymph\nnode imaging task. In cancer diagnostics, lymph node metastasis is a key prognostic indicator of tumor progression. Fluorescence imaging enables rapid screening of sentinel lymph\nnodes [41].\nIn our experiment, all animal procedures were approved by\nthe Institutional Animal Care and Use Committee of ShanghaiTech University (Approval No. 20211115001). 5 female\nBALB/c mice (8 weeks old) were obtained from Shanghai\nJihui Laboratory Animal Breeding Co. Ltd. and housed under\na circadian rhythm of 12 hours of day and night alternation.\nBefore taking imaging experiments, fur was removed over the\nwhole body. For FMT reconstruction, we assumed an optically\nhomogeneous medium with properties calibrated during the\nexcitation step with ( a = 0.0055 mm 1 , s = 1.1 mm 1 ).\nWe followed a three-stage protocol fluorescent-dye injection, imaging, and ex vivo validation. Prior to FMT imaging, Cy5-saline solution (1.2146 mol mL 1 , 40 L) was injected subcutaneously into the left forepaw to drive lymphatic\ndrainage toward the sentinel lymph nodes and create a highintensity target. Next, follow-up FMT measurements were\nacquired using the system setup in Subsection II-D. Finally,\nafter data collection, ex vivo verification was performed using\na fluorescent stereoscopic microscope (MVX10, Olympus,\nJapan; 6.3 objective). Illumination was provided by a heightadjustable 630 nm LED at 20 mW cm 2 . White-light and\nCy5-channel fluorescence images were recorded using filters\nmatched to the Cy5 spectrum, and the lymph nodes were\nidentified, excised, and imaged to validate the in vivo findings.", "III. R ESULTS\nA. Convergence Verification of Optical Property Adaptive\nOptimization\nTo validate our proposed optical property adaptation mechanism, we conducted a series of numerical experiments on\na digital phantom. The primary objective was to demonstrate\nthat the -adaption module can robustly recover absorption a\nand s coefficients from severely erroneous initial estimates,\nthereby enabling high-fidelity fluorescence reconstruction.\nWe constructed a homogeneous digital slab phantom of size\n55 55 15 mm3 featuring an S -shaped fluorescent target at\nits geometric center. The ground-truth optical properties were\n 1\nset to true\nand s true = 1.0 mm 1 . To rigorously\na = 0.1 mm\ntest the correction capability, we initialized the reconstruction\nwith significantly mismatched scattering coefficients ( s init =\n0.5, 1.5, 2.0 mm 1 ) while keeping the absorption coefficient\nfixed at its true value for this specific test.\nAs summarized in Fig. 2 (a), without the -adaption module, the reconstructed fluorescence distributions suffered from\nsubstantial errors in both depth localization and morphological accuracy. The mismatched s value led to an incorrect\nmodel of photon propagation, which directly translated to\ndistorted reconstructions. In contrast, when the -adaption\nmodule was enabled, the proposed NeuFMT successfully\nrecovered fluorescence distributions that closely matched the\nground truth obtained with the correct optical properties.\nCrucially, the evolution of the scattering coefficient during\noptimization, plotted in Fig. 2 (b), demonstrates the module s\nrobust convergence. Regardless of the initial value whether\nhalved or doubled the estimated s reliably converged to the\nneighborhood of the true value (1.0 mm 1 ).\nA similar convergence behavior was observed for the absorption coefficient a . When initialized with biased values\n 1\n( init\n) against a fixed true s , the a = 0.05, 0.15, 0.2 mm\nadaption module corrected a with an average error of only\n1.5% (Fig. 2 (d)), and its convergence curves are shown in\nFig. 2 (e). This convergence robustness was maintained across\na range of true a and s values, confirming the general\nefficacy of our alternating optimization strategy in mitigating\nparameter coupling (Fig. 2 (c), (f)).\nWe further extended the validation to the most challenging\nscenario, where both optical parameters were simultaneously\ninitialized with substantial errors. In this experiment, the initial\nvalues for both a and s were set to 50% higher than\ntheir GT values. Remarkably, even under these highly adverse\nconditions, the -adaption module successfully drove both\nparameters towards their true values. The convergence trajectories remained stable and ultimately reached a neighborhood\nof the true parameter pair. These results collectively verify\nthat the integrated -adaption module empowers NeuFMT\nto jointly recover accurate optical properties and fluorescence\ndistributions even from profoundly inaccurate initial guesses,\neffectively addressing a critical source of ill-posedness in\npractical FMT scenarios.", "B. Numerical Simulations\nTo comprehensively evaluate the performance of the proposed NeuFMT under controlled conditions, we designed\nfour distinct numerical phantoms (Fig. 3 (a) (d) respectively)\nto systematically increase the reconstruction challenge:\n Case 1 - single small target: a 3 mm-diameter spherical\nfluorescence target embedded in a homogeneous cuboid\nphantom (55 55 15 mm3 ), serving as a baseline\nfor evaluating localization and quantitative accuracy of\na simple, isolated inclusion.\n Case 2 - complex surface geometry: a 2 mm-diameter\nspherical target inside a phantom with a curved surface\ngeometry, featuring a spherical cap top (base: 50 50 4\nmm, cap height = 5 mm, total height = 9 mm). This\ncase tests the method s robustness to non-planar surface\ntopography.\n Case 3 - complex target shape: a large peanut-shaped fluorescence region with uniform concentration embedded in\na standard cuboid phantom same as Case 1. This scenario\nassesses the capability to recover intricate morphological\ndetails beyond simple spheres.\n Case 4 - multi-target with background: the same peanutshaped region as in Case 3, but with the addition of\na small, high-concentration spherical target inside. This\nrepresents a highly realistic and challenging condition,\ntesting the ability to resolve targets of different concentrations and shapes against a noisy background.\n\nThe ground-truth optical properties for all simulated measurements in this test were set to a = 0.1 mm 1 and s = 1.0\nmm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against\nfour established methods: conventional Tikhonov-regularized\nconjugate gradients (L2 -CG) [42] and L1 -regularized nonnegative least squares (L1 -FISTA) [43], a pretrained supervised U-Net, and our baseline method NeuFMT without adaption. The U-Net was trained on a large, synthetically\ngenerated dataset of 5,488 samples. For each sample, the\ninput was a boundary measurement simulated using the DEbased forward model under the ground-truth properties in a\ncuboid phantom (55 55 15 mm3 ), and the label was the\ncorresponding 3D fluorescence map of 1 2 ellipsoids with\nrandom sizes and spatial positions. To clearly demonstrate the\neffect of the -adaption module, we focused on adapting s\nwhile fixing a at its true value during reconstruction. For all\nmethods, the initial s was set to an erroneous value of 1.2\nmm 1 , which is 20% higher than the ground truth.\nThe results presented in Fig. 3 (a) (d) demonstrate the\nconsistent superiority of NeuFMT across all four numerical cases. We observe that the conventional methods were\nadversely affected by the optical property mismatch: L2 -CG\nreconstructions were characteristically blurred and exhibited\nsignificant depth errors, such as full-depth penetration in\nCases 3 and 4 and depth-wise expansion in Case 1. L1 -FISTA\nfrequently introduced non-physical, fragmented artifacts, such\nas staircase patterns in Case 1 and hollow structures in Case 3,\nwhile it also suffered from severe depth inaccuracy. The\nsupervised U-Net, though performed well in Case 1, showed\nlimited generalization beyond its training data, as seen in its\nlocalization failure in the complex surface geometry of Case 2\nand noticeable shape distortion in the unseen peanut-shaped\ntarget of Case 3 and 4. The direct NeuFMT provided better\ndepth prediction than the traditional methods but remained\nsensitive to the erroneous s , resulting in substantial shape\nexpansion in the x-y plane (Cases 1, 2) and axial splitting\n(Case 3). In contrast, NeuFMT successfully rectified the\noptical properties and overcame these limitations. It achieved\nthe most accurate spatial localization and shape fidelity, as\nevidenced by its 3D isosurfaces tightly conforming to the\nground truth in both simple and complex targets, and it clearly\nresolved both the small target and the complex background in\nCase 4. Quantitatively, NeuFMT consistently achieved the\nhighest Dice coefficients, and its intensity profiles (Fig. 3 (e))\nmost closely matched the ground truth in terms of peak\nlocation, width, and background suppression.", "C. Phantom Experiments\nWe further evaluated the performance of all methods using\nphysical phantom experiments to assess their practicality under real-world conditions, including measurement noise. The\nphantoms were fabricated from silicone, with their optical\nproperties calibrated to be approximately a = 0.0055 mm 1\nand s = 1.1 mm 1 at 680 nm. Fluorescent targets were embedded within the phantoms to create the four cases previously\ndefined in the simulations. The initial value of s was set identically for all reconstruction methods as the calibrated value,\nand also the U-Net was retrained accordingly. Consistent with\nthe simulation study, we focused on the adaptive recovery of\nthe reduced scattering coefficient s .\nThe reconstruction results are summarized in Fig. 4. Under\nthese challenging real-world conditions, the limitations of the\nbaseline methods became evident: conventional approaches\n(L2 -CG, L1 -FISTA) produced blurry or fragmented reconstructions with significant depth errors, while the supervised\nU-Net, susceptible to domain shift and noise, failed to generalize, resulting in complete localization failures (Case 1)\nor severely distorted shapes (Cases 3 and 4). In contrast,\nthe INR-based frameworks, NeuFMT and NeuFMT, demonstrated markedly superior robustness, consistently yielding\nphysically plausible and continuous reconstructions where\nother methods failed. A detailed comparison between the two\nreveals that NeuFMT provided critical refinements toward\nenhanced physical consistency. In Cases 1 and 3, NeuFMT\nachieved better depth sensitivity and more uniform fluorophore\ndistribution, more faithfully representing the homogeneous\nnature of the true targets. In the complex geometry of Case 2,\nit uniquely achieved accurate localization, whereas direct\nNeuFMT produced a solution with an aberrant depth shift. For\nthe multi-target scenario in Case 4, NeuFMT reconstructed\nthe background region with improved morphological accuracy.\nAlthough the performance gap in quantitative metrics such\nas the Dice coefficient was occasionally narrow, which reflects the inherent robustness of the shared INR architecture,\n NeuFMT provided consistent, subtle refinements, particularly\nin depth accuracy. The phantom experiments confirm that the\nadaptive physical correction mechanism in NeuFMT can enhance reconstruction fidelity under practical conditions where\nthe exact coefficient in most real experiments is uncertain.", "D. In Vivo Lymph Node FMT Imaging Experiments\nWe performed an in vivo imaging experiment on mice.\nFollowing the protocol described in Subsection II-F, Cy5\nfluorescent dye accumulated primarily at the sentinel lymph\nnodes (LN), with some residual signal at the vein (Fig. 5 (a)).\nOur task was to reconstruct the spatial location and shape of\nthe sentinel lymph nodes.\nThe 3D FMT reconstruction results from all methods\nare presented in Fig. 5 (b). The conventional L2 -CG method\nproduced a reconstruction where the volume of LN-3 was\noverestimated, and the signals from LN-1, LN-2, and the vein\nmerged into a single, indistinguishable cluster. The L1 -FISTA\nreconstruction was highly fragmented, making it impossible\nto discern the shape or count of the lymph nodes accurately.\nAlso, the baseline NeuFMT failed to produce a physiologically plausible reconstruction. In contrast, NeuFMT was\nthe only method that successfully and distinctly resolved all\nthree lymph nodes (LN-1, LN-2, LN-3) and the vein, clearly\nidentifying each as separate, localized regions of fluorescence.\nFor quantitative validation, the mouse was sacrificed, and\nthe lymph nodes were excised to be imaged by ex vivo FRI\n(Fig. 5 (c)). The reconstructed target lengths from NeuFMT\nshowed the closest agreement with the physical measurements\ntaken from the ex vivo lymph nodes, as visualized by the\nintensity profiles in Fig. 5 (c). These results demonstrate that\n NeuFMT provides a definitive advantage in practical in vivo\nscenarios, enabling robust and accurate target segmentation\nand localization under complex clinically related scenarios,\nsuch as fluorescence guided surgery.", "IV. D ISCUSSION AND C ONCLUSION\nIn this study, we introduced NeuFMT, an optical-propertyadaptive FMT reconstruction framework that integrates INR\nwith an explicitly differentiable FEM-based light propagation model. By unifying a continuous fluorescence field\nparameterized by an INR and a physics-based forward model\namenable to end-to-end optimization, NeuFMT addresses\ntwo fundamental limitations of existing FMT reconstruction\ntechniques: their inability to efficiently adapt to complex and\nheterogeneous fluorescence distribution, and their reliance on\nfixed, often inaccurate, optical properties, which significantly\nexacerbates the inherent ill-posedness of the inverse problem.\nUnlike supervised deep learning approaches which are constrained by the diversity and scale of training datasets and\noften fail under domain shift, NeuFMT operates in a selfsupervised, physics-informed regime. It does not require paired\ntraining data; instead, it directly minimizes the discrepancy between measured and simulated boundary fluxes. This not only\neliminates the need for extensive experimental datasets but also\nensures generalizability across different imaging geometries\nand target configurations. The continuous, coordinate-based\nrepresentation provided by the INR further ensures that our\nreconstructions are free from discretization artifacts and inherently resolution-agnostic.\nA central contribution of our work is the introduction of\nan optical property adaptation mechanism, which enables the\ndynamic optimization of absorption and scattering coefficients\n( a , s ) concurrently with the fluorescence distribution. Our\nframework demonstrates that the integration of a differentiable\nphysics-based forward model is the key to enabling this\nself-supervised adaptation. The FEM-based light propagation\nmodel is not merely a component of the loss function, but\nan active and adaptive part of the inverse solver. This stands\nin contrast to both traditional iterative methods, which hold\noptical properties static and thus aggravate the problem s illposedness, and conventional end-to-end deep learning approaches, which struggle to generalize beyond their training\ndata. The adaptivity of our model is thus its core strength,\nproviding a principled way to refine the physical model itself\nbased on the measured data, which is crucial for practical\napplications where precise prior knowledge of tissue optics\nis unavailable.", "Our results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate\nthat NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1 ) and deep learningbased (U-Net) benchmarks. In particular, the method consistently localized fluorescent targets with higher spatial accuracy, improved contrast, and more realistic morphological\nfeatures especially under challenging conditions involving\nbackground fluorescence and complex geometry.\nDespite these promising results, several aspects of\n NeuFMT merit further investigation. First, the current implementation assumes a homogeneous optical background a\ncommon simplification in FMT studies. Extending the model\nto incorporate spatially varying optical properties represents\na logical next step, potentially by representing a (r) and\n s (r) with additional INRs, though this would significantly\nincrease the complexity of the inverse problem. Nevertheless,\nthe proposed NeuFMT can be validated or even combined\nwith time-domain near-infrared spectroscopy (fNIRS) [44],\n[45] or diffuse optical tomography (DOT) [46] techniques,\nwhere the complex optical properties related with absorption\nand scattering can disentangled and calibrated. More importantly, the integration of NeuFMT with emerging imaging\ntechnologies holds particular promise. The inherent adaptivity\nof our framework is well-suited to the distinct scattering\nand absorption landscapes of NIR-II fluorescence tomography\n[47], [48], where our optical property optimization could be\ncrucial for accurately modeling the increased photon penetration and achieving higher-resolution reconstruction at depth.\nFurthermore, the framework can be naturally extended to\nhyperspectral FMT, using a single INR to output both fluorophore concentration and spectral signature, thereby disentangling multiple probes or accounting for wavelength-dependent\noptical properties. Finally, translating NeuFMT into clinical\nsettings, such as intraoperative fluorescence-guided surgery\n[8], [9], represents an exciting frontier where its adaptability\ncould overcome patient-specific variations in tissue optics.\nIn conclusion, by harmonizing a differentiable physics\nmodel with a continuous INR, NeuFMT provides a robust,\nself-supervised, and adaptive framework for FMT reconstruction. It effectively mitigates the ill-posedness inherent to\ninverse problems with uncertain parameters, setting a new\nparadigm for practical, high-resolution fluorescence molecular\nimaging. We believe this physics-in-the-loop INR approach\noffers a generalizable template for tackling a wide range of\ntomographic and inverse problems in biomedical imaging.", "R EFERENCES\n[1] F. Song, P. Zhang, H. Wu, C. Ma, Z. Liu, R. Cai, Y. Feng, Y. He,\nX. Dong, Y. Tian, and G. Zhang, Advances of fluorescence molecular\nimaging: NIR-II window, probes, and tomography, Laser & Photonics\nReviews, vol. 19, no. 10, p. 2400275, 2025.\n[2] B. Zhu, J. Hendricks, J. E. Morton, J. C. Rasmussen, C. Janssen,\nM. N. Shah, and E. M. Sevick-Muraca, Near-infrared fluorescence\ntomography and imaging of ventricular cerebrospinal fluid flow and\nextracranial outflow in non-human primates, IEEE Transactions on\nMedical Imaging, vol. 42, no. 12, pp. 3555 3565, 2023.\n[3] M. S. Ozturk and et al., High-resolution tomographic analysis of in\nvitro 3D glioblastoma tumor model under long-term drug treatment, \nScience Advances, vol. 6, no. 10, p. eaay7513, 2020.\n[4] M. Cai, Z. Zhang, X. Shi, Z. Hu, and J. Tian, NIR-II/NIR-I fluorescence molecular tomography of heterogeneous mice based on gaussian\nweighted neighborhood fused lasso method, IEEE Transactions on\nMedical Imaging, vol. 39, no. 6, pp. 2213 2222, 2020.\n[5] S. R. Arridge and J. C. Schotland, Optical tomography: forward and\ninverse problems, Inverse problems, vol. 25, no. 12, p. 123010, 2009.\n[6] L. V. Wang and H.-i. Wu, Biomedical optics: principles and imaging.\nJohn Wiley & Sons, 2007.\n[7] F. Stuker, J. Ripoll, and M. Rudin, Fluorescence molecular tomography:\nprinciples and potential for pharmaceutical research, Pharmaceutics,\nvol. 3, no. 2, pp. 229 274, 2011.\n[8] J. S. D. Mieog, F. B. Achterberg, A. Zlitni, M. Hutteman, J. Burggraaf,\nR.-J. Swijnenburg, S. Gioux, and A. L. Vahrmeijer, Fundamentals and\ndevelopments in fluorescence-guided cancer surgery, Nature Reviews\nClinical Oncology, vol. 19, no. 1, pp. 9 22, 2022.\n[9] K. Wang, Y. Du, Z. Zhang, K. He, Z. Cheng, L. Yin, D. Dong, C. Li,\nW. Li, Z. Hu et al., Fluorescence image-guided tumour surgery, Nature\nReviews Bioengineering, vol. 1, no. 3, pp. 161 179, 2023.\n[10] D. Zhu et al., Comparison of regularization methods in fluorescence\nmolecular tomography, Photonics, vol. 1, no. 2, pp. 95 109, 2014.\n[11] H. Yi et al., Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography:\na comparative study, Journal of Biomedical Optics, vol. 18, no. 5, p.\n56013, 2013.\n[12] J. Shi, B. Zhang, F. Liu, J. Luo, and J. Bai, Efficient L1 regularizationbased reconstruction for fluorescent molecular tomography using\nrestarted nonlinear conjugate gradient, Optics letters, vol. 38, no. 18,\npp. 3696 3699, 2013.\n[13] D. Zhu and C. Li, Nonconvex regularizations in fluorescence molecular\ntomography for sparsity enhancement, Physics in Medicine & Biology,\nvol. 59, no. 12, p. 2901, 2014.\n[14] J. Zhang, L. Li, Q. Hu, J. Zhang, Y. Wu, L. Gu, J. Li, F. Li, X. Zhu,\nJ. Jiang et al., High-fidelity solution decomposition fluorescence tomography in the presence of background interference, Laser & Photonics\nReviews, p. e01013, 2025.\n[15] C. Huang, H. Meng, Y. Gao, S. Jiang, K. Wang, and J. Tian, Fast and\nrobust reconstruction method for fluorescence molecular tomography\nbased on deep neural network, in Imaging, Manipulation, and Analysis\nof Biomolecules, Cells, and Tissues XVII, vol. 10881. SPIE, 2019, pp.\n257 262.\n[16] L. Guo, F. Liu, C. Cai, J. Liu, and G. Zhang, 3D deep encoder decoder\nnetwork for fluorescence molecular tomography, Optics letters, vol. 44,\nno. 8, pp. 1892 1895, 2019.\n[17] P. Zhang, G. Fan, T. Xing, F. Song, and G. Zhang, UHR-DeepFMT:\nultra-high spatial resolution reconstruction of fluorescence molecular\ntomography based on 3-d fusion dual-sampling deep neural network, \nIEEE Transactions on Medical Imaging, vol. 40, no. 11, pp. 3217 3228,\n2021.\n[18] J. Cheng, P. Zhang, F. Liu, J. Liu, H. Hui, J. Tian, and J. Luo, Encoderdecoder deep learning network for simultaneous reconstruction of fluorescence yield and lifetime distributions, Biomedical Optics Express,\nvol. 13, no. 9, pp. 4693 4705, 2022.\n[19] P. Zhang, C. Ma, F. Song, Z. Liu, Y. Feng, Y. Sun, Y. He,\nF. Liu, D. Wang, and G. Zhang, Multi-branch attention prior based\nparameterized generative adversarial network for fast and accurate\nlimited-projection reconstruction in fluorescence molecular tomography, Biomedical Optics Express, vol. 13, no. 10, pp. 5327 5343, 2022.\n[20] P. Zhang, F. Song, C. Ma, Z. Liu, H. Wu, Y. Sun, Y. Feng, Y. He, and\nG. Zhang, Robust reconstruction of fluorescence molecular tomography\nbased on adaptive adversarial learning strategy, Physics in Medicine &\nBiology, vol. 68, no. 4, p. 04LT01, 2023.\n[21] P. Zhang, X. Liu, Q. Xue, Y. Shang, C. Liu, R. Chen, H. Gao, J. Liang,\nW. Wang, and G. Zhang, PAH2T-Former: Paired-attention hybrid\nhierarchical transformer for synergistically enhanced fmt reconstruction\nquality and efficiency, IEEE Transactions on Computational Imaging,\n2025.\n[22] H. Meng, Y. Gao, X. Yang, K. Wang, and J. Tian, K-nearest neighbor\nbased locally connected network for fast morphological reconstruction\nin fluorescence molecular tomography, IEEE transactions on medical\nimaging, vol. 39, no. 10, pp. 3019 3028, 2020.\n[23] D. Li, C. Chen, J. Li, and Q. Yan, Reconstruction of fluorescence\nmolecular tomography based on graph convolution networks, Journal\nof Optics, vol. 22, no. 4, p. 045602, 2020.\n[24] Y. Wang, C. Bian, Y. An, H. Wang, Q. Liang, Y. Du, and J. Tian,\n Graph convolution based residual connected network for morphological reconstruction in fluorescence molecular tomography, in Medical\nImaging 2022: Biomedical Applications in Molecular, Structural, and\nFunctional Imaging, vol. 12036. SPIE, 2022, pp. 527 533.\n[25] Y. Sun, J. Liu, M. Xie, B. Wohlberg, and U. S. Kamilov, Coil:\nCoordinate-based internal learning for tomographic imaging, IEEE\nTransactions on Computational Imaging, vol. 7, pp. 1400 1412, 2021.\n[26] L. Lozenski, M. A. Anastasio, and U. Villa, A memory-efficient selfsupervised dynamic image reconstruction method using neural fields, \nIEEE Transactions on Computational Imaging, vol. 8, pp. 879 892,\n2022.\n[27] A. W. Reed, H. Kim, R. Anirudh, K. A. Mohan, K. Champley, J. Kang,\nand S. Jayasuriya, Dynamic CT reconstruction from limited views\nwith implicit neural representations and parametric motion fields, in\nProceedings of the IEEE/CVF International Conference on Computer\nVision, 2021, pp. 2258 2268.\n[28] L. Shen, J. Pauly, and L. Xing, NeRP: implicit neural representation\nlearning with prior embedding for sparsely sampled image reconstruction, IEEE Transactions on Neural Networks and Learning Systems,\nvol. 35, no. 1, pp. 770 782, 2022.\n[29] R. Liu, Y. Sun, J. Zhu, L. Tian, and U. S. Kamilov, Recovery\nof continuous 3D refractive index maps from discrete intensity-only\nmeasurements using neural fields, Nature Machine Intelligence, vol. 4,\nno. 9, pp. 781 791, 2022.\n[30] S. Shen, L. Li, S. Gao, Y. Wang, L. Gu, S. Li, X. Zhu, J. Jiang, J. Yu, and\nW. Ren, High resolution diffuse optical tomography via neural fields, \nIEEE Transactions on Computational Imaging, 2024.\n[31] K. Han, C. Li, A. Xiao, Y. Tian, J. Tian, and Z. Hu, TSPE: Reconstruction of multi-morphological tumors of NIR-II fluorescence molecular\ntomography based on positional encoding, Computer Methods and\nPrograms in Biomedicine, vol. 261, p. 108554, 2025.\n[32] S. R. Arridge, Optical tomography in medical imaging, Inverse problems, vol. 15, no. 2, p. R41, 1999.\n[33] , Photon-measurement density functions. part I: Analytical forms, \nApplied Optics, vol. 34, no. 31, pp. 7395 7409, 1995.\n[34] S. R. Arridge and M. Schweiger, Photon-measurement density functions. part 2: Finite-element-method calculations, Applied Optics,\nvol. 34, no. 34, pp. 8026 8037, 1995.\n[35] O. C. Zienkiewicz, R. L. Taylor, P. Nithiarasu, and J. Zhu, The finite\nelement method. Elsevier, 1977, vol. 3.\n[36] V. Ntziachristos, C. Bremer, and R. Weissleder, Fluorescence molecular\ntomography resolves protease activity in vivo, Nature Medicine, vol. 8,\nno. 7, pp. 757 760, 2002.\n[37] M. Schweiger and S. Arridge, The Toast++ software suite for forward\nand inverse modeling in optical tomography, Journal of biomedical\noptics, vol. 19, no. 4, pp. 040 801 040 801, 2014.\n[38] W. Ren, H. Isler, M. Wolf, J. Ripoll, and M. Rudin, Smart toolkit\nfor fluorescence tomography: simulation, reconstruction, and validation, \nIEEE Transactions on Biomedical Engineering, vol. 67, no. 1, pp. 16 \n26, 2019.\n[39] S. Gao, J. Zhang, Y. Hu, Y. Wu, L. Li, Q. Hu, X. Lou, X. Zhu, J. Jiang,\nand W. Ren, Multifunctional optical tomography system with highfidelity surface extraction based on a single programmable scanner and\nunified pinhole modeling, IEEE Transactions on Biomedical Engineering, 2023.\n[40] Y. Hu, Y. Wu, L. Li, L. Gu, X. Zhu, J. Jiang, and W. Ren, Simultaneous\nreconstruction of 3D fluorescence distribution and object surface using\nstructured light illumination and dual-camera detection, Optics Express,\nvol. 32, no. 9, pp. 15 760 15 773, 2024.\n[41] C. Ji, M. Zhao, C. Wang, R. Liu, S. Zhu, X. Dong, C. Su, and Z. Gu,\n Biocompatible tantalum nanoparticles as radiosensitizers for enhancing\ntherapy efficacy in primary tumor and metastatic sentinel lymph nodes, \nACS nano, vol. 16, no. 6, pp. 9428 9441, 2022.\n[42] S. Kawata and O. Nalcioglu, Constrained iterative reconstruction by\nthe conjugate gradient method, IEEE Transactions on Medical Imaging,\nvol. 4, no. 2, pp. 65 71, 1985.\n[43] A. Beck and M. Teboulle, A fast iterative shrinkage-thresholding algorithm for linear inverse problems, SIAM Journal on Imaging Sciences,\nvol. 2, no. 1, pp. 183 202, 2009.\n[44] Y. Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared\nspectroscopy and imaging: a review, Applied Sciences, vol. 9, no. 6, p.\n1127, 2019.\n[45] H. Y. Ban, G. M. Barrett, A. Borisevich, A. Chaturvedi, J. L. Dahle,\nH. Dehghani, J. Dubois, R. M. Field, V. Gopalakrishnan, A. Gundran\net al., Kernel flow: a high channel count scalable time-domain functional near-infrared spectroscopy system, Journal of biomedical optics,\nvol. 27, no. 7, p. 074710, 2022.\n[46] A. Pifferi, D. Contini, A. D. Mora, A. Farina, L. Spinelli, and A. Torricelli, New frontiers in time-domain diffuse optics, a review, Journal\nof Biomedical Optics, vol. 21, no. 9, pp. 091 310 091 310, 2016.\n[47] F. Wang, Y. Zhong, O. Bruns, Y. Liang, and H. Dai, In vivo NIRII fluorescence imaging for biology and medicine, Nature Photonics,\nvol. 18, no. 6, pp. 535 547, 2024.\n[48] Z. Zhang, Y. Du, X. Shi, K. Wang, Q. Qu, Q. Liang, X. Ma, K. He,\nC. Chi, J. Tang et al., NIR-II light in clinical oncology: opportunities\nand challenges, Nature Reviews Clinical Oncology, vol. 21, no. 6, pp.\n449 467, 2024."]}
{"method": "delimiter", "num_chunks": 603, "avg_chunk_len": 95.70149253731343, "std_chunk_len": 444.39281300799865, "max_chunk_len": 4683, "min_chunk_len": 1, "total_chars": 57708, "compression_ratio": 1.0211755735773203, "chunks": ["PREPRINT VERSION 2025", "1", "NeuFMT: Optical-Property-Adaptive Fluorescence\nMolecular Tomography via Implicit\nNeural Representation", "arXiv:2511.04510v1 [eess.IV] 6 Nov 2025", "Shihan Zhao, Jianru Zhang, Yanan Wu, Linlin Li, Siyuan Shen, Xingjun Zhu, Guoyan Zheng, Member IEEE,\nJiahua Jiang, and Wuwei Ren", "Abstract Fluorescence Molecular Tomography (FMT) is a\npromising technique for non-invasive 3D visualization of fluorescent probes, but its reconstruction remains challenging due to\nthe inherent ill-posedness and reliance on inaccurate or oftenunknown tissue optical properties. While deep learning methods\nhave shown promise, their supervised nature limits generalization\nbeyond training data. To address these problems, we propose\n NeuFMT, a self-supervised FMT reconstruction framework that\nintegrates implicit neural-based scene representation with explicit\nphysical modeling of photon propagation. Its key innovation lies\nin jointly optimize both the fluorescence distribution and the\noptical properties ( ) during reconstruction, eliminating the need\nfor precise prior knowledge of tissue optics or pre-conditioned\ntraining data. We demonstrate that NeuFMT robustly recovers\naccurate fluorophore distributions and optical coefficients even\nwith severely erroneous initial values (0.5 to 2 of ground\ntruth). Extensive numerical, phantom, and in vivo validations\nshow that NeuFMT outperforms conventional and supervised\ndeep learning approaches across diverse heterogeneous scenarios.\nOur work establishes a new paradigm for robust and accurate\nFMT reconstruction, paving the way for more reliable molecular\nimaging in complex clinically related scenarios, such as fluorescence guided surgery.\nIndex Terms fluorescence molecular tomography, image reconstruction, optical properties, implicit neural representation,\nfluorescence guided surgery", "The work was supported by Science and Technology Commission of Shanghai Municipality under Grant 25JS2830300 (Wuwei Ren), National Natural\nScience Foundation of China under Grants 62105205 (Wuwei Ren), and\nShanghai Clinical Research and Trial Center (Wuwei Ren). (Corresponding\nauthor: Wuwei Ren.)\nShihan Zhao and Jianru Zhang contributed equally to this work.\nShihan Zhao, Yanan Wu, Linlin Li and Siyuan Shen are with\nthe School of Information Science and Technology, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: zhaoshh, wuyn1, lill,\nshensy2023@shanghaitech.edu.cn).\nJianru Zhang and Jiahua Jiang are with the School of Mathematics,\nUniversity of Birmingham, Edgbaston, B15 2QN, United Kingdom (e-mail:\njxz389@student.bham.ac.uk; j.jiang.3@bham.ac.uk).\nXingjun Zhu is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail:\nzhuxj1@shanghaitech.edu.cn).\nGuoyan Zheng is with the Institute of Medical Robotics, School of\nBiomedical Engineering, Shanghai Jiao Tong University, Shanghai 200240,\nChina (e-mail: guoyan.zheng@sjtu.edu.cn)\nWuwei Ren is with the School of Information Science and Technology,\nShanghaiTech University, Shanghai 201210, China, and also with State\nKey Laboratory of Advanced Medical Materials and Devices, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: renww@shanghaitech.edu.cn).", "I. INTRODUCTION\nFluorescence Molecular Tomography (FMT) has emerged\nas a promising molecular imaging modality, enabling noninvasive 3D visualization of fluorescent probe distribution\nin highly turbid media [1]. Owning to its high sensitivity,\ncost-effectiveness, and non-ionizing radiation, FMT has found\nbroad applications in preclinical research and clinical practice, e.g., brain imaging [2], in vitro cell culture monitoring\n[3] and tumor detection [4]. FMT reconstructs the internal\nfluorescence distribution by measuring the photon distribution\non the object surface and minimizing the discrepancy between\nreal measurements and the simulated results. A canonic framework of FMT reconstruction employs an iterative optimization\nstrategy with a forward model typically based on the\nRadiation Transfer Equation (RTE) or the diffusion equation\n(DE) and an inverse model that refines fluorescence distribution prediction until convergence [5], [6]. However, FMT\nreconstruction is inherently ill-posed due to insufficient surface measurements and strong photon scattering effect within\ntissues. Development of high-precision FMT reconstruction\nalgorithms is highly attractive for further improvement of\nthe spatial resolution and detection depth of this technology,\nwhich ultimately broaden the biological applications in drug\ndiscovery [7] and clinical use such as fluorescence guided\nsurgery [8], [9].\nTo address the ill-posed nature of FMT reconstruction,\nregularization techniques that incorporate prior knowledge are\napplied. Conventional approaches include Tikhonov (L2 norm)\nregularization for smoothing the results [10], [11], and sparsepromoting regularization (L1 , Lp norm) or total variation (TV)\nregularization for enhancing the spatial resolution [12], [13].\nRecent advancements in regularization techniques, such as\nthe solution-decomposition algorithm, utilize an advanced\nstochastic prior model that improves the differentiation of\nfluorescence targets from background interference, thereby\nenhancing reconstruction quality [14]. While these methods\nstabilize solutions, their reliance on time-consuming iterative\noptimization and idealized assumptions about optical parameters often results in slow convergence and limited accuracy in\nheterogeneous tissues. Deep learning (DL) methods, particularly en-decoder-based neural networks [15] [21] and graphbased networks [22] [24], have recently been used in FMT\nreconstruction by learning direct mappings from boundary\nmeasurements to fluorescence distributions. These approaches", "2", "encode physical priors within network parameters, enabling\noverwhelmingly rapid inference. However, their dependence\non supervised training with large, scenario-specific datasets restricts generalizability across variable experimental conditions\n(e.g., tissue object geometry and optical properties), leading\nto significant accuracy degradation when the object properties\ndeviate from training assumptions.\nRecently, implicit neural representation (INR) models have\nemerged as a powerful alternative for medical image reconstruction. By mapping arbitrary spatial coordinates to certain\nunknown physical quantities via a coordinate-based multilayer perceptron network (MLP), INRs achieve continuous\n3D representations, self-supervised training, and memory efficiency. Originally popularized in computer vision and medical imaging, INRs have demonstrated remarkable success\nin modalities such as computed tomography (CT), magnetic\nresonance imaging (MRI) [25] [29], and notably in diffuse\noptical tomography (DOT), where INR has been proven to be\nable to capture a high-resolution, continuous optical absorption\nmap that account for light scattering in complex tissues [30].\nINR captures continuous spatial information and integrates\nphysical priors makes it particularly suited for various imaging problems. In the context of FMT, preliminary work has\nexplored position encoding strategies to enhance spatial resolution and improve the quality of FMT reconstructions [31].\nNevertheless, systematic studies integrating optical diffusion\nphysics within an INR framework remain scarce. This gap\npresents an opportunity to harness the strengths of implicit\nmodeling for robust and data-efficient FMT reconstruction.\nTo bridge this gap, we propose neural-field-based FMT, or\nNeuFMT, a physics-driven reconstruction framework unifying\nINR with explicit physical models. Unlike conventional DLbased FMT reconstruction algorithms that couple explicit\nfluorescence predictions to implicit physical model, NeuFMT\nintegrates the DE-based forward model in the network loss,\nenabling self-supervised training without paired data. The\ndifferentiability of the forward model is achieved via finite\nelement method (FEM). This inversion-free approach ensures\nrapid, continuous reconstruction across diverse geometries\nwhile inherently addressing scattering effects. Another critical\nlimitation of both traditional and DL methods lies in the\npresumed optical properties of the object during reconstruction, which largely aggravate the ill-posedness of the inverse\nproblem given the optical parameters were initially biased. To\novercome this, we further introduce optical-property-adaptive\nNeuFMT, or NeuFMT, an adaptive extension of NeuFMT\nthat dynamically optimizes scattering / absorption coefficients\nand fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations, NeuFMT achieves robust accuracy even when provided\nwith erroneous initial guess of the optical coefficient values,\naddressing the problem of unrealistic assumption prior to\nFMT reconstruction. Both proposed INR-based FMT reconstruction algorithms were thoroughly compared and validated\nby simulations and phantom experiments along with other\nmethods. Furthermore, in vivo lymph node imaging in mice\nwas performed, further demonstrating the advantages of the\nproposed methods.", "PREPRINT VERSION 2025", "II. M ETHODS\nA. Forward Modeling of FMT\nModel-based FMT reconstruction comprises two fundamental steps: forward modeling and inversion. The former predicts\nsurface photon density measurements based on an assumed\nfluorescence distribution. At the macroscopic scale, we employ\nthe first-order approximation of the radiative transport equation (RTE), known as the diffusion equation (DE) [32]. The\nexcitation and fluorescence emission processes in continuouswave (CW) mode form a coupled pair of DEs expressed as\n[33], [34]:\n κ ϕx (r) + a ϕx (r) = qx (r),", "r , (1)", "κ ϕm (r) + a ϕm (r) = η C(r) ϕx (r),", "r , (2)", "where ϕx and ϕm denote the excitation and emission photon\ndensity, qx is the excitation source, C(r) is the fluorophore\nconcentration to be reconstructed in the inversion, and η\ncollects quantum-yield factors in the CW source term. κ\nrepresents the diffusion coefficient, calculated by [33]\n1\n,\n(3)\nκ=\n3 ( a + s )\nwith the absorption coefficient a and the reduced scattering\ncoefficient s . In a non-contact setting of FMT, to calculate\nthe value of ϕ (r) on the object surface as the measurement, a Robin-type boundary condition is added alongside the\nequation pair (1 2):\n ϕ (r)\n= 0, {x, m}, r , (4)\n ν\nwhere ζ(c) is the refractive index mismatch parameter that\naccounts for the light reflection on the boundary surface, with\nc representing the light speed inside the medium. ν denotes\nthe outward normal on the boundary. Notably, to simplified the\nproblem setting, we only consider a homogeneous medium\ncase and the difference of a , s values under different\nwavelengths are neglected.\nϕ (r) + 2 ζ(c) κ", "B. Finite Element Discretization and System Matrix Construction\nWe apply the finite element method (FEM) [35] to the\ndiffusion model (1) - (4). Discretizing with a tetrahedral\nN\nmesh of N\ni }i=1 , we approximate\nP nodes and nodal basis {ψP\nϕ (r) i Φ ,i ψi (r) and qx (r) i (Qx )i ψi (r), which\ntransforms the continuous-form equations into a linear system\nfor excitation and emission photon propagation:\nS Φx = Qx", "(5)", "S Φm = Qm", "(6)", "where S RN N is the system matrix and Φ , Q RN\nare discretized form (coefficient vectors) for ϕ and q , respectively. In particular, the excitation field ϕx interacts with\nfluorophores C RN to produce the emission source term\nQm = C Φx", "(7)", "with denoting element-wise multiplication. The equation\n(7) physically describes how fluorophores absorb excitation", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "explicitly reveals the functional dependence of S on the\noptical parameters a and s , which forms the mathematical\nfoundation for our adaptive optimization approach introduced\nin Subsection II-C.", "(b)", "(a)", "3", "Camera\nFilter Wheel\nReal Measurement\nSample", "C. INR-based FMT reconstruction: NeuFMT / NeuFMT\nScanners", "Laser\nPredicted\nMeasurement", "Focal Lens OD Filter\n(c)", "(d)", "Adaption Module", "Forward Model\nBased on DE", "Absorption Term\nHigh Absorption", "Low Absorption", "inv\nDi usion Term", "High Scattering", "Sti ness Matrix", "Low Scattering\nBoundary Term", "(e)", "Forward Data\nBackward Gradient", "Fluorescence Distribution Encoded with INR\nNode Coordinate", "3D Mesh with", "Nodes", "sine", "cosine", "Positional\nEncoding", "MLP", "Fig. 1. Conceptual illustration of NeuFMT. (a) The FMT setup: a scanned\nlaser illuminates the sample while a CMOS camera with filter wheel on the\nopposite side records boundary images. The raster scanning method yields\nthe raw 2D image stack M real , serving as the input to the subsequent FMT\nreconstruction. (b) The difference between M real and the simulated meac( a , , Cθ ) is iteratively minimized until an optimized value\nsurement M\ns\nof unknown fluorescence distribution C is found. R(C) is a regularization\nterm and { a , s } is the intrinsic optical properties consisting of\nabsorption coefficient a and scattering coefficient s . (c) A -adaption\nmodule is integrated into the FMT reconstruction. The stiffness matrix S is\ndetermined by both a and s . (d) The FEM-based simulator predicts virtual\nc( a , , Cθ ) based on the operator S 1 ( ) and predicted\nmeasurement M\ns\nfluorescence distribution C. (e) Fluorescence distribution encoded in an INR.\n3D node coordinate serves as input, while a continuous C map is generated\nthrough positional encoding and an MLP network.", "Unlike traditional voxel-based or mesh-dependent representations, INR provides a continuous, memory-efficient framework for modeling complex physical fields. The basic variant,\nNeuFMT, learns only the fluorophore Cθ with fixed optical\nproperties; the proposed adaptive NeuFMT jointly optimizes\nthe optical coefficients ( a , s ) with Cθ for enhancing the\nreconstruction accuracy and robustness. In this section, we\ndescribe the NeuFMT representation, formulate the learning\nobjective, introduce optical-property adaptation, and summarize the network architecture and implementation.\n1) INR representation of the unknown fluorescence: Our\n NeuFMT model the 3D fluorescence field as an INR, i.e., a\ncoordinate-conditioned MLP:", "Cθ (r) = fθ Γ (r) ,\n(10)\nwhere r = (x, y, z) R3 , Γ : Rd is a highdimensional positional encoding of spatial coordinates, and\nfθ : Rd R is an MLP with parameters θ. This INR formulation (10) enables resolution-independent reconstruction and\nnaturally accommodates arbitrary spatial queries without being\nconstrained by the conventional discrete grid structure.\nTo enhance the network s ability to represent high-frequency\ndetails, which is crucial for resolving complex in vivo fluorescence patterns, we apply a sinusoidal positional encoding to\neach coordinate component. Let γ : R R2L be\nγ(p) = sin(20 πp), cos(20 πp), ,\nL 1", "sin(2", "πp), cos(2", "L 1", "(11)", "πp) ,", "p {x, y, z},", "photons and re-emit light at longer wavelengths. The emission\nsource Qm then propagates through the same medium to\nproduce the emission photon density Φm , which is finally\ndetected at the boundary, which is computed as", "where L is the number of frequency bands. The\n 3D position\nis then encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that\nd = 6L. Feeding Γ (r) into fθ enables compact representation\nof both low- and high-frequency variations in Cθ .\n2) Learning objective: We estimate the fluorescence field\nCθ and, in NeuFMT, the optical properties { a , s } by\nminimizing a data-fidelity term plus regularization:", "M = P Φm", "c( a , , Cθ ) M real 2 + λ R(Cθ ), (12)\nL( a , s , θ) = M\ns\n2", "(8)", "where P represents the transfer function, which maps the\nboundary photon density Φm the measurement data M acquired by the camera. The above linearized forward model\nprovides the physical foundation for the inversion procedure.\nCrucially, the SPD FEM stiffness matrix S( a , s ) \nN N\nR\nin (5) (6) encode the optical properties and boundary\ngeometry, generating from a linear combination of matrices\ncorresponding to distinct physical components [33], [36]", "1", "Sd + Sb . (9)\nS( a , s ) = c a Sa +\n3( a + s )\nwith Sa , Sd , and Sb the assembled absorption, diffusion, and\nRobin-boundary matrices, respectively. This decomposition", "c denotes the boundary measurements, and R(Cθ ) is\nwhere M\na regularization term applied to the fluorescence distribution.\nThe hyperparameter λ controls the regularization strength,\nbalancing data fidelity with sparsity constraints. The training of\n NeuFMT / NeuFMT follows a fully self-supervised paradigm\nthat explicitly integrates the DE-based physical model into\nthe optimization loop. Note that NeuFMT uses fixed optical\nparameters ( a , s ), whereas NeuFMT updates jointly.\n3) Alternating optical-property adaptation: A fundamental\ninnovation of NeuFMT lies in formulating the entire photon propagation process from excitation to emission as an\nend-to-end differentiable map. The forward model follows a", "4", "PREPRINT VERSION 2025", "precise physical sequence from excitation source to surface\nmeasurements, as described in Subsection II-B:", "c( a , s , Cθ ) = P S( a , s ) 1 Cθ S( a , s ) 1 Qx ,\nM\n(13)\nWe optimize the introduced objective L( a , s , θ) in (12),\njointly updating network parameters θ and optical coefficients\n( a , s ). The chain in (13) contains only differentiable operations, including linear solves, elementwise products, and linear\nc is differentiable w.r.t. both Cθ (hence θ)\nprojections. Thus M", "and ( a , s ), enabling standard gradient-based training. For\ncompleteness, we state the chain-rule decomposition of the\nloss gradient with respect to ( a , s ). Based on (13), the\ngradient splits into an emission term and an excitation term:", "c \n S\n L M\n L\n S 1\n=\nΦm +\nc Φm", "{z\n}\n| M\nEmission pathway", "c Φm Qm \n L M\n S\nΦx\n S 1\nc Φm Qm Φx", "| M\n{z\n}", "(14)", "Excitation pathway", "{ a , s }.\nThe only model-specific ingredient of a and s is the\nJacobian of S( a , s ). According to (9), the partial derivatives\nare", "S\n1\n= c Sa \nSd ,\n a\n3( a + s )2", "S\n1\n=c \nSd .\n(15)\n s\n3( a + s )2\nThis allows a and s to be optimized directly using gradient\ndescent, and then be updated together with θ, bridging the\nlearning process with the underlying physical model.\nTo mitigate potential coupling effects between a and s\nduring optimization, we propose an alternating update strategy,\nwhich periodically updates one optical parameter with the\nother fixed. The alternating framework largely promotes training stability to avoid oscillations with sufficient computational\nefficiency. The complete NeuFMT algorithm is described in\nAlgorithm 1. Overall, the alternating -adaption module ensures that each optical parameter receives dedicated optimization attention while maintaining the physical consistency of\nthe forward model, yielding more accurate FMT reconstruction\nresults even in the presence of mismatch between the initial\nguess and ground truth of the optical properties.\n4) Network architecture and implementation: We adopt\nMLP for the NeuFMT / NeuFMT, comprising 8 fullyconnected layers with 512 hidden units each, followed by\na final layer with 128 units. ReLU activation functions are\nemployed throughout the network. A critical skip connection\nbridges the input Γ (r) to the 4th hidden layer, facilitating\ngradient flow and enhancing the ability to learn fine-grained\ndetails. This architectural choice is particularly suited for FMT\napplications where accurately reconstructing high-contrast targets against complex backgrounds is essential.\nWe implement the NeuFMT / NeuFMT framework with\nPyTorch, leveraging its automatic differentiation capability to", "compute the gradient through both MLP and the physical\nmodel. Adam optimizer is used with the initial learning rates\nof 10 4 for θ update, 10 3 for scattering coefficient and\n10 5 for absorption coefficient. To improve the computational\nefficiency, a learning rate decay is applied for MLP update.\nThese rates are determined empirically to ensure stable convergence. The L1 regularization parameter λ is set to 10 6\nbased on cross validation. The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality,\nwith the entire process completing within 3 30 minutes on\na single NVIDIA RTX 3090 GPU for problems of varying\nscales. The FEM discretization is built on TOAST++ toolkit\n[37], and the FMT simulation is based on a modular software\nplatform STIFT [38] in MATLAB (R2024b, MathWorks, MA,\nUS) using a desktop computer (Intel Core i5-12600 CPU @\n3.30 GHz, 128 GB RAM).\nAlgorithm 1 NeuFMT\nRequire: Real measurements M real , light speed c, stepsizes\nαθ , αa , αs , alternation period T , total iterations K\n1: Initialize θ, a , s ;\n2: Precompute Sa , Sd , Sb , Qx , P\n3: Compute S via (9);\n4: for i = 1 to K do \n5:\nC = fθ Γ (r)\n6:\nSolve Φx RN satisfying S Φx = Qx\n7:\nQm = C Φx\n8:\nSolve Φm RN satisfying S Φm = Qm\nc = P Φm\n9:\nCompute predicted measurements: M\nreal 2\nc\n10:\nCompute loss: L = M M 2 + R(C)\n11:\nUpdate MLP parameters: θ = θ αθ L\n θ\n12:\nif i mod\n T = 0 then\n13:\nif i/T is even then\n L\n14:\nUpdate absorption: a = a αa \na\n15:\nelse\n L\n16:\nUpdate diffusion: s = s αs", "s\n17:\nend if", "1\n18:\nUpdate S = c a Sa +\nS\n+\nS\nd\nb ;\n3( a + s )\n19:\nend if\n20: end for\n21: Output: fluorescence C, optical parameters a , s", "D. FMT System Setup\nWe devised a continuous-wave (CW) FMT system\n(SHMOT) [39], [40] as depicted in Fig. 1 (a), which incorporates a 16-bit CMOS camera (Edge 4.2, PCO, Germany) with\n2048 2048 pixel resolution and a filter wheel (FW102C,\nThorlabs, NJ, US) for selective wavelength detection. A\ntunable laser source (SuperK EXTREME, NKT, Denmark),\nspanning 400-890 nm, provides fluorescence excitation with a\npower density of approximately 2 mW/mm2 at the sample\nplane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube, Germany) mounted aside steers\nthe laser beam to raster-scan either the top or bottom object", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "surface, enabling switchable reflection-/transmission-mode detection. During experiments, the camera exposure time was\nfixed at 500 ms, with pixel binning applied to improve the\nsignal-to-noise ratio. The acquired raw 2D image data serve\nas supervision target for NeuFMT / NeuFMT reconstruction\n(Fig. 1 (b)). It worth mentioning that our FMT system also\nintegrates a programmable line-scanning illumination, which\nenables high-precision extraction of the surface geometry\nwith approximated maximum error of 0.1 mm. The extracted\nsurface information is then leveraged as prior knowledge for\nFEM meshing and improving reconstruction accuracy.", "E. Phantom preparation and optical calibration\nIn our validation, the slab phantomswere cast from silicone (SYLGARDTM 184; DOW, CA, USA) to emulate softtissue matrix. Optical properties were tuned by dispersing\ntitanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon\nblack powder (Colins, Shanghai, China) as scattering and\nabsorbing additives, respectively. In all phantoms, TiO2 and\ncarbon black were uniformly distributed. All the designs\nshown in Fig. 4 (a) used the same TiO2 /carbon-black mixing\nratio, yielding isotropic media with identical absorption and\nscattering parameters.", "F. In Vivo Lymph Node FMT Imaging\nFollowing numerical simulations and phantom experiments,\nwe evaluated the proposed method in vivo in a murine lymph\nnode imaging task. In cancer diagnostics, lymph node metastasis is a key prognostic indicator of tumor progression. Fluorescence imaging enables rapid screening of sentinel lymph\nnodes [41].\nIn our experiment, all animal procedures were approved by\nthe Institutional Animal Care and Use Committee of ShanghaiTech University (Approval No. 20211115001). 5 female\nBALB/c mice (8 weeks old) were obtained from Shanghai\nJihui Laboratory Animal Breeding Co. Ltd. and housed under\na circadian rhythm of 12 hours of day and night alternation.\nBefore taking imaging experiments, fur was removed over the\nwhole body. For FMT reconstruction, we assumed an optically\nhomogeneous medium with properties calibrated during the\nexcitation step with ( a = 0.0055 mm 1 , s = 1.1 mm 1 ).\nWe followed a three-stage protocol fluorescent-dye injection, imaging, and ex vivo validation. Prior to FMT imaging, Cy5-saline solution (1.2146 mol mL 1 , 40 L) was injected subcutaneously into the left forepaw to drive lymphatic\ndrainage toward the sentinel lymph nodes and create a highintensity target. Next, follow-up FMT measurements were\nacquired using the system setup in Subsection II-D. Finally,\nafter data collection, ex vivo verification was performed using\na fluorescent stereoscopic microscope (MVX10, Olympus,\nJapan; 6.3 objective). Illumination was provided by a heightadjustable 630 nm LED at 20 mW cm 2 . White-light and\nCy5-channel fluorescence images were recorded using filters\nmatched to the Cy5 spectrum, and the lymph nodes were\nidentified, excised, and imaged to validate the in vivo findings.", "5", "III. R ESULTS\nA. Convergence Verification of Optical Property Adaptive\nOptimization\nTo validate our proposed optical property adaptation mechanism, we conducted a series of numerical experiments on\na digital phantom. The primary objective was to demonstrate\nthat the -adaption module can robustly recover absorption a\nand s coefficients from severely erroneous initial estimates,\nthereby enabling high-fidelity fluorescence reconstruction.\nWe constructed a homogeneous digital slab phantom of size\n55 55 15 mm3 featuring an S -shaped fluorescent target at\nits geometric center. The ground-truth optical properties were\n 1\nset to true\nand s true = 1.0 mm 1 . To rigorously\na = 0.1 mm\ntest the correction capability, we initialized the reconstruction\nwith significantly mismatched scattering coefficients ( s init =\n0.5, 1.5, 2.0 mm 1 ) while keeping the absorption coefficient\nfixed at its true value for this specific test.\nAs summarized in Fig. 2 (a), without the -adaption module, the reconstructed fluorescence distributions suffered from\nsubstantial errors in both depth localization and morphological accuracy. The mismatched s value led to an incorrect\nmodel of photon propagation, which directly translated to\ndistorted reconstructions. In contrast, when the -adaption\nmodule was enabled, the proposed NeuFMT successfully\nrecovered fluorescence distributions that closely matched the\nground truth obtained with the correct optical properties.\nCrucially, the evolution of the scattering coefficient during\noptimization, plotted in Fig. 2 (b), demonstrates the module s\nrobust convergence. Regardless of the initial value whether\nhalved or doubled the estimated s reliably converged to the\nneighborhood of the true value (1.0 mm 1 ).\nA similar convergence behavior was observed for the absorption coefficient a . When initialized with biased values\n 1\n( init\n) against a fixed true s , the a = 0.05, 0.15, 0.2 mm\nadaption module corrected a with an average error of only\n1.5% (Fig. 2 (d)), and its convergence curves are shown in\nFig. 2 (e). This convergence robustness was maintained across\na range of true a and s values, confirming the general\nefficacy of our alternating optimization strategy in mitigating\nparameter coupling (Fig. 2 (c), (f)).\nWe further extended the validation to the most challenging\nscenario, where both optical parameters were simultaneously\ninitialized with substantial errors. In this experiment, the initial\nvalues for both a and s were set to 50% higher than\ntheir GT values. Remarkably, even under these highly adverse\nconditions, the -adaption module successfully drove both\nparameters towards their true values. The convergence trajectories remained stable and ultimately reached a neighborhood\nof the true parameter pair. These results collectively verify\nthat the integrated -adaption module empowers NeuFMT\nto jointly recover accurate optical properties and fluorescence\ndistributions even from profoundly inaccurate initial guesses,\neffectively addressing a critical source of ill-posedness in\npractical FMT scenarios.", "6", "PREPRINT VERSION 2025", "0.995", "1.0", "0.996", "1.5", "1.007", "2.0", "1.006", "GT\ny\nx", "DICE =\n0.0257", "0.7337", "0.4660", "Norm.int (a.u.)", "= 1.0\n= 0.1", "Non-Adaptive", "1", "0.3967", "(b)", "1.2\n1.0", "(c)", "1.6", "Adaptive", "y", "0.7198", "0.7230", "0.6964", "Norm.int (a.u.)", "z", "0.7796", "0.9\n 0.8\n 0.5\nAsym.\nLine", "0.8\n0.4", "2", "4", "6", "8", "10", "12", "14", "0.12\n 0.11", "1.4", "Predicted", "z=8", "2.0\n 1.5\n 1.2\n 1.1", "1.6", "0\n1", "2.0", "Predicted", "0.5", "(a)", "0.10\n 0.09", "1.2", "0.08\n1.0", "0", "Asym.\nLine\n1", "2", "4", "8", "16", "32", "64", "iterations\n0.10", "0.100", "0.15", "0.101", "0.20", "0.102", "y\nx", "0.0281", "0.7337", "0.7390", "Norm.int (a.u.)", "GT", "0.5991", "z=8\nz", "Adaptive", "y", "0.6718", "0.7642", "0.8740", "0.8708", "(e)", "0.2", "= 1.0\n= 0.1", "GT", "0.11\n 0.09", "0.12\n0.1\n0.08", "0", "0.04", "1", "(f) 0.16\n0.14", "2", "4", "6", "8", "10", "12", "0.08\n 0.05\nAsym.\nLine", "14", "1.2\n 1.1\n 1.0\n 0.9", "0.12", "0.8\n0.1", "0", "(g)", "0.20\n 0.15\n 0.12", "0.16", "Norm.int (a.u.)", "= 1.0\n= 0.1", "Non-Adaptive", "1", "Predicted", "(d)", "0.097", "Predicted", "0.05", "Asym.\nLine\n1", "2", "4", "8", "16", "32", "64", "iterations\n2000 iters", "5000 iters", "10000 iters", "20000 iters\n1", "y", "(h)", "1.6", "0.16", "1.4", "0.14", "1.2", "0.12", "1.0", "0.1", "0.8125", "0.8651", "0.8691", "z\ny", "= 1.5\n= 0.15", "1.333\n0.1332", "1.177\n0.1156", "1.050\n0.1045", "1.001\n0.0995", "0", "0.8", "2", "5", "8", "11", "14", "17", "Predicted", "0.6481", "Norm.int (a.u.)", "z=8", "Predicted", "x", "0.08\n20", "iterations", "Fig. 2. Ablation test for the optical-property-adaption ( -adaption) module in NeuFMT. (a-c) Effective test for the correction of s . (a) For a homogeneous\nphantom simulation with a S -shaped fluorescence inclusion, the ground truth (GT) of a and s values are 0.1 mm-1 and 1.0 mm-1 respectively. A\nmismatched initial guess of s was assumed for FMT reconstruction. The -adaption module successfully corrects s with an average error of 0.55%,\nleading to significantly improved FMT reconstruction results compared to non-adaptive NeuFMT. (b) Convergence curve of s given more initial s values\nranging from 0.5 to 2 GT value under the same setting of (a). (c) Convergence curve of s value across all cases with different a values, given\ninitial s = 1.5 mm-1 . (d-f) Effective test for the correction of the absorption coefficient ( a ). (d) For the same phantom in (a), a (mismatched) a initial\nvalue is assumed for FMT reconstruction. The -adaption module successfully corrects a with an average error of 1.5%, leading to significantly improved\nFMT reconstruction results. (e) Convergence curve of a given more initial a values ranging from 0.5 to 2 GT value under the same setting of (d).\n(f) Convergence curve of a value across all cases with different s values, given initial a = 0.15 mm-1 . (g-h) Effective test for the correction of both\nabsorption and diffusion coefficients. (g) For the same phantom in (a), given mismatched initial a = 1.5 and s = 0.15, both of which are 50% higher than\nGT, the -adaption module successfully corrects both a and s at the same time. (h) Convergence curve given the iteration process in (g) for both optical\ncoefficients.", "B. Numerical Simulations\nTo comprehensively evaluate the performance of the proposed NeuFMT under controlled conditions, we designed\nfour distinct numerical phantoms (Fig. 3 (a) (d) respectively)\nto systematically increase the reconstruction challenge:\n Case 1 - single small target: a 3 mm-diameter spherical\nfluorescence target embedded in a homogeneous cuboid\nphantom (55 55 15 mm3 ), serving as a baseline\nfor evaluating localization and quantitative accuracy of\na simple, isolated inclusion.\n Case 2 - complex surface geometry: a 2 mm-diameter\nspherical target inside a phantom with a curved surface\ngeometry, featuring a spherical cap top (base: 50 50 4\nmm, cap height = 5 mm, total height = 9 mm). This\ncase tests the method s robustness to non-planar surface\ntopography.", "Case 3 - complex target shape: a large peanut-shaped fluorescence region with uniform concentration embedded in\na standard cuboid phantom same as Case 1. This scenario\nassesses the capability to recover intricate morphological\ndetails beyond simple spheres.\n Case 4 - multi-target with background: the same peanutshaped region as in Case 3, but with the addition of\na small, high-concentration spherical target inside. This\nrepresents a highly realistic and challenging condition,\ntesting the ability to resolve targets of different concentrations and shapes against a noisy background.", "The ground-truth optical properties for all simulated measurements in this test were set to a = 0.1 mm 1 and s = 1.0\nmm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against\nfour established methods: conventional Tikhonov-regularized", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "GT", "L2-CG", "L1-FISTA", "U-Net", "NeuFMT", "μNeuFMT\n1", "y\nx", "y", "z", "DICE =\n0.6581", "z=8", "0.4956", "0.6446", "Norm.int (a.u.)", "Case 1", "(a)", "0.8800", "0.5128", "0\nz", "y\nx", "y\nx", "y", "z", "0.6286", "z=2", "0.7500", "0.0000", "Norm.int (a.u.)", "Case 2", "(b)", "1", "0.7586", "0.2041", "0\nz", "y\nx", "x", "y", "z", "z=8", "0.6938", "0.0828", "0.6153", "Norm.int (a.u.)", "Case 3", "(c)", "1", "y", "0.9751", "0.4766", "0\nz", "y\nx", "y\nx", "y", "z", "0.5435", "z=8", "0.5908", "0.2637", "Norm.int (a.u.)", "Case 4", "(d)", "1", "0.8983", "0.7645", "0\nz", "y\nx", "Norm.int (a.u.)", "(e)", "Case 1", "Case 2", "Case 3", "Case 4", "1", "1", "1", "1", "0.8", "0.8", "0.8", "0.8", "0.6", "0.6", "0.6", "0.6", "0.4", "0.4", "0.4", "0.4", "0.2", "0.2", "0.2", "0", "15", "20", "25", "30", "35", "40", "0\n15", "0\n20", "25", "30", "mm", "GT", "L2-CG", "35", "0.2\n0", "10", "mm", "L1-FISTA", "20", "30", "40", "50", "0", "15", "20", "25", "30", "35", "mm", "U-Net", "NeuFMT", "40", "mm", "μNeuFMT", "Fig. 3. Results of numerical phantom simulations. (a) (d) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (e) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.", "conjugate gradients (L2 -CG) [42] and L1 -regularized nonnegative least squares (L1 -FISTA) [43], a pretrained supervised U-Net, and our baseline method NeuFMT without adaption. The U-Net was trained on a large, synthetically\ngenerated dataset of 5,488 samples. For each sample, the\ninput was a boundary measurement simulated using the DEbased forward model under the ground-truth properties in a\ncuboid phantom (55 55 15 mm3 ), and the label was the\ncorresponding 3D fluorescence map of 1 2 ellipsoids with\nrandom sizes and spatial positions. To clearly demonstrate the\neffect of the -adaption module, we focused on adapting s\nwhile fixing a at its true value during reconstruction. For all\nmethods, the initial s was set to an erroneous value of 1.2\nmm 1 , which is 20% higher than the ground truth.\nThe results presented in Fig. 3 (a) (d) demonstrate the\nconsistent superiority of NeuFMT across all four numerical cases. We observe that the conventional methods were\nadversely affected by the optical property mismatch: L2 -CG\nreconstructions were characteristically blurred and exhibited\nsignificant depth errors, such as full-depth penetration in\nCases 3 and 4 and depth-wise expansion in Case 1. L1 -FISTA\nfrequently introduced non-physical, fragmented artifacts, such\nas staircase patterns in Case 1 and hollow structures in Case 3,\nwhile it also suffered from severe depth inaccuracy. The\nsupervised U-Net, though performed well in Case 1, showed\nlimited generalization beyond its training data, as seen in its\nlocalization failure in the complex surface geometry of Case 2", "7", "and noticeable shape distortion in the unseen peanut-shaped\ntarget of Case 3 and 4. The direct NeuFMT provided better\ndepth prediction than the traditional methods but remained\nsensitive to the erroneous s , resulting in substantial shape\nexpansion in the x-y plane (Cases 1, 2) and axial splitting\n(Case 3). In contrast, NeuFMT successfully rectified the\noptical properties and overcame these limitations. It achieved\nthe most accurate spatial localization and shape fidelity, as\nevidenced by its 3D isosurfaces tightly conforming to the\nground truth in both simple and complex targets, and it clearly\nresolved both the small target and the complex background in\nCase 4. Quantitatively, NeuFMT consistently achieved the\nhighest Dice coefficients, and its intensity profiles (Fig. 3 (e))\nmost closely matched the ground truth in terms of peak\nlocation, width, and background suppression.\nC. Phantom Experiments\nWe further evaluated the performance of all methods using\nphysical phantom experiments to assess their practicality under real-world conditions, including measurement noise. The\nphantoms were fabricated from silicone, with their optical\nproperties calibrated to be approximately a = 0.0055 mm 1\nand s = 1.1 mm 1 at 680 nm. Fluorescent targets were embedded within the phantoms to create the four cases previously\ndefined in the simulations. The initial value of s was set identically for all reconstruction methods as the calibrated value,\nand also the U-Net was retrained accordingly. Consistent with\nthe simulation study, we focused on the adaptive recovery of\nthe reduced scattering coefficient s .\nThe reconstruction results are summarized in Fig. 4. Under\nthese challenging real-world conditions, the limitations of the\nbaseline methods became evident: conventional approaches\n(L2 -CG, L1 -FISTA) produced blurry or fragmented reconstructions with significant depth errors, while the supervised\nU-Net, susceptible to domain shift and noise, failed to generalize, resulting in complete localization failures (Case 1)\nor severely distorted shapes (Cases 3 and 4). In contrast,\nthe INR-based frameworks, NeuFMT and NeuFMT, demonstrated markedly superior robustness, consistently yielding\nphysically plausible and continuous reconstructions where\nother methods failed. A detailed comparison between the two\nreveals that NeuFMT provided critical refinements toward\nenhanced physical consistency. In Cases 1 and 3, NeuFMT\nachieved better depth sensitivity and more uniform fluorophore\ndistribution, more faithfully representing the homogeneous\nnature of the true targets. In the complex geometry of Case 2,\nit uniquely achieved accurate localization, whereas direct\nNeuFMT produced a solution with an aberrant depth shift. For\nthe multi-target scenario in Case 4, NeuFMT reconstructed\nthe background region with improved morphological accuracy.\nAlthough the performance gap in quantitative metrics such\nas the Dice coefficient was occasionally narrow, which reflects the inherent robustness of the shared INR architecture,\n NeuFMT provided consistent, subtle refinements, particularly\nin depth accuracy. The phantom experiments confirm that the\nadaptive physical correction mechanism in NeuFMT can enhance reconstruction fidelity under practical conditions where\nthe exact coefficient in most real experiments is uncertain.", "8", "PREPRINT VERSION 2025", "(a)", "Silicone Phantoms\nGT", "L2-CG", "L1-FISTA", "U-Net", "NeuFMT", "μNeuFMT\n1", "y\nx", "y", "z", "DICE =\n0.5895", "z=8", "0.6154", "0.0762", "Norm.int (a.u.)", "Case 1", "(b)", "Fluorescence Inclusions", "0.7023", "0.6615", "0\nz", "(Fig. 5 (c)). The reconstructed target lengths from NeuFMT\nshowed the closest agreement with the physical measurements\ntaken from the ex vivo lymph nodes, as visualized by the\nintensity profiles in Fig. 5 (c). These results demonstrate that\n NeuFMT provides a definitive advantage in practical in vivo\nscenarios, enabling robust and accurate target segmentation\nand localization under complex clinically related scenarios,\nsuch as fluorescence guided surgery.", "y\nx", "y\nx", "y", "z", "0.3371", "z=2", "0.3810", "0.4000", "0.5200", "0.2586", "White Light Image", "(a)", "vein", "LN-2", "0\nz", "y\nx", "y", "z", "z=8", "0.5413", "0.3358", "0.7011", "0.8230", "0.8050", "0\nz", "y\nx", "y\nx", "y", "z", "0.5193", "z=8", "0.4319", "0.6601", "0.2849", "Norm.int (a.u.)", "0.6240", "NeuFMT", "μNeuFMT\nz\nx", "vein", "LN-3\nLN-2\nLN-1", "Case 3", "Case 4", "1", "1", "0.8", "0.8", "0.6", "0.6", "0.6", "0.6", "0.4", "0.4", "0.4", "0.4", "0.2", "0.2\n20", "25", "30", "35", "40", "0\n15", "0.2\n20", "25", "30", "mm", "GT", "L2-CG", "35", "0.2", "0", "0\n0", "10", "mm", "L1-FISTA", "20", "30", "40", "50", "15", "20", "25", "30", "35", "mm", "U-Net", "NeuFMT", "40", "mm", "NeuFMT-Ada", "Fig. 4. Results of real phantom experiments. (a) Photograph of the real\nsilicone phantoms and fluorescence inclusions. (b) (e) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (f) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.", "10 mm", "(c)", "We performed an in vivo imaging experiment on mice.\nFollowing the protocol described in Subsection II-F, Cy5\nfluorescent dye accumulated primarily at the sentinel lymph\nnodes (LN), with some residual signal at the vein (Fig. 5 (a)).\nOur task was to reconstruct the spatial location and shape of\nthe sentinel lymph nodes.\nThe 3D FMT reconstruction results from all methods\nare presented in Fig. 5 (b). The conventional L2 -CG method\nproduced a reconstruction where the volume of LN-3 was\noverestimated, and the signals from LN-1, LN-2, and the vein\nmerged into a single, indistinguishable cluster. The L1 -FISTA\nreconstruction was highly fragmented, making it impossible\nto discern the shape or count of the lymph nodes accurately.\nAlso, the baseline NeuFMT failed to produce a physiologically plausible reconstruction. In contrast, NeuFMT was\nthe only method that successfully and distinctly resolved all\nthree lymph nodes (LN-1, LN-2, LN-3) and the vein, clearly\nidentifying each as separate, localized regions of fluorescence.\nFor quantitative validation, the mouse was sacrificed, and\nthe lymph nodes were excised to be imaged by ex vivo FRI", "LN-1", "x\ny", "LN-3 LN-2", "10 mm", "0", "1", "1", "1", "0.8", "0.8", "0.8", "0.6", "LN-1", "0.4", "0.6", "LN-2", "0.4", "0.2", "0.6", "0.2", "0\n2", "4", "6", "L2-CG", "8", "10", "12\nmm", "LN-3", "0.4", "0.2", "0\n0", "D. In Vivo Lymph Node FMT Imaging Experiments", "Concentration of Cy5 (a.u.)", "Case 2\n1\n0.8", "Slice z = 8 mm", "Case 1\n1\n0.8", "x\ny", "Slice z = 11 mm", "(f)\nNorm.int (a.u.)", "L1-FISTA", "R", "1", "Profiles", "y\nx", "15", "L2-CG", "LN-3", "L", "0\nz", "0", "R", "y", "Concentration of Cy5 (a.u.)", "Case 4", "(e)", "1", "(b)", "LN-1", "L", "3D Segmentation", "x", "Norm.int (a.u.)", "Case 3", "(d)", "1", "y", "In vivo FRI", "Norm.int (a.u.)", "Case 2", "(c)", "1", "0\n0", "2", "L1-FISTA", "4", "6", "8", "10", "12\nmm", "0", "2", "NeuFMT", "4", "6", "8", "10", "12\nmm", "μNeuFMT", "Fig. 5. In vivo lymph node FMT imaging and reconstruction results. (a) The\nwhite-light image and preview via 2D fluorescence reflectance imaging (FRI)\noverlaid on the white-light image with the red aera indicating the concentrated\ndistribution of Cy5 probe on the cites of three lymph nodes (LN-1, LN-2, LN3) and the vein. (b) Comparison of FMT reconstruction results from different\nmethods. The 3D segmentation, along with two slices at z = 8 and 11 mm,\nare displayed. (c) Intensity profiles along the dashed lines in b. are compared\nfor each ex vivo images of lymph nodes after sacrificing the animal. The gray\nzone represents the estimated size of LN, based on the ex vivo fluorescence\nimages.", "IV. D ISCUSSION AND C ONCLUSION\nIn this study, we introduced NeuFMT, an optical-propertyadaptive FMT reconstruction framework that integrates INR\nwith an explicitly differentiable FEM-based light propagation model. By unifying a continuous fluorescence field parameterized by an INR and a physics-based forward model\namenable to end-to-end optimization, NeuFMT addresses\ntwo fundamental limitations of existing FMT reconstruction\ntechniques: their inability to efficiently adapt to complex and\nheterogeneous fluorescence distribution, and their reliance on", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "fixed, often inaccurate, optical properties, which significantly\nexacerbates the inherent ill-posedness of the inverse problem.\nUnlike supervised deep learning approaches which are constrained by the diversity and scale of training datasets and\noften fail under domain shift, NeuFMT operates in a selfsupervised, physics-informed regime. It does not require paired\ntraining data; instead, it directly minimizes the discrepancy between measured and simulated boundary fluxes. This not only\neliminates the need for extensive experimental datasets but also\nensures generalizability across different imaging geometries\nand target configurations. The continuous, coordinate-based\nrepresentation provided by the INR further ensures that our\nreconstructions are free from discretization artifacts and inherently resolution-agnostic.\nA central contribution of our work is the introduction of\nan optical property adaptation mechanism, which enables the\ndynamic optimization of absorption and scattering coefficients\n( a , s ) concurrently with the fluorescence distribution. Our\nframework demonstrates that the integration of a differentiable\nphysics-based forward model is the key to enabling this\nself-supervised adaptation. The FEM-based light propagation\nmodel is not merely a component of the loss function, but\nan active and adaptive part of the inverse solver. This stands\nin contrast to both traditional iterative methods, which hold\noptical properties static and thus aggravate the problem s illposedness, and conventional end-to-end deep learning approaches, which struggle to generalize beyond their training\ndata. The adaptivity of our model is thus its core strength,\nproviding a principled way to refine the physical model itself\nbased on the measured data, which is crucial for practical\napplications where precise prior knowledge of tissue optics\nis unavailable.\nOur results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate\nthat NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1 ) and deep learningbased (U-Net) benchmarks. In particular, the method consistently localized fluorescent targets with higher spatial accuracy, improved contrast, and more realistic morphological\nfeatures especially under challenging conditions involving\nbackground fluorescence and complex geometry.\nDespite these promising results, several aspects of\n NeuFMT merit further investigation. First, the current implementation assumes a homogeneous optical background a\ncommon simplification in FMT studies. Extending the model\nto incorporate spatially varying optical properties represents\na logical next step, potentially by representing a (r) and\n s (r) with additional INRs, though this would significantly\nincrease the complexity of the inverse problem. Nevertheless,\nthe proposed NeuFMT can be validated or even combined\nwith time-domain near-infrared spectroscopy (fNIRS) [44],\n[45] or diffuse optical tomography (DOT) [46] techniques,\nwhere the complex optical properties related with absorption\nand scattering can disentangled and calibrated. More importantly, the integration of NeuFMT with emerging imaging\ntechnologies holds particular promise. The inherent adaptivity\nof our framework is well-suited to the distinct scattering\nand absorption landscapes of NIR-II fluorescence tomography", "9", "[47], [48], where our optical property optimization could be\ncrucial for accurately modeling the increased photon penetration and achieving higher-resolution reconstruction at depth.\nFurthermore, the framework can be naturally extended to\nhyperspectral FMT, using a single INR to output both fluorophore concentration and spectral signature, thereby disentangling multiple probes or accounting for wavelength-dependent\noptical properties. Finally, translating NeuFMT into clinical\nsettings, such as intraoperative fluorescence-guided surgery\n[8], [9], represents an exciting frontier where its adaptability\ncould overcome patient-specific variations in tissue optics.\nIn conclusion, by harmonizing a differentiable physics\nmodel with a continuous INR, NeuFMT provides a robust,\nself-supervised, and adaptive framework for FMT reconstruction. It effectively mitigates the ill-posedness inherent to\ninverse problems with uncertain parameters, setting a new\nparadigm for practical, high-resolution fluorescence molecular\nimaging. We believe this physics-in-the-loop INR approach\noffers a generalizable template for tackling a wide range of\ntomographic and inverse problems in biomedical imaging.\nR EFERENCES\n[1] F. Song, P. Zhang, H. Wu, C. Ma, Z. Liu, R. Cai, Y. Feng, Y. He,\nX. Dong, Y. Tian, and G. Zhang, Advances of fluorescence molecular\nimaging: NIR-II window, probes, and tomography, Laser & Photonics\nReviews, vol. 19, no. 10, p. 2400275, 2025.\n[2] B. Zhu, J. Hendricks, J. E. Morton, J. C. Rasmussen, C. Janssen,\nM. N. Shah, and E. M. Sevick-Muraca, Near-infrared fluorescence\ntomography and imaging of ventricular cerebrospinal fluid flow and\nextracranial outflow in non-human primates, IEEE Transactions on\nMedical Imaging, vol. 42, no. 12, pp. 3555 3565, 2023.\n[3] M. S. Ozturk and et al., High-resolution tomographic analysis of in\nvitro 3D glioblastoma tumor model under long-term drug treatment, \nScience Advances, vol. 6, no. 10, p. eaay7513, 2020.\n[4] M. Cai, Z. Zhang, X. Shi, Z. Hu, and J. Tian, NIR-II/NIR-I fluorescence molecular tomography of heterogeneous mice based on gaussian\nweighted neighborhood fused lasso method, IEEE Transactions on\nMedical Imaging, vol. 39, no. 6, pp. 2213 2222, 2020.\n[5] S. R. Arridge and J. C. Schotland, Optical tomography: forward and\ninverse problems, Inverse problems, vol. 25, no. 12, p. 123010, 2009.\n[6] L. V. Wang and H.-i. Wu, Biomedical optics: principles and imaging.\nJohn Wiley & Sons, 2007.\n[7] F. Stuker, J. Ripoll, and M. Rudin, Fluorescence molecular tomography:\nprinciples and potential for pharmaceutical research, Pharmaceutics,\nvol. 3, no. 2, pp. 229 274, 2011.\n[8] J. S. D. Mieog, F. B. Achterberg, A. Zlitni, M. Hutteman, J. Burggraaf,\nR.-J. Swijnenburg, S. Gioux, and A. L. Vahrmeijer, Fundamentals and\ndevelopments in fluorescence-guided cancer surgery, Nature Reviews\nClinical Oncology, vol. 19, no. 1, pp. 9 22, 2022.\n[9] K. Wang, Y. Du, Z. Zhang, K. He, Z. Cheng, L. Yin, D. Dong, C. Li,\nW. Li, Z. Hu et al., Fluorescence image-guided tumour surgery, Nature\nReviews Bioengineering, vol. 1, no. 3, pp. 161 179, 2023.\n[10] D. Zhu et al., Comparison of regularization methods in fluorescence\nmolecular tomography, Photonics, vol. 1, no. 2, pp. 95 109, 2014.\n[11] H. Yi et al., Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography:\na comparative study, Journal of Biomedical Optics, vol. 18, no. 5, p.\n56013, 2013.\n[12] J. Shi, B. Zhang, F. Liu, J. Luo, and J. Bai, Efficient L1 regularizationbased reconstruction for fluorescent molecular tomography using\nrestarted nonlinear conjugate gradient, Optics letters, vol. 38, no. 18,\npp. 3696 3699, 2013.\n[13] D. Zhu and C. Li, Nonconvex regularizations in fluorescence molecular\ntomography for sparsity enhancement, Physics in Medicine & Biology,\nvol. 59, no. 12, p. 2901, 2014.\n[14] J. Zhang, L. Li, Q. Hu, J. Zhang, Y. Wu, L. Gu, J. Li, F. Li, X. Zhu,\nJ. Jiang et al., High-fidelity solution decomposition fluorescence tomography in the presence of background interference, Laser & Photonics\nReviews, p. e01013, 2025.", "10", "[15] C. Huang, H. Meng, Y. Gao, S. Jiang, K. Wang, and J. Tian, Fast and\nrobust reconstruction method for fluorescence molecular tomography\nbased on deep neural network, in Imaging, Manipulation, and Analysis\nof Biomolecules, Cells, and Tissues XVII, vol. 10881. SPIE, 2019, pp.\n257 262.\n[16] L. Guo, F. Liu, C. Cai, J. Liu, and G. Zhang, 3D deep encoder decoder\nnetwork for fluorescence molecular tomography, Optics letters, vol. 44,\nno. 8, pp. 1892 1895, 2019.\n[17] P. Zhang, G. Fan, T. Xing, F. Song, and G. Zhang, UHR-DeepFMT:\nultra-high spatial resolution reconstruction of fluorescence molecular\ntomography based on 3-d fusion dual-sampling deep neural network, \nIEEE Transactions on Medical Imaging, vol. 40, no. 11, pp. 3217 3228,\n2021.\n[18] J. Cheng, P. Zhang, F. Liu, J. Liu, H. Hui, J. Tian, and J. Luo, Encoderdecoder deep learning network for simultaneous reconstruction of fluorescence yield and lifetime distributions, Biomedical Optics Express,\nvol. 13, no. 9, pp. 4693 4705, 2022.\n[19] P. Zhang, C. Ma, F. Song, Z. Liu, Y. Feng, Y. Sun, Y. He,\nF. Liu, D. Wang, and G. Zhang, Multi-branch attention prior based\nparameterized generative adversarial network for fast and accurate\nlimited-projection reconstruction in fluorescence molecular tomography, Biomedical Optics Express, vol. 13, no. 10, pp. 5327 5343, 2022.\n[20] P. Zhang, F. Song, C. Ma, Z. Liu, H. Wu, Y. Sun, Y. Feng, Y. He, and\nG. Zhang, Robust reconstruction of fluorescence molecular tomography\nbased on adaptive adversarial learning strategy, Physics in Medicine &\nBiology, vol. 68, no. 4, p. 04LT01, 2023.\n[21] P. Zhang, X. Liu, Q. Xue, Y. Shang, C. Liu, R. Chen, H. Gao, J. Liang,\nW. Wang, and G. Zhang, PAH2T-Former: Paired-attention hybrid\nhierarchical transformer for synergistically enhanced fmt reconstruction\nquality and efficiency, IEEE Transactions on Computational Imaging,\n2025.\n[22] H. Meng, Y. Gao, X. Yang, K. Wang, and J. Tian, K-nearest neighbor\nbased locally connected network for fast morphological reconstruction\nin fluorescence molecular tomography, IEEE transactions on medical\nimaging, vol. 39, no. 10, pp. 3019 3028, 2020.\n[23] D. Li, C. Chen, J. Li, and Q. Yan, Reconstruction of fluorescence\nmolecular tomography based on graph convolution networks, Journal\nof Optics, vol. 22, no. 4, p. 045602, 2020.\n[24] Y. Wang, C. Bian, Y. An, H. Wang, Q. Liang, Y. Du, and J. Tian,\n Graph convolution based residual connected network for morphological reconstruction in fluorescence molecular tomography, in Medical\nImaging 2022: Biomedical Applications in Molecular, Structural, and\nFunctional Imaging, vol. 12036. SPIE, 2022, pp. 527 533.\n[25] Y. Sun, J. Liu, M. Xie, B. Wohlberg, and U. S. Kamilov, Coil:\nCoordinate-based internal learning for tomographic imaging, IEEE\nTransactions on Computational Imaging, vol. 7, pp. 1400 1412, 2021.\n[26] L. Lozenski, M. A. Anastasio, and U. Villa, A memory-efficient selfsupervised dynamic image reconstruction method using neural fields, \nIEEE Transactions on Computational Imaging, vol. 8, pp. 879 892,\n2022.\n[27] A. W. Reed, H. Kim, R. Anirudh, K. A. Mohan, K. Champley, J. Kang,\nand S. Jayasuriya, Dynamic CT reconstruction from limited views\nwith implicit neural representations and parametric motion fields, in\nProceedings of the IEEE/CVF International Conference on Computer\nVision, 2021, pp. 2258 2268.\n[28] L. Shen, J. Pauly, and L. Xing, NeRP: implicit neural representation\nlearning with prior embedding for sparsely sampled image reconstruction, IEEE Transactions on Neural Networks and Learning Systems,\nvol. 35, no. 1, pp. 770 782, 2022.\n[29] R. Liu, Y. Sun, J. Zhu, L. Tian, and U. S. Kamilov, Recovery\nof continuous 3D refractive index maps from discrete intensity-only\nmeasurements using neural fields, Nature Machine Intelligence, vol. 4,\nno. 9, pp. 781 791, 2022.\n[30] S. Shen, L. Li, S. Gao, Y. Wang, L. Gu, S. Li, X. Zhu, J. Jiang, J. Yu, and\nW. Ren, High resolution diffuse optical tomography via neural fields, \nIEEE Transactions on Computational Imaging, 2024.\n[31] K. Han, C. Li, A. Xiao, Y. Tian, J. Tian, and Z. Hu, TSPE: Reconstruction of multi-morphological tumors of NIR-II fluorescence molecular\ntomography based on positional encoding, Computer Methods and\nPrograms in Biomedicine, vol. 261, p. 108554, 2025.\n[32] S. R. Arridge, Optical tomography in medical imaging, Inverse problems, vol. 15, no. 2, p. R41, 1999.\n[33] , Photon-measurement density functions. part I: Analytical forms, \nApplied Optics, vol. 34, no. 31, pp. 7395 7409, 1995.\n[34] S. R. Arridge and M. Schweiger, Photon-measurement density functions. part 2: Finite-element-method calculations, Applied Optics,\nvol. 34, no. 34, pp. 8026 8037, 1995.", "PREPRINT VERSION 2025", "[35] O. C. Zienkiewicz, R. L. Taylor, P. Nithiarasu, and J. Zhu, The finite\nelement method. Elsevier, 1977, vol. 3.\n[36] V. Ntziachristos, C. Bremer, and R. Weissleder, Fluorescence molecular\ntomography resolves protease activity in vivo, Nature Medicine, vol. 8,\nno. 7, pp. 757 760, 2002.\n[37] M. Schweiger and S. Arridge, The Toast++ software suite for forward\nand inverse modeling in optical tomography, Journal of biomedical\noptics, vol. 19, no. 4, pp. 040 801 040 801, 2014.\n[38] W. Ren, H. Isler, M. Wolf, J. Ripoll, and M. Rudin, Smart toolkit\nfor fluorescence tomography: simulation, reconstruction, and validation, \nIEEE Transactions on Biomedical Engineering, vol. 67, no. 1, pp. 16 \n26, 2019.\n[39] S. Gao, J. Zhang, Y. Hu, Y. Wu, L. Li, Q. Hu, X. Lou, X. Zhu, J. Jiang,\nand W. Ren, Multifunctional optical tomography system with highfidelity surface extraction based on a single programmable scanner and\nunified pinhole modeling, IEEE Transactions on Biomedical Engineering, 2023.\n[40] Y. Hu, Y. Wu, L. Li, L. Gu, X. Zhu, J. Jiang, and W. Ren, Simultaneous\nreconstruction of 3D fluorescence distribution and object surface using\nstructured light illumination and dual-camera detection, Optics Express,\nvol. 32, no. 9, pp. 15 760 15 773, 2024.\n[41] C. Ji, M. Zhao, C. Wang, R. Liu, S. Zhu, X. Dong, C. Su, and Z. Gu,\n Biocompatible tantalum nanoparticles as radiosensitizers for enhancing\ntherapy efficacy in primary tumor and metastatic sentinel lymph nodes, \nACS nano, vol. 16, no. 6, pp. 9428 9441, 2022.\n[42] S. Kawata and O. Nalcioglu, Constrained iterative reconstruction by\nthe conjugate gradient method, IEEE Transactions on Medical Imaging,\nvol. 4, no. 2, pp. 65 71, 1985.\n[43] A. Beck and M. Teboulle, A fast iterative shrinkage-thresholding algorithm for linear inverse problems, SIAM Journal on Imaging Sciences,\nvol. 2, no. 1, pp. 183 202, 2009.\n[44] Y. Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared\nspectroscopy and imaging: a review, Applied Sciences, vol. 9, no. 6, p.\n1127, 2019.\n[45] H. Y. Ban, G. M. Barrett, A. Borisevich, A. Chaturvedi, J. L. Dahle,\nH. Dehghani, J. Dubois, R. M. Field, V. Gopalakrishnan, A. Gundran\net al., Kernel flow: a high channel count scalable time-domain functional near-infrared spectroscopy system, Journal of biomedical optics,\nvol. 27, no. 7, p. 074710, 2022.\n[46] A. Pifferi, D. Contini, A. D. Mora, A. Farina, L. Spinelli, and A. Torricelli, New frontiers in time-domain diffuse optics, a review, Journal\nof Biomedical Optics, vol. 21, no. 9, pp. 091 310 091 310, 2016.\n[47] F. Wang, Y. Zhong, O. Bruns, Y. Liang, and H. Dai, In vivo NIRII fluorescence imaging for biology and medicine, Nature Photonics,\nvol. 18, no. 6, pp. 535 547, 2024.\n[48] Z. Zhang, Y. Du, X. Shi, K. Wang, Q. Qu, Q. Liang, X. Ma, K. He,\nC. Chi, J. Tang et al., NIR-II light in clinical oncology: opportunities\nand challenges, Nature Reviews Clinical Oncology, vol. 21, no. 6, pp.\n449 467, 2024."]}
{"method": "token_limit", "num_chunks": 74, "avg_chunk_len": 796.0405405405405, "std_chunk_len": 31.259350682847227, "max_chunk_len": 800, "min_chunk_len": 529, "total_chars": 58907, "compression_ratio": 1.0003904459571868, "avg_chunk_tokens": 198.82432432432432, "max_chunk_tokens": 200, "min_chunk_tokens": 132, "tokenizer": "", "chunks": ["PREPRINT VERSION 2025\n\n1\n\n NeuFMT: Optical-Property-Adaptive Fluorescence\nMolecular Tomography via Implicit\nNeural Representation\n\narXiv:2511.04510v1 [eess.IV] 6 Nov 2025\n\nShihan Zhao, Jianru Zhang, Yanan Wu, Linlin Li, Siyuan Shen, Xingjun Zhu, Guoyan Zheng, Member IEEE,\nJiahua Jiang, and Wuwei Ren\n\nAbstract Fluorescence Molecular Tomography (FMT) is a\npromising technique for non-invasive 3D visualization of fluorescent probes, but its reconstruction remains challenging due to\nthe inherent ill-posedness and reliance on inaccurate or oftenunknown tissue optical properties. While deep learning methods\nhave shown promise, their supervised nature limits generalization\nbeyond training data. To address these problems, we propose\n NeuFMT, a self-supervised FMT reconstruction framework that\ninteg", "rates implicit neural-based scene representation with explicit\nphysical modeling of photon propagation. Its key innovation lies\nin jointly optimize both the fluorescence distribution and the\noptical properties ( ) during reconstruction, eliminating the need\nfor precise prior knowledge of tissue optics or pre-conditioned\ntraining data. We demonstrate that NeuFMT robustly recovers\naccurate fluorophore distributions and optical coefficients even\nwith severely erroneous initial values (0.5 to 2 of ground\ntruth). Extensive numerical, phantom, and in vivo validations\nshow that NeuFMT outperforms conventional and supervised\ndeep learning approaches across diverse heterogeneous scenarios.\nOur work establishes a new paradigm for robust and accurate\nFMT reconstruction, paving the way for more reliab", "le molecular\nimaging in complex clinically related scenarios, such as fluorescence guided surgery.\nIndex Terms fluorescence molecular tomography, image reconstruction, optical properties, implicit neural representation,\nfluorescence guided surgery\n\nThe work was supported by Science and Technology Commission of Shanghai Municipality under Grant 25JS2830300 (Wuwei Ren), National Natural\nScience Foundation of China under Grants 62105205 (Wuwei Ren), and\nShanghai Clinical Research and Trial Center (Wuwei Ren). (Corresponding\nauthor: Wuwei Ren.)\nShihan Zhao and Jianru Zhang contributed equally to this work.\nShihan Zhao, Yanan Wu, Linlin Li and Siyuan Shen are with\nthe School of Information Science and Technology, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: zhaoshh, wuyn1, lill,\nshe", "nsy2023@shanghaitech.edu.cn).\nJianru Zhang and Jiahua Jiang are with the School of Mathematics,\nUniversity of Birmingham, Edgbaston, B15 2QN, United Kingdom (e-mail:\njxz389@student.bham.ac.uk; j.jiang.3@bham.ac.uk).\nXingjun Zhu is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail:\nzhuxj1@shanghaitech.edu.cn).\nGuoyan Zheng is with the Institute of Medical Robotics, School of\nBiomedical Engineering, Shanghai Jiao Tong University, Shanghai 200240,\nChina (e-mail: guoyan.zheng@sjtu.edu.cn)\nWuwei Ren is with the School of Information Science and Technology,\nShanghaiTech University, Shanghai 201210, China, and also with State\nKey Laboratory of Advanced Medical Materials and Devices, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail:", "renww@shanghaitech.edu.cn).\n\nI. INTRODUCTION\nFluorescence Molecular Tomography (FMT) has emerged\nas a promising molecular imaging modality, enabling noninvasive 3D visualization of fluorescent probe distribution\nin highly turbid media [1]. Owning to its high sensitivity,\ncost-effectiveness, and non-ionizing radiation, FMT has found\nbroad applications in preclinical research and clinical practice, e.g., brain imaging [2], in vitro cell culture monitoring\n[3] and tumor detection [4]. FMT reconstructs the internal\nfluorescence distribution by measuring the photon distribution\non the object surface and minimizing the discrepancy between\nreal measurements and the simulated results. A canonic framework of FMT reconstruction employs an iterative optimization\nstrategy with a forward model typicall", "y based on the\nRadiation Transfer Equation (RTE) or the diffusion equation\n(DE) and an inverse model that refines fluorescence distribution prediction until convergence [5], [6]. However, FMT\nreconstruction is inherently ill-posed due to insufficient surface measurements and strong photon scattering effect within\ntissues. Development of high-precision FMT reconstruction\nalgorithms is highly attractive for further improvement of\nthe spatial resolution and detection depth of this technology,\nwhich ultimately broaden the biological applications in drug\ndiscovery [7] and clinical use such as fluorescence guided\nsurgery [8], [9].\nTo address the ill-posed nature of FMT reconstruction,\nregularization techniques that incorporate prior knowledge are\napplied. Conventional approaches include Tikhonov", "(L2 norm)\nregularization for smoothing the results [10], [11], and sparsepromoting regularization (L1 , Lp norm) or total variation (TV)\nregularization for enhancing the spatial resolution [12], [13].\nRecent advancements in regularization techniques, such as\nthe solution-decomposition algorithm, utilize an advanced\nstochastic prior model that improves the differentiation of\nfluorescence targets from background interference, thereby\nenhancing reconstruction quality [14]. While these methods\nstabilize solutions, their reliance on time-consuming iterative\noptimization and idealized assumptions about optical parameters often results in slow convergence and limited accuracy in\nheterogeneous tissues. Deep learning (DL) methods, particularly en-decoder-based neural networks [15] [21] and graphba", "sed networks [22] [24], have recently been used in FMT\nreconstruction by learning direct mappings from boundary\nmeasurements to fluorescence distributions. These approaches\n\n2\n\nencode physical priors within network parameters, enabling\noverwhelmingly rapid inference. However, their dependence\non supervised training with large, scenario-specific datasets restricts generalizability across variable experimental conditions\n(e.g., tissue object geometry and optical properties), leading\nto significant accuracy degradation when the object properties\ndeviate from training assumptions.\nRecently, implicit neural representation (INR) models have\nemerged as a powerful alternative for medical image reconstruction. By mapping arbitrary spatial coordinates to certain\nunknown physical quantities via a coo", "rdinate-based multilayer perceptron network (MLP), INRs achieve continuous\n3D representations, self-supervised training, and memory efficiency. Originally popularized in computer vision and medical imaging, INRs have demonstrated remarkable success\nin modalities such as computed tomography (CT), magnetic\nresonance imaging (MRI) [25] [29], and notably in diffuse\noptical tomography (DOT), where INR has been proven to be\nable to capture a high-resolution, continuous optical absorption\nmap that account for light scattering in complex tissues [30].\nINR captures continuous spatial information and integrates\nphysical priors makes it particularly suited for various imaging problems. In the context of FMT, preliminary work has\nexplored position encoding strategies to enhance spatial resolution and", "improve the quality of FMT reconstructions [31].\nNevertheless, systematic studies integrating optical diffusion\nphysics within an INR framework remain scarce. This gap\npresents an opportunity to harness the strengths of implicit\nmodeling for robust and data-efficient FMT reconstruction.\nTo bridge this gap, we propose neural-field-based FMT, or\nNeuFMT, a physics-driven reconstruction framework unifying\nINR with explicit physical models. Unlike conventional DLbased FMT reconstruction algorithms that couple explicit\nfluorescence predictions to implicit physical model, NeuFMT\nintegrates the DE-based forward model in the network loss,\nenabling self-supervised training without paired data. The\ndifferentiability of the forward model is achieved via finite\nelement method (FEM). This inversion-free", "approach ensures\nrapid, continuous reconstruction across diverse geometries\nwhile inherently addressing scattering effects. Another critical\nlimitation of both traditional and DL methods lies in the\npresumed optical properties of the object during reconstruction, which largely aggravate the ill-posedness of the inverse\nproblem given the optical parameters were initially biased. To\novercome this, we further introduce optical-property-adaptive\nNeuFMT, or NeuFMT, an adaptive extension of NeuFMT\nthat dynamically optimizes scattering / absorption coefficients\nand fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations, NeuFMT achieves robust accuracy even when provided\nwith erroneous initial guess of the optical coefficient valu", "es,\naddressing the problem of unrealistic assumption prior to\nFMT reconstruction. Both proposed INR-based FMT reconstruction algorithms were thoroughly compared and validated\nby simulations and phantom experiments along with other\nmethods. Furthermore, in vivo lymph node imaging in mice\nwas performed, further demonstrating the advantages of the\nproposed methods.\n\nPREPRINT VERSION 2025\n\nII. M ETHODS\nA. Forward Modeling of FMT\nModel-based FMT reconstruction comprises two fundamental steps: forward modeling and inversion. The former predicts\nsurface photon density measurements based on an assumed\nfluorescence distribution. At the macroscopic scale, we employ\nthe first-order approximation of the radiative transport equation (RTE), known as the diffusion equation (DE) [32]. The\nexcitation and f", "luorescence emission processes in continuouswave (CW) mode form a coupled pair of DEs expressed as\n[33], [34]:\n κ ϕx (r) + a ϕx (r) = qx (r),\n\nr , (1)\n\n κ ϕm (r) + a ϕm (r) = η C(r) ϕx (r),\n\nr , (2)\n\nwhere ϕx and ϕm denote the excitation and emission photon\ndensity, qx is the excitation source, C(r) is the fluorophore\nconcentration to be reconstructed in the inversion, and η\ncollects quantum-yield factors in the CW source term. κ\nrepresents the diffusion coefficient, calculated by [33]\n1\n,\n(3)\nκ=\n3 ( a + s )\nwith the absorption coefficient a and the reduced scattering\ncoefficient s . In a non-contact setting of FMT, to calculate\nthe value of ϕ (r) on the object surface as the measurement, a Robin-type boundary condition is added alongside the\nequation pair (1 2):\n ϕ (r)\n= 0, {x, m}, r , (4", ")\n ν\nwhere ζ(c) is the refractive index mismatch parameter that\naccounts for the light reflection on the boundary surface, with\nc representing the light speed inside the medium. ν denotes\nthe outward normal on the boundary. Notably, to simplified the\nproblem setting, we only consider a homogeneous medium\ncase and the difference of a , s values under different\nwavelengths are neglected.\nϕ (r) + 2 ζ(c) κ\n\nB. Finite Element Discretization and System Matrix Construction\nWe apply the finite element method (FEM) [35] to the\ndiffusion model (1) - (4). Discretizing with a tetrahedral\nN\nmesh of N\ni }i=1 , we approximate\nP nodes and nodal basis {ψP\nϕ (r) i Φ ,i ψi (r) and qx (r) i (Qx )i ψi (r), which\ntransforms the continuous-form equations into a linear system\nfor excitation and emission photon pr", "opagation:\nS Φx = Qx\n\n(5)\n\nS Φm = Qm\n\n(6)\n\nwhere S RN N is the system matrix and Φ , Q RN\nare discretized form (coefficient vectors) for ϕ and q , respectively. In particular, the excitation field ϕx interacts with\nfluorophores C RN to produce the emission source term\nQm = C Φx\n\n(7)\n\nwith denoting element-wise multiplication. The equation\n(7) physically describes how fluorophores absorb excitation\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nexplicitly reveals the functional dependence of S on the\noptical parameters a and s , which forms the mathematical\nfoundation for our adaptive optimization approach introduced\nin Subsection II-C.\n\n(b)\n\n(a)\n\n3\n\nCamera\nFilter Wheel\nReal Measurement\nSample\n\nC. INR-based FMT reconstru", "ction: NeuFMT / NeuFMT\nScanners\n\nLaser\nPredicted\nMeasurement\n\nFocal Lens OD Filter\n(c)\n\n(d)\n\nAdaption Module\n\nForward Model\nBased on DE\n\nAbsorption Term\nHigh Absorption\n\nLow Absorption\n\ninv\nDi usion Term\n\nHigh Scattering\n\nSti ness Matrix\n\nLow Scattering\nBoundary Term\n\n(e)\n\nForward Data\nBackward Gradient\n\nFluorescence Distribution Encoded with INR\nNode Coordinate\n\n3D Mesh with\n\nNodes\n\nsine\n\ncosine\n\nPositional\nEncoding\n\nMLP\n\nFig. 1. Conceptual illustration of NeuFMT. (a) The FMT setup: a scanned\nlaser illuminates the sample while a CMOS camera with filter wheel on the\nopposite side records boundary images. The raster scanning method yields\nthe raw 2D image stack M real , serving as the input to the subsequent FMT\nreconstruction. (b) The difference between M real and the simulated meac( a , ,", "Cθ ) is iteratively minimized until an optimized value\nsurement M\ns\nof unknown fluorescence distribution C is found. R(C) is a regularization\nterm and { a , s } is the intrinsic optical properties consisting of\nabsorption coefficient a and scattering coefficient s . (c) A -adaption\nmodule is integrated into the FMT reconstruction. The stiffness matrix S is\ndetermined by both a and s . (d) The FEM-based simulator predicts virtual\nc( a , , Cθ ) based on the operator S 1 ( ) and predicted\nmeasurement M\ns\nfluorescence distribution C. (e) Fluorescence distribution encoded in an INR.\n3D node coordinate serves as input, while a continuous C map is generated\nthrough positional encoding and an MLP network.\n\nUnlike traditional voxel-based or mesh-dependent representations, INR provides a continuous", ", memory-efficient framework for modeling complex physical fields. The basic variant,\nNeuFMT, learns only the fluorophore Cθ with fixed optical\nproperties; the proposed adaptive NeuFMT jointly optimizes\nthe optical coefficients ( a , s ) with Cθ for enhancing the\nreconstruction accuracy and robustness. In this section, we\ndescribe the NeuFMT representation, formulate the learning\nobjective, introduce optical-property adaptation, and summarize the network architecture and implementation.\n1) INR representation of the unknown fluorescence: Our\n NeuFMT model the 3D fluorescence field as an INR, i.e., a\ncoordinate-conditioned MLP:\n\nCθ (r) = fθ Γ (r) ,\n(10)\nwhere r = (x, y, z) R3 , Γ : Rd is a highdimensional positional encoding of spatial coordinates, and\nfθ : Rd R is an MLP with parameters θ.", "This INR formulation (10) enables resolution-independent reconstruction and\nnaturally accommodates arbitrary spatial queries without being\nconstrained by the conventional discrete grid structure.\nTo enhance the network s ability to represent high-frequency\ndetails, which is crucial for resolving complex in vivo fluorescence patterns, we apply a sinusoidal positional encoding to\neach coordinate component. Let γ : R R2L be\nγ(p) = sin(20 πp), cos(20 πp), ,\nL 1\n\nsin(2\n\nπp), cos(2\n\nL 1\n\n(11)\n\nπp) ,\n\np {x, y, z},\n\nphotons and re-emit light at longer wavelengths. The emission\nsource Qm then propagates through the same medium to\nproduce the emission photon density Φm , which is finally\ndetected at the boundary, which is computed as\n\nwhere L is the number of frequency bands. The\n 3D position\nis the", "n encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that\nd = 6L. Feeding Γ (r) into fθ enables compact representation\nof both low- and high-frequency variations in Cθ .\n2) Learning objective: We estimate the fluorescence field\nCθ and, in NeuFMT, the optical properties { a , s } by\nminimizing a data-fidelity term plus regularization:\n\nM = P Φm\n\nc( a , , Cθ ) M real 2 + λ R(Cθ ), (12)\nL( a , s , θ) = M\ns\n2\n\n(8)\n\nwhere P represents the transfer function, which maps the\nboundary photon density Φm the measurement data M acquired by the camera. The above linearized forward model\nprovides the physical foundation for the inversion procedure.\nCrucially, the SPD FEM stiffness matrix S( a , s ) \nN N\nR\nin (5) (6) encode the optical properties and boundary\ngeometry, generating from a linear combination of m", "atrices\ncorresponding to distinct physical components [33], [36]\n\n1\n\n Sd + Sb . (9)\nS( a , s ) = c a Sa +\n3( a + s )\nwith Sa , Sd , and Sb the assembled absorption, diffusion, and\nRobin-boundary matrices, respectively. This decomposition\n\nc denotes the boundary measurements, and R(Cθ ) is\nwhere M\na regularization term applied to the fluorescence distribution.\nThe hyperparameter λ controls the regularization strength,\nbalancing data fidelity with sparsity constraints. The training of\n NeuFMT / NeuFMT follows a fully self-supervised paradigm\nthat explicitly integrates the DE-based physical model into\nthe optimization loop. Note that NeuFMT uses fixed optical\nparameters ( a , s ), whereas NeuFMT updates jointly.\n3) Alternating optical-property adaptation: A fundamental\ninnovation of NeuFMT li", "es in formulating the entire photon propagation process from excitation to emission as an\nend-to-end differentiable map. The forward model follows a\n\n4\n\nPREPRINT VERSION 2025\n\nprecise physical sequence from excitation source to surface\nmeasurements, as described in Subsection II-B:\n\nc( a , s , Cθ ) = P S( a , s ) 1 Cθ S( a , s ) 1 Qx ,\nM\n(13)\nWe optimize the introduced objective L( a , s , θ) in (12),\njointly updating network parameters θ and optical coefficients\n( a , s ). The chain in (13) contains only differentiable operations, including linear solves, elementwise products, and linear\nc is differentiable w.r.t. both Cθ (hence θ)\nprojections. Thus M\n\nand ( a , s ), enabling standard gradient-based training. For\ncompleteness, we state the chain-rule decomposition of the\nloss gradient wit", "h respect to ( a , s ). Based on (13), the\ngradient splits into an emission term and an excitation term:\n\nc \n S\n L M\n L\n S 1\n=\nΦm +\nc Φm\n\n{z\n}\n| M\nEmission pathway\n\nc Φm Qm \n L M\n S\nΦx\n S 1\nc Φm Qm Φx\n\n| M\n{z\n}\n\n(14)\n\nExcitation pathway\n\n { a , s }.\nThe only model-specific ingredient of a and s is the\nJacobian of S( a , s ). According to (9), the partial derivatives\nare\n\n S\n1\n= c Sa \nSd ,\n a\n3( a + s )2\n\n S\n1\n=c \nSd .\n(15)\n s\n3( a + s )2\nThis allows a and s to be optimized directly using gradient\ndescent, and then be updated together with θ, bridging the\nlearning process with the underlying physical model.\nTo mitigate potential coupling effects between a and s\nduring optimization, we propose an alternating update strategy,\nwhich periodically updates one optical parameter with the\nother fix", "ed. The alternating framework largely promotes training stability to avoid oscillations with sufficient computational\nefficiency. The complete NeuFMT algorithm is described in\nAlgorithm 1. Overall, the alternating -adaption module ensures that each optical parameter receives dedicated optimization attention while maintaining the physical consistency of\nthe forward model, yielding more accurate FMT reconstruction\nresults even in the presence of mismatch between the initial\nguess and ground truth of the optical properties.\n4) Network architecture and implementation: We adopt\nMLP for the NeuFMT / NeuFMT, comprising 8 fullyconnected layers with 512 hidden units each, followed by\na final layer with 128 units. ReLU activation functions are\nemployed throughout the network. A critical skip connect", "ion\nbridges the input Γ (r) to the 4th hidden layer, facilitating\ngradient flow and enhancing the ability to learn fine-grained\ndetails. This architectural choice is particularly suited for FMT\napplications where accurately reconstructing high-contrast targets against complex backgrounds is essential.\nWe implement the NeuFMT / NeuFMT framework with\nPyTorch, leveraging its automatic differentiation capability to\n\ncompute the gradient through both MLP and the physical\nmodel. Adam optimizer is used with the initial learning rates\nof 10 4 for θ update, 10 3 for scattering coefficient and\n10 5 for absorption coefficient. To improve the computational\nefficiency, a learning rate decay is applied for MLP update.\nThese rates are determined empirically to ensure stable convergence. The L1 regulariza", "tion parameter λ is set to 10 6\nbased on cross validation. The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality,\nwith the entire process completing within 3 30 minutes on\na single NVIDIA RTX 3090 GPU for problems of varying\nscales. The FEM discretization is built on TOAST++ toolkit\n[37], and the FMT simulation is based on a modular software\nplatform STIFT [38] in MATLAB (R2024b, MathWorks, MA,\nUS) using a desktop computer (Intel Core i5-12600 CPU @\n3.30 GHz, 128 GB RAM).\nAlgorithm 1 NeuFMT\nRequire: Real measurements M real , light speed c, stepsizes\nαθ , αa , αs , alternation period T , total iterations K\n1: Initialize θ, a , s ;\n2: Precompute Sa , Sd , Sb , Qx , P\n3: Compute S via (9);\n4: for i = 1 to K do \n5:\nC = fθ Γ (r)\n6:\nSolve Φx RN sati", "sfying S Φx = Qx\n7:\nQm = C Φx\n8:\nSolve Φm RN satisfying S Φm = Qm\nc = P Φm\n9:\nCompute predicted measurements: M\nreal 2\nc\n10:\nCompute loss: L = M M 2 + R(C)\n11:\nUpdate MLP parameters: θ = θ αθ L\n θ\n12:\nif i mod\n T = 0 then\n13:\nif i/T is even then\n L\n14:\nUpdate absorption: a = a αa \na\n15:\nelse\n L\n16:\nUpdate diffusion: s = s αs \n\ns\n17:\nend if\n\n1\n18:\nUpdate S = c a Sa +\nS\n+\nS\nd\nb ;\n3( a + s )\n19:\nend if\n20: end for\n21: Output: fluorescence C, optical parameters a , s\n\nD. FMT System Setup\nWe devised a continuous-wave (CW) FMT system\n(SHMOT) [39], [40] as depicted in Fig. 1 (a), which incorporates a 16-bit CMOS camera (Edge 4.2, PCO, Germany) with\n2048 2048 pixel resolution and a filter wheel (FW102C,\nThorlabs, NJ, US) for selective wavelength detection. A\ntunable laser source (SuperK EXTREME, N", "KT, Denmark),\nspanning 400-890 nm, provides fluorescence excitation with a\npower density of approximately 2 mW/mm2 at the sample\nplane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube, Germany) mounted aside steers\nthe laser beam to raster-scan either the top or bottom object\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nsurface, enabling switchable reflection-/transmission-mode detection. During experiments, the camera exposure time was\nfixed at 500 ms, with pixel binning applied to improve the\nsignal-to-noise ratio. The acquired raw 2D image data serve\nas supervision target for NeuFMT / NeuFMT reconstruction\n(Fig. 1 (b)). It worth m", "entioning that our FMT system also\nintegrates a programmable line-scanning illumination, which\nenables high-precision extraction of the surface geometry\nwith approximated maximum error of 0.1 mm. The extracted\nsurface information is then leveraged as prior knowledge for\nFEM meshing and improving reconstruction accuracy.\n\nE. Phantom preparation and optical calibration\nIn our validation, the slab phantomswere cast from silicone (SYLGARDTM 184; DOW, CA, USA) to emulate softtissue matrix. Optical properties were tuned by dispersing\ntitanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon\nblack powder (Colins, Shanghai, China) as scattering and\nabsorbing additives, respectively. In all phantoms, TiO2 and\ncarbon black were uniformly distributed. All the designs\nshown in Fig. 4 (a) used the s", "ame TiO2 /carbon-black mixing\nratio, yielding isotropic media with identical absorption and\nscattering parameters.\n\nF. In Vivo Lymph Node FMT Imaging\nFollowing numerical simulations and phantom experiments,\nwe evaluated the proposed method in vivo in a murine lymph\nnode imaging task. In cancer diagnostics, lymph node metastasis is a key prognostic indicator of tumor progression. Fluorescence imaging enables rapid screening of sentinel lymph\nnodes [41].\nIn our experiment, all animal procedures were approved by\nthe Institutional Animal Care and Use Committee of ShanghaiTech University (Approval No. 20211115001). 5 female\nBALB/c mice (8 weeks old) were obtained from Shanghai\nJihui Laboratory Animal Breeding Co. Ltd. and housed under\na circadian rhythm of 12 hours of day and night alternation.", "Before taking imaging experiments, fur was removed over the\nwhole body. For FMT reconstruction, we assumed an optically\nhomogeneous medium with properties calibrated during the\nexcitation step with ( a = 0.0055 mm 1 , s = 1.1 mm 1 ).\nWe followed a three-stage protocol fluorescent-dye injection, imaging, and ex vivo validation. Prior to FMT imaging, Cy5-saline solution (1.2146 mol mL 1 , 40 L) was injected subcutaneously into the left forepaw to drive lymphatic\ndrainage toward the sentinel lymph nodes and create a highintensity target. Next, follow-up FMT measurements were\nacquired using the system setup in Subsection II-D. Finally,\nafter data collection, ex vivo verification was performed using\na fluorescent stereoscopic microscope (MVX10, Olympus,\nJapan; 6.3 objective). Illumination was", "provided by a heightadjustable 630 nm LED at 20 mW cm 2 . White-light and\nCy5-channel fluorescence images were recorded using filters\nmatched to the Cy5 spectrum, and the lymph nodes were\nidentified, excised, and imaged to validate the in vivo findings.\n\n5\n\nIII. R ESULTS\nA. Convergence Verification of Optical Property Adaptive\nOptimization\nTo validate our proposed optical property adaptation mechanism, we conducted a series of numerical experiments on\na digital phantom. The primary objective was to demonstrate\nthat the -adaption module can robustly recover absorption a\nand s coefficients from severely erroneous initial estimates,\nthereby enabling high-fidelity fluorescence reconstruction.\nWe constructed a homogeneous digital slab phantom of size\n55 55 15 mm3 featuring an S -shaped fluoresc", "ent target at\nits geometric center. The ground-truth optical properties were\n 1\nset to true\nand s true = 1.0 mm 1 . To rigorously\na = 0.1 mm\ntest the correction capability, we initialized the reconstruction\nwith significantly mismatched scattering coefficients ( s init =\n0.5, 1.5, 2.0 mm 1 ) while keeping the absorption coefficient\nfixed at its true value for this specific test.\nAs summarized in Fig. 2 (a), without the -adaption module, the reconstructed fluorescence distributions suffered from\nsubstantial errors in both depth localization and morphological accuracy. The mismatched s value led to an incorrect\nmodel of photon propagation, which directly translated to\ndistorted reconstructions. In contrast, when the -adaption\nmodule was enabled, the proposed NeuFMT successfully\nrecovered flu", "orescence distributions that closely matched the\nground truth obtained with the correct optical properties.\nCrucially, the evolution of the scattering coefficient during\noptimization, plotted in Fig. 2 (b), demonstrates the module s\nrobust convergence. Regardless of the initial value whether\nhalved or doubled the estimated s reliably converged to the\nneighborhood of the true value (1.0 mm 1 ).\nA similar convergence behavior was observed for the absorption coefficient a . When initialized with biased values\n 1\n( init\n) against a fixed true s , the a = 0.05, 0.15, 0.2 mm\nadaption module corrected a with an average error of only\n1.5% (Fig. 2 (d)), and its convergence curves are shown in\nFig. 2 (e). This convergence robustness was maintained across\na range of true a and s values, confirming th", "e general\nefficacy of our alternating optimization strategy in mitigating\nparameter coupling (Fig. 2 (c), (f)).\nWe further extended the validation to the most challenging\nscenario, where both optical parameters were simultaneously\ninitialized with substantial errors. In this experiment, the initial\nvalues for both a and s were set to 50% higher than\ntheir GT values. Remarkably, even under these highly adverse\nconditions, the -adaption module successfully drove both\nparameters towards their true values. The convergence trajectories remained stable and ultimately reached a neighborhood\nof the true parameter pair. These results collectively verify\nthat the integrated -adaption module empowers NeuFMT\nto jointly recover accurate optical properties and fluorescence\ndistributions even from profou", "ndly inaccurate initial guesses,\neffectively addressing a critical source of ill-posedness in\npractical FMT scenarios.\n\n6\n\nPREPRINT VERSION 2025\n\n0.995\n\n1.0\n\n0.996\n\n1.5\n\n1.007\n\n2.0\n\n1.006\n\nGT\ny\nx\n\nDICE =\n0.0257\n\n0.7337\n\n0.4660\n\nNorm.int (a.u.)\n\n= 1.0\n= 0.1\n\nNon-Adaptive\n\n1\n\n0.3967\n\n(b)\n\n1.2\n1.0\n\n(c)\n\n1.6\n\nAdaptive\n\ny\n\n0.7198\n\n0.7230\n\n0.6964\n\nNorm.int (a.u.)\n\nz\n\n0.7796\n\n 0.9\n 0.8\n 0.5\nAsym.\nLine\n\n0.8\n0.4\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n14\n\n 0.12\n 0.11\n\n1.4\n\nPredicted\n\nz=8\n\n 2.0\n 1.5\n 1.2\n 1.1\n\n1.6\n\n0\n1\n\n2.0\n\nPredicted\n\n0.5\n\n(a)\n\n 0.10\n 0.09\n\n1.2\n\n 0.08\n1.0\n\n0\n\nAsym.\nLine\n1\n\n2\n\n4\n\n8\n\n16\n\n32\n\n64\n\niterations\n0.10\n\n0.100\n\n0.15\n\n0.101\n\n0.20\n\n0.102\n\ny\nx\n\n0.0281\n\n0.7337\n\n0.7390\n\nNorm.int (a.u.)\n\nGT\n\n0.5991\n\nz=8\nz\n\nAdaptive\n\ny\n\n0.6718\n\n0.7642\n\n0.8740\n\n0.8708\n\n(e)\n\n0.2\n\n= 1.0\n= 0.1\n\nGT\n\n 0.11\n 0.09\n\n0.12\n0.1\n0", ".08\n\n0\n\n0.04\n\n1\n\n(f) 0.16\n0.14\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n 0.08\n 0.05\nAsym.\nLine\n\n14\n\n 1.2\n 1.1\n 1.0\n 0.9\n\n0.12\n\n 0.8\n0.1\n\n0\n\n(g)\n\n 0.20\n 0.15\n 0.12\n\n0.16\n\nNorm.int (a.u.)\n\n= 1.0\n= 0.1\n\nNon-Adaptive\n\n1\n\nPredicted\n\n(d)\n\n0.097\n\nPredicted\n\n0.05\n\nAsym.\nLine\n1\n\n2\n\n4\n\n8\n\n16\n\n32\n\n64\n\niterations\n2000 iters\n\n5000 iters\n\n10000 iters\n\n20000 iters\n1\n\ny\n\n(h)\n\n1.6\n\n0.16\n\n1.4\n\n0.14\n\n1.2\n\n0.12\n\n1.0\n\n0.1\n\n0.8125\n\n0.8651\n\n0.8691\n\nz\ny\n\n= 1.5\n= 0.15\n\n1.333\n0.1332\n\n1.177\n0.1156\n\n1.050\n0.1045\n\n1.001\n0.0995\n\n0\n\n0.8\n\n2\n\n5\n\n8\n\n11\n\n14\n\n17\n\nPredicted\n\n0.6481\n\nNorm.int (a.u.)\n\nz=8\n\nPredicted\n\nx\n\n0.08\n20\n\niterations\n\nFig. 2. Ablation test for the optical-property-adaption ( -adaption) module in NeuFMT. (a-c) Effective test for the correction of s . (a) For a homogeneous\nphantom simulation with a S -shaped fluorescence inclu", "sion, the ground truth (GT) of a and s values are 0.1 mm-1 and 1.0 mm-1 respectively. A\nmismatched initial guess of s was assumed for FMT reconstruction. The -adaption module successfully corrects s with an average error of 0.55%,\nleading to significantly improved FMT reconstruction results compared to non-adaptive NeuFMT. (b) Convergence curve of s given more initial s values\nranging from 0.5 to 2 GT value under the same setting of (a). (c) Convergence curve of s value across all cases with different a values, given\ninitial s = 1.5 mm-1 . (d-f) Effective test for the correction of the absorption coefficient ( a ). (d) For the same phantom in (a), a (mismatched) a initial\nvalue is assumed for FMT reconstruction. The -adaption module successfully corrects a with an average error of 1.5%, le", "ading to significantly improved\nFMT reconstruction results. (e) Convergence curve of a given more initial a values ranging from 0.5 to 2 GT value under the same setting of (d).\n(f) Convergence curve of a value across all cases with different s values, given initial a = 0.15 mm-1 . (g-h) Effective test for the correction of both\nabsorption and diffusion coefficients. (g) For the same phantom in (a), given mismatched initial a = 1.5 and s = 0.15, both of which are 50% higher than\nGT, the -adaption module successfully corrects both a and s at the same time. (h) Convergence curve given the iteration process in (g) for both optical\ncoefficients.\n\nB. Numerical Simulations\nTo comprehensively evaluate the performance of the proposed NeuFMT under controlled conditions, we designed\nfour distinct num", "erical phantoms (Fig. 3 (a) (d) respectively)\nto systematically increase the reconstruction challenge:\n Case 1 - single small target: a 3 mm-diameter spherical\nfluorescence target embedded in a homogeneous cuboid\nphantom (55 55 15 mm3 ), serving as a baseline\nfor evaluating localization and quantitative accuracy of\na simple, isolated inclusion.\n Case 2 - complex surface geometry: a 2 mm-diameter\nspherical target inside a phantom with a curved surface\ngeometry, featuring a spherical cap top (base: 50 50 4\nmm, cap height = 5 mm, total height = 9 mm). This\ncase tests the method s robustness to non-planar surface\ntopography.\n\nCase 3 - complex target shape: a large peanut-shaped fluorescence region with uniform concentration embedded in\na standard cuboid phantom same as Case 1. This scenario\nas", "sesses the capability to recover intricate morphological\ndetails beyond simple spheres.\n Case 4 - multi-target with background: the same peanutshaped region as in Case 3, but with the addition of\na small, high-concentration spherical target inside. This\nrepresents a highly realistic and challenging condition,\ntesting the ability to resolve targets of different concentrations and shapes against a noisy background.\n\nThe ground-truth optical properties for all simulated measurements in this test were set to a = 0.1 mm 1 and s = 1.0\nmm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against\nfour established methods: conventional Tikhonov-regularized\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IM", "PLICIT NEURAL REPRESENTATION\n\nGT\n\nL2-CG\n\nL1-FISTA\n\nU-Net\n\nNeuFMT\n\nμNeuFMT\n1\n\ny\nx\n\ny\n\nz\n\nDICE =\n0.6581\n\nz=8\n\n0.4956\n\n0.6446\n\nNorm.int (a.u.)\n\nCase 1\n\n(a)\n\n0.8800\n\n0.5128\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.6286\n\nz=2\n\n0.7500\n\n0.0000\n\nNorm.int (a.u.)\n\nCase 2\n\n(b)\n\n1\n\n0.7586\n\n0.2041\n\n0\nz\n\ny\nx\n\nx\n\ny\n\nz\n\nz=8\n\n0.6938\n\n0.0828\n\n0.6153\n\nNorm.int (a.u.)\n\nCase 3\n\n(c)\n\n1\n\ny\n\n0.9751\n\n0.4766\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.5435\n\nz=8\n\n0.5908\n\n0.2637\n\nNorm.int (a.u.)\n\nCase 4\n\n(d)\n\n1\n\n0.8983\n\n0.7645\n\n0\nz\n\ny\nx\n\nNorm.int (a.u.)\n\n(e)\n\nCase 1\n\nCase 2\n\nCase 3\n\nCase 4\n\n1\n\n1\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.8\n\n0.8\n\n0.6\n\n0.6\n\n0.6\n\n0.6\n\n0.4\n\n0.4\n\n0.4\n\n0.4\n\n0.2\n\n0.2\n\n0.2\n\n0\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n0\n15\n\n0\n20\n\n25\n\n30\n\nmm\n\nGT\n\nL2-CG\n\n35\n\n0.2\n0\n\n10\n\nmm\n\nL1-FISTA\n\n20\n\n30\n\n40\n\n50\n\n0\n\n15\n\n20\n\n25\n\n30\n\n35\n\nmm\n\nU-Net\n\nNeuFMT\n\n40\n\nmm\n\nμNeuFMT\n\nFig. 3. Results", "of numerical phantom simulations. (a) (d) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (e) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.\n\nconjugate gradients (L2 -CG) [42] and L1 -regularized nonnegative least squares (L1 -FISTA) [43], a pretrained supervised U-Net, and our baseline method NeuFMT without adaption. The U-Net was trained on a large, synthetically\ngenerated dataset of 5,488 samples. For each sample, the\ninput was a boundary measurement simulated using the DEbased forward model under the ground-truth properties", "in a\ncuboid phantom (55 55 15 mm3 ), and the label was the\ncorresponding 3D fluorescence map of 1 2 ellipsoids with\nrandom sizes and spatial positions. To clearly demonstrate the\neffect of the -adaption module, we focused on adapting s\nwhile fixing a at its true value during reconstruction. For all\nmethods, the initial s was set to an erroneous value of 1.2\nmm 1 , which is 20% higher than the ground truth.\nThe results presented in Fig. 3 (a) (d) demonstrate the\nconsistent superiority of NeuFMT across all four numerical cases. We observe that the conventional methods were\nadversely affected by the optical property mismatch: L2 -CG\nreconstructions were characteristically blurred and exhibited\nsignificant depth errors, such as full-depth penetration in\nCases 3 and 4 and depth-wise expansion", "in Case 1. L1 -FISTA\nfrequently introduced non-physical, fragmented artifacts, such\nas staircase patterns in Case 1 and hollow structures in Case 3,\nwhile it also suffered from severe depth inaccuracy. The\nsupervised U-Net, though performed well in Case 1, showed\nlimited generalization beyond its training data, as seen in its\nlocalization failure in the complex surface geometry of Case 2\n\n7\n\nand noticeable shape distortion in the unseen peanut-shaped\ntarget of Case 3 and 4. The direct NeuFMT provided better\ndepth prediction than the traditional methods but remained\nsensitive to the erroneous s , resulting in substantial shape\nexpansion in the x-y plane (Cases 1, 2) and axial splitting\n(Case 3). In contrast, NeuFMT successfully rectified the\noptical properties and overcame these limitations", ". It achieved\nthe most accurate spatial localization and shape fidelity, as\nevidenced by its 3D isosurfaces tightly conforming to the\nground truth in both simple and complex targets, and it clearly\nresolved both the small target and the complex background in\nCase 4. Quantitatively, NeuFMT consistently achieved the\nhighest Dice coefficients, and its intensity profiles (Fig. 3 (e))\nmost closely matched the ground truth in terms of peak\nlocation, width, and background suppression.\nC. Phantom Experiments\nWe further evaluated the performance of all methods using\nphysical phantom experiments to assess their practicality under real-world conditions, including measurement noise. The\nphantoms were fabricated from silicone, with their optical\nproperties calibrated to be approximately a = 0.0055 mm 1", "and s = 1.1 mm 1 at 680 nm. Fluorescent targets were embedded within the phantoms to create the four cases previously\ndefined in the simulations. The initial value of s was set identically for all reconstruction methods as the calibrated value,\nand also the U-Net was retrained accordingly. Consistent with\nthe simulation study, we focused on the adaptive recovery of\nthe reduced scattering coefficient s .\nThe reconstruction results are summarized in Fig. 4. Under\nthese challenging real-world conditions, the limitations of the\nbaseline methods became evident: conventional approaches\n(L2 -CG, L1 -FISTA) produced blurry or fragmented reconstructions with significant depth errors, while the supervised\nU-Net, susceptible to domain shift and noise, failed to generalize, resulting in complete loca", "lization failures (Case 1)\nor severely distorted shapes (Cases 3 and 4). In contrast,\nthe INR-based frameworks, NeuFMT and NeuFMT, demonstrated markedly superior robustness, consistently yielding\nphysically plausible and continuous reconstructions where\nother methods failed. A detailed comparison between the two\nreveals that NeuFMT provided critical refinements toward\nenhanced physical consistency. In Cases 1 and 3, NeuFMT\nachieved better depth sensitivity and more uniform fluorophore\ndistribution, more faithfully representing the homogeneous\nnature of the true targets. In the complex geometry of Case 2,\nit uniquely achieved accurate localization, whereas direct\nNeuFMT produced a solution with an aberrant depth shift. For\nthe multi-target scenario in Case 4, NeuFMT reconstructed\nthe backgr", "ound region with improved morphological accuracy.\nAlthough the performance gap in quantitative metrics such\nas the Dice coefficient was occasionally narrow, which reflects the inherent robustness of the shared INR architecture,\n NeuFMT provided consistent, subtle refinements, particularly\nin depth accuracy. The phantom experiments confirm that the\nadaptive physical correction mechanism in NeuFMT can enhance reconstruction fidelity under practical conditions where\nthe exact coefficient in most real experiments is uncertain.\n\n8\n\nPREPRINT VERSION 2025\n\n(a)\n\nSilicone Phantoms\nGT\n\nL2-CG\n\nL1-FISTA\n\nU-Net\n\nNeuFMT\n\nμNeuFMT\n1\n\ny\nx\n\ny\n\nz\n\nDICE =\n0.5895\n\nz=8\n\n0.6154\n\n0.0762\n\nNorm.int (a.u.)\n\nCase 1\n\n(b)\n\nFluorescence Inclusions\n\n0.7023\n\n0.6615\n\n0\nz\n\n(Fig. 5 (c)). The reconstructed target lengths from", "NeuFMT\nshowed the closest agreement with the physical measurements\ntaken from the ex vivo lymph nodes, as visualized by the\nintensity profiles in Fig. 5 (c). These results demonstrate that\n NeuFMT provides a definitive advantage in practical in vivo\nscenarios, enabling robust and accurate target segmentation\nand localization under complex clinically related scenarios,\nsuch as fluorescence guided surgery.\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.3371\n\nz=2\n\n0.3810\n\n0.4000\n\n0.5200\n\n0.2586\n\nWhite Light Image\n\n(a)\n\nvein\n\nLN-2\n\n0\nz\n\ny\nx\n\ny\n\nz\n\nz=8\n\n0.5413\n\n0.3358\n\n0.7011\n\n0.8230\n\n0.8050\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.5193\n\nz=8\n\n0.4319\n\n0.6601\n\n0.2849\n\nNorm.int (a.u.)\n\n0.6240\n\nNeuFMT\n\nμNeuFMT\nz\nx\n\nvein\n\nLN-3\nLN-2\nLN-1\n\nCase 3\n\nCase 4\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.6\n\n0.6\n\n0.6\n\n0.6\n\n0.4\n\n0.4\n\n0.4\n\n0.4\n\n0.2\n\n0.2\n20\n\n25\n\n30\n\n35\n\n40\n\n0\n15", "0.2\n20\n\n25\n\n30\n\nmm\n\nGT\n\nL2-CG\n\n35\n\n0.2\n\n0\n\n0\n0\n\n10\n\nmm\n\nL1-FISTA\n\n20\n\n30\n\n40\n\n50\n\n15\n\n20\n\n25\n\n30\n\n35\n\nmm\n\nU-Net\n\nNeuFMT\n\n40\n\nmm\n\nNeuFMT-Ada\n\nFig. 4. Results of real phantom experiments. (a) Photograph of the real\nsilicone phantoms and fluorescence inclusions. (b) (e) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (f) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.\n\n10 mm\n\n(c)\n\nWe performed an in vivo imaging experiment on mice.\nFollowing the protocol described in Subsection II-F, Cy5\nfluorescent dye accumulated primarily at the", "sentinel lymph\nnodes (LN), with some residual signal at the vein (Fig. 5 (a)).\nOur task was to reconstruct the spatial location and shape of\nthe sentinel lymph nodes.\nThe 3D FMT reconstruction results from all methods\nare presented in Fig. 5 (b). The conventional L2 -CG method\nproduced a reconstruction where the volume of LN-3 was\noverestimated, and the signals from LN-1, LN-2, and the vein\nmerged into a single, indistinguishable cluster. The L1 -FISTA\nreconstruction was highly fragmented, making it impossible\nto discern the shape or count of the lymph nodes accurately.\nAlso, the baseline NeuFMT failed to produce a physiologically plausible reconstruction. In contrast, NeuFMT was\nthe only method that successfully and distinctly resolved all\nthree lymph nodes (LN-1, LN-2, LN-3) and the vei", "n, clearly\nidentifying each as separate, localized regions of fluorescence.\nFor quantitative validation, the mouse was sacrificed, and\nthe lymph nodes were excised to be imaged by ex vivo FRI\n\nLN-1\n\nx\ny\n\nLN-3 LN-2\n\n10 mm\n\n0\n\n1\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.8\n\n0.6\n\nLN-1\n\n0.4\n\n0.6\n\nLN-2\n\n0.4\n\n0.2\n\n0.6\n\n0.2\n\n0\n2\n\n4\n\n6\n\nL2-CG\n\n8\n\n10\n\n12\nmm\n\nLN-3\n\n0.4\n\n0.2\n\n0\n0\n\nD. In Vivo Lymph Node FMT Imaging Experiments\n\nConcentration of Cy5 (a.u.)\n\nCase 2\n1\n0.8\n\nSlice z = 8 mm\n\nCase 1\n1\n0.8\n\nx\ny\n\nSlice z = 11 mm\n\n(f)\nNorm.int (a.u.)\n\nL1-FISTA\n\nR\n\n1\n\nProfiles\n\ny\nx\n\n15\n\nL2-CG\n\nLN-3\n\nL\n\n0\nz\n\n0\n\nR\n\ny\n\nConcentration of Cy5 (a.u.)\n\nCase 4\n\n(e)\n\n1\n\n(b)\n\nLN-1\n\nL\n\n3D Segmentation\n\nx\n\nNorm.int (a.u.)\n\nCase 3\n\n(d)\n\n1\n\ny\n\nIn vivo FRI\n\nNorm.int (a.u.)\n\nCase 2\n\n(c)\n\n1\n\n0\n0\n\n2\n\nL1-FISTA\n\n4\n\n6\n\n8\n\n10\n\n12\nmm\n\n0\n\n2\n\nNeuFMT\n\n4\n\n6\n\n8\n\n1", "0\n\n12\nmm\n\nμNeuFMT\n\nFig. 5. In vivo lymph node FMT imaging and reconstruction results. (a) The\nwhite-light image and preview via 2D fluorescence reflectance imaging (FRI)\noverlaid on the white-light image with the red aera indicating the concentrated\ndistribution of Cy5 probe on the cites of three lymph nodes (LN-1, LN-2, LN3) and the vein. (b) Comparison of FMT reconstruction results from different\nmethods. The 3D segmentation, along with two slices at z = 8 and 11 mm,\nare displayed. (c) Intensity profiles along the dashed lines in b. are compared\nfor each ex vivo images of lymph nodes after sacrificing the animal. The gray\nzone represents the estimated size of LN, based on the ex vivo fluorescence\nimages.\n\nIV. D ISCUSSION AND C ONCLUSION\nIn this study, we introduced NeuFMT, an optical-pro", "pertyadaptive FMT reconstruction framework that integrates INR\nwith an explicitly differentiable FEM-based light propagation model. By unifying a continuous fluorescence field parameterized by an INR and a physics-based forward model\namenable to end-to-end optimization, NeuFMT addresses\ntwo fundamental limitations of existing FMT reconstruction\ntechniques: their inability to efficiently adapt to complex and\nheterogeneous fluorescence distribution, and their reliance on\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nfixed, often inaccurate, optical properties, which significantly\nexacerbates the inherent ill-posedness of the inverse problem.\nUnlike supervised deep learning approaches which are constrained by the diversit", "y and scale of training datasets and\noften fail under domain shift, NeuFMT operates in a selfsupervised, physics-informed regime. It does not require paired\ntraining data; instead, it directly minimizes the discrepancy between measured and simulated boundary fluxes. This not only\neliminates the need for extensive experimental datasets but also\nensures generalizability across different imaging geometries\nand target configurations. The continuous, coordinate-based\nrepresentation provided by the INR further ensures that our\nreconstructions are free from discretization artifacts and inherently resolution-agnostic.\nA central contribution of our work is the introduction of\nan optical property adaptation mechanism, which enables the\ndynamic optimization of absorption and scattering coefficients\n(", "a , s ) concurrently with the fluorescence distribution. Our\nframework demonstrates that the integration of a differentiable\nphysics-based forward model is the key to enabling this\nself-supervised adaptation. The FEM-based light propagation\nmodel is not merely a component of the loss function, but\nan active and adaptive part of the inverse solver. This stands\nin contrast to both traditional iterative methods, which hold\noptical properties static and thus aggravate the problem s illposedness, and conventional end-to-end deep learning approaches, which struggle to generalize beyond their training\ndata. The adaptivity of our model is thus its core strength,\nproviding a principled way to refine the physical model itself\nbased on the measured data, which is crucial for practical\napplications w", "here precise prior knowledge of tissue optics\nis unavailable.\nOur results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate\nthat NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1 ) and deep learningbased (U-Net) benchmarks. In particular, the method consistently localized fluorescent targets with higher spatial accuracy, improved contrast, and more realistic morphological\nfeatures especially under challenging conditions involving\nbackground fluorescence and complex geometry.\nDespite these promising results, several aspects of\n NeuFMT merit further investigation. First, the current implementation assumes a homogeneous optical background a\ncommon simplification in FMT studies. Extending the model\nto incor", "porate spatially varying optical properties represents\na logical next step, potentially by representing a (r) and\n s (r) with additional INRs, though this would significantly\nincrease the complexity of the inverse problem. Nevertheless,\nthe proposed NeuFMT can be validated or even combined\nwith time-domain near-infrared spectroscopy (fNIRS) [44],\n[45] or diffuse optical tomography (DOT) [46] techniques,\nwhere the complex optical properties related with absorption\nand scattering can disentangled and calibrated. More importantly, the integration of NeuFMT with emerging imaging\ntechnologies holds particular promise. The inherent adaptivity\nof our framework is well-suited to the distinct scattering\nand absorption landscapes of NIR-II fluorescence tomography\n\n9\n\n[47], [48], where our optical pr", "operty optimization could be\ncrucial for accurately modeling the increased photon penetration and achieving higher-resolution reconstruction at depth.\nFurthermore, the framework can be naturally extended to\nhyperspectral FMT, using a single INR to output both fluorophore concentration and spectral signature, thereby disentangling multiple probes or accounting for wavelength-dependent\noptical properties. Finally, translating NeuFMT into clinical\nsettings, such as intraoperative fluorescence-guided surgery\n[8], [9], represents an exciting frontier where its adaptability\ncould overcome patient-specific variations in tissue optics.\nIn conclusion, by harmonizing a differentiable physics\nmodel with a continuous INR, NeuFMT provides a robust,\nself-supervised, and adaptive framework for FMT recons", "truction. It effectively mitigates the ill-posedness inherent to\ninverse problems with uncertain parameters, setting a new\nparadigm for practical, high-resolution fluorescence molecular\nimaging. We believe this physics-in-the-loop INR approach\noffers a generalizable template for tackling a wide range of\ntomographic and inverse problems in biomedical imaging.\nR EFERENCES\n[1] F. Song, P. Zhang, H. Wu, C. Ma, Z. Liu, R. Cai, Y. Feng, Y. He,\nX. Dong, Y. Tian, and G. Zhang, Advances of fluorescence molecular\nimaging: NIR-II window, probes, and tomography, Laser & Photonics\nReviews, vol. 19, no. 10, p. 2400275, 2025.\n[2] B. Zhu, J. Hendricks, J. E. Morton, J. C. Rasmussen, C. Janssen,\nM. N. Shah, and E. M. Sevick-Muraca, Near-infrared fluorescence\ntomography and imaging of ventricular cerebrospi", "nal fluid flow and\nextracranial outflow in non-human primates, IEEE Transactions on\nMedical Imaging, vol. 42, no. 12, pp. 3555 3565, 2023.\n[3] M. S. Ozturk and et al., High-resolution tomographic analysis of in\nvitro 3D glioblastoma tumor model under long-term drug treatment, \nScience Advances, vol. 6, no. 10, p. eaay7513, 2020.\n[4] M. Cai, Z. Zhang, X. Shi, Z. Hu, and J. Tian, NIR-II/NIR-I fluorescence molecular tomography of heterogeneous mice based on gaussian\nweighted neighborhood fused lasso method, IEEE Transactions on\nMedical Imaging, vol. 39, no. 6, pp. 2213 2222, 2020.\n[5] S. R. Arridge and J. C. Schotland, Optical tomography: forward and\ninverse problems, Inverse problems, vol. 25, no. 12, p. 123010, 2009.\n[6] L. V. Wang and H.-i. Wu, Biomedical optics: principles and imaging.\nJo", "hn Wiley & Sons, 2007.\n[7] F. Stuker, J. Ripoll, and M. Rudin, Fluorescence molecular tomography:\nprinciples and potential for pharmaceutical research, Pharmaceutics,\nvol. 3, no. 2, pp. 229 274, 2011.\n[8] J. S. D. Mieog, F. B. Achterberg, A. Zlitni, M. Hutteman, J. Burggraaf,\nR.-J. Swijnenburg, S. Gioux, and A. L. Vahrmeijer, Fundamentals and\ndevelopments in fluorescence-guided cancer surgery, Nature Reviews\nClinical Oncology, vol. 19, no. 1, pp. 9 22, 2022.\n[9] K. Wang, Y. Du, Z. Zhang, K. He, Z. Cheng, L. Yin, D. Dong, C. Li,\nW. Li, Z. Hu et al., Fluorescence image-guided tumour surgery, Nature\nReviews Bioengineering, vol. 1, no. 3, pp. 161 179, 2023.\n[10] D. Zhu et al., Comparison of regularization methods in fluorescence\nmolecular tomography, Photonics, vol. 1, no. 2, pp. 95 109, 2014.", "[11] H. Yi et al., Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography:\na comparative study, Journal of Biomedical Optics, vol. 18, no. 5, p.\n56013, 2013.\n[12] J. Shi, B. Zhang, F. Liu, J. Luo, and J. Bai, Efficient L1 regularizationbased reconstruction for fluorescent molecular tomography using\nrestarted nonlinear conjugate gradient, Optics letters, vol. 38, no. 18,\npp. 3696 3699, 2013.\n[13] D. Zhu and C. Li, Nonconvex regularizations in fluorescence molecular\ntomography for sparsity enhancement, Physics in Medicine & Biology,\nvol. 59, no. 12, p. 2901, 2014.\n[14] J. Zhang, L. Li, Q. Hu, J. Zhang, Y. Wu, L. Gu, J. Li, F. Li, X. Zhu,\nJ. Jiang et al., High-fidelity solution decomposition fluorescence tomography in the presence of", "background interference, Laser & Photonics\nReviews, p. e01013, 2025.\n\n10\n\n[15] C. Huang, H. Meng, Y. Gao, S. Jiang, K. Wang, and J. Tian, Fast and\nrobust reconstruction method for fluorescence molecular tomography\nbased on deep neural network, in Imaging, Manipulation, and Analysis\nof Biomolecules, Cells, and Tissues XVII, vol. 10881. SPIE, 2019, pp.\n257 262.\n[16] L. Guo, F. Liu, C. Cai, J. Liu, and G. Zhang, 3D deep encoder decoder\nnetwork for fluorescence molecular tomography, Optics letters, vol. 44,\nno. 8, pp. 1892 1895, 2019.\n[17] P. Zhang, G. Fan, T. Xing, F. Song, and G. Zhang, UHR-DeepFMT:\nultra-high spatial resolution reconstruction of fluorescence molecular\ntomography based on 3-d fusion dual-sampling deep neural network, \nIEEE Transactions on Medical Imaging, vol. 40, no. 11, p", "p. 3217 3228,\n2021.\n[18] J. Cheng, P. Zhang, F. Liu, J. Liu, H. Hui, J. Tian, and J. Luo, Encoderdecoder deep learning network for simultaneous reconstruction of fluorescence yield and lifetime distributions, Biomedical Optics Express,\nvol. 13, no. 9, pp. 4693 4705, 2022.\n[19] P. Zhang, C. Ma, F. Song, Z. Liu, Y. Feng, Y. Sun, Y. He,\nF. Liu, D. Wang, and G. Zhang, Multi-branch attention prior based\nparameterized generative adversarial network for fast and accurate\nlimited-projection reconstruction in fluorescence molecular tomography, Biomedical Optics Express, vol. 13, no. 10, pp. 5327 5343, 2022.\n[20] P. Zhang, F. Song, C. Ma, Z. Liu, H. Wu, Y. Sun, Y. Feng, Y. He, and\nG. Zhang, Robust reconstruction of fluorescence molecular tomography\nbased on adaptive adversarial learning strategy, Ph", "ysics in Medicine &\nBiology, vol. 68, no. 4, p. 04LT01, 2023.\n[21] P. Zhang, X. Liu, Q. Xue, Y. Shang, C. Liu, R. Chen, H. Gao, J. Liang,\nW. Wang, and G. Zhang, PAH2T-Former: Paired-attention hybrid\nhierarchical transformer for synergistically enhanced fmt reconstruction\nquality and efficiency, IEEE Transactions on Computational Imaging,\n2025.\n[22] H. Meng, Y. Gao, X. Yang, K. Wang, and J. Tian, K-nearest neighbor\nbased locally connected network for fast morphological reconstruction\nin fluorescence molecular tomography, IEEE transactions on medical\nimaging, vol. 39, no. 10, pp. 3019 3028, 2020.\n[23] D. Li, C. Chen, J. Li, and Q. Yan, Reconstruction of fluorescence\nmolecular tomography based on graph convolution networks, Journal\nof Optics, vol. 22, no. 4, p. 045602, 2020.\n[24] Y. Wang, C.", "Bian, Y. An, H. Wang, Q. Liang, Y. Du, and J. Tian,\n Graph convolution based residual connected network for morphological reconstruction in fluorescence molecular tomography, in Medical\nImaging 2022: Biomedical Applications in Molecular, Structural, and\nFunctional Imaging, vol. 12036. SPIE, 2022, pp. 527 533.\n[25] Y. Sun, J. Liu, M. Xie, B. Wohlberg, and U. S. Kamilov, Coil:\nCoordinate-based internal learning for tomographic imaging, IEEE\nTransactions on Computational Imaging, vol. 7, pp. 1400 1412, 2021.\n[26] L. Lozenski, M. A. Anastasio, and U. Villa, A memory-efficient selfsupervised dynamic image reconstruction method using neural fields, \nIEEE Transactions on Computational Imaging, vol. 8, pp. 879 892,\n2022.\n[27] A. W. Reed, H. Kim, R. Anirudh, K. A. Mohan, K. Champley, J. Kang,\nand S", ". Jayasuriya, Dynamic CT reconstruction from limited views\nwith implicit neural representations and parametric motion fields, in\nProceedings of the IEEE/CVF International Conference on Computer\nVision, 2021, pp. 2258 2268.\n[28] L. Shen, J. Pauly, and L. Xing, NeRP: implicit neural representation\nlearning with prior embedding for sparsely sampled image reconstruction, IEEE Transactions on Neural Networks and Learning Systems,\nvol. 35, no. 1, pp. 770 782, 2022.\n[29] R. Liu, Y. Sun, J. Zhu, L. Tian, and U. S. Kamilov, Recovery\nof continuous 3D refractive index maps from discrete intensity-only\nmeasurements using neural fields, Nature Machine Intelligence, vol. 4,\nno. 9, pp. 781 791, 2022.\n[30] S. Shen, L. Li, S. Gao, Y. Wang, L. Gu, S. Li, X. Zhu, J. Jiang, J. Yu, and\nW. Ren, High resolution", "diffuse optical tomography via neural fields, \nIEEE Transactions on Computational Imaging, 2024.\n[31] K. Han, C. Li, A. Xiao, Y. Tian, J. Tian, and Z. Hu, TSPE: Reconstruction of multi-morphological tumors of NIR-II fluorescence molecular\ntomography based on positional encoding, Computer Methods and\nPrograms in Biomedicine, vol. 261, p. 108554, 2025.\n[32] S. R. Arridge, Optical tomography in medical imaging, Inverse problems, vol. 15, no. 2, p. R41, 1999.\n[33] , Photon-measurement density functions. part I: Analytical forms, \nApplied Optics, vol. 34, no. 31, pp. 7395 7409, 1995.\n[34] S. R. Arridge and M. Schweiger, Photon-measurement density functions. part 2: Finite-element-method calculations, Applied Optics,\nvol. 34, no. 34, pp. 8026 8037, 1995.\n\nPREPRINT VERSION 2025\n\n[35] O. C. Zienki", "ewicz, R. L. Taylor, P. Nithiarasu, and J. Zhu, The finite\nelement method. Elsevier, 1977, vol. 3.\n[36] V. Ntziachristos, C. Bremer, and R. Weissleder, Fluorescence molecular\ntomography resolves protease activity in vivo, Nature Medicine, vol. 8,\nno. 7, pp. 757 760, 2002.\n[37] M. Schweiger and S. Arridge, The Toast++ software suite for forward\nand inverse modeling in optical tomography, Journal of biomedical\noptics, vol. 19, no. 4, pp. 040 801 040 801, 2014.\n[38] W. Ren, H. Isler, M. Wolf, J. Ripoll, and M. Rudin, Smart toolkit\nfor fluorescence tomography: simulation, reconstruction, and validation, \nIEEE Transactions on Biomedical Engineering, vol. 67, no. 1, pp. 16 \n26, 2019.\n[39] S. Gao, J. Zhang, Y. Hu, Y. Wu, L. Li, Q. Hu, X. Lou, X. Zhu, J. Jiang,\nand W. Ren, Multifunctional optical", "tomography system with highfidelity surface extraction based on a single programmable scanner and\nunified pinhole modeling, IEEE Transactions on Biomedical Engineering, 2023.\n[40] Y. Hu, Y. Wu, L. Li, L. Gu, X. Zhu, J. Jiang, and W. Ren, Simultaneous\nreconstruction of 3D fluorescence distribution and object surface using\nstructured light illumination and dual-camera detection, Optics Express,\nvol. 32, no. 9, pp. 15 760 15 773, 2024.\n[41] C. Ji, M. Zhao, C. Wang, R. Liu, S. Zhu, X. Dong, C. Su, and Z. Gu,\n Biocompatible tantalum nanoparticles as radiosensitizers for enhancing\ntherapy efficacy in primary tumor and metastatic sentinel lymph nodes, \nACS nano, vol. 16, no. 6, pp. 9428 9441, 2022.\n[42] S. Kawata and O. Nalcioglu, Constrained iterative reconstruction by\nthe conjugate gradient met", "hod, IEEE Transactions on Medical Imaging,\nvol. 4, no. 2, pp. 65 71, 1985.\n[43] A. Beck and M. Teboulle, A fast iterative shrinkage-thresholding algorithm for linear inverse problems, SIAM Journal on Imaging Sciences,\nvol. 2, no. 1, pp. 183 202, 2009.\n[44] Y. Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared\nspectroscopy and imaging: a review, Applied Sciences, vol. 9, no. 6, p.\n1127, 2019.\n[45] H. Y. Ban, G. M. Barrett, A. Borisevich, A. Chaturvedi, J. L. Dahle,\nH. Dehghani, J. Dubois, R. M. Field, V. Gopalakrishnan, A. Gundran\net al., Kernel flow: a high channel count scalable time-domain functional near-infrared spectroscopy system, Journal of biomedical optics,\nvol. 27, no. 7, p. 074710, 2022.\n[46] A. Pifferi, D. Contini, A. D. Mora, A. Farina, L. Spinelli, and A. Torricel", "li, New frontiers in time-domain diffuse optics, a review, Journal\nof Biomedical Optics, vol. 21, no. 9, pp. 091 310 091 310, 2016.\n[47] F. Wang, Y. Zhong, O. Bruns, Y. Liang, and H. Dai, In vivo NIRII fluorescence imaging for biology and medicine, Nature Photonics,\nvol. 18, no. 6, pp. 535 547, 2024.\n[48] Z. Zhang, Y. Du, X. Shi, K. Wang, Q. Qu, Q. Liang, X. Ma, K. He,\nC. Chi, J. Tang et al., NIR-II light in clinical oncology: opportunities\nand challenges, Nature Reviews Clinical Oncology, vol. 21, no. 6, pp.\n449 467, 2024."]}
{"method": "format_aware", "num_chunks": 1, "avg_chunk_len": 58929.0, "std_chunk_len": 0.0, "max_chunk_len": 58929, "min_chunk_len": 58929, "total_chars": 58929, "compression_ratio": 1.0000169695735546, "chunks": ["PREPRINT VERSION 2025\n\n1\n\n NeuFMT: Optical-Property-Adaptive Fluorescence\nMolecular Tomography via Implicit\nNeural Representation\n\narXiv:2511.04510v1 [eess.IV] 6 Nov 2025\n\nShihan Zhao, Jianru Zhang, Yanan Wu, Linlin Li, Siyuan Shen, Xingjun Zhu, Guoyan Zheng, Member IEEE,\nJiahua Jiang, and Wuwei Ren\n\nAbstract Fluorescence Molecular Tomography (FMT) is a\npromising technique for non-invasive 3D visualization of fluorescent probes, but its reconstruction remains challenging due to\nthe inherent ill-posedness and reliance on inaccurate or oftenunknown tissue optical properties. While deep learning methods\nhave shown promise, their supervised nature limits generalization\nbeyond training data. To address these problems, we propose\n NeuFMT, a self-supervised FMT reconstruction framework that\nintegrates implicit neural-based scene representation with explicit\nphysical modeling of photon propagation. Its key innovation lies\nin jointly optimize both the fluorescence distribution and the\noptical properties ( ) during reconstruction, eliminating the need\nfor precise prior knowledge of tissue optics or pre-conditioned\ntraining data. We demonstrate that NeuFMT robustly recovers\naccurate fluorophore distributions and optical coefficients even\nwith severely erroneous initial values (0.5 to 2 of ground\ntruth). Extensive numerical, phantom, and in vivo validations\nshow that NeuFMT outperforms conventional and supervised\ndeep learning approaches across diverse heterogeneous scenarios.\nOur work establishes a new paradigm for robust and accurate\nFMT reconstruction, paving the way for more reliable molecular\nimaging in complex clinically related scenarios, such as fluorescence guided surgery.\nIndex Terms fluorescence molecular tomography, image reconstruction, optical properties, implicit neural representation,\nfluorescence guided surgery\n\nThe work was supported by Science and Technology Commission of Shanghai Municipality under Grant 25JS2830300 (Wuwei Ren), National Natural\nScience Foundation of China under Grants 62105205 (Wuwei Ren), and\nShanghai Clinical Research and Trial Center (Wuwei Ren). (Corresponding\nauthor: Wuwei Ren.)\nShihan Zhao and Jianru Zhang contributed equally to this work.\nShihan Zhao, Yanan Wu, Linlin Li and Siyuan Shen are with\nthe School of Information Science and Technology, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: zhaoshh, wuyn1, lill,\nshensy2023@shanghaitech.edu.cn).\nJianru Zhang and Jiahua Jiang are with the School of Mathematics,\nUniversity of Birmingham, Edgbaston, B15 2QN, United Kingdom (e-mail:\njxz389@student.bham.ac.uk; j.jiang.3@bham.ac.uk).\nXingjun Zhu is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail:\nzhuxj1@shanghaitech.edu.cn).\nGuoyan Zheng is with the Institute of Medical Robotics, School of\nBiomedical Engineering, Shanghai Jiao Tong University, Shanghai 200240,\nChina (e-mail: guoyan.zheng@sjtu.edu.cn)\nWuwei Ren is with the School of Information Science and Technology,\nShanghaiTech University, Shanghai 201210, China, and also with State\nKey Laboratory of Advanced Medical Materials and Devices, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: renww@shanghaitech.edu.cn).\n\nI. INTRODUCTION\nFluorescence Molecular Tomography (FMT) has emerged\nas a promising molecular imaging modality, enabling noninvasive 3D visualization of fluorescent probe distribution\nin highly turbid media [1]. Owning to its high sensitivity,\ncost-effectiveness, and non-ionizing radiation, FMT has found\nbroad applications in preclinical research and clinical practice, e.g., brain imaging [2], in vitro cell culture monitoring\n[3] and tumor detection [4]. FMT reconstructs the internal\nfluorescence distribution by measuring the photon distribution\non the object surface and minimizing the discrepancy between\nreal measurements and the simulated results. A canonic framework of FMT reconstruction employs an iterative optimization\nstrategy with a forward model typically based on the\nRadiation Transfer Equation (RTE) or the diffusion equation\n(DE) and an inverse model that refines fluorescence distribution prediction until convergence [5], [6]. However, FMT\nreconstruction is inherently ill-posed due to insufficient surface measurements and strong photon scattering effect within\ntissues. Development of high-precision FMT reconstruction\nalgorithms is highly attractive for further improvement of\nthe spatial resolution and detection depth of this technology,\nwhich ultimately broaden the biological applications in drug\ndiscovery [7] and clinical use such as fluorescence guided\nsurgery [8], [9].\nTo address the ill-posed nature of FMT reconstruction,\nregularization techniques that incorporate prior knowledge are\napplied. Conventional approaches include Tikhonov (L2 norm)\nregularization for smoothing the results [10], [11], and sparsepromoting regularization (L1 , Lp norm) or total variation (TV)\nregularization for enhancing the spatial resolution [12], [13].\nRecent advancements in regularization techniques, such as\nthe solution-decomposition algorithm, utilize an advanced\nstochastic prior model that improves the differentiation of\nfluorescence targets from background interference, thereby\nenhancing reconstruction quality [14]. While these methods\nstabilize solutions, their reliance on time-consuming iterative\noptimization and idealized assumptions about optical parameters often results in slow convergence and limited accuracy in\nheterogeneous tissues. Deep learning (DL) methods, particularly en-decoder-based neural networks [15] [21] and graphbased networks [22] [24], have recently been used in FMT\nreconstruction by learning direct mappings from boundary\nmeasurements to fluorescence distributions. These approaches\n\n2\n\nencode physical priors within network parameters, enabling\noverwhelmingly rapid inference. However, their dependence\non supervised training with large, scenario-specific datasets restricts generalizability across variable experimental conditions\n(e.g., tissue object geometry and optical properties), leading\nto significant accuracy degradation when the object properties\ndeviate from training assumptions.\nRecently, implicit neural representation (INR) models have\nemerged as a powerful alternative for medical image reconstruction. By mapping arbitrary spatial coordinates to certain\nunknown physical quantities via a coordinate-based multilayer perceptron network (MLP), INRs achieve continuous\n3D representations, self-supervised training, and memory efficiency. Originally popularized in computer vision and medical imaging, INRs have demonstrated remarkable success\nin modalities such as computed tomography (CT), magnetic\nresonance imaging (MRI) [25] [29], and notably in diffuse\noptical tomography (DOT), where INR has been proven to be\nable to capture a high-resolution, continuous optical absorption\nmap that account for light scattering in complex tissues [30].\nINR captures continuous spatial information and integrates\nphysical priors makes it particularly suited for various imaging problems. In the context of FMT, preliminary work has\nexplored position encoding strategies to enhance spatial resolution and improve the quality of FMT reconstructions [31].\nNevertheless, systematic studies integrating optical diffusion\nphysics within an INR framework remain scarce. This gap\npresents an opportunity to harness the strengths of implicit\nmodeling for robust and data-efficient FMT reconstruction.\nTo bridge this gap, we propose neural-field-based FMT, or\nNeuFMT, a physics-driven reconstruction framework unifying\nINR with explicit physical models. Unlike conventional DLbased FMT reconstruction algorithms that couple explicit\nfluorescence predictions to implicit physical model, NeuFMT\nintegrates the DE-based forward model in the network loss,\nenabling self-supervised training without paired data. The\ndifferentiability of the forward model is achieved via finite\nelement method (FEM). This inversion-free approach ensures\nrapid, continuous reconstruction across diverse geometries\nwhile inherently addressing scattering effects. Another critical\nlimitation of both traditional and DL methods lies in the\npresumed optical properties of the object during reconstruction, which largely aggravate the ill-posedness of the inverse\nproblem given the optical parameters were initially biased. To\novercome this, we further introduce optical-property-adaptive\nNeuFMT, or NeuFMT, an adaptive extension of NeuFMT\nthat dynamically optimizes scattering / absorption coefficients\nand fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations, NeuFMT achieves robust accuracy even when provided\nwith erroneous initial guess of the optical coefficient values,\naddressing the problem of unrealistic assumption prior to\nFMT reconstruction. Both proposed INR-based FMT reconstruction algorithms were thoroughly compared and validated\nby simulations and phantom experiments along with other\nmethods. Furthermore, in vivo lymph node imaging in mice\nwas performed, further demonstrating the advantages of the\nproposed methods.\n\nPREPRINT VERSION 2025\n\nII. M ETHODS\nA. Forward Modeling of FMT\nModel-based FMT reconstruction comprises two fundamental steps: forward modeling and inversion. The former predicts\nsurface photon density measurements based on an assumed\nfluorescence distribution. At the macroscopic scale, we employ\nthe first-order approximation of the radiative transport equation (RTE), known as the diffusion equation (DE) [32]. The\nexcitation and fluorescence emission processes in continuouswave (CW) mode form a coupled pair of DEs expressed as\n[33], [34]:\n κ ϕx (r) + a ϕx (r) = qx (r),\n\nr , (1)\n\n κ ϕm (r) + a ϕm (r) = η C(r) ϕx (r),\n\nr , (2)\n\nwhere ϕx and ϕm denote the excitation and emission photon\ndensity, qx is the excitation source, C(r) is the fluorophore\nconcentration to be reconstructed in the inversion, and η\ncollects quantum-yield factors in the CW source term. κ\nrepresents the diffusion coefficient, calculated by [33]\n1\n,\n(3)\nκ=\n3 ( a + s )\nwith the absorption coefficient a and the reduced scattering\ncoefficient s . In a non-contact setting of FMT, to calculate\nthe value of ϕ (r) on the object surface as the measurement, a Robin-type boundary condition is added alongside the\nequation pair (1 2):\n ϕ (r)\n= 0, {x, m}, r , (4)\n ν\nwhere ζ(c) is the refractive index mismatch parameter that\naccounts for the light reflection on the boundary surface, with\nc representing the light speed inside the medium. ν denotes\nthe outward normal on the boundary. Notably, to simplified the\nproblem setting, we only consider a homogeneous medium\ncase and the difference of a , s values under different\nwavelengths are neglected.\nϕ (r) + 2 ζ(c) κ\n\nB. Finite Element Discretization and System Matrix Construction\nWe apply the finite element method (FEM) [35] to the\ndiffusion model (1) - (4). Discretizing with a tetrahedral\nN\nmesh of N\ni }i=1 , we approximate\nP nodes and nodal basis {ψP\nϕ (r) i Φ ,i ψi (r) and qx (r) i (Qx )i ψi (r), which\ntransforms the continuous-form equations into a linear system\nfor excitation and emission photon propagation:\nS Φx = Qx\n\n(5)\n\nS Φm = Qm\n\n(6)\n\nwhere S RN N is the system matrix and Φ , Q RN\nare discretized form (coefficient vectors) for ϕ and q , respectively. In particular, the excitation field ϕx interacts with\nfluorophores C RN to produce the emission source term\nQm = C Φx\n\n(7)\n\nwith denoting element-wise multiplication. The equation\n(7) physically describes how fluorophores absorb excitation\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nexplicitly reveals the functional dependence of S on the\noptical parameters a and s , which forms the mathematical\nfoundation for our adaptive optimization approach introduced\nin Subsection II-C.\n\n(b)\n\n(a)\n\n3\n\nCamera\nFilter Wheel\nReal Measurement\nSample\n\nC. INR-based FMT reconstruction: NeuFMT / NeuFMT\nScanners\n\nLaser\nPredicted\nMeasurement\n\nFocal Lens OD Filter\n(c)\n\n(d)\n\nAdaption Module\n\nForward Model\nBased on DE\n\nAbsorption Term\nHigh Absorption\n\nLow Absorption\n\ninv\nDi usion Term\n\nHigh Scattering\n\nSti ness Matrix\n\nLow Scattering\nBoundary Term\n\n(e)\n\nForward Data\nBackward Gradient\n\nFluorescence Distribution Encoded with INR\nNode Coordinate\n\n3D Mesh with\n\nNodes\n\nsine\n\ncosine\n\nPositional\nEncoding\n\nMLP\n\nFig. 1. Conceptual illustration of NeuFMT. (a) The FMT setup: a scanned\nlaser illuminates the sample while a CMOS camera with filter wheel on the\nopposite side records boundary images. The raster scanning method yields\nthe raw 2D image stack M real , serving as the input to the subsequent FMT\nreconstruction. (b) The difference between M real and the simulated meac( a , , Cθ ) is iteratively minimized until an optimized value\nsurement M\ns\nof unknown fluorescence distribution C is found. R(C) is a regularization\nterm and { a , s } is the intrinsic optical properties consisting of\nabsorption coefficient a and scattering coefficient s . (c) A -adaption\nmodule is integrated into the FMT reconstruction. The stiffness matrix S is\ndetermined by both a and s . (d) The FEM-based simulator predicts virtual\nc( a , , Cθ ) based on the operator S 1 ( ) and predicted\nmeasurement M\ns\nfluorescence distribution C. (e) Fluorescence distribution encoded in an INR.\n3D node coordinate serves as input, while a continuous C map is generated\nthrough positional encoding and an MLP network.\n\nUnlike traditional voxel-based or mesh-dependent representations, INR provides a continuous, memory-efficient framework for modeling complex physical fields. The basic variant,\nNeuFMT, learns only the fluorophore Cθ with fixed optical\nproperties; the proposed adaptive NeuFMT jointly optimizes\nthe optical coefficients ( a , s ) with Cθ for enhancing the\nreconstruction accuracy and robustness. In this section, we\ndescribe the NeuFMT representation, formulate the learning\nobjective, introduce optical-property adaptation, and summarize the network architecture and implementation.\n1) INR representation of the unknown fluorescence: Our\n NeuFMT model the 3D fluorescence field as an INR, i.e., a\ncoordinate-conditioned MLP:\n\nCθ (r) = fθ Γ (r) ,\n(10)\nwhere r = (x, y, z) R3 , Γ : Rd is a highdimensional positional encoding of spatial coordinates, and\nfθ : Rd R is an MLP with parameters θ. This INR formulation (10) enables resolution-independent reconstruction and\nnaturally accommodates arbitrary spatial queries without being\nconstrained by the conventional discrete grid structure.\nTo enhance the network s ability to represent high-frequency\ndetails, which is crucial for resolving complex in vivo fluorescence patterns, we apply a sinusoidal positional encoding to\neach coordinate component. Let γ : R R2L be\nγ(p) = sin(20 πp), cos(20 πp), ,\nL 1\n\nsin(2\n\nπp), cos(2\n\nL 1\n\n(11)\n\nπp) ,\n\np {x, y, z},\n\nphotons and re-emit light at longer wavelengths. The emission\nsource Qm then propagates through the same medium to\nproduce the emission photon density Φm , which is finally\ndetected at the boundary, which is computed as\n\nwhere L is the number of frequency bands. The\n 3D position\nis then encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that\nd = 6L. Feeding Γ (r) into fθ enables compact representation\nof both low- and high-frequency variations in Cθ .\n2) Learning objective: We estimate the fluorescence field\nCθ and, in NeuFMT, the optical properties { a , s } by\nminimizing a data-fidelity term plus regularization:\n\nM = P Φm\n\nc( a , , Cθ ) M real 2 + λ R(Cθ ), (12)\nL( a , s , θ) = M\ns\n2\n\n(8)\n\nwhere P represents the transfer function, which maps the\nboundary photon density Φm the measurement data M acquired by the camera. The above linearized forward model\nprovides the physical foundation for the inversion procedure.\nCrucially, the SPD FEM stiffness matrix S( a , s ) \nN N\nR\nin (5) (6) encode the optical properties and boundary\ngeometry, generating from a linear combination of matrices\ncorresponding to distinct physical components [33], [36]\n\n1\n\n Sd + Sb . (9)\nS( a , s ) = c a Sa +\n3( a + s )\nwith Sa , Sd , and Sb the assembled absorption, diffusion, and\nRobin-boundary matrices, respectively. This decomposition\n\nc denotes the boundary measurements, and R(Cθ ) is\nwhere M\na regularization term applied to the fluorescence distribution.\nThe hyperparameter λ controls the regularization strength,\nbalancing data fidelity with sparsity constraints. The training of\n NeuFMT / NeuFMT follows a fully self-supervised paradigm\nthat explicitly integrates the DE-based physical model into\nthe optimization loop. Note that NeuFMT uses fixed optical\nparameters ( a , s ), whereas NeuFMT updates jointly.\n3) Alternating optical-property adaptation: A fundamental\ninnovation of NeuFMT lies in formulating the entire photon propagation process from excitation to emission as an\nend-to-end differentiable map. The forward model follows a\n\n4\n\nPREPRINT VERSION 2025\n\nprecise physical sequence from excitation source to surface\nmeasurements, as described in Subsection II-B:\n\nc( a , s , Cθ ) = P S( a , s ) 1 Cθ S( a , s ) 1 Qx ,\nM\n(13)\nWe optimize the introduced objective L( a , s , θ) in (12),\njointly updating network parameters θ and optical coefficients\n( a , s ). The chain in (13) contains only differentiable operations, including linear solves, elementwise products, and linear\nc is differentiable w.r.t. both Cθ (hence θ)\nprojections. Thus M\n\nand ( a , s ), enabling standard gradient-based training. For\ncompleteness, we state the chain-rule decomposition of the\nloss gradient with respect to ( a , s ). Based on (13), the\ngradient splits into an emission term and an excitation term:\n\nc \n S\n L M\n L\n S 1\n=\nΦm +\nc Φm\n\n{z\n}\n| M\nEmission pathway\n\nc Φm Qm \n L M\n S\nΦx\n S 1\nc Φm Qm Φx\n\n| M\n{z\n}\n\n(14)\n\nExcitation pathway\n\n { a , s }.\nThe only model-specific ingredient of a and s is the\nJacobian of S( a , s ). According to (9), the partial derivatives\nare\n\n S\n1\n= c Sa \nSd ,\n a\n3( a + s )2\n\n S\n1\n=c \nSd .\n(15)\n s\n3( a + s )2\nThis allows a and s to be optimized directly using gradient\ndescent, and then be updated together with θ, bridging the\nlearning process with the underlying physical model.\nTo mitigate potential coupling effects between a and s\nduring optimization, we propose an alternating update strategy,\nwhich periodically updates one optical parameter with the\nother fixed. The alternating framework largely promotes training stability to avoid oscillations with sufficient computational\nefficiency. The complete NeuFMT algorithm is described in\nAlgorithm 1. Overall, the alternating -adaption module ensures that each optical parameter receives dedicated optimization attention while maintaining the physical consistency of\nthe forward model, yielding more accurate FMT reconstruction\nresults even in the presence of mismatch between the initial\nguess and ground truth of the optical properties.\n4) Network architecture and implementation: We adopt\nMLP for the NeuFMT / NeuFMT, comprising 8 fullyconnected layers with 512 hidden units each, followed by\na final layer with 128 units. ReLU activation functions are\nemployed throughout the network. A critical skip connection\nbridges the input Γ (r) to the 4th hidden layer, facilitating\ngradient flow and enhancing the ability to learn fine-grained\ndetails. This architectural choice is particularly suited for FMT\napplications where accurately reconstructing high-contrast targets against complex backgrounds is essential.\nWe implement the NeuFMT / NeuFMT framework with\nPyTorch, leveraging its automatic differentiation capability to\n\ncompute the gradient through both MLP and the physical\nmodel. Adam optimizer is used with the initial learning rates\nof 10 4 for θ update, 10 3 for scattering coefficient and\n10 5 for absorption coefficient. To improve the computational\nefficiency, a learning rate decay is applied for MLP update.\nThese rates are determined empirically to ensure stable convergence. The L1 regularization parameter λ is set to 10 6\nbased on cross validation. The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality,\nwith the entire process completing within 3 30 minutes on\na single NVIDIA RTX 3090 GPU for problems of varying\nscales. The FEM discretization is built on TOAST++ toolkit\n[37], and the FMT simulation is based on a modular software\nplatform STIFT [38] in MATLAB (R2024b, MathWorks, MA,\nUS) using a desktop computer (Intel Core i5-12600 CPU @\n3.30 GHz, 128 GB RAM).\nAlgorithm 1 NeuFMT\nRequire: Real measurements M real , light speed c, stepsizes\nαθ , αa , αs , alternation period T , total iterations K\n1: Initialize θ, a , s ;\n2: Precompute Sa , Sd , Sb , Qx , P\n3: Compute S via (9);\n4: for i = 1 to K do \n5:\nC = fθ Γ (r)\n6:\nSolve Φx RN satisfying S Φx = Qx\n7:\nQm = C Φx\n8:\nSolve Φm RN satisfying S Φm = Qm\nc = P Φm\n9:\nCompute predicted measurements: M\nreal 2\nc\n10:\nCompute loss: L = M M 2 + R(C)\n11:\nUpdate MLP parameters: θ = θ αθ L\n θ\n12:\nif i mod\n T = 0 then\n13:\nif i/T is even then\n L\n14:\nUpdate absorption: a = a αa \na\n15:\nelse\n L\n16:\nUpdate diffusion: s = s αs \n\ns\n17:\nend if\n\n1\n18:\nUpdate S = c a Sa +\nS\n+\nS\nd\nb ;\n3( a + s )\n19:\nend if\n20: end for\n21: Output: fluorescence C, optical parameters a , s\n\nD. FMT System Setup\nWe devised a continuous-wave (CW) FMT system\n(SHMOT) [39], [40] as depicted in Fig. 1 (a), which incorporates a 16-bit CMOS camera (Edge 4.2, PCO, Germany) with\n2048 2048 pixel resolution and a filter wheel (FW102C,\nThorlabs, NJ, US) for selective wavelength detection. A\ntunable laser source (SuperK EXTREME, NKT, Denmark),\nspanning 400-890 nm, provides fluorescence excitation with a\npower density of approximately 2 mW/mm2 at the sample\nplane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube, Germany) mounted aside steers\nthe laser beam to raster-scan either the top or bottom object\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nsurface, enabling switchable reflection-/transmission-mode detection. During experiments, the camera exposure time was\nfixed at 500 ms, with pixel binning applied to improve the\nsignal-to-noise ratio. The acquired raw 2D image data serve\nas supervision target for NeuFMT / NeuFMT reconstruction\n(Fig. 1 (b)). It worth mentioning that our FMT system also\nintegrates a programmable line-scanning illumination, which\nenables high-precision extraction of the surface geometry\nwith approximated maximum error of 0.1 mm. The extracted\nsurface information is then leveraged as prior knowledge for\nFEM meshing and improving reconstruction accuracy.\n\nE. Phantom preparation and optical calibration\nIn our validation, the slab phantomswere cast from silicone (SYLGARDTM 184; DOW, CA, USA) to emulate softtissue matrix. Optical properties were tuned by dispersing\ntitanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon\nblack powder (Colins, Shanghai, China) as scattering and\nabsorbing additives, respectively. In all phantoms, TiO2 and\ncarbon black were uniformly distributed. All the designs\nshown in Fig. 4 (a) used the same TiO2 /carbon-black mixing\nratio, yielding isotropic media with identical absorption and\nscattering parameters.\n\nF. In Vivo Lymph Node FMT Imaging\nFollowing numerical simulations and phantom experiments,\nwe evaluated the proposed method in vivo in a murine lymph\nnode imaging task. In cancer diagnostics, lymph node metastasis is a key prognostic indicator of tumor progression. Fluorescence imaging enables rapid screening of sentinel lymph\nnodes [41].\nIn our experiment, all animal procedures were approved by\nthe Institutional Animal Care and Use Committee of ShanghaiTech University (Approval No. 20211115001). 5 female\nBALB/c mice (8 weeks old) were obtained from Shanghai\nJihui Laboratory Animal Breeding Co. Ltd. and housed under\na circadian rhythm of 12 hours of day and night alternation.\nBefore taking imaging experiments, fur was removed over the\nwhole body. For FMT reconstruction, we assumed an optically\nhomogeneous medium with properties calibrated during the\nexcitation step with ( a = 0.0055 mm 1 , s = 1.1 mm 1 ).\nWe followed a three-stage protocol fluorescent-dye injection, imaging, and ex vivo validation. Prior to FMT imaging, Cy5-saline solution (1.2146 mol mL 1 , 40 L) was injected subcutaneously into the left forepaw to drive lymphatic\ndrainage toward the sentinel lymph nodes and create a highintensity target. Next, follow-up FMT measurements were\nacquired using the system setup in Subsection II-D. Finally,\nafter data collection, ex vivo verification was performed using\na fluorescent stereoscopic microscope (MVX10, Olympus,\nJapan; 6.3 objective). Illumination was provided by a heightadjustable 630 nm LED at 20 mW cm 2 . White-light and\nCy5-channel fluorescence images were recorded using filters\nmatched to the Cy5 spectrum, and the lymph nodes were\nidentified, excised, and imaged to validate the in vivo findings.\n\n5\n\nIII. R ESULTS\nA. Convergence Verification of Optical Property Adaptive\nOptimization\nTo validate our proposed optical property adaptation mechanism, we conducted a series of numerical experiments on\na digital phantom. The primary objective was to demonstrate\nthat the -adaption module can robustly recover absorption a\nand s coefficients from severely erroneous initial estimates,\nthereby enabling high-fidelity fluorescence reconstruction.\nWe constructed a homogeneous digital slab phantom of size\n55 55 15 mm3 featuring an S -shaped fluorescent target at\nits geometric center. The ground-truth optical properties were\n 1\nset to true\nand s true = 1.0 mm 1 . To rigorously\na = 0.1 mm\ntest the correction capability, we initialized the reconstruction\nwith significantly mismatched scattering coefficients ( s init =\n0.5, 1.5, 2.0 mm 1 ) while keeping the absorption coefficient\nfixed at its true value for this specific test.\nAs summarized in Fig. 2 (a), without the -adaption module, the reconstructed fluorescence distributions suffered from\nsubstantial errors in both depth localization and morphological accuracy. The mismatched s value led to an incorrect\nmodel of photon propagation, which directly translated to\ndistorted reconstructions. In contrast, when the -adaption\nmodule was enabled, the proposed NeuFMT successfully\nrecovered fluorescence distributions that closely matched the\nground truth obtained with the correct optical properties.\nCrucially, the evolution of the scattering coefficient during\noptimization, plotted in Fig. 2 (b), demonstrates the module s\nrobust convergence. Regardless of the initial value whether\nhalved or doubled the estimated s reliably converged to the\nneighborhood of the true value (1.0 mm 1 ).\nA similar convergence behavior was observed for the absorption coefficient a . When initialized with biased values\n 1\n( init\n) against a fixed true s , the a = 0.05, 0.15, 0.2 mm\nadaption module corrected a with an average error of only\n1.5% (Fig. 2 (d)), and its convergence curves are shown in\nFig. 2 (e). This convergence robustness was maintained across\na range of true a and s values, confirming the general\nefficacy of our alternating optimization strategy in mitigating\nparameter coupling (Fig. 2 (c), (f)).\nWe further extended the validation to the most challenging\nscenario, where both optical parameters were simultaneously\ninitialized with substantial errors. In this experiment, the initial\nvalues for both a and s were set to 50% higher than\ntheir GT values. Remarkably, even under these highly adverse\nconditions, the -adaption module successfully drove both\nparameters towards their true values. The convergence trajectories remained stable and ultimately reached a neighborhood\nof the true parameter pair. These results collectively verify\nthat the integrated -adaption module empowers NeuFMT\nto jointly recover accurate optical properties and fluorescence\ndistributions even from profoundly inaccurate initial guesses,\neffectively addressing a critical source of ill-posedness in\npractical FMT scenarios.\n\n6\n\nPREPRINT VERSION 2025\n\n0.995\n\n1.0\n\n0.996\n\n1.5\n\n1.007\n\n2.0\n\n1.006\n\nGT\ny\nx\n\nDICE =\n0.0257\n\n0.7337\n\n0.4660\n\nNorm.int (a.u.)\n\n= 1.0\n= 0.1\n\nNon-Adaptive\n\n1\n\n0.3967\n\n(b)\n\n1.2\n1.0\n\n(c)\n\n1.6\n\nAdaptive\n\ny\n\n0.7198\n\n0.7230\n\n0.6964\n\nNorm.int (a.u.)\n\nz\n\n0.7796\n\n 0.9\n 0.8\n 0.5\nAsym.\nLine\n\n0.8\n0.4\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n14\n\n 0.12\n 0.11\n\n1.4\n\nPredicted\n\nz=8\n\n 2.0\n 1.5\n 1.2\n 1.1\n\n1.6\n\n0\n1\n\n2.0\n\nPredicted\n\n0.5\n\n(a)\n\n 0.10\n 0.09\n\n1.2\n\n 0.08\n1.0\n\n0\n\nAsym.\nLine\n1\n\n2\n\n4\n\n8\n\n16\n\n32\n\n64\n\niterations\n0.10\n\n0.100\n\n0.15\n\n0.101\n\n0.20\n\n0.102\n\ny\nx\n\n0.0281\n\n0.7337\n\n0.7390\n\nNorm.int (a.u.)\n\nGT\n\n0.5991\n\nz=8\nz\n\nAdaptive\n\ny\n\n0.6718\n\n0.7642\n\n0.8740\n\n0.8708\n\n(e)\n\n0.2\n\n= 1.0\n= 0.1\n\nGT\n\n 0.11\n 0.09\n\n0.12\n0.1\n0.08\n\n0\n\n0.04\n\n1\n\n(f) 0.16\n0.14\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n 0.08\n 0.05\nAsym.\nLine\n\n14\n\n 1.2\n 1.1\n 1.0\n 0.9\n\n0.12\n\n 0.8\n0.1\n\n0\n\n(g)\n\n 0.20\n 0.15\n 0.12\n\n0.16\n\nNorm.int (a.u.)\n\n= 1.0\n= 0.1\n\nNon-Adaptive\n\n1\n\nPredicted\n\n(d)\n\n0.097\n\nPredicted\n\n0.05\n\nAsym.\nLine\n1\n\n2\n\n4\n\n8\n\n16\n\n32\n\n64\n\niterations\n2000 iters\n\n5000 iters\n\n10000 iters\n\n20000 iters\n1\n\ny\n\n(h)\n\n1.6\n\n0.16\n\n1.4\n\n0.14\n\n1.2\n\n0.12\n\n1.0\n\n0.1\n\n0.8125\n\n0.8651\n\n0.8691\n\nz\ny\n\n= 1.5\n= 0.15\n\n1.333\n0.1332\n\n1.177\n0.1156\n\n1.050\n0.1045\n\n1.001\n0.0995\n\n0\n\n0.8\n\n2\n\n5\n\n8\n\n11\n\n14\n\n17\n\nPredicted\n\n0.6481\n\nNorm.int (a.u.)\n\nz=8\n\nPredicted\n\nx\n\n0.08\n20\n\niterations\n\nFig. 2. Ablation test for the optical-property-adaption ( -adaption) module in NeuFMT. (a-c) Effective test for the correction of s . (a) For a homogeneous\nphantom simulation with a S -shaped fluorescence inclusion, the ground truth (GT) of a and s values are 0.1 mm-1 and 1.0 mm-1 respectively. A\nmismatched initial guess of s was assumed for FMT reconstruction. The -adaption module successfully corrects s with an average error of 0.55%,\nleading to significantly improved FMT reconstruction results compared to non-adaptive NeuFMT. (b) Convergence curve of s given more initial s values\nranging from 0.5 to 2 GT value under the same setting of (a). (c) Convergence curve of s value across all cases with different a values, given\ninitial s = 1.5 mm-1 . (d-f) Effective test for the correction of the absorption coefficient ( a ). (d) For the same phantom in (a), a (mismatched) a initial\nvalue is assumed for FMT reconstruction. The -adaption module successfully corrects a with an average error of 1.5%, leading to significantly improved\nFMT reconstruction results. (e) Convergence curve of a given more initial a values ranging from 0.5 to 2 GT value under the same setting of (d).\n(f) Convergence curve of a value across all cases with different s values, given initial a = 0.15 mm-1 . (g-h) Effective test for the correction of both\nabsorption and diffusion coefficients. (g) For the same phantom in (a), given mismatched initial a = 1.5 and s = 0.15, both of which are 50% higher than\nGT, the -adaption module successfully corrects both a and s at the same time. (h) Convergence curve given the iteration process in (g) for both optical\ncoefficients.\n\nB. Numerical Simulations\nTo comprehensively evaluate the performance of the proposed NeuFMT under controlled conditions, we designed\nfour distinct numerical phantoms (Fig. 3 (a) (d) respectively)\nto systematically increase the reconstruction challenge:\n Case 1 - single small target: a 3 mm-diameter spherical\nfluorescence target embedded in a homogeneous cuboid\nphantom (55 55 15 mm3 ), serving as a baseline\nfor evaluating localization and quantitative accuracy of\na simple, isolated inclusion.\n Case 2 - complex surface geometry: a 2 mm-diameter\nspherical target inside a phantom with a curved surface\ngeometry, featuring a spherical cap top (base: 50 50 4\nmm, cap height = 5 mm, total height = 9 mm). This\ncase tests the method s robustness to non-planar surface\ntopography.\n\nCase 3 - complex target shape: a large peanut-shaped fluorescence region with uniform concentration embedded in\na standard cuboid phantom same as Case 1. This scenario\nassesses the capability to recover intricate morphological\ndetails beyond simple spheres.\n Case 4 - multi-target with background: the same peanutshaped region as in Case 3, but with the addition of\na small, high-concentration spherical target inside. This\nrepresents a highly realistic and challenging condition,\ntesting the ability to resolve targets of different concentrations and shapes against a noisy background.\n\nThe ground-truth optical properties for all simulated measurements in this test were set to a = 0.1 mm 1 and s = 1.0\nmm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against\nfour established methods: conventional Tikhonov-regularized\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nGT\n\nL2-CG\n\nL1-FISTA\n\nU-Net\n\nNeuFMT\n\nμNeuFMT\n1\n\ny\nx\n\ny\n\nz\n\nDICE =\n0.6581\n\nz=8\n\n0.4956\n\n0.6446\n\nNorm.int (a.u.)\n\nCase 1\n\n(a)\n\n0.8800\n\n0.5128\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.6286\n\nz=2\n\n0.7500\n\n0.0000\n\nNorm.int (a.u.)\n\nCase 2\n\n(b)\n\n1\n\n0.7586\n\n0.2041\n\n0\nz\n\ny\nx\n\nx\n\ny\n\nz\n\nz=8\n\n0.6938\n\n0.0828\n\n0.6153\n\nNorm.int (a.u.)\n\nCase 3\n\n(c)\n\n1\n\ny\n\n0.9751\n\n0.4766\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.5435\n\nz=8\n\n0.5908\n\n0.2637\n\nNorm.int (a.u.)\n\nCase 4\n\n(d)\n\n1\n\n0.8983\n\n0.7645\n\n0\nz\n\ny\nx\n\nNorm.int (a.u.)\n\n(e)\n\nCase 1\n\nCase 2\n\nCase 3\n\nCase 4\n\n1\n\n1\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.8\n\n0.8\n\n0.6\n\n0.6\n\n0.6\n\n0.6\n\n0.4\n\n0.4\n\n0.4\n\n0.4\n\n0.2\n\n0.2\n\n0.2\n\n0\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n0\n15\n\n0\n20\n\n25\n\n30\n\nmm\n\nGT\n\nL2-CG\n\n35\n\n0.2\n0\n\n10\n\nmm\n\nL1-FISTA\n\n20\n\n30\n\n40\n\n50\n\n0\n\n15\n\n20\n\n25\n\n30\n\n35\n\nmm\n\nU-Net\n\nNeuFMT\n\n40\n\nmm\n\nμNeuFMT\n\nFig. 3. Results of numerical phantom simulations. (a) (d) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (e) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.\n\nconjugate gradients (L2 -CG) [42] and L1 -regularized nonnegative least squares (L1 -FISTA) [43], a pretrained supervised U-Net, and our baseline method NeuFMT without adaption. The U-Net was trained on a large, synthetically\ngenerated dataset of 5,488 samples. For each sample, the\ninput was a boundary measurement simulated using the DEbased forward model under the ground-truth properties in a\ncuboid phantom (55 55 15 mm3 ), and the label was the\ncorresponding 3D fluorescence map of 1 2 ellipsoids with\nrandom sizes and spatial positions. To clearly demonstrate the\neffect of the -adaption module, we focused on adapting s\nwhile fixing a at its true value during reconstruction. For all\nmethods, the initial s was set to an erroneous value of 1.2\nmm 1 , which is 20% higher than the ground truth.\nThe results presented in Fig. 3 (a) (d) demonstrate the\nconsistent superiority of NeuFMT across all four numerical cases. We observe that the conventional methods were\nadversely affected by the optical property mismatch: L2 -CG\nreconstructions were characteristically blurred and exhibited\nsignificant depth errors, such as full-depth penetration in\nCases 3 and 4 and depth-wise expansion in Case 1. L1 -FISTA\nfrequently introduced non-physical, fragmented artifacts, such\nas staircase patterns in Case 1 and hollow structures in Case 3,\nwhile it also suffered from severe depth inaccuracy. The\nsupervised U-Net, though performed well in Case 1, showed\nlimited generalization beyond its training data, as seen in its\nlocalization failure in the complex surface geometry of Case 2\n\n7\n\nand noticeable shape distortion in the unseen peanut-shaped\ntarget of Case 3 and 4. The direct NeuFMT provided better\ndepth prediction than the traditional methods but remained\nsensitive to the erroneous s , resulting in substantial shape\nexpansion in the x-y plane (Cases 1, 2) and axial splitting\n(Case 3). In contrast, NeuFMT successfully rectified the\noptical properties and overcame these limitations. It achieved\nthe most accurate spatial localization and shape fidelity, as\nevidenced by its 3D isosurfaces tightly conforming to the\nground truth in both simple and complex targets, and it clearly\nresolved both the small target and the complex background in\nCase 4. Quantitatively, NeuFMT consistently achieved the\nhighest Dice coefficients, and its intensity profiles (Fig. 3 (e))\nmost closely matched the ground truth in terms of peak\nlocation, width, and background suppression.\nC. Phantom Experiments\nWe further evaluated the performance of all methods using\nphysical phantom experiments to assess their practicality under real-world conditions, including measurement noise. The\nphantoms were fabricated from silicone, with their optical\nproperties calibrated to be approximately a = 0.0055 mm 1\nand s = 1.1 mm 1 at 680 nm. Fluorescent targets were embedded within the phantoms to create the four cases previously\ndefined in the simulations. The initial value of s was set identically for all reconstruction methods as the calibrated value,\nand also the U-Net was retrained accordingly. Consistent with\nthe simulation study, we focused on the adaptive recovery of\nthe reduced scattering coefficient s .\nThe reconstruction results are summarized in Fig. 4. Under\nthese challenging real-world conditions, the limitations of the\nbaseline methods became evident: conventional approaches\n(L2 -CG, L1 -FISTA) produced blurry or fragmented reconstructions with significant depth errors, while the supervised\nU-Net, susceptible to domain shift and noise, failed to generalize, resulting in complete localization failures (Case 1)\nor severely distorted shapes (Cases 3 and 4). In contrast,\nthe INR-based frameworks, NeuFMT and NeuFMT, demonstrated markedly superior robustness, consistently yielding\nphysically plausible and continuous reconstructions where\nother methods failed. A detailed comparison between the two\nreveals that NeuFMT provided critical refinements toward\nenhanced physical consistency. In Cases 1 and 3, NeuFMT\nachieved better depth sensitivity and more uniform fluorophore\ndistribution, more faithfully representing the homogeneous\nnature of the true targets. In the complex geometry of Case 2,\nit uniquely achieved accurate localization, whereas direct\nNeuFMT produced a solution with an aberrant depth shift. For\nthe multi-target scenario in Case 4, NeuFMT reconstructed\nthe background region with improved morphological accuracy.\nAlthough the performance gap in quantitative metrics such\nas the Dice coefficient was occasionally narrow, which reflects the inherent robustness of the shared INR architecture,\n NeuFMT provided consistent, subtle refinements, particularly\nin depth accuracy. The phantom experiments confirm that the\nadaptive physical correction mechanism in NeuFMT can enhance reconstruction fidelity under practical conditions where\nthe exact coefficient in most real experiments is uncertain.\n\n8\n\nPREPRINT VERSION 2025\n\n(a)\n\nSilicone Phantoms\nGT\n\nL2-CG\n\nL1-FISTA\n\nU-Net\n\nNeuFMT\n\nμNeuFMT\n1\n\ny\nx\n\ny\n\nz\n\nDICE =\n0.5895\n\nz=8\n\n0.6154\n\n0.0762\n\nNorm.int (a.u.)\n\nCase 1\n\n(b)\n\nFluorescence Inclusions\n\n0.7023\n\n0.6615\n\n0\nz\n\n(Fig. 5 (c)). The reconstructed target lengths from NeuFMT\nshowed the closest agreement with the physical measurements\ntaken from the ex vivo lymph nodes, as visualized by the\nintensity profiles in Fig. 5 (c). These results demonstrate that\n NeuFMT provides a definitive advantage in practical in vivo\nscenarios, enabling robust and accurate target segmentation\nand localization under complex clinically related scenarios,\nsuch as fluorescence guided surgery.\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.3371\n\nz=2\n\n0.3810\n\n0.4000\n\n0.5200\n\n0.2586\n\nWhite Light Image\n\n(a)\n\nvein\n\nLN-2\n\n0\nz\n\ny\nx\n\ny\n\nz\n\nz=8\n\n0.5413\n\n0.3358\n\n0.7011\n\n0.8230\n\n0.8050\n\n0\nz\n\ny\nx\n\ny\nx\n\ny\n\nz\n\n0.5193\n\nz=8\n\n0.4319\n\n0.6601\n\n0.2849\n\nNorm.int (a.u.)\n\n0.6240\n\nNeuFMT\n\nμNeuFMT\nz\nx\n\nvein\n\nLN-3\nLN-2\nLN-1\n\nCase 3\n\nCase 4\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.6\n\n0.6\n\n0.6\n\n0.6\n\n0.4\n\n0.4\n\n0.4\n\n0.4\n\n0.2\n\n0.2\n20\n\n25\n\n30\n\n35\n\n40\n\n0\n15\n\n0.2\n20\n\n25\n\n30\n\nmm\n\nGT\n\nL2-CG\n\n35\n\n0.2\n\n0\n\n0\n0\n\n10\n\nmm\n\nL1-FISTA\n\n20\n\n30\n\n40\n\n50\n\n15\n\n20\n\n25\n\n30\n\n35\n\nmm\n\nU-Net\n\nNeuFMT\n\n40\n\nmm\n\nNeuFMT-Ada\n\nFig. 4. Results of real phantom experiments. (a) Photograph of the real\nsilicone phantoms and fluorescence inclusions. (b) (e) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (f) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.\n\n10 mm\n\n(c)\n\nWe performed an in vivo imaging experiment on mice.\nFollowing the protocol described in Subsection II-F, Cy5\nfluorescent dye accumulated primarily at the sentinel lymph\nnodes (LN), with some residual signal at the vein (Fig. 5 (a)).\nOur task was to reconstruct the spatial location and shape of\nthe sentinel lymph nodes.\nThe 3D FMT reconstruction results from all methods\nare presented in Fig. 5 (b). The conventional L2 -CG method\nproduced a reconstruction where the volume of LN-3 was\noverestimated, and the signals from LN-1, LN-2, and the vein\nmerged into a single, indistinguishable cluster. The L1 -FISTA\nreconstruction was highly fragmented, making it impossible\nto discern the shape or count of the lymph nodes accurately.\nAlso, the baseline NeuFMT failed to produce a physiologically plausible reconstruction. In contrast, NeuFMT was\nthe only method that successfully and distinctly resolved all\nthree lymph nodes (LN-1, LN-2, LN-3) and the vein, clearly\nidentifying each as separate, localized regions of fluorescence.\nFor quantitative validation, the mouse was sacrificed, and\nthe lymph nodes were excised to be imaged by ex vivo FRI\n\nLN-1\n\nx\ny\n\nLN-3 LN-2\n\n10 mm\n\n0\n\n1\n\n1\n\n1\n\n0.8\n\n0.8\n\n0.8\n\n0.6\n\nLN-1\n\n0.4\n\n0.6\n\nLN-2\n\n0.4\n\n0.2\n\n0.6\n\n0.2\n\n0\n2\n\n4\n\n6\n\nL2-CG\n\n8\n\n10\n\n12\nmm\n\nLN-3\n\n0.4\n\n0.2\n\n0\n0\n\nD. In Vivo Lymph Node FMT Imaging Experiments\n\nConcentration of Cy5 (a.u.)\n\nCase 2\n1\n0.8\n\nSlice z = 8 mm\n\nCase 1\n1\n0.8\n\nx\ny\n\nSlice z = 11 mm\n\n(f)\nNorm.int (a.u.)\n\nL1-FISTA\n\nR\n\n1\n\nProfiles\n\ny\nx\n\n15\n\nL2-CG\n\nLN-3\n\nL\n\n0\nz\n\n0\n\nR\n\ny\n\nConcentration of Cy5 (a.u.)\n\nCase 4\n\n(e)\n\n1\n\n(b)\n\nLN-1\n\nL\n\n3D Segmentation\n\nx\n\nNorm.int (a.u.)\n\nCase 3\n\n(d)\n\n1\n\ny\n\nIn vivo FRI\n\nNorm.int (a.u.)\n\nCase 2\n\n(c)\n\n1\n\n0\n0\n\n2\n\nL1-FISTA\n\n4\n\n6\n\n8\n\n10\n\n12\nmm\n\n0\n\n2\n\nNeuFMT\n\n4\n\n6\n\n8\n\n10\n\n12\nmm\n\nμNeuFMT\n\nFig. 5. In vivo lymph node FMT imaging and reconstruction results. (a) The\nwhite-light image and preview via 2D fluorescence reflectance imaging (FRI)\noverlaid on the white-light image with the red aera indicating the concentrated\ndistribution of Cy5 probe on the cites of three lymph nodes (LN-1, LN-2, LN3) and the vein. (b) Comparison of FMT reconstruction results from different\nmethods. The 3D segmentation, along with two slices at z = 8 and 11 mm,\nare displayed. (c) Intensity profiles along the dashed lines in b. are compared\nfor each ex vivo images of lymph nodes after sacrificing the animal. The gray\nzone represents the estimated size of LN, based on the ex vivo fluorescence\nimages.\n\nIV. D ISCUSSION AND C ONCLUSION\nIn this study, we introduced NeuFMT, an optical-propertyadaptive FMT reconstruction framework that integrates INR\nwith an explicitly differentiable FEM-based light propagation model. By unifying a continuous fluorescence field parameterized by an INR and a physics-based forward model\namenable to end-to-end optimization, NeuFMT addresses\ntwo fundamental limitations of existing FMT reconstruction\ntechniques: their inability to efficiently adapt to complex and\nheterogeneous fluorescence distribution, and their reliance on\n\nZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION\n\nfixed, often inaccurate, optical properties, which significantly\nexacerbates the inherent ill-posedness of the inverse problem.\nUnlike supervised deep learning approaches which are constrained by the diversity and scale of training datasets and\noften fail under domain shift, NeuFMT operates in a selfsupervised, physics-informed regime. It does not require paired\ntraining data; instead, it directly minimizes the discrepancy between measured and simulated boundary fluxes. This not only\neliminates the need for extensive experimental datasets but also\nensures generalizability across different imaging geometries\nand target configurations. The continuous, coordinate-based\nrepresentation provided by the INR further ensures that our\nreconstructions are free from discretization artifacts and inherently resolution-agnostic.\nA central contribution of our work is the introduction of\nan optical property adaptation mechanism, which enables the\ndynamic optimization of absorption and scattering coefficients\n( a , s ) concurrently with the fluorescence distribution. Our\nframework demonstrates that the integration of a differentiable\nphysics-based forward model is the key to enabling this\nself-supervised adaptation. The FEM-based light propagation\nmodel is not merely a component of the loss function, but\nan active and adaptive part of the inverse solver. This stands\nin contrast to both traditional iterative methods, which hold\noptical properties static and thus aggravate the problem s illposedness, and conventional end-to-end deep learning approaches, which struggle to generalize beyond their training\ndata. The adaptivity of our model is thus its core strength,\nproviding a principled way to refine the physical model itself\nbased on the measured data, which is crucial for practical\napplications where precise prior knowledge of tissue optics\nis unavailable.\nOur results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate\nthat NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1 ) and deep learningbased (U-Net) benchmarks. In particular, the method consistently localized fluorescent targets with higher spatial accuracy, improved contrast, and more realistic morphological\nfeatures especially under challenging conditions involving\nbackground fluorescence and complex geometry.\nDespite these promising results, several aspects of\n NeuFMT merit further investigation. First, the current implementation assumes a homogeneous optical background a\ncommon simplification in FMT studies. Extending the model\nto incorporate spatially varying optical properties represents\na logical next step, potentially by representing a (r) and\n s (r) with additional INRs, though this would significantly\nincrease the complexity of the inverse problem. Nevertheless,\nthe proposed NeuFMT can be validated or even combined\nwith time-domain near-infrared spectroscopy (fNIRS) [44],\n[45] or diffuse optical tomography (DOT) [46] techniques,\nwhere the complex optical properties related with absorption\nand scattering can disentangled and calibrated. More importantly, the integration of NeuFMT with emerging imaging\ntechnologies holds particular promise. The inherent adaptivity\nof our framework is well-suited to the distinct scattering\nand absorption landscapes of NIR-II fluorescence tomography\n\n9\n\n[47], [48], where our optical property optimization could be\ncrucial for accurately modeling the increased photon penetration and achieving higher-resolution reconstruction at depth.\nFurthermore, the framework can be naturally extended to\nhyperspectral FMT, using a single INR to output both fluorophore concentration and spectral signature, thereby disentangling multiple probes or accounting for wavelength-dependent\noptical properties. Finally, translating NeuFMT into clinical\nsettings, such as intraoperative fluorescence-guided surgery\n[8], [9], represents an exciting frontier where its adaptability\ncould overcome patient-specific variations in tissue optics.\nIn conclusion, by harmonizing a differentiable physics\nmodel with a continuous INR, NeuFMT provides a robust,\nself-supervised, and adaptive framework for FMT reconstruction. It effectively mitigates the ill-posedness inherent to\ninverse problems with uncertain parameters, setting a new\nparadigm for practical, high-resolution fluorescence molecular\nimaging. We believe this physics-in-the-loop INR approach\noffers a generalizable template for tackling a wide range of\ntomographic and inverse problems in biomedical imaging.\nR EFERENCES\n[1] F. Song, P. Zhang, H. Wu, C. Ma, Z. Liu, R. Cai, Y. Feng, Y. He,\nX. Dong, Y. Tian, and G. Zhang, Advances of fluorescence molecular\nimaging: NIR-II window, probes, and tomography, Laser & Photonics\nReviews, vol. 19, no. 10, p. 2400275, 2025.\n[2] B. Zhu, J. Hendricks, J. E. Morton, J. C. Rasmussen, C. Janssen,\nM. N. Shah, and E. M. Sevick-Muraca, Near-infrared fluorescence\ntomography and imaging of ventricular cerebrospinal fluid flow and\nextracranial outflow in non-human primates, IEEE Transactions on\nMedical Imaging, vol. 42, no. 12, pp. 3555 3565, 2023.\n[3] M. S. Ozturk and et al., High-resolution tomographic analysis of in\nvitro 3D glioblastoma tumor model under long-term drug treatment, \nScience Advances, vol. 6, no. 10, p. eaay7513, 2020.\n[4] M. Cai, Z. Zhang, X. Shi, Z. Hu, and J. Tian, NIR-II/NIR-I fluorescence molecular tomography of heterogeneous mice based on gaussian\nweighted neighborhood fused lasso method, IEEE Transactions on\nMedical Imaging, vol. 39, no. 6, pp. 2213 2222, 2020.\n[5] S. R. Arridge and J. C. Schotland, Optical tomography: forward and\ninverse problems, Inverse problems, vol. 25, no. 12, p. 123010, 2009.\n[6] L. V. Wang and H.-i. Wu, Biomedical optics: principles and imaging.\nJohn Wiley & Sons, 2007.\n[7] F. Stuker, J. Ripoll, and M. Rudin, Fluorescence molecular tomography:\nprinciples and potential for pharmaceutical research, Pharmaceutics,\nvol. 3, no. 2, pp. 229 274, 2011.\n[8] J. S. D. Mieog, F. B. Achterberg, A. Zlitni, M. Hutteman, J. Burggraaf,\nR.-J. Swijnenburg, S. Gioux, and A. L. Vahrmeijer, Fundamentals and\ndevelopments in fluorescence-guided cancer surgery, Nature Reviews\nClinical Oncology, vol. 19, no. 1, pp. 9 22, 2022.\n[9] K. Wang, Y. Du, Z. Zhang, K. He, Z. Cheng, L. Yin, D. Dong, C. Li,\nW. Li, Z. Hu et al., Fluorescence image-guided tumour surgery, Nature\nReviews Bioengineering, vol. 1, no. 3, pp. 161 179, 2023.\n[10] D. Zhu et al., Comparison of regularization methods in fluorescence\nmolecular tomography, Photonics, vol. 1, no. 2, pp. 95 109, 2014.\n[11] H. Yi et al., Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography:\na comparative study, Journal of Biomedical Optics, vol. 18, no. 5, p.\n56013, 2013.\n[12] J. Shi, B. Zhang, F. Liu, J. Luo, and J. Bai, Efficient L1 regularizationbased reconstruction for fluorescent molecular tomography using\nrestarted nonlinear conjugate gradient, Optics letters, vol. 38, no. 18,\npp. 3696 3699, 2013.\n[13] D. Zhu and C. Li, Nonconvex regularizations in fluorescence molecular\ntomography for sparsity enhancement, Physics in Medicine & Biology,\nvol. 59, no. 12, p. 2901, 2014.\n[14] J. Zhang, L. Li, Q. Hu, J. Zhang, Y. Wu, L. Gu, J. Li, F. Li, X. Zhu,\nJ. Jiang et al., High-fidelity solution decomposition fluorescence tomography in the presence of background interference, Laser & Photonics\nReviews, p. e01013, 2025.\n\n10\n\n[15] C. Huang, H. Meng, Y. Gao, S. Jiang, K. Wang, and J. Tian, Fast and\nrobust reconstruction method for fluorescence molecular tomography\nbased on deep neural network, in Imaging, Manipulation, and Analysis\nof Biomolecules, Cells, and Tissues XVII, vol. 10881. SPIE, 2019, pp.\n257 262.\n[16] L. Guo, F. Liu, C. Cai, J. Liu, and G. Zhang, 3D deep encoder decoder\nnetwork for fluorescence molecular tomography, Optics letters, vol. 44,\nno. 8, pp. 1892 1895, 2019.\n[17] P. Zhang, G. Fan, T. Xing, F. Song, and G. Zhang, UHR-DeepFMT:\nultra-high spatial resolution reconstruction of fluorescence molecular\ntomography based on 3-d fusion dual-sampling deep neural network, \nIEEE Transactions on Medical Imaging, vol. 40, no. 11, pp. 3217 3228,\n2021.\n[18] J. Cheng, P. Zhang, F. Liu, J. Liu, H. Hui, J. Tian, and J. Luo, Encoderdecoder deep learning network for simultaneous reconstruction of fluorescence yield and lifetime distributions, Biomedical Optics Express,\nvol. 13, no. 9, pp. 4693 4705, 2022.\n[19] P. Zhang, C. Ma, F. Song, Z. Liu, Y. Feng, Y. Sun, Y. He,\nF. Liu, D. Wang, and G. Zhang, Multi-branch attention prior based\nparameterized generative adversarial network for fast and accurate\nlimited-projection reconstruction in fluorescence molecular tomography, Biomedical Optics Express, vol. 13, no. 10, pp. 5327 5343, 2022.\n[20] P. Zhang, F. Song, C. Ma, Z. Liu, H. Wu, Y. Sun, Y. Feng, Y. He, and\nG. Zhang, Robust reconstruction of fluorescence molecular tomography\nbased on adaptive adversarial learning strategy, Physics in Medicine &\nBiology, vol. 68, no. 4, p. 04LT01, 2023.\n[21] P. Zhang, X. Liu, Q. Xue, Y. Shang, C. Liu, R. Chen, H. Gao, J. Liang,\nW. Wang, and G. Zhang, PAH2T-Former: Paired-attention hybrid\nhierarchical transformer for synergistically enhanced fmt reconstruction\nquality and efficiency, IEEE Transactions on Computational Imaging,\n2025.\n[22] H. Meng, Y. Gao, X. Yang, K. Wang, and J. Tian, K-nearest neighbor\nbased locally connected network for fast morphological reconstruction\nin fluorescence molecular tomography, IEEE transactions on medical\nimaging, vol. 39, no. 10, pp. 3019 3028, 2020.\n[23] D. Li, C. Chen, J. Li, and Q. Yan, Reconstruction of fluorescence\nmolecular tomography based on graph convolution networks, Journal\nof Optics, vol. 22, no. 4, p. 045602, 2020.\n[24] Y. Wang, C. Bian, Y. An, H. Wang, Q. Liang, Y. Du, and J. Tian,\n Graph convolution based residual connected network for morphological reconstruction in fluorescence molecular tomography, in Medical\nImaging 2022: Biomedical Applications in Molecular, Structural, and\nFunctional Imaging, vol. 12036. SPIE, 2022, pp. 527 533.\n[25] Y. Sun, J. Liu, M. Xie, B. Wohlberg, and U. S. Kamilov, Coil:\nCoordinate-based internal learning for tomographic imaging, IEEE\nTransactions on Computational Imaging, vol. 7, pp. 1400 1412, 2021.\n[26] L. Lozenski, M. A. Anastasio, and U. Villa, A memory-efficient selfsupervised dynamic image reconstruction method using neural fields, \nIEEE Transactions on Computational Imaging, vol. 8, pp. 879 892,\n2022.\n[27] A. W. Reed, H. Kim, R. Anirudh, K. A. Mohan, K. Champley, J. Kang,\nand S. Jayasuriya, Dynamic CT reconstruction from limited views\nwith implicit neural representations and parametric motion fields, in\nProceedings of the IEEE/CVF International Conference on Computer\nVision, 2021, pp. 2258 2268.\n[28] L. Shen, J. Pauly, and L. Xing, NeRP: implicit neural representation\nlearning with prior embedding for sparsely sampled image reconstruction, IEEE Transactions on Neural Networks and Learning Systems,\nvol. 35, no. 1, pp. 770 782, 2022.\n[29] R. Liu, Y. Sun, J. Zhu, L. Tian, and U. S. Kamilov, Recovery\nof continuous 3D refractive index maps from discrete intensity-only\nmeasurements using neural fields, Nature Machine Intelligence, vol. 4,\nno. 9, pp. 781 791, 2022.\n[30] S. Shen, L. Li, S. Gao, Y. Wang, L. Gu, S. Li, X. Zhu, J. Jiang, J. Yu, and\nW. Ren, High resolution diffuse optical tomography via neural fields, \nIEEE Transactions on Computational Imaging, 2024.\n[31] K. Han, C. Li, A. Xiao, Y. Tian, J. Tian, and Z. Hu, TSPE: Reconstruction of multi-morphological tumors of NIR-II fluorescence molecular\ntomography based on positional encoding, Computer Methods and\nPrograms in Biomedicine, vol. 261, p. 108554, 2025.\n[32] S. R. Arridge, Optical tomography in medical imaging, Inverse problems, vol. 15, no. 2, p. R41, 1999.\n[33] , Photon-measurement density functions. part I: Analytical forms, \nApplied Optics, vol. 34, no. 31, pp. 7395 7409, 1995.\n[34] S. R. Arridge and M. Schweiger, Photon-measurement density functions. part 2: Finite-element-method calculations, Applied Optics,\nvol. 34, no. 34, pp. 8026 8037, 1995.\n\nPREPRINT VERSION 2025\n\n[35] O. C. Zienkiewicz, R. L. Taylor, P. Nithiarasu, and J. Zhu, The finite\nelement method. Elsevier, 1977, vol. 3.\n[36] V. Ntziachristos, C. Bremer, and R. Weissleder, Fluorescence molecular\ntomography resolves protease activity in vivo, Nature Medicine, vol. 8,\nno. 7, pp. 757 760, 2002.\n[37] M. Schweiger and S. Arridge, The Toast++ software suite for forward\nand inverse modeling in optical tomography, Journal of biomedical\noptics, vol. 19, no. 4, pp. 040 801 040 801, 2014.\n[38] W. Ren, H. Isler, M. Wolf, J. Ripoll, and M. Rudin, Smart toolkit\nfor fluorescence tomography: simulation, reconstruction, and validation, \nIEEE Transactions on Biomedical Engineering, vol. 67, no. 1, pp. 16 \n26, 2019.\n[39] S. Gao, J. Zhang, Y. Hu, Y. Wu, L. Li, Q. Hu, X. Lou, X. Zhu, J. Jiang,\nand W. Ren, Multifunctional optical tomography system with highfidelity surface extraction based on a single programmable scanner and\nunified pinhole modeling, IEEE Transactions on Biomedical Engineering, 2023.\n[40] Y. Hu, Y. Wu, L. Li, L. Gu, X. Zhu, J. Jiang, and W. Ren, Simultaneous\nreconstruction of 3D fluorescence distribution and object surface using\nstructured light illumination and dual-camera detection, Optics Express,\nvol. 32, no. 9, pp. 15 760 15 773, 2024.\n[41] C. Ji, M. Zhao, C. Wang, R. Liu, S. Zhu, X. Dong, C. Su, and Z. Gu,\n Biocompatible tantalum nanoparticles as radiosensitizers for enhancing\ntherapy efficacy in primary tumor and metastatic sentinel lymph nodes, \nACS nano, vol. 16, no. 6, pp. 9428 9441, 2022.\n[42] S. Kawata and O. Nalcioglu, Constrained iterative reconstruction by\nthe conjugate gradient method, IEEE Transactions on Medical Imaging,\nvol. 4, no. 2, pp. 65 71, 1985.\n[43] A. Beck and M. Teboulle, A fast iterative shrinkage-thresholding algorithm for linear inverse problems, SIAM Journal on Imaging Sciences,\nvol. 2, no. 1, pp. 183 202, 2009.\n[44] Y. Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared\nspectroscopy and imaging: a review, Applied Sciences, vol. 9, no. 6, p.\n1127, 2019.\n[45] H. Y. Ban, G. M. Barrett, A. Borisevich, A. Chaturvedi, J. L. Dahle,\nH. Dehghani, J. Dubois, R. M. Field, V. Gopalakrishnan, A. Gundran\net al., Kernel flow: a high channel count scalable time-domain functional near-infrared spectroscopy system, Journal of biomedical optics,\nvol. 27, no. 7, p. 074710, 2022.\n[46] A. Pifferi, D. Contini, A. D. Mora, A. Farina, L. Spinelli, and A. Torricelli, New frontiers in time-domain diffuse optics, a review, Journal\nof Biomedical Optics, vol. 21, no. 9, pp. 091 310 091 310, 2016.\n[47] F. Wang, Y. Zhong, O. Bruns, Y. Liang, and H. Dai, In vivo NIRII fluorescence imaging for biology and medicine, Nature Photonics,\nvol. 18, no. 6, pp. 535 547, 2024.\n[48] Z. Zhang, Y. Du, X. Shi, K. Wang, Q. Qu, Q. Liang, X. Ma, K. He,\nC. Chi, J. Tang et al., NIR-II light in clinical oncology: opportunities\nand challenges, Nature Reviews Clinical Oncology, vol. 21, no. 6, pp.\n449 467, 2024."]}
{"method": "hybrid", "num_chunks": 829, "avg_chunk_len": 69.41013268998793, "std_chunk_len": 147.08554478528254, "max_chunk_len": 848, "min_chunk_len": 1, "total_chars": 57541, "compression_ratio": 1.0241393093620201, "chunks": ["PREPRINT VERSION 2025", "1", "NeuFMT: Optical-Property-Adaptive Fluorescence\nMolecular Tomography via Implicit\nNeural Representation", "arXiv:2511.04510v1 [eess.IV] 6 Nov 2025", "Shihan Zhao, Jianru Zhang, Yanan Wu, Linlin Li, Siyuan Shen, Xingjun Zhu, Guoyan Zheng, Member IEEE,\nJiahua Jiang, and Wuwei Ren", "Abstract Fluorescence Molecular Tomography (FMT) is a\npromising technique for non-invasive 3D visualization of fluorescent probes, but its reconstruction remains challenging due to\nthe inherent ill-posedness and reliance on inaccurate or oftenunknown tissue optical properties. While deep learning methods\nhave shown promise, their supervised nature limits generalization\nbeyond training data. To address these problems, we propose\n NeuFMT, a self-supervised FMT reconstruction framework that\nintegrates implicit neural-based scene representation with explicit\nphysical modeling of photon propagation.", "Its key innovation lies\nin jointly optimize both the fluorescence distribution and the\noptical properties ( ) during reconstruction, eliminating the need\nfor precise prior knowledge of tissue optics or pre-conditioned\ntraining data. We demonstrate that NeuFMT robustly recovers\naccurate fluorophore distributions and optical coefficients even\nwith severely erroneous initial values (0. 5 to 2 of ground\ntruth).", "Extensive numerical, phantom, and in vivo validations\nshow that NeuFMT outperforms conventional and supervised\ndeep learning approaches across diverse heterogeneous scenarios. Our work establishes a new paradigm for robust and accurate\nFMT reconstruction, paving the way for more reliable molecular\nimaging in complex clinically related scenarios, such as fluorescence guided surgery. Index Terms fluorescence molecular tomography, image reconstruction, optical properties, implicit neural representation,\nfluorescence guided surgery", "The work was supported by Science and Technology Commission of Shanghai Municipality under Grant 25JS2830300 (Wuwei Ren), National Natural\nScience Foundation of China under Grants 62105205 (Wuwei Ren), and\nShanghai Clinical Research and Trial Center (Wuwei Ren). (Corresponding\nauthor: Wuwei Ren. )\nShihan Zhao and Jianru Zhang contributed equally to this work.", "Shihan Zhao, Yanan Wu, Linlin Li and Siyuan Shen are with\nthe School of Information Science and Technology, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: zhaoshh, wuyn1, lill,\nshensy2023@shanghaitech. edu. cn).", "Jianru Zhang and Jiahua Jiang are with the School of Mathematics,\nUniversity of Birmingham, Edgbaston, B15 2QN, United Kingdom (e-mail:\njxz389@student. bham. ac.", "uk; j. jiang. 3@bham.", "ac. uk). Xingjun Zhu is with the School of Physical Science and Technology, ShanghaiTech University, Shanghai 201210, China (e-mail:\nzhuxj1@shanghaitech.", "edu. cn). Guoyan Zheng is with the Institute of Medical Robotics, School of\nBiomedical Engineering, Shanghai Jiao Tong University, Shanghai 200240,\nChina (e-mail: guoyan.", "zheng@sjtu. edu. cn)\nWuwei Ren is with the School of Information Science and Technology,\nShanghaiTech University, Shanghai 201210, China, and also with State\nKey Laboratory of Advanced Medical Materials and Devices, ShanghaiTech\nUniversity, Shanghai 201210, China (e-mail: renww@shanghaitech.", "edu. cn).", "I. INTRODUCTION\nFluorescence Molecular Tomography (FMT) has emerged\nas a promising molecular imaging modality, enabling noninvasive 3D visualization of fluorescent probe distribution\nin highly turbid media [1]. Owning to its high sensitivity,\ncost-effectiveness, and non-ionizing radiation, FMT has found\nbroad applications in preclinical research and clinical practice, e.", "g. , brain imaging [2], in vitro cell culture monitoring\n[3] and tumor detection [4]. FMT reconstructs the internal\nfluorescence distribution by measuring the photon distribution\non the object surface and minimizing the discrepancy between\nreal measurements and the simulated results.", "A canonic framework of FMT reconstruction employs an iterative optimization\nstrategy with a forward model typically based on the\nRadiation Transfer Equation (RTE) or the diffusion equation\n(DE) and an inverse model that refines fluorescence distribution prediction until convergence [5], [6]. However, FMT\nreconstruction is inherently ill-posed due to insufficient surface measurements and strong photon scattering effect within\ntissues. Development of high-precision FMT reconstruction\nalgorithms is highly attractive for further improvement of\nthe spatial resolution and detection depth of this technology,\nwhich ultimately broaden the biological applications in drug\ndiscovery [7] and clinical use such as fluorescence guided\nsurgery [8], [9].", "To address the ill-posed nature of FMT reconstruction,\nregularization techniques that incorporate prior knowledge are\napplied. Conventional approaches include Tikhonov (L2 norm)\nregularization for smoothing the results [10], [11], and sparsepromoting regularization (L1 , Lp norm) or total variation (TV)\nregularization for enhancing the spatial resolution [12], [13]. Recent advancements in regularization techniques, such as\nthe solution-decomposition algorithm, utilize an advanced\nstochastic prior model that improves the differentiation of\nfluorescence targets from background interference, thereby\nenhancing reconstruction quality [14].", "While these methods\nstabilize solutions, their reliance on time-consuming iterative\noptimization and idealized assumptions about optical parameters often results in slow convergence and limited accuracy in\nheterogeneous tissues. Deep learning (DL) methods, particularly en-decoder-based neural networks [15] [21] and graphbased networks [22] [24], have recently been used in FMT\nreconstruction by learning direct mappings from boundary\nmeasurements to fluorescence distributions. These approaches", "2", "encode physical priors within network parameters, enabling\noverwhelmingly rapid inference. However, their dependence\non supervised training with large, scenario-specific datasets restricts generalizability across variable experimental conditions\n(e. g.", ", tissue object geometry and optical properties), leading\nto significant accuracy degradation when the object properties\ndeviate from training assumptions. Recently, implicit neural representation (INR) models have\nemerged as a powerful alternative for medical image reconstruction. By mapping arbitrary spatial coordinates to certain\nunknown physical quantities via a coordinate-based multilayer perceptron network (MLP), INRs achieve continuous\n3D representations, self-supervised training, and memory efficiency.", "Originally popularized in computer vision and medical imaging, INRs have demonstrated remarkable success\nin modalities such as computed tomography (CT), magnetic\nresonance imaging (MRI) [25] [29], and notably in diffuse\noptical tomography (DOT), where INR has been proven to be\nable to capture a high-resolution, continuous optical absorption\nmap that account for light scattering in complex tissues [30]. INR captures continuous spatial information and integrates\nphysical priors makes it particularly suited for various imaging problems. In the context of FMT, preliminary work has\nexplored position encoding strategies to enhance spatial resolution and improve the quality of FMT reconstructions [31].", "Nevertheless, systematic studies integrating optical diffusion\nphysics within an INR framework remain scarce. This gap\npresents an opportunity to harness the strengths of implicit\nmodeling for robust and data-efficient FMT reconstruction. To bridge this gap, we propose neural-field-based FMT, or\nNeuFMT, a physics-driven reconstruction framework unifying\nINR with explicit physical models.", "Unlike conventional DLbased FMT reconstruction algorithms that couple explicit\nfluorescence predictions to implicit physical model, NeuFMT\nintegrates the DE-based forward model in the network loss,\nenabling self-supervised training without paired data. The\ndifferentiability of the forward model is achieved via finite\nelement method (FEM). This inversion-free approach ensures\nrapid, continuous reconstruction across diverse geometries\nwhile inherently addressing scattering effects.", "Another critical\nlimitation of both traditional and DL methods lies in the\npresumed optical properties of the object during reconstruction, which largely aggravate the ill-posedness of the inverse\nproblem given the optical parameters were initially biased. To\novercome this, we further introduce optical-property-adaptive\nNeuFMT, or NeuFMT, an adaptive extension of NeuFMT\nthat dynamically optimizes scattering / absorption coefficients\nand fluorescence distributions jointly. By integrating an adaptive module of adjusting optical property during the iterations, NeuFMT achieves robust accuracy even when provided\nwith erroneous initial guess of the optical coefficient values,\naddressing the problem of unrealistic assumption prior to\nFMT reconstruction.", "Both proposed INR-based FMT reconstruction algorithms were thoroughly compared and validated\nby simulations and phantom experiments along with other\nmethods. Furthermore, in vivo lymph node imaging in mice\nwas performed, further demonstrating the advantages of the\nproposed methods.", "PREPRINT VERSION 2025", "II. M ETHODS\nA. Forward Modeling of FMT\nModel-based FMT reconstruction comprises two fundamental steps: forward modeling and inversion. The former predicts\nsurface photon density measurements based on an assumed\nfluorescence distribution. At the macroscopic scale, we employ\nthe first-order approximation of the radiative transport equation (RTE), known as the diffusion equation (DE) [32]. The\nexcitation and fluorescence emission processes in continuouswave (CW) mode form a coupled pair of DEs expressed as\n[33], [34]:\n κ ϕx (r) + a ϕx (r) = qx (r),", "r , (1)", "κ ϕm (r) + a ϕm (r) = η C(r) ϕx (r),", "r , (2)", "where ϕx and ϕm denote the excitation and emission photon\ndensity, qx is the excitation source, C(r) is the fluorophore\nconcentration to be reconstructed in the inversion, and η\ncollects quantum-yield factors in the CW source term. κ\nrepresents the diffusion coefficient, calculated by [33]\n1\n,\n(3)\nκ=\n3 ( a + s )\nwith the absorption coefficient a and the reduced scattering\ncoefficient s . In a non-contact setting of FMT, to calculate\nthe value of ϕ (r) on the object surface as the measurement, a Robin-type boundary condition is added alongside the\nequation pair (1 2):\n ϕ (r)\n= 0, {x, m}, r , (4)\n ν\nwhere ζ(c) is the refractive index mismatch parameter that\naccounts for the light reflection on the boundary surface, with\nc representing the light speed inside the medium.", "ν denotes\nthe outward normal on the boundary. Notably, to simplified the\nproblem setting, we only consider a homogeneous medium\ncase and the difference of a , s values under different\nwavelengths are neglected. ϕ (r) + 2 ζ(c) κ", "B. Finite Element Discretization and System Matrix Construction\nWe apply the finite element method (FEM) [35] to the\ndiffusion model (1) - (4). Discretizing with a tetrahedral\nN\nmesh of N\ni }i=1 , we approximate\nP nodes and nodal basis {ψP\nϕ (r) i Φ ,i ψi (r) and qx (r) i (Qx )i ψi (r), which\ntransforms the continuous-form equations into a linear system\nfor excitation and emission photon propagation:\nS Φx = Qx", "(5)", "S Φm = Qm", "(6)", "where S RN N is the system matrix and Φ , Q RN\nare discretized form (coefficient vectors) for ϕ and q , respectively. In particular, the excitation field ϕx interacts with\nfluorophores C RN to produce the emission source term\nQm = C Φx", "(7)", "with denoting element-wise multiplication. The equation\n(7) physically describes how fluorophores absorb excitation", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "explicitly reveals the functional dependence of S on the\noptical parameters a and s , which forms the mathematical\nfoundation for our adaptive optimization approach introduced\nin Subsection II-C.", "(b)", "(a)", "3", "Camera\nFilter Wheel\nReal Measurement\nSample", "C. INR-based FMT reconstruction: NeuFMT / NeuFMT\nScanners", "Laser\nPredicted\nMeasurement", "Focal Lens OD Filter\n(c)", "(d)", "Adaption Module", "Forward Model\nBased on DE", "Absorption Term\nHigh Absorption", "Low Absorption", "inv\nDi usion Term", "High Scattering", "Sti ness Matrix", "Low Scattering\nBoundary Term", "(e)", "Forward Data\nBackward Gradient", "Fluorescence Distribution Encoded with INR\nNode Coordinate", "3D Mesh with", "Nodes", "sine", "cosine", "Positional\nEncoding", "MLP", "Fig. 1. Conceptual illustration of NeuFMT.", "(a) The FMT setup: a scanned\nlaser illuminates the sample while a CMOS camera with filter wheel on the\nopposite side records boundary images. The raster scanning method yields\nthe raw 2D image stack M real , serving as the input to the subsequent FMT\nreconstruction. (b) The difference between M real and the simulated meac( a , , Cθ ) is iteratively minimized until an optimized value\nsurement M\ns\nof unknown fluorescence distribution C is found.", "R(C) is a regularization\nterm and { a , s } is the intrinsic optical properties consisting of\nabsorption coefficient a and scattering coefficient s . (c) A -adaption\nmodule is integrated into the FMT reconstruction. The stiffness matrix S is\ndetermined by both a and s .", "(d) The FEM-based simulator predicts virtual\nc( a , , Cθ ) based on the operator S 1 ( ) and predicted\nmeasurement M\ns\nfluorescence distribution C. (e) Fluorescence distribution encoded in an INR. 3D node coordinate serves as input, while a continuous C map is generated\nthrough positional encoding and an MLP network.", "Unlike traditional voxel-based or mesh-dependent representations, INR provides a continuous, memory-efficient framework for modeling complex physical fields. The basic variant,\nNeuFMT, learns only the fluorophore Cθ with fixed optical\nproperties; the proposed adaptive NeuFMT jointly optimizes\nthe optical coefficients ( a , s ) with Cθ for enhancing the\nreconstruction accuracy and robustness. In this section, we\ndescribe the NeuFMT representation, formulate the learning\nobjective, introduce optical-property adaptation, and summarize the network architecture and implementation.\n1) INR representation of the unknown fluorescence: Our\n NeuFMT model the 3D fluorescence field as an INR, i.e., a\ncoordinate-conditioned MLP:", "Cθ (r) = fθ Γ (r) ,\n(10)\nwhere r = (x, y, z) R3 , Γ : Rd is a highdimensional positional encoding of spatial coordinates, and\nfθ : Rd R is an MLP with parameters θ. This INR formulation (10) enables resolution-independent reconstruction and\nnaturally accommodates arbitrary spatial queries without being\nconstrained by the conventional discrete grid structure.\nTo enhance the network s ability to represent high-frequency\ndetails, which is crucial for resolving complex in vivo fluorescence patterns, we apply a sinusoidal positional encoding to\neach coordinate component. Let γ : R R2L be\nγ(p) = sin(20 πp), cos(20 πp), ,\nL 1", "sin(2", "πp), cos(2", "L 1", "(11)", "πp) ,", "p {x, y, z},", "photons and re-emit light at longer wavelengths. The emission\nsource Qm then propagates through the same medium to\nproduce the emission photon density Φm , which is finally\ndetected at the boundary, which is computed as", "where L is the number of frequency bands. The\n 3D position\nis then encoded as Γ (r) = γ(x), γ(y), γ(z) R6L , so that\nd = 6L. Feeding Γ (r) into fθ enables compact representation\nof both low- and high-frequency variations in Cθ .\n2) Learning objective: We estimate the fluorescence field\nCθ and, in NeuFMT, the optical properties { a , s } by\nminimizing a data-fidelity term plus regularization:", "M = P Φm", "c( a , , Cθ ) M real 2 + λ R(Cθ ), (12)\nL( a , s , θ) = M\ns\n2", "(8)", "where P represents the transfer function, which maps the\nboundary photon density Φm the measurement data M acquired by the camera. The above linearized forward model\nprovides the physical foundation for the inversion procedure.\nCrucially, the SPD FEM stiffness matrix S( a , s ) \nN N\nR\nin (5) (6) encode the optical properties and boundary\ngeometry, generating from a linear combination of matrices\ncorresponding to distinct physical components [33], [36]", "1", "Sd + Sb . (9)\nS( a , s ) = c a Sa +\n3( a + s )\nwith Sa , Sd , and Sb the assembled absorption, diffusion, and\nRobin-boundary matrices, respectively. This decomposition", "c denotes the boundary measurements, and R(Cθ ) is\nwhere M\na regularization term applied to the fluorescence distribution.\nThe hyperparameter λ controls the regularization strength,\nbalancing data fidelity with sparsity constraints. The training of\n NeuFMT / NeuFMT follows a fully self-supervised paradigm\nthat explicitly integrates the DE-based physical model into\nthe optimization loop. Note that NeuFMT uses fixed optical\nparameters ( a , s ), whereas NeuFMT updates jointly.\n3) Alternating optical-property adaptation: A fundamental\ninnovation of NeuFMT lies in formulating the entire photon propagation process from excitation to emission as an\nend-to-end differentiable map. The forward model follows a", "4", "PREPRINT VERSION 2025", "precise physical sequence from excitation source to surface\nmeasurements, as described in Subsection II-B:", "c( a , s , Cθ ) = P S( a , s ) 1 Cθ S( a , s ) 1 Qx ,\nM\n(13)\nWe optimize the introduced objective L( a , s , θ) in (12),\njointly updating network parameters θ and optical coefficients\n( a , s ). The chain in (13) contains only differentiable operations, including linear solves, elementwise products, and linear\nc is differentiable w.r.t. both Cθ (hence θ)\nprojections. Thus M", "and ( a , s ), enabling standard gradient-based training. For\ncompleteness, we state the chain-rule decomposition of the\nloss gradient with respect to ( a , s ). Based on (13), the\ngradient splits into an emission term and an excitation term:", "c \n S\n L M\n L\n S 1\n=\nΦm +\nc Φm", "{z\n}\n| M\nEmission pathway", "c Φm Qm \n L M\n S\nΦx\n S 1\nc Φm Qm Φx", "| M\n{z\n}", "(14)", "Excitation pathway", "{ a , s }.\nThe only model-specific ingredient of a and s is the\nJacobian of S( a , s ). According to (9), the partial derivatives\nare", "S\n1\n= c Sa \nSd ,\n a\n3( a + s )2", "S\n1\n=c \nSd . (15)\n s\n3( a + s )2\nThis allows a and s to be optimized directly using gradient\ndescent, and then be updated together with θ, bridging the\nlearning process with the underlying physical model. To mitigate potential coupling effects between a and s\nduring optimization, we propose an alternating update strategy,\nwhich periodically updates one optical parameter with the\nother fixed.", "The alternating framework largely promotes training stability to avoid oscillations with sufficient computational\nefficiency. The complete NeuFMT algorithm is described in\nAlgorithm 1. Overall, the alternating -adaption module ensures that each optical parameter receives dedicated optimization attention while maintaining the physical consistency of\nthe forward model, yielding more accurate FMT reconstruction\nresults even in the presence of mismatch between the initial\nguess and ground truth of the optical properties.", "4) Network architecture and implementation: We adopt\nMLP for the NeuFMT / NeuFMT, comprising 8 fullyconnected layers with 512 hidden units each, followed by\na final layer with 128 units. ReLU activation functions are\nemployed throughout the network. A critical skip connection\nbridges the input Γ (r) to the 4th hidden layer, facilitating\ngradient flow and enhancing the ability to learn fine-grained\ndetails.", "This architectural choice is particularly suited for FMT\napplications where accurately reconstructing high-contrast targets against complex backgrounds is essential. We implement the NeuFMT / NeuFMT framework with\nPyTorch, leveraging its automatic differentiation capability to", "compute the gradient through both MLP and the physical\nmodel. Adam optimizer is used with the initial learning rates\nof 10 4 for θ update, 10 3 for scattering coefficient and\n10 5 for absorption coefficient. To improve the computational\nefficiency, a learning rate decay is applied for MLP update.", "These rates are determined empirically to ensure stable convergence. The L1 regularization parameter λ is set to 10 6\nbased on cross validation. The training typically requires 200020000 iterations to achieve satisfactory reconstruction quality,\nwith the entire process completing within 3 30 minutes on\na single NVIDIA RTX 3090 GPU for problems of varying\nscales.", "The FEM discretization is built on TOAST++ toolkit\n[37], and the FMT simulation is based on a modular software\nplatform STIFT [38] in MATLAB (R2024b, MathWorks, MA,\nUS) using a desktop computer (Intel Core i5-12600 CPU @\n3. 30 GHz, 128 GB RAM). Algorithm 1 NeuFMT\nRequire: Real measurements M real , light speed c, stepsizes\nαθ , αa , αs , alternation period T , total iterations K\n1: Initialize θ, a , s ;\n2: Precompute Sa , Sd , Sb , Qx , P\n3: Compute S via (9);\n4: for i = 1 to K do \n5:\nC = fθ Γ (r)\n6:\nSolve Φx RN satisfying S Φx = Qx\n7:\nQm = C Φx\n8:\nSolve Φm RN satisfying S Φm = Qm\nc = P Φm\n9:\nCompute predicted measurements: M\nreal 2\nc\n10:\nCompute loss: L = M M 2 + R(C)\n11:\nUpdate MLP parameters: θ = θ αθ L\n θ\n12:\nif i mod\n T = 0 then\n13:\nif i/T is even then\n L\n14:\nUpdate absorption: a = a αa \na\n15:\nelse\n L\n16:\nUpdate diffusion: s = s αs", "s\n17:\nend if", "1\n18:\nUpdate S = c a Sa +\nS\n+\nS\nd\nb ;\n3( a + s )\n19:\nend if\n20: end for\n21: Output: fluorescence C, optical parameters a , s", "D. FMT System Setup\nWe devised a continuous-wave (CW) FMT system\n(SHMOT) [39], [40] as depicted in Fig. 1 (a), which incorporates a 16-bit CMOS camera (Edge 4.2, PCO, Germany) with\n2048 2048 pixel resolution and a filter wheel (FW102C,\nThorlabs, NJ, US) for selective wavelength detection. A\ntunable laser source (SuperK EXTREME, NKT, Denmark),\nspanning 400-890 nm, provides fluorescence excitation with a\npower density of approximately 2 mW/mm2 at the sample\nplane. The imaging object can be positioned on a heightadjustable platform, while a galvanometer-driven mirror system (basiCube 10, SCANcube, Germany) mounted aside steers\nthe laser beam to raster-scan either the top or bottom object", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "surface, enabling switchable reflection-/transmission-mode detection. During experiments, the camera exposure time was\nfixed at 500 ms, with pixel binning applied to improve the\nsignal-to-noise ratio. The acquired raw 2D image data serve\nas supervision target for NeuFMT / NeuFMT reconstruction\n(Fig. 1 (b)). It worth mentioning that our FMT system also\nintegrates a programmable line-scanning illumination, which\nenables high-precision extraction of the surface geometry\nwith approximated maximum error of 0.1 mm. The extracted\nsurface information is then leveraged as prior knowledge for\nFEM meshing and improving reconstruction accuracy.", "E. Phantom preparation and optical calibration\nIn our validation, the slab phantomswere cast from silicone (SYLGARDTM 184; DOW, CA, USA) to emulate softtissue matrix. Optical properties were tuned by dispersing\ntitanium dioxide (TiO2 ; Colins, Shanghai, China) and carbon\nblack powder (Colins, Shanghai, China) as scattering and\nabsorbing additives, respectively. In all phantoms, TiO2 and\ncarbon black were uniformly distributed. All the designs\nshown in Fig. 4 (a) used the same TiO2 /carbon-black mixing\nratio, yielding isotropic media with identical absorption and\nscattering parameters.", "F. In Vivo Lymph Node FMT Imaging\nFollowing numerical simulations and phantom experiments,\nwe evaluated the proposed method in vivo in a murine lymph\nnode imaging task. In cancer diagnostics, lymph node metastasis is a key prognostic indicator of tumor progression.", "Fluorescence imaging enables rapid screening of sentinel lymph\nnodes [41]. In our experiment, all animal procedures were approved by\nthe Institutional Animal Care and Use Committee of ShanghaiTech University (Approval No. 20211115001).", "5 female\nBALB/c mice (8 weeks old) were obtained from Shanghai\nJihui Laboratory Animal Breeding Co. Ltd. and housed under\na circadian rhythm of 12 hours of day and night alternation.", "Before taking imaging experiments, fur was removed over the\nwhole body. For FMT reconstruction, we assumed an optically\nhomogeneous medium with properties calibrated during the\nexcitation step with ( a = 0. 0055 mm 1 , s = 1.", "1 mm 1 ). We followed a three-stage protocol fluorescent-dye injection, imaging, and ex vivo validation. Prior to FMT imaging, Cy5-saline solution (1.", "2146 mol mL 1 , 40 L) was injected subcutaneously into the left forepaw to drive lymphatic\ndrainage toward the sentinel lymph nodes and create a highintensity target. Next, follow-up FMT measurements were\nacquired using the system setup in Subsection II-D. Finally,\nafter data collection, ex vivo verification was performed using\na fluorescent stereoscopic microscope (MVX10, Olympus,\nJapan; 6.", "3 objective). Illumination was provided by a heightadjustable 630 nm LED at 20 mW cm 2 . White-light and\nCy5-channel fluorescence images were recorded using filters\nmatched to the Cy5 spectrum, and the lymph nodes were\nidentified, excised, and imaged to validate the in vivo findings.", "5", "III. R ESULTS\nA. Convergence Verification of Optical Property Adaptive\nOptimization\nTo validate our proposed optical property adaptation mechanism, we conducted a series of numerical experiments on\na digital phantom.", "The primary objective was to demonstrate\nthat the -adaption module can robustly recover absorption a\nand s coefficients from severely erroneous initial estimates,\nthereby enabling high-fidelity fluorescence reconstruction. We constructed a homogeneous digital slab phantom of size\n55 55 15 mm3 featuring an S -shaped fluorescent target at\nits geometric center. The ground-truth optical properties were\n 1\nset to true\nand s true = 1.", "0 mm 1 . To rigorously\na = 0. 1 mm\ntest the correction capability, we initialized the reconstruction\nwith significantly mismatched scattering coefficients ( s init =\n0.", "5, 1. 5, 2. 0 mm 1 ) while keeping the absorption coefficient\nfixed at its true value for this specific test.", "As summarized in Fig. 2 (a), without the -adaption module, the reconstructed fluorescence distributions suffered from\nsubstantial errors in both depth localization and morphological accuracy. The mismatched s value led to an incorrect\nmodel of photon propagation, which directly translated to\ndistorted reconstructions.", "In contrast, when the -adaption\nmodule was enabled, the proposed NeuFMT successfully\nrecovered fluorescence distributions that closely matched the\nground truth obtained with the correct optical properties. Crucially, the evolution of the scattering coefficient during\noptimization, plotted in Fig. 2 (b), demonstrates the module s\nrobust convergence.", "Regardless of the initial value whether\nhalved or doubled the estimated s reliably converged to the\nneighborhood of the true value (1. 0 mm 1 ). A similar convergence behavior was observed for the absorption coefficient a .", "When initialized with biased values\n 1\n( init\n) against a fixed true s , the a = 0. 05, 0. 15, 0.", "2 mm\nadaption module corrected a with an average error of only\n1. 5% (Fig. 2 (d)), and its convergence curves are shown in\nFig.", "2 (e). This convergence robustness was maintained across\na range of true a and s values, confirming the general\nefficacy of our alternating optimization strategy in mitigating\nparameter coupling (Fig. 2 (c), (f)).", "We further extended the validation to the most challenging\nscenario, where both optical parameters were simultaneously\ninitialized with substantial errors. In this experiment, the initial\nvalues for both a and s were set to 50% higher than\ntheir GT values. Remarkably, even under these highly adverse\nconditions, the -adaption module successfully drove both\nparameters towards their true values.", "The convergence trajectories remained stable and ultimately reached a neighborhood\nof the true parameter pair. These results collectively verify\nthat the integrated -adaption module empowers NeuFMT\nto jointly recover accurate optical properties and fluorescence\ndistributions even from profoundly inaccurate initial guesses,\neffectively addressing a critical source of ill-posedness in\npractical FMT scenarios.", "6", "PREPRINT VERSION 2025", "0.995", "1.0", "0.996", "1.5", "1.007", "2.0", "1.006", "GT\ny\nx", "DICE =\n0.0257", "0.7337", "0.4660", "Norm.int (a.u.)", "= 1.0\n= 0.1", "Non-Adaptive", "1", "0.3967", "(b)", "1.2\n1.0", "(c)", "1.6", "Adaptive", "y", "0.7198", "0.7230", "0.6964", "Norm.int (a.u.)", "z", "0.7796", "0.9\n 0.8\n 0.5\nAsym.\nLine", "0.8\n0.4", "2", "4", "6", "8", "10", "12", "14", "0.12\n 0.11", "1.4", "Predicted", "z=8", "2.0\n 1.5\n 1.2\n 1.1", "1.6", "0\n1", "2.0", "Predicted", "0.5", "(a)", "0.10\n 0.09", "1.2", "0.08\n1.0", "0", "Asym.\nLine\n1", "2", "4", "8", "16", "32", "64", "iterations\n0.10", "0.100", "0.15", "0.101", "0.20", "0.102", "y\nx", "0.0281", "0.7337", "0.7390", "Norm.int (a.u.)", "GT", "0.5991", "z=8\nz", "Adaptive", "y", "0.6718", "0.7642", "0.8740", "0.8708", "(e)", "0.2", "= 1.0\n= 0.1", "GT", "0.11\n 0.09", "0.12\n0.1\n0.08", "0", "0.04", "1", "(f) 0.16\n0.14", "2", "4", "6", "8", "10", "12", "0.08\n 0.05\nAsym.\nLine", "14", "1.2\n 1.1\n 1.0\n 0.9", "0.12", "0.8\n0.1", "0", "(g)", "0.20\n 0.15\n 0.12", "0.16", "Norm.int (a.u.)", "= 1.0\n= 0.1", "Non-Adaptive", "1", "Predicted", "(d)", "0.097", "Predicted", "0.05", "Asym.\nLine\n1", "2", "4", "8", "16", "32", "64", "iterations\n2000 iters", "5000 iters", "10000 iters", "20000 iters\n1", "y", "(h)", "1.6", "0.16", "1.4", "0.14", "1.2", "0.12", "1.0", "0.1", "0.8125", "0.8651", "0.8691", "z\ny", "= 1.5\n= 0.15", "1.333\n0.1332", "1.177\n0.1156", "1.050\n0.1045", "1.001\n0.0995", "0", "0.8", "2", "5", "8", "11", "14", "17", "Predicted", "0.6481", "Norm.int (a.u.)", "z=8", "Predicted", "x", "0.08\n20", "iterations", "Fig. 2. Ablation test for the optical-property-adaption ( -adaption) module in NeuFMT.", "(a-c) Effective test for the correction of s . (a) For a homogeneous\nphantom simulation with a S -shaped fluorescence inclusion, the ground truth (GT) of a and s values are 0. 1 mm-1 and 1.", "0 mm-1 respectively. A\nmismatched initial guess of s was assumed for FMT reconstruction. The -adaption module successfully corrects s with an average error of 0.", "55%,\nleading to significantly improved FMT reconstruction results compared to non-adaptive NeuFMT. (b) Convergence curve of s given more initial s values\nranging from 0. 5 to 2 GT value under the same setting of (a).", "(c) Convergence curve of s value across all cases with different a values, given\ninitial s = 1. 5 mm-1 . (d-f) Effective test for the correction of the absorption coefficient ( a ).", "(d) For the same phantom in (a), a (mismatched) a initial\nvalue is assumed for FMT reconstruction. The -adaption module successfully corrects a with an average error of 1. 5%, leading to significantly improved\nFMT reconstruction results.", "(e) Convergence curve of a given more initial a values ranging from 0. 5 to 2 GT value under the same setting of (d). (f) Convergence curve of a value across all cases with different s values, given initial a = 0.", "15 mm-1 . (g-h) Effective test for the correction of both\nabsorption and diffusion coefficients. (g) For the same phantom in (a), given mismatched initial a = 1.", "5 and s = 0. 15, both of which are 50% higher than\nGT, the -adaption module successfully corrects both a and s at the same time. (h) Convergence curve given the iteration process in (g) for both optical\ncoefficients.", "B. Numerical Simulations\nTo comprehensively evaluate the performance of the proposed NeuFMT under controlled conditions, we designed\nfour distinct numerical phantoms (Fig. 3 (a) (d) respectively)\nto systematically increase the reconstruction challenge:\n Case 1 - single small target: a 3 mm-diameter spherical\nfluorescence target embedded in a homogeneous cuboid\nphantom (55 55 15 mm3 ), serving as a baseline\nfor evaluating localization and quantitative accuracy of\na simple, isolated inclusion.\n Case 2 - complex surface geometry: a 2 mm-diameter\nspherical target inside a phantom with a curved surface\ngeometry, featuring a spherical cap top (base: 50 50 4\nmm, cap height = 5 mm, total height = 9 mm). This\ncase tests the method s robustness to non-planar surface\ntopography.", "Case 3 - complex target shape: a large peanut-shaped fluorescence region with uniform concentration embedded in\na standard cuboid phantom same as Case 1. This scenario\nassesses the capability to recover intricate morphological\ndetails beyond simple spheres.\n Case 4 - multi-target with background: the same peanutshaped region as in Case 3, but with the addition of\na small, high-concentration spherical target inside. This\nrepresents a highly realistic and challenging condition,\ntesting the ability to resolve targets of different concentrations and shapes against a noisy background.", "The ground-truth optical properties for all simulated measurements in this test were set to a = 0.1 mm 1 and s = 1.0\nmm 1 , and a 5% gaussian noise is added to all simulated measurements. For each case, we compared our NeuFMT against\nfour established methods: conventional Tikhonov-regularized", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "GT", "L2-CG", "L1-FISTA", "U-Net", "NeuFMT", "μNeuFMT\n1", "y\nx", "y", "z", "DICE =\n0.6581", "z=8", "0.4956", "0.6446", "Norm.int (a.u.)", "Case 1", "(a)", "0.8800", "0.5128", "0\nz", "y\nx", "y\nx", "y", "z", "0.6286", "z=2", "0.7500", "0.0000", "Norm.int (a.u.)", "Case 2", "(b)", "1", "0.7586", "0.2041", "0\nz", "y\nx", "x", "y", "z", "z=8", "0.6938", "0.0828", "0.6153", "Norm.int (a.u.)", "Case 3", "(c)", "1", "y", "0.9751", "0.4766", "0\nz", "y\nx", "y\nx", "y", "z", "0.5435", "z=8", "0.5908", "0.2637", "Norm.int (a.u.)", "Case 4", "(d)", "1", "0.8983", "0.7645", "0\nz", "y\nx", "Norm.int (a.u.)", "(e)", "Case 1", "Case 2", "Case 3", "Case 4", "1", "1", "1", "1", "0.8", "0.8", "0.8", "0.8", "0.6", "0.6", "0.6", "0.6", "0.4", "0.4", "0.4", "0.4", "0.2", "0.2", "0.2", "0", "15", "20", "25", "30", "35", "40", "0\n15", "0\n20", "25", "30", "mm", "GT", "L2-CG", "35", "0.2\n0", "10", "mm", "L1-FISTA", "20", "30", "40", "50", "0", "15", "20", "25", "30", "35", "mm", "U-Net", "NeuFMT", "40", "mm", "μNeuFMT", "Fig. 3. Results of numerical phantom simulations. (a) (d) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (e) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.", "conjugate gradients (L2 -CG) [42] and L1 -regularized nonnegative least squares (L1 -FISTA) [43], a pretrained supervised U-Net, and our baseline method NeuFMT without adaption. The U-Net was trained on a large, synthetically\ngenerated dataset of 5,488 samples. For each sample, the\ninput was a boundary measurement simulated using the DEbased forward model under the ground-truth properties in a\ncuboid phantom (55 55 15 mm3 ), and the label was the\ncorresponding 3D fluorescence map of 1 2 ellipsoids with\nrandom sizes and spatial positions.", "To clearly demonstrate the\neffect of the -adaption module, we focused on adapting s\nwhile fixing a at its true value during reconstruction. For all\nmethods, the initial s was set to an erroneous value of 1. 2\nmm 1 , which is 20% higher than the ground truth.", "The results presented in Fig. 3 (a) (d) demonstrate the\nconsistent superiority of NeuFMT across all four numerical cases. We observe that the conventional methods were\nadversely affected by the optical property mismatch: L2 -CG\nreconstructions were characteristically blurred and exhibited\nsignificant depth errors, such as full-depth penetration in\nCases 3 and 4 and depth-wise expansion in Case 1.", "L1 -FISTA\nfrequently introduced non-physical, fragmented artifacts, such\nas staircase patterns in Case 1 and hollow structures in Case 3,\nwhile it also suffered from severe depth inaccuracy. The\nsupervised U-Net, though performed well in Case 1, showed\nlimited generalization beyond its training data, as seen in its\nlocalization failure in the complex surface geometry of Case 2", "7", "and noticeable shape distortion in the unseen peanut-shaped\ntarget of Case 3 and 4. The direct NeuFMT provided better\ndepth prediction than the traditional methods but remained\nsensitive to the erroneous s , resulting in substantial shape\nexpansion in the x-y plane (Cases 1, 2) and axial splitting\n(Case 3). In contrast, NeuFMT successfully rectified the\noptical properties and overcame these limitations.", "It achieved\nthe most accurate spatial localization and shape fidelity, as\nevidenced by its 3D isosurfaces tightly conforming to the\nground truth in both simple and complex targets, and it clearly\nresolved both the small target and the complex background in\nCase 4. Quantitatively, NeuFMT consistently achieved the\nhighest Dice coefficients, and its intensity profiles (Fig. 3 (e))\nmost closely matched the ground truth in terms of peak\nlocation, width, and background suppression.", "C. Phantom Experiments\nWe further evaluated the performance of all methods using\nphysical phantom experiments to assess their practicality under real-world conditions, including measurement noise. The\nphantoms were fabricated from silicone, with their optical\nproperties calibrated to be approximately a = 0.", "0055 mm 1\nand s = 1. 1 mm 1 at 680 nm. Fluorescent targets were embedded within the phantoms to create the four cases previously\ndefined in the simulations.", "The initial value of s was set identically for all reconstruction methods as the calibrated value,\nand also the U-Net was retrained accordingly. Consistent with\nthe simulation study, we focused on the adaptive recovery of\nthe reduced scattering coefficient s . The reconstruction results are summarized in Fig.", "4. Under\nthese challenging real-world conditions, the limitations of the\nbaseline methods became evident: conventional approaches\n(L2 -CG, L1 -FISTA) produced blurry or fragmented reconstructions with significant depth errors, while the supervised\nU-Net, susceptible to domain shift and noise, failed to generalize, resulting in complete localization failures (Case 1)\nor severely distorted shapes (Cases 3 and 4). In contrast,\nthe INR-based frameworks, NeuFMT and NeuFMT, demonstrated markedly superior robustness, consistently yielding\nphysically plausible and continuous reconstructions where\nother methods failed.", "A detailed comparison between the two\nreveals that NeuFMT provided critical refinements toward\nenhanced physical consistency. In Cases 1 and 3, NeuFMT\nachieved better depth sensitivity and more uniform fluorophore\ndistribution, more faithfully representing the homogeneous\nnature of the true targets. In the complex geometry of Case 2,\nit uniquely achieved accurate localization, whereas direct\nNeuFMT produced a solution with an aberrant depth shift.", "For\nthe multi-target scenario in Case 4, NeuFMT reconstructed\nthe background region with improved morphological accuracy. Although the performance gap in quantitative metrics such\nas the Dice coefficient was occasionally narrow, which reflects the inherent robustness of the shared INR architecture,\n NeuFMT provided consistent, subtle refinements, particularly\nin depth accuracy. The phantom experiments confirm that the\nadaptive physical correction mechanism in NeuFMT can enhance reconstruction fidelity under practical conditions where\nthe exact coefficient in most real experiments is uncertain.", "8", "PREPRINT VERSION 2025", "(a)", "Silicone Phantoms\nGT", "L2-CG", "L1-FISTA", "U-Net", "NeuFMT", "μNeuFMT\n1", "y\nx", "y", "z", "DICE =\n0.5895", "z=8", "0.6154", "0.0762", "Norm.int (a.u.)", "Case 1", "(b)", "Fluorescence Inclusions", "0.7023", "0.6615", "0\nz", "(Fig. 5 (c)). The reconstructed target lengths from NeuFMT\nshowed the closest agreement with the physical measurements\ntaken from the ex vivo lymph nodes, as visualized by the\nintensity profiles in Fig. 5 (c). These results demonstrate that\n NeuFMT provides a definitive advantage in practical in vivo\nscenarios, enabling robust and accurate target segmentation\nand localization under complex clinically related scenarios,\nsuch as fluorescence guided surgery.", "y\nx", "y\nx", "y", "z", "0.3371", "z=2", "0.3810", "0.4000", "0.5200", "0.2586", "White Light Image", "(a)", "vein", "LN-2", "0\nz", "y\nx", "y", "z", "z=8", "0.5413", "0.3358", "0.7011", "0.8230", "0.8050", "0\nz", "y\nx", "y\nx", "y", "z", "0.5193", "z=8", "0.4319", "0.6601", "0.2849", "Norm.int (a.u.)", "0.6240", "NeuFMT", "μNeuFMT\nz\nx", "vein", "LN-3\nLN-2\nLN-1", "Case 3", "Case 4", "1", "1", "0.8", "0.8", "0.6", "0.6", "0.6", "0.6", "0.4", "0.4", "0.4", "0.4", "0.2", "0.2\n20", "25", "30", "35", "40", "0\n15", "0.2\n20", "25", "30", "mm", "GT", "L2-CG", "35", "0.2", "0", "0\n0", "10", "mm", "L1-FISTA", "20", "30", "40", "50", "15", "20", "25", "30", "35", "mm", "U-Net", "NeuFMT", "40", "mm", "NeuFMT-Ada", "Fig. 4. Results of real phantom experiments. (a) Photograph of the real\nsilicone phantoms and fluorescence inclusions. (b) (e) Ground truth (GT)\nand FMT reconstruction results from five methods (L2 -CG, L1 -FISTA, UNet, direct NeuFMT, and NeuFMT) across four numerical cases. For each\nmethod, two cross-sections (along XY- and XZ-planes), a 3D isosurface, and\nthe Dice coefficient are displayed. (f) Intensity profiles along the dashed lines\nin the XY slices are compared for the four cases.", "10 mm", "(c)", "We performed an in vivo imaging experiment on mice. Following the protocol described in Subsection II-F, Cy5\nfluorescent dye accumulated primarily at the sentinel lymph\nnodes (LN), with some residual signal at the vein (Fig. 5 (a)).", "Our task was to reconstruct the spatial location and shape of\nthe sentinel lymph nodes. The 3D FMT reconstruction results from all methods\nare presented in Fig. 5 (b).", "The conventional L2 -CG method\nproduced a reconstruction where the volume of LN-3 was\noverestimated, and the signals from LN-1, LN-2, and the vein\nmerged into a single, indistinguishable cluster. The L1 -FISTA\nreconstruction was highly fragmented, making it impossible\nto discern the shape or count of the lymph nodes accurately. Also, the baseline NeuFMT failed to produce a physiologically plausible reconstruction.", "In contrast, NeuFMT was\nthe only method that successfully and distinctly resolved all\nthree lymph nodes (LN-1, LN-2, LN-3) and the vein, clearly\nidentifying each as separate, localized regions of fluorescence. For quantitative validation, the mouse was sacrificed, and\nthe lymph nodes were excised to be imaged by ex vivo FRI", "LN-1", "x\ny", "LN-3 LN-2", "10 mm", "0", "1", "1", "1", "0.8", "0.8", "0.8", "0.6", "LN-1", "0.4", "0.6", "LN-2", "0.4", "0.2", "0.6", "0.2", "0\n2", "4", "6", "L2-CG", "8", "10", "12\nmm", "LN-3", "0.4", "0.2", "0\n0", "D. In Vivo Lymph Node FMT Imaging Experiments", "Concentration of Cy5 (a.u.)", "Case 2\n1\n0.8", "Slice z = 8 mm", "Case 1\n1\n0.8", "x\ny", "Slice z = 11 mm", "(f)\nNorm.int (a.u.)", "L1-FISTA", "R", "1", "Profiles", "y\nx", "15", "L2-CG", "LN-3", "L", "0\nz", "0", "R", "y", "Concentration of Cy5 (a.u.)", "Case 4", "(e)", "1", "(b)", "LN-1", "L", "3D Segmentation", "x", "Norm.int (a.u.)", "Case 3", "(d)", "1", "y", "In vivo FRI", "Norm.int (a.u.)", "Case 2", "(c)", "1", "0\n0", "2", "L1-FISTA", "4", "6", "8", "10", "12\nmm", "0", "2", "NeuFMT", "4", "6", "8", "10", "12\nmm", "μNeuFMT", "Fig. 5. In vivo lymph node FMT imaging and reconstruction results. (a) The\nwhite-light image and preview via 2D fluorescence reflectance imaging (FRI)\noverlaid on the white-light image with the red aera indicating the concentrated\ndistribution of Cy5 probe on the cites of three lymph nodes (LN-1, LN-2, LN3) and the vein. (b) Comparison of FMT reconstruction results from different\nmethods. The 3D segmentation, along with two slices at z = 8 and 11 mm,\nare displayed. (c) Intensity profiles along the dashed lines in b. are compared\nfor each ex vivo images of lymph nodes after sacrificing the animal. The gray\nzone represents the estimated size of LN, based on the ex vivo fluorescence\nimages.", "IV. D ISCUSSION AND C ONCLUSION\nIn this study, we introduced NeuFMT, an optical-propertyadaptive FMT reconstruction framework that integrates INR\nwith an explicitly differentiable FEM-based light propagation model. By unifying a continuous fluorescence field parameterized by an INR and a physics-based forward model\namenable to end-to-end optimization, NeuFMT addresses\ntwo fundamental limitations of existing FMT reconstruction\ntechniques: their inability to efficiently adapt to complex and\nheterogeneous fluorescence distribution, and their reliance on", "ZHAO et al.: NEUFMT: OPTICAL-PROPERTY-ADAPTIVE FLUORESCENCE MOLECULAR TOMOGRAPHY VIA IMPLICIT NEURAL REPRESENTATION", "fixed, often inaccurate, optical properties, which significantly\nexacerbates the inherent ill-posedness of the inverse problem. Unlike supervised deep learning approaches which are constrained by the diversity and scale of training datasets and\noften fail under domain shift, NeuFMT operates in a selfsupervised, physics-informed regime. It does not require paired\ntraining data; instead, it directly minimizes the discrepancy between measured and simulated boundary fluxes.", "This not only\neliminates the need for extensive experimental datasets but also\nensures generalizability across different imaging geometries\nand target configurations. The continuous, coordinate-based\nrepresentation provided by the INR further ensures that our\nreconstructions are free from discretization artifacts and inherently resolution-agnostic. A central contribution of our work is the introduction of\nan optical property adaptation mechanism, which enables the\ndynamic optimization of absorption and scattering coefficients\n( a , s ) concurrently with the fluorescence distribution.", "Our\nframework demonstrates that the integration of a differentiable\nphysics-based forward model is the key to enabling this\nself-supervised adaptation. The FEM-based light propagation\nmodel is not merely a component of the loss function, but\nan active and adaptive part of the inverse solver. This stands\nin contrast to both traditional iterative methods, which hold\noptical properties static and thus aggravate the problem s illposedness, and conventional end-to-end deep learning approaches, which struggle to generalize beyond their training\ndata.", "The adaptivity of our model is thus its core strength,\nproviding a principled way to refine the physical model itself\nbased on the measured data, which is crucial for practical\napplications where precise prior knowledge of tissue optics\nis unavailable. Our results from numerical simulations, phantom experiments, and in vivo mouse imaging collectively demonstrate\nthat NeuFMT achieves superior reconstruction fidelity compared to both conventional (L2 , L1 ) and deep learningbased (U-Net) benchmarks. In particular, the method consistently localized fluorescent targets with higher spatial accuracy, improved contrast, and more realistic morphological\nfeatures especially under challenging conditions involving\nbackground fluorescence and complex geometry.", "Despite these promising results, several aspects of\n NeuFMT merit further investigation. First, the current implementation assumes a homogeneous optical background a\ncommon simplification in FMT studies. Extending the model\nto incorporate spatially varying optical properties represents\na logical next step, potentially by representing a (r) and\n s (r) with additional INRs, though this would significantly\nincrease the complexity of the inverse problem.", "Nevertheless,\nthe proposed NeuFMT can be validated or even combined\nwith time-domain near-infrared spectroscopy (fNIRS) [44],\n[45] or diffuse optical tomography (DOT) [46] techniques,\nwhere the complex optical properties related with absorption\nand scattering can disentangled and calibrated. More importantly, the integration of NeuFMT with emerging imaging\ntechnologies holds particular promise. The inherent adaptivity\nof our framework is well-suited to the distinct scattering\nand absorption landscapes of NIR-II fluorescence tomography", "9", "[47], [48], where our optical property optimization could be\ncrucial for accurately modeling the increased photon penetration and achieving higher-resolution reconstruction at depth. Furthermore, the framework can be naturally extended to\nhyperspectral FMT, using a single INR to output both fluorophore concentration and spectral signature, thereby disentangling multiple probes or accounting for wavelength-dependent\noptical properties. Finally, translating NeuFMT into clinical\nsettings, such as intraoperative fluorescence-guided surgery\n[8], [9], represents an exciting frontier where its adaptability\ncould overcome patient-specific variations in tissue optics.", "In conclusion, by harmonizing a differentiable physics\nmodel with a continuous INR, NeuFMT provides a robust,\nself-supervised, and adaptive framework for FMT reconstruction. It effectively mitigates the ill-posedness inherent to\ninverse problems with uncertain parameters, setting a new\nparadigm for practical, high-resolution fluorescence molecular\nimaging. We believe this physics-in-the-loop INR approach\noffers a generalizable template for tackling a wide range of\ntomographic and inverse problems in biomedical imaging.", "R EFERENCES\n[1] F. Song, P. Zhang, H.", "Wu, C. Ma, Z. Liu, R.", "Cai, Y. Feng, Y. He,\nX.", "Dong, Y. Tian, and G. Zhang, Advances of fluorescence molecular\nimaging: NIR-II window, probes, and tomography, Laser & Photonics\nReviews, vol.", "19, no. 10, p. 2400275, 2025.", "[2] B. Zhu, J. Hendricks, J.", "E. Morton, J. C.", "Rasmussen, C. Janssen,\nM. N.", "Shah, and E. M. Sevick-Muraca, Near-infrared fluorescence\ntomography and imaging of ventricular cerebrospinal fluid flow and\nextracranial outflow in non-human primates, IEEE Transactions on\nMedical Imaging, vol.", "42, no. 12, pp. 3555 3565, 2023.", "[3] M. S. Ozturk and et al.", ", High-resolution tomographic analysis of in\nvitro 3D glioblastoma tumor model under long-term drug treatment, \nScience Advances, vol. 6, no. 10, p.", "eaay7513, 2020. [4] M. Cai, Z.", "Zhang, X. Shi, Z. Hu, and J.", "Tian, NIR-II/NIR-I fluorescence molecular tomography of heterogeneous mice based on gaussian\nweighted neighborhood fused lasso method, IEEE Transactions on\nMedical Imaging, vol. 39, no. 6, pp.", "2213 2222, 2020. [5] S. R.", "Arridge and J. C. Schotland, Optical tomography: forward and\ninverse problems, Inverse problems, vol.", "25, no. 12, p. 123010, 2009.", "[6] L. V. Wang and H.", "-i. Wu, Biomedical optics: principles and imaging. John Wiley & Sons, 2007.", "[7] F. Stuker, J. Ripoll, and M.", "Rudin, Fluorescence molecular tomography:\nprinciples and potential for pharmaceutical research, Pharmaceutics,\nvol. 3, no. 2, pp.", "229 274, 2011. [8] J. S.", "D. Mieog, F. B.", "Achterberg, A. Zlitni, M. Hutteman, J.", "Burggraaf,\nR. -J. Swijnenburg, S.", "Gioux, and A. L. Vahrmeijer, Fundamentals and\ndevelopments in fluorescence-guided cancer surgery, Nature Reviews\nClinical Oncology, vol.", "19, no. 1, pp. 9 22, 2022.", "[9] K. Wang, Y. Du, Z.", "Zhang, K. He, Z. Cheng, L.", "Yin, D. Dong, C. Li,\nW.", "Li, Z. Hu et al. , Fluorescence image-guided tumour surgery, Nature\nReviews Bioengineering, vol.", "1, no. 3, pp. 161 179, 2023.", "[10] D. Zhu et al. , Comparison of regularization methods in fluorescence\nmolecular tomography, Photonics, vol.", "1, no. 2, pp. 95 109, 2014.", "[11] H. Yi et al. , Reconstruction algorithms based on l1-norm and l2norm for two imaging models of fluorescence molecular tomography:\na comparative study, Journal of Biomedical Optics, vol.", "18, no. 5, p. 56013, 2013.", "[12] J. Shi, B. Zhang, F.", "Liu, J. Luo, and J. Bai, Efficient L1 regularizationbased reconstruction for fluorescent molecular tomography using\nrestarted nonlinear conjugate gradient, Optics letters, vol.", "38, no. 18,\npp. 3696 3699, 2013.", "[13] D. Zhu and C. Li, Nonconvex regularizations in fluorescence molecular\ntomography for sparsity enhancement, Physics in Medicine & Biology,\nvol.", "59, no. 12, p. 2901, 2014.", "[14] J. Zhang, L. Li, Q.", "Hu, J. Zhang, Y. Wu, L.", "Gu, J. Li, F. Li, X.", "Zhu,\nJ. Jiang et al. , High-fidelity solution decomposition fluorescence tomography in the presence of background interference, Laser & Photonics\nReviews, p.", "e01013, 2025.", "10", "[15] C. Huang, H. Meng, Y.", "Gao, S. Jiang, K. Wang, and J.", "Tian, Fast and\nrobust reconstruction method for fluorescence molecular tomography\nbased on deep neural network, in Imaging, Manipulation, and Analysis\nof Biomolecules, Cells, and Tissues XVII, vol. 10881. SPIE, 2019, pp.", "257 262. [16] L. Guo, F.", "Liu, C. Cai, J. Liu, and G.", "Zhang, 3D deep encoder decoder\nnetwork for fluorescence molecular tomography, Optics letters, vol. 44,\nno. 8, pp.", "1892 1895, 2019. [17] P. Zhang, G.", "Fan, T. Xing, F. Song, and G.", "Zhang, UHR-DeepFMT:\nultra-high spatial resolution reconstruction of fluorescence molecular\ntomography based on 3-d fusion dual-sampling deep neural network, \nIEEE Transactions on Medical Imaging, vol. 40, no. 11, pp.", "3217 3228,\n2021. [18] J. Cheng, P.", "Zhang, F. Liu, J. Liu, H.", "Hui, J. Tian, and J. Luo, Encoderdecoder deep learning network for simultaneous reconstruction of fluorescence yield and lifetime distributions, Biomedical Optics Express,\nvol.", "13, no. 9, pp. 4693 4705, 2022.", "[19] P. Zhang, C. Ma, F.", "Song, Z. Liu, Y. Feng, Y.", "Sun, Y. He,\nF. Liu, D.", "Wang, and G. Zhang, Multi-branch attention prior based\nparameterized generative adversarial network for fast and accurate\nlimited-projection reconstruction in fluorescence molecular tomography, Biomedical Optics Express, vol. 13, no.", "10, pp. 5327 5343, 2022. [20] P.", "Zhang, F. Song, C. Ma, Z.", "Liu, H. Wu, Y. Sun, Y.", "Feng, Y. He, and\nG. Zhang, Robust reconstruction of fluorescence molecular tomography\nbased on adaptive adversarial learning strategy, Physics in Medicine &\nBiology, vol.", "68, no. 4, p. 04LT01, 2023.", "[21] P. Zhang, X. Liu, Q.", "Xue, Y. Shang, C. Liu, R.", "Chen, H. Gao, J. Liang,\nW.", "Wang, and G. Zhang, PAH2T-Former: Paired-attention hybrid\nhierarchical transformer for synergistically enhanced fmt reconstruction\nquality and efficiency, IEEE Transactions on Computational Imaging,\n2025. [22] H.", "Meng, Y. Gao, X. Yang, K.", "Wang, and J. Tian, K-nearest neighbor\nbased locally connected network for fast morphological reconstruction\nin fluorescence molecular tomography, IEEE transactions on medical\nimaging, vol. 39, no.", "10, pp. 3019 3028, 2020. [23] D.", "Li, C. Chen, J. Li, and Q.", "Yan, Reconstruction of fluorescence\nmolecular tomography based on graph convolution networks, Journal\nof Optics, vol. 22, no. 4, p.", "045602, 2020. [24] Y. Wang, C.", "Bian, Y. An, H. Wang, Q.", "Liang, Y. Du, and J. Tian,\n Graph convolution based residual connected network for morphological reconstruction in fluorescence molecular tomography, in Medical\nImaging 2022: Biomedical Applications in Molecular, Structural, and\nFunctional Imaging, vol.", "12036. SPIE, 2022, pp. 527 533.", "[25] Y. Sun, J. Liu, M.", "Xie, B. Wohlberg, and U. S.", "Kamilov, Coil:\nCoordinate-based internal learning for tomographic imaging, IEEE\nTransactions on Computational Imaging, vol. 7, pp. 1400 1412, 2021.", "[26] L. Lozenski, M. A.", "Anastasio, and U. Villa, A memory-efficient selfsupervised dynamic image reconstruction method using neural fields, \nIEEE Transactions on Computational Imaging, vol. 8, pp.", "879 892,\n2022. [27] A. W.", "Reed, H. Kim, R. Anirudh, K.", "A. Mohan, K. Champley, J.", "Kang,\nand S. Jayasuriya, Dynamic CT reconstruction from limited views\nwith implicit neural representations and parametric motion fields, in\nProceedings of the IEEE/CVF International Conference on Computer\nVision, 2021, pp. 2258 2268.", "[28] L. Shen, J. Pauly, and L.", "Xing, NeRP: implicit neural representation\nlearning with prior embedding for sparsely sampled image reconstruction, IEEE Transactions on Neural Networks and Learning Systems,\nvol. 35, no. 1, pp.", "770 782, 2022. [29] R. Liu, Y.", "Sun, J. Zhu, L. Tian, and U.", "S. Kamilov, Recovery\nof continuous 3D refractive index maps from discrete intensity-only\nmeasurements using neural fields, Nature Machine Intelligence, vol. 4,\nno.", "9, pp. 781 791, 2022. [30] S.", "Shen, L. Li, S. Gao, Y.", "Wang, L. Gu, S. Li, X.", "Zhu, J. Jiang, J. Yu, and\nW.", "Ren, High resolution diffuse optical tomography via neural fields, \nIEEE Transactions on Computational Imaging, 2024. [31] K. Han, C.", "Li, A. Xiao, Y. Tian, J.", "Tian, and Z. Hu, TSPE: Reconstruction of multi-morphological tumors of NIR-II fluorescence molecular\ntomography based on positional encoding, Computer Methods and\nPrograms in Biomedicine, vol. 261, p.", "108554, 2025. [32] S. R.", "Arridge, Optical tomography in medical imaging, Inverse problems, vol. 15, no. 2, p.", "R41, 1999. [33] , Photon-measurement density functions. part I: Analytical forms, \nApplied Optics, vol.", "34, no. 31, pp. 7395 7409, 1995.", "[34] S. R. Arridge and M.", "Schweiger, Photon-measurement density functions. part 2: Finite-element-method calculations, Applied Optics,\nvol. 34, no.", "34, pp. 8026 8037, 1995.", "PREPRINT VERSION 2025", "[35] O. C. Zienkiewicz, R.", "L. Taylor, P. Nithiarasu, and J.", "Zhu, The finite\nelement method. Elsevier, 1977, vol. 3.", "[36] V. Ntziachristos, C. Bremer, and R.", "Weissleder, Fluorescence molecular\ntomography resolves protease activity in vivo, Nature Medicine, vol. 8,\nno. 7, pp.", "757 760, 2002. [37] M. Schweiger and S.", "Arridge, The Toast++ software suite for forward\nand inverse modeling in optical tomography, Journal of biomedical\noptics, vol. 19, no. 4, pp.", "040 801 040 801, 2014. [38] W. Ren, H.", "Isler, M. Wolf, J. Ripoll, and M.", "Rudin, Smart toolkit\nfor fluorescence tomography: simulation, reconstruction, and validation, \nIEEE Transactions on Biomedical Engineering, vol. 67, no. 1, pp.", "16 \n26, 2019. [39] S. Gao, J.", "Zhang, Y. Hu, Y. Wu, L.", "Li, Q. Hu, X. Lou, X.", "Zhu, J. Jiang,\nand W. Ren, Multifunctional optical tomography system with highfidelity surface extraction based on a single programmable scanner and\nunified pinhole modeling, IEEE Transactions on Biomedical Engineering, 2023.", "[40] Y. Hu, Y. Wu, L.", "Li, L. Gu, X. Zhu, J.", "Jiang, and W. Ren, Simultaneous\nreconstruction of 3D fluorescence distribution and object surface using\nstructured light illumination and dual-camera detection, Optics Express,\nvol. 32, no.", "9, pp. 15 760 15 773, 2024. [41] C.", "Ji, M. Zhao, C. Wang, R.", "Liu, S. Zhu, X. Dong, C.", "Su, and Z. Gu,\n Biocompatible tantalum nanoparticles as radiosensitizers for enhancing\ntherapy efficacy in primary tumor and metastatic sentinel lymph nodes, \nACS nano, vol. 16, no.", "6, pp. 9428 9441, 2022. [42] S.", "Kawata and O. Nalcioglu, Constrained iterative reconstruction by\nthe conjugate gradient method, IEEE Transactions on Medical Imaging,\nvol. 4, no.", "2, pp. 65 71, 1985. [43] A.", "Beck and M. Teboulle, A fast iterative shrinkage-thresholding algorithm for linear inverse problems, SIAM Journal on Imaging Sciences,\nvol. 2, no.", "1, pp. 183 202, 2009. [44] Y.", "Yamada, H. Suzuki, and Y. Yamashita, Time-domain near-infrared\nspectroscopy and imaging: a review, Applied Sciences, vol.", "9, no. 6, p. 1127, 2019.", "[45] H. Y. Ban, G.", "M. Barrett, A. Borisevich, A.", "Chaturvedi, J. L. Dahle,\nH.", "Dehghani, J. Dubois, R. M.", "Field, V. Gopalakrishnan, A. Gundran\net al.", ", Kernel flow: a high channel count scalable time-domain functional near-infrared spectroscopy system, Journal of biomedical optics,\nvol. 27, no. 7, p.", "074710, 2022. [46] A. Pifferi, D.", "Contini, A. D. Mora, A.", "Farina, L. Spinelli, and A. Torricelli, New frontiers in time-domain diffuse optics, a review, Journal\nof Biomedical Optics, vol.", "21, no. 9, pp. 091 310 091 310, 2016.", "[47] F. Wang, Y. Zhong, O.", "Bruns, Y. Liang, and H. Dai, In vivo NIRII fluorescence imaging for biology and medicine, Nature Photonics,\nvol.", "18, no. 6, pp. 535 547, 2024.", "[48] Z. Zhang, Y. Du, X.", "Shi, K. Wang, Q. Qu, Q.", "Liang, X. Ma, K. He,\nC.", "Chi, J. Tang et al. , NIR-II light in clinical oncology: opportunities\nand challenges, Nature Reviews Clinical Oncology, vol.", "21, no. 6, pp. 449 467, 2024."]}
